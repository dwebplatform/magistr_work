var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Word=function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=54)}([function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.u="App_AccessibilityLoopComplete",t.v="WacInitialize_Ready",t.O="Wac_AppFailed",t._="Wac_AppBootState",t.A="Wac_AppCompleted",t.P="BrowserEvent",t.R="UI_Close",t.U="App_CloseTab",t.F="UI_Conversation",t.W="UI_CopyAndEdit",t.N="App_CreateNewDocument",t.H="Wac_AppDataSavedStatus",t.B="UI_Download",t.J="UI_Edit",t.K="Error",t.Z="UI_FileEmbed",t.$="UI_FileProperties",t.X="File_Rename",t.Y="File_RenameFailed",t.tt="UI_FileVersions",t.et="StateChanged",t.it="App_IsFrameTrusted",t.nt="GetAccessToken",t.ot="App_GetAuthToken",t.rt="App_GetCustomAuthConfig",t.st="App_GetHostKeyValue",t.ct="App_WopiInfoFromUrl",t.at="App_LoadingStatus",t.ut="App_SwitchMode",t.ft="App_MoveToFolder",t.ht="App_OpenFile",t.dt="UI_OpenInBrowser",t.lt="UI_OpenInClient",t.pt="PageChanged",t.vt="App_PushCommentContext",t.bt="App_PushState",t.wt="App_DocReboot",t.Ot="UI_RedeemForCommenting",t.gt="App_RefreshSessionInfo",t.jt="UI_ReplyWithChanges",t.St="UI_ReportAbuse",t.It="App_SaveACopy",t.Ct="UI_SaveStatus",t.yt="WopiSession_Complete_Ack",t.Tt="SetOverlayContent",t._t="UI_Sharing",t.At="UI_ShareForm",t.Pt="UI_SignIn",t.Rt="App_StoreHostKeyValue",t.Ut="App_Unloaded",t.Et="Wac_UnloadingApp",t.Ft="PageCount",t.Wt="UI_CheckUserAccessAndGrantPermissions",t.Nt="User_Activity",t.xt="Edit_Notification",t.Mt="UI_Workflow",t.kt="ZoomChanged",t.Ht="Excel_HostFrameCacheSave",t.Dt="Excel_HostFrameCacheEvict",t.Bt="Excel_RegenerateFileBundle"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.Disposed="Disposed",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.ModeSwitched="ModeSwitched",t.CreateNewDocument="App_CreateNewDocument",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.SetOverlayContent="SetOverlayContent",t.MoveToFolder="MoveToFolder",t.OpenFile="OpenFile",t.SaveACopy="SaveACopy"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.BrowserEvent="BrowserEvent",t.Close="Close",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.CreateNewDocument="CreateNewDocument",t.Download="Download",t.Edit="Edit",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.GetAccessToken="GetAccessToken",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.ModeSwitched="ModeSwitched",t.MoveToFolder="MoveToFolder",t.OpenFile="OpenFile",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.PushState="PushState",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SaveACopy="SaveACopy",t.SaveStatus="SaveStatus",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.Vt=0]="msoulscat_ES_EWAJS",t[t.Jt=1]="msoulscat_ES_EWAJSGrid",t[t.Lt=6]="msoulscat_ES_EWAJSChart",t[t.zt=202]="msoulscat_MSOSP_FileMenuCommands",t[t.qt=301]="msoulscat_Wac_WordViewer",t[t.Gt=306]="msoulscat_Wac_BrowserGeneral",t[t.Kt=320]="msoulscat_Wac_TaskPane",t[t.Zt=339]="msoulscat_Wac_OneNoteGeneral",t[t.$t=340]="msoulscat_Wac_Ribbon",t[t.Xt=379]="msoulscat_Wac_WopiPendingApplication",t[t.Qt=383]="msoulscat_Wac_Telemetry",t[t.Yt=391]="msoulscat_Wac_WacCatchUpActivities",t[t.te=394]="msoulscat_Wac_Dictation",t[t.ee=395]="msoulscat_Wac_OneNoteSync",t[t.ie=700]="msoulscat_Wac_VisioApp",t[t.ne=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.oe=800]="msoulscat_Wac_PptAnimation",t[t.re=833]="msoulscat_Wac_PptLive",t[t.se=834]="msoulscat_Wac_PptMWeb",t[t.ce=815]="msoulscat_Wac_PptShape",t[t.ae=817]="msoulscat_Wac_PptSession",t[t.ue=830]="msoulscat_Wac_PptSlideshow",t[t.fe=2300]="msoulscat_Wac_VersionHistory",t[t.he=302]="msoulscat_Wac_WordPresence",t[t.de=3005]="msoulscat_Wac_WordVersionHistory",t[t.le=3006]="msoulscat_Wac_LivePersonaCard",t[t.pe=3012]="msoulscat_Wac_CatchUpFlyout",t[t.ve=3021]="msoulscat_Wac_ModernFontPicker"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return r}));var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function o(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var r=function(){return(r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)}},function(t,e,i){"use strict";var n=i(28);i.d(e,"d",(function(){return n.a}));var o=i(23);i.d(e,"a",(function(){return o.a}));var r=i(29);i.d(e,"b",(function(){return r.a}));var s=i(39);i.d(e,"c",(function(){return s.a}))},function(t,e,i){"use strict";i.d(e,"h",(function(){return o})),i.d(e,"e",(function(){return r})),i.d(e,"f",(function(){return s})),i.d(e,"g",(function(){return a})),i.d(e,"i",(function(){return u})),i.d(e,"j",(function(){return f})),i.d(e,"a",(function(){return d})),i.d(e,"b",(function(){return l})),i.d(e,"c",(function(){return p})),i.d(e,"d",(function(){return v}));var n=i(15),o="word-edit",r="/we/",s="wordeditorframe.aspx",c=r+s,a="wordeditorstartsession.ashx",u="/wv/",f="wordviewerframe.aspx",h=u+f;function d(t){return t.toLowerCase().indexOf(s)>0}function l(t){return t.toLowerCase().indexOf(f)>0}function p(t,e){void 0===e&&(e=!1);var i=t;return i=(i=i.replace(new RegExp(o,"i"),"word-view")).replace(new RegExp(c,"i"),h),e&&(i=Object(n.b)(i,"WordEditorFailedToLoad","1")),i}function v(t){var e=t;return e=(e=e.replace(new RegExp("word-view","i"),o)).replace(new RegExp(h,"i"),c)}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.moveToFolder="moveToFolder",t.openFile="openFile",t.popState="popState",t.rename="rename",t.saveACopy="saveACopy",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.switchMode="switchMode"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.me="Ack",t.be="WacInitialize_Ready_Ack",t.we="Wac_BeforeUnloadApp",t.Oe="Blur_Focus",t.ge="Wac_AppFailed_Ack",t.je="Wac_AppCompleted_Ack",t.Se="WopiStartSession_Complete",t.Ie="WopiPendingSession_Complete",t.Ce="Host_AccessibilityLoopComplete",t.it="Host_IsFrameTrusted",t.ye="Grab_Focus",t.Te="HostCacheDiagnostic",t._e="Host_KeyValue",t.Ae="JsApiDiagnostics",t.ft="Host_MoveToFolder",t.ht="Host_OpenFile",t.Pe="PageChanged_Ack",t.Re="App_PopState",t.Ue="Host_PostmessageReady",t.Ee="File_Rename",t.It="Host_SaveACopy",t.Fe="PostAccessToken",t.We="Host_SetAuthToken",t.Ne="Host_SetCustomAuthConfig",t.xe="App_PushCommentContext",t.Me="CanEmbed",t.ke="Host_RefreshSessionInfo",t.He="CheckUserAccessAndGrantPermissions_Result",t.De="Host_WopiInfoFromUrl",t.Be="SetCurrentPage",t.Ve="SetZoomLevel",t.Je="WopiPendingSession_Fail",t.Le="SetOverlayContent",t.ze="WopiPendingApplicationComplete_Received",t.qe="Host_SwitchMode",t.Ge="Host_Unload",t.Ke="PageCount_Ack",t.Ze="ZoomChanged_Ack"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(n||(n={}))},,function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.appReboot="appReboot",t.boot="boot",t.closeTab="closeTab",t.createNew="createNew",t.dispose="dispose",t.frameTrust="frameTrust",t.getHostKeyValue="getHostKeyValue",t.handleBootState="handleBootState",t.postMessage="postMessage",t.rename="rename",t.setOverlayContent="setOverlayContent",t.storeHostKeyValue="storeHostKeyValue",t.switchMode="switchMode"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"l",(function(){return p})),i.d(e,"d",(function(){return v})),i.d(e,"m",(function(){return m})),i.d(e,"h",(function(){return w})),i.d(e,"i",(function(){return O})),i.d(e,"c",(function(){return j})),i.d(e,"k",(function(){return S})),i.d(e,"e",(function(){return y})),i.d(e,"g",(function(){return T})),i.d(e,"a",(function(){return _})),i.d(e,"b",(function(){return A})),i.d(e,"j",(function(){return P})),i.d(e,"f",(function(){return R}));var n,o,r,s=i(5),c=i(3),a=i(4),u=i(19),f=i(24),h=i(37),d=i(15),l=i(17);function p(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}function v(t,e){e&&Object.keys(e).forEach((function(i){t[i]=e[i]}))}function m(t,e){try{if(void 0===window.performance)return void e.ULS.$e(595948609,c.a.Xt,a.a.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void e.ULS.$e(595948610,c.a.Xt,a.a.Info,"No resources under performance");for(var n=new RegExp(t+"(-boot.min|(.(app|preview))?.boot).js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var u=JSON.stringify(r);return u=u.replace(new RegExp(r.name,"g"),s[0]),void e.ULS.$e(595948616,c.a.Xt,a.a.Info,u)}}e.ULS.$e(595948484,c.a.Xt,a.a.Info,"Could not find JSAPI resource timing entry")}catch(t){e.ULS.$e(595948617,c.a.Xt,a.a.Info,"Could not trace the resource timing: "+p(t))}}function b(t){var e=Object(s.a)(Object(s.a)({},t.host),{sessionId:t.hostSessionId,domain:location?location.host:void 0}),i={};if(t.wdParams){var n=JSON.parse(JSON.stringify(t.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(t){n[t]&&(i[t]=n[t])}))}var o=Object(s.a)({},t.rebootOverride);delete o.ackExpected,delete o["ui-language"],delete o.wdUserSession,delete o.rebootMode,delete o.documentUrl;var r=t.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",bootParams:t.bootParams,build:Object(h.a)(),host:e,intent:t.intent,jsApiVersion:"v2",rebootOverride:o,region:Object(d.j)(t.appBaseUrl),sessionOrigin:t.hostInitDiagnostics?t.hostInitDiagnostics.entryPoint:void 0,sessionContext:t.sessionContext,throttling:t.throttling,ui:t.ui,viewMode:t.viewMode,wdParams:i}}function w(){var t={perfNowSupported:l.c,browser:u.a[Object(u.c)()],touchMode:Object(u.g)(),highContrast:Object(u.d)(),windows10x:Object(u.h)()};try{var e=window.navigator,i=e.connection||e.mozConnection||e.webkitConnection;i&&(t.netDownlink=i.downlink,t.netDownlinkMax=i.downlinkMax,t.netEffectiveType=i.effectiveType,t.netRtt=i.rtt,t.netSaveData=i.saveData,t.netType=i.type),t.deviceMemory=e.deviceMemory,t.logicalProcessors=e.hardwareConcurrency}catch(t){}return t}function O(t){try{var e=t.hostInitDiagnostics;t.logger.ULS.$e(590447446,c.a.Xt,a.a.Info,"HostInitDiagnostics: "+(e?JSON.stringify(e):"N/A")),t.logger.ULS.$e(596444237,c.a.Xt,a.a.Info,JSON.stringify({session:b(t),client:w()}))}catch(e){t.logger.ULS.$e(590447447,c.a.Xt,a.a.Error,"Failed to log init info: "+p(e))}}function g(t,e,i){t.ULS.$e(595957843,c.a.Xt,a.a.Info,"Page lifecycle: "+e+" fired"+(i?", flushing logger":"")),i&&t.ULS.flush()}function j(t,e){n=function(){return g(t,"OnBeforeUnload",e)},o=function(){return g(t,"OnPageHide",e)},r=function(){return g(t,"VisibilityChange_"+document.visibilityState,e)},window.addEventListener("beforeunload",n,{capture:!0,once:!0}),window.addEventListener("pagehide",o,{capture:!0}),window.addEventListener("visibilitychange",r,{capture:!0})}function S(){window.removeEventListener("beforeunload",n,{capture:!0}),window.removeEventListener("pagehide",o,{capture:!0}),window.removeEventListener("visibilitychange",r,{capture:!0})}var I,C;function y(t,e,i,n){if(e.getValue(f.a.Xe,!1)){I=Object(l.b)();var o=t?3e3:5e3;C=window.setInterval((function(){i.ULS.$e(595724178,c.a.Xt,a.a.Info,"Boot_HeartBeat"),Object(l.b)()-I>e.getValue(f.a.Qe,3e5)&&(T(),n&&n())}),e.getValue(f.a.Ye,o))}}function T(){C&&(window.clearInterval(C),C=void 0)}var _=6e4,A=18e4;function P(t,e){t.ULS.$e(594901218,c.a.Xt,a.a.Warning,"Boot_NotComplete_"+(e||"Final")),t.ULS.flush()}function R(t){for(var e=0;e<t.length;e+=1)t[e]&&window.clearTimeout(t[e])}},function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return s}));var n=i(15);function o(t){return t.toLowerCase().indexOf("uiembed=1")>=0}function r(t){return"1"===Object(n.i)(t,"embed")}function s(t){var e=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}},function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"p",(function(){return o})),i.d(e,"k",(function(){return r})),i.d(e,"l",(function(){return s})),i.d(e,"j",(function(){return c})),i.d(e,"q",(function(){return a})),i.d(e,"g",(function(){return u})),i.d(e,"f",(function(){return f})),i.d(e,"e",(function(){return h})),i.d(e,"a",(function(){return d})),i.d(e,"n",(function(){return l})),i.d(e,"d",(function(){return p})),i.d(e,"i",(function(){return v})),i.d(e,"b",(function(){return m})),i.d(e,"o",(function(){return b})),i.d(e,"s",(function(){return w})),i.d(e,"h",(function(){return O})),i.d(e,"r",(function(){return g})),i.d(e,"m",(function(){return j}));var n="AppSettingsHandler.ashx",o="RemoteUls.ashx";function r(t){return 8===t.toLowerCase().indexOf("ffc")}function s(t){return 8===t.toLowerCase().indexOf("ppc")}function c(t){var e=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return e&&e[1]?e[1]:"public"}function a(t,e){if(!e)return t;var i=t.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?""+i[1]+e+"-"+i[3]:t}function u(t){var e=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}function f(t,e){var i=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===e)return n;if(e<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(e+1)).join(".")}function h(t){return t+o}function d(t,e,i){i&&(t[e.toLowerCase()]=i)}function l(t,e){t[e.toLowerCase()]=""}function p(t,e,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return t+e+(n.length>0?"?"+n.join("&"):"")}function v(t,e){var i=t.toLowerCase(),n=e.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(e.length+2),s=t.indexOf("&",r);return t.substring(r,-1===s?void 0:s)}function m(t,e,i,n){if(!i)return t;var o=t,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var c=e.toLowerCase()+"=",a=o.toLowerCase().indexOf(c,r);if("?"!==s&&a>=0){if(n){var u=o.indexOf("&",a);o=o.substring(0,a)+c+i+(-1===u?"":o.substring(u))}return o}return o.concat(s,c,i)}function b(t){var e={},i=t.indexOf("?");return-1===i||i===t.length-1||t.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var i=t.indexOf("=");-1!==i&&i!==t.length-1&&(e[t.substring(0,i).toLowerCase()]=t.substring(i+1))}})),e}function w(t,e){if(!t)return t;var i=t,n=i.indexOf("?"),o=e.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return t}function O(t){if(!t)return"";var e=-1===t.indexOf("#")?t.length:t.indexOf("#"),i=t.lastIndexOf("/",e);if(-1!==i&&i+1===t.indexOf("://")+"://".length)return"";i+=1;var n=t.indexOf("?");if(-1!==(n=n>=e?-1:n)&&i>n)return"";var o=-1===n?e:n;return i>=o?"":t.substring(i,o)}function g(t){var e=new RegExp("(c[1-5])h?(-)");return t.replace(e,"$1h$2")}function j(t){return/[?&]new=1\b/i.test(t)}},,function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return s}));var n,o=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function r(){return o?window.performance.now():Date.now()}function s(){if(!n){var t=window.performance;n=o&&t.timing&&t.timing.navigationStart?function(){return Math.round(t.now()+t.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return n()}},function(t,e,i){"use strict";i.d(e,"b",(function(){return h})),i.d(e,"a",(function(){return d}));var n=i(3),o=i(4),r=i(17),s=i(0),c=i(9),a=i(13),u=!1,f=!1;function h(){u=!1}function d(t,e,i,a,h,d,p){if(e.ULS.$e(595714433,n.a.Xt,o.a.Info,"Starting disposing the application. unloadApp:"+t+"; disposed:"+u+"; unloading:"+f),u||f&&t)e.ULS.$e(595714908,n.a.Xt,o.a.Info,"Application is already disposed or unloading");else{var v,m={logger:e,postMessenger:i,innerApplicationFrame:a,onDisposed:h,onFrameRemoved:d,unloadTimeoutInMs:p||1e3,forceAppUnload:!1,disposeStartTime:Object(r.a)(),appUnloadTimedOut:!1};if(t&&a)return f=!0,m.forceAppUnload=!0,(v=m).forceAppUnloadStartTime=Object(r.a)(),v.logger.ULS.$e(595855490,n.a.Xt,o.a.Info,"Sending postmessage to unload app"),v.logger.ULS.flush(),v.postMessenger.registerMessagePayloadHandler(s.a.Ut,(function(t){return function(t,e){t.forceAppUnloadEndTime=Object(r.a)(),t.appUnloadedMessageValues=e,t.logger.ULS.$e(595855491,n.a.Xt,o.a.Info,"AppUnloaded received from app"),l(t)}(v,t)})),v.postMessenger.sendPostMessage(v.innerApplicationFrame,c.a.Ge,{}),void window.setTimeout((function(){return function(t){!f&&u||(t.appUnloadTimedOut=!0,t.logger.ULS.$e(595855492,n.a.Xt,o.a.Info,"ApplicationUnload timed out, forcing dispose"),l(t))}(v)}),v.unloadTimeoutInMs);l(m)}}function l(t){if(!u)try{u=!0,f=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame),t.onFrameRemoved&&t.onFrameRemoved()}),0)}(t),function(t){var e={disposeStartTime:t.disposeStartTime,disposeEndTime:Object(r.a)(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(e.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(e.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var i=t.appUnloadedMessageValues,s=Number(i.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(s)&&(e.hostToAppPostMessageLatency=s-t.forceAppUnloadStartTime);var c=Number(i.appMessageSent);!isNaN(c)&&t.forceAppUnloadEndTime&&(e.appToHostPostMessageLatency=t.forceAppUnloadEndTime-c);var a=Number(i.appUnloadStart),u=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(u)||(e.appUnloadLatency=u-a),i.serverTimings){var f=i.serverTimings;for(var h in f)e["st-"+h.toString()]=f[h]}}t.logger.ULS.$e(595855436,n.a.Xt,o.a.Info,"App disposed "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(e){t.logger.ULS.$e(595714434,n.a.Xt,o.a.Error,"Error disposing: "+Object(a.l)(e))}}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return c})),i.d(e,"g",(function(){return a})),i.d(e,"d",(function(){return u})),i.d(e,"f",(function(){return f})),i.d(e,"e",(function(){return h})),i.d(e,"h",(function(){return d})),function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.Unknown=6]="Unknown"}(n||(n={}));var o=window.navigator,r=o?o.userAgent:void 0;function s(){if(r){if(r.indexOf("Firefox")>-1)return n.Firefox;if(r.indexOf("Opera")>-1||r.indexOf("OPR")>-1)return n.Opera;if(r.indexOf("Trident")>-1)return n.IE;if(r.indexOf("Edg")>-1)return n.Edge;if(r.indexOf("Chrome")>-1)return n.Chrome;if(r.indexOf("Safari")>-1)return n.Safari}return n.Unknown}function c(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function a(){try{return!!r&&r.indexOf("iPad")>=0||!!r&&r.indexOf("Macintosh")>=0&&l()&&!(r&&r.indexOf("iPhone")>=0)||!!r&&r.indexOf("Android")>=0||l()}catch(t){return!1}}function u(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}function f(){return s()===n.IE&&!function(){if(s()!==n.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function h(){return s()===n.IE}function d(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}function l(){return!!o&&(o.maxTouchPoints>0||o.msMaxTouchPoints>0)}},,function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.ti="EnterpriseTemplates",t.ei="ExcelAdaptiveLayoutDownload",t.ii="ExcelJsApiV2",t.ni="ExcelJsApiV2NoWrapper",t.oi="ExcelLandingPageOfflineTelemetry",t.ri="ExcelLandingPageObserverRetry",t.si="H2StaticContent",t.ci="HashedUrl",t.ai="ODCShareLinkPreload",t.fi="OfficeComExcelJsApiV2",t.hi="OfficeComUiHost",t.di="OfficeComWordJsApiV2",t.li="OfficeHwaUiHost",t.pi="WordJsApiV2",t.vi="WordJsApiV2NoWrapper",t.mi="WordViewToUnifiedRead"}(n||(n={}))},,function(t,e,i){"use strict";var n=i(8);i.d(e,"a",(function(){return n.a}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.Qe="BootstrapperMaxUlsHeartbeatTime",t.bi="BootstrapperNoCompleteWarning1Time",t.wi="BootstrapperNoCompleteWarning2Time",t.Oi="RemoteUlsETag",t.gi="RemoteUlsSuppressions",t.ji="BootstrapperSettingsFetchPeriod",t.Si="timestamp",t.Ye="BootstrapperUlsHeartbeatIntervalMs",t.Xe="BootstrapperUlsHeartBeatIsEnabled",t.Ii="BootstrapperUlsUploadCadenceMs",t.Ci="WordConsumptionViewToEditRedirectIsEnabled"}(n||(n={}))},,,,function(t,e,i){"use strict";var n=i(52);i.d(e,"a",(function(){return n.b}))},function(t,e,i){"use strict";var n;!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(n||(n={})),i.d(e,"a",(function(){return n}))},,function(t,e,i){"use strict";function n(t){return!!t&&/\.docx$/i.test(t)}i.d(e,"a",(function(){return n}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));function n(t){return t.toLowerCase().indexOf("sharepoint")>=0}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.yi="ClassicViewModePreference"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return p})),i.d(e,"b",(function(){return v}));var n,o=i(0),r=i(37),s=i(35),c=i(3),a=i(4),u=i(13),f=i(1),h=i(18),d=((n={})[f.a.DocumentReboot]=o.a.wt,n[f.a.GetAuthToken]=o.a.ot,n[f.a.GetCustomAuthConfig]=o.a.rt,n[f.a.WopiInfoFromUrl]=o.a.ct,n),l=[o.a.Z,o.a.nt,o.a.gt,o.a.Wt],p=function(){function t(t,e,i,n,o){this.Ti={},this._i=!1,this.Ai=!1,this.Pi=t,this.Ri=e,this.Ui=o.innerApplicationFrame,this.Ei=i,this.Fi=n,this.registerPostMessageHandlers(),Object(h.b)()}return t.prototype.GetApplicationType=function(){throw new Error("Not implemented")},t.prototype.GetVersion=function(){return Object(r.a)()},t.prototype.GetSessionId=function(){return this.Pi},t.prototype.RegisterEventHandler=function(t,e){if(this.Ai)throw new Error("RegisterEventHandler is not supposed to be called");this._i=!0,this.registerEventHandlerInternal(t,e)},t.prototype.RemoveEventHandler=function(t,e){if(this.Ai)throw new Error("RemoveEventHandler is not supposed to be called");switch(t){case f.a.Unloaded:case f.a.Disposed:case f.a.DocumentReboot:case f.a.WopiInfoFromUrl:case f.a.GetAuthToken:case f.a.GetCustomAuthConfig:case f.a.MoveToFolder:case f.a.OpenFile:case f.a.SaveACopy:case f.a.SetOverlayContent:if(this.Ti[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ti[t];break;default:this.Ei.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.RegisterAllEventsHandler=function(t){var e=this;if(this._i)throw new Error("RegisterAllEventsHandler is not supposed to be called");if(this.Ai)throw new Error("RegisterAllEventsHandler is supposed to be called only once");this.Ai=!0,Object.keys(d).forEach((function(i){e.registerEventHandlerInternal(i,(function(e){return t({MessageId:d[i],SendTime:0,CorrelationId:"",Values:e})}))})),l.forEach((function(i){e.registerEventHandlerInternal(i,(function(e){return t({MessageId:i,SendTime:0,CorrelationId:"",Values:e})}))})),this.Ei.removeMessageHandler(o.a.ft),this.Ei.removeMessageHandler(o.a.ht),this.Ei.removeMessageHandler(o.a.It),Object.keys(s.a).forEach((function(i){s.a[i].Wi&&e.registerEventHandlerInternal(i,(function(e){return t({MessageId:i,SendTime:0,CorrelationId:"",Values:e})}))}))},t.prototype.PostCommand=function(t,e){this.Ei.postMessageForCommand(this.Ui,t,e)},t.prototype.Dispose=function(t,e){var i=this;Object(h.a)(t||!1,this.Ri,this.Ei,this.Ui,(function(){delete i.Ui,i.Fi(),i.Ei.dispose(),i.raiseEvent(f.a.Unloaded,{})}),(function(){try{i.raiseEvent(f.a.Disposed,{}),i.Ti={}}catch(t){i.Ri.ULS.$e(589108815,c.a.Xt,a.a.Error,"onFrameRemoved error: "+Object(u.l)(t))}}),e)},t.prototype.registerEventHandlerInternal=function(t,e){switch(t){case f.a.Unloaded:case f.a.Disposed:case f.a.DocumentReboot:case f.a.WopiInfoFromUrl:case f.a.GetAuthToken:case f.a.GetCustomAuthConfig:case f.a.MoveToFolder:case f.a.OpenFile:case f.a.SaveACopy:case f.a.SetOverlayContent:if(this.Ti[t])throw new Error("Duplicate registration");this.Ti[t]=e;break;default:this.Ei.registerMessagePayloadHandler(t,e)}},t.prototype.registerPostMessageHandlers=function(){this.Ei.registerMessagePayloadHandler(o.a.wt,this.handleDocumentRebootMessage.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.ct,this.handleWopiInfoFromUrlRequest.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.ot,this.handleAuthTokenRequest.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.rt,this.handleCustomAuthConfigRequest.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.ft,this.handleMoveToFolderRequest.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.ht,this.handleOpenFileRequest.bind(this)),this.Ei.registerMessagePayloadHandler(o.a.It,this.handleSaveACopyRequest.bind(this))},t.prototype.raiseEvent=function(t,e){var i=this.Ti[t];if(i)try{i(e||{})}catch(t){this.Ri.ULS.$e(593773706,c.a.Xt,a.a.Error,"Handler error: "+Object(u.l)(t))}},t.prototype.handleDocumentRebootMessage=function(t){t.previousSessionId=this.Pi,this.raiseEvent(f.a.DocumentReboot,t)},t.prototype.handleWopiInfoFromUrlRequest=function(t){this.raiseEvent(f.a.WopiInfoFromUrl,t)},t.prototype.handleAuthTokenRequest=function(t){this.raiseEvent(f.a.GetAuthToken,t)},t.prototype.handleCustomAuthConfigRequest=function(t){this.raiseEvent(f.a.GetCustomAuthConfig,t)},t.prototype.handleMoveToFolderRequest=function(t){this.raiseEvent(f.a.MoveToFolder,t)},t.prototype.handleOpenFileRequest=function(t){this.raiseEvent(f.a.OpenFile,t)},t.prototype.handleSaveACopyRequest=function(t){this.raiseEvent(f.a.SaveACopy,t)},t}();function v(t,e,i,n,o){return new p(t,e,i,n,o)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n,o=i(12),r=i(8),s=i(0),c=i(9),a=i(2),u=((n={})[r.a.boot]={Ni:o.a.boot},n[r.a.createNew]={Ni:o.a.createNew},n[r.a.dispose]={Ni:o.a.dispose},n[r.a.rename]={Ni:o.a.rename},n[r.a.switchMode]={Ni:o.a.switchMode},n[s.a._]={Ni:o.a.handleBootState},n[s.a.U]={Ni:o.a.closeTab},n[s.a.it]={Ni:o.a.frameTrust},n[s.a.st]={Ni:o.a.getHostKeyValue},n[s.a.wt]={Ni:o.a.appReboot},n[s.a.Tt]={Ni:o.a.setOverlayContent},n[s.a.Rt]={Ni:o.a.storeHostKeyValue},n[r.a.blurFocus]={xi:c.a.Oe},n[r.a.continueAccessibilityLoop]={xi:c.a.Ce},n[r.a.grabFocus]={xi:c.a.ye},n[r.a.moveToFolder]={xi:c.a.ft},n[r.a.openFile]={xi:c.a.ht},n[r.a.popState]={xi:c.a.Re},n[r.a.saveACopy]={xi:c.a.It},n[s.a.u]={Wi:a.a.AccessibilityLoopCompleted},n[s.a.P]={Wi:a.a.BrowserEvent},n[s.a.R]={Wi:a.a.Close},n[s.a.F]={Wi:a.a.Conversation},n[s.a.W]={Wi:a.a.CopyAndEdit},n[s.a.N]={Wi:a.a.CreateNewDocument},n[s.a.B]={Wi:a.a.Download},n[s.a.J]={Wi:a.a.Edit},n[s.a.K]={Wi:a.a.Error},n[s.a.$]={Wi:a.a.FileProperties},n[s.a.X]={Wi:a.a.FileRenamed},n[s.a.tt]={Wi:a.a.FileVersions},n[s.a.et]={Wi:a.a.FrameStateChanged},n[s.a.ut]={Wi:a.a.ModeSwitched},n[s.a.ft]={Wi:a.a.MoveToFolder},n[s.a.ht]={Wi:a.a.OpenFile},n[s.a.dt]={Wi:a.a.OpenInBrowser},n[s.a.lt]={Wi:a.a.OpenInClient},n[s.a.pt]={Wi:a.a.PageChanged},n[s.a.bt]={Wi:a.a.PushState},n[s.a.Ot]={Wi:a.a.RedeemForCommenting},n[s.a.jt]={Wi:a.a.ReplyWithChanges},n[s.a.It]={Wi:a.a.SaveACopy},n[s.a.St]={Wi:a.a.ReportAbuse},n[s.a.Ct]={Wi:a.a.SaveStatus},n[s.a._t]={Wi:a.a.Share},n[s.a.At]={Wi:a.a.ShareForm},n[s.a.Pt]={Wi:a.a.SignIn},n[s.a.Nt]={Wi:a.a.UserActivity},n[s.a.xt]={Wi:a.a.UserEditActivity},n[s.a.Mt]={Wi:a.a.Workflow},n[s.a.kt]={Wi:a.a.ZoomChanged},n[s.a.Z]={Mi:{Wi:a.a.FileEmbed,ki:r.a.sendEmbeddedViewUrl,Hi:c.a.Me,Di:5e3}},n[s.a.nt]={Mi:{Wi:a.a.GetAccessToken,ki:r.a.sendAccessToken,Hi:c.a.Fe}},n[s.a.ot]={Mi:{Wi:a.a.GetAuthToken,ki:r.a.sendAuthToken,Hi:c.a.We}},n[s.a.rt]={Mi:{Wi:a.a.GetCustomAuthConfig,ki:r.a.sendCustomAuthConfig,Hi:c.a.Ne,Di:5e3}},n[s.a.ct]={Mi:{Wi:a.a.GetWopiInfoFromUrl,ki:r.a.sendWopiInfo,Hi:c.a.De,Di:5e3}},n[s.a.gt]={Mi:{Wi:a.a.RefreshSessionInfo,ki:r.a.sendSessionInfo,Hi:c.a.ke,Di:5e3}},n[s.a.Wt]={Mi:{Wi:a.a.UserAccessAndPermissions,ki:r.a.sendUserAccessAndPermissions,Hi:c.a.He,Di:5e3}},n)},,function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n= "16.0.13818.41021";function o(){return n}},function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return s})),i.d(e,"d",(function(){return c}));var n,o=365;function r(t,e){var i=s(t);return"true"===i||"false"!==i&&e}function s(t){if(!t)return"";var e=""+document.cookie,i=new RegExp("(?:^|; )"+t+"=([^;]*)"),n=e.match(i);return!n||n.length<2?"":n[1]}function c(t,e,i,r){void 0===r&&(r=n.none);var s=t+"="+e,a="",u=new Date;u.setTime(u.getTime()+864e5*o);var f=new Date;f.setTime(f.getTime()+864e5*i),f>u&&(f=u),f&&(a=";expires="+f.toUTCString());var h=";SameSite="+n[r];return document.cookie=s+a+h,!(!document.cookie||-1===document.cookie.indexOf(s))||r===n.none&&c(t,e,i,n.doNotSet)}!function(t){t[t.doNotSet=0]="doNotSet",t[t.none=1]="none",t[t.lax=2]="lax",t[t.strict=3]="strict"}(n||(n={}))},function(t,e,i){"use strict";var n=i(2);i.d(e,"a",(function(){return n.a}))},function(t,e,i){"use strict";var n=i(5),o=i(37),r=i(17),s=i(15),c=i(63),a=i(66),u=i(13),f=i(19),h=i(0),d=i(3),l=i(4),p=i(21),v=i(9),m=i(80),b=i(10),w=i(14);function O(t,e){e&&e.Diagnostics&&Object.keys(e.Diagnostics).forEach((function(i){return t[i]=e.Diagnostics[i]}))}function g(t,e,i){e.ULS.$e(596459999,d.a.Xt,i,"SessionTraces: "+JSON.stringify(t))}function j(t,e){e.Stop();var i=e.GetVisibilityChangeEvents();null!=i&&i.length>0&&(t.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,t.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),e.Dispose()}function S(t,e,i){try{var r=function(t,e){var i=Object(n.a)({},e);delete i.UserId,delete i.OwnerId,delete i.WdParams;var o=i,r=e.WdParams?JSON.parse(JSON.stringify(e.WdParams).toLowerCase()):{};return o.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(t){r[t]&&(o.WdParams[t]=r[t])})),o.UiEmbedMode=Object(w.c)(t),o.UiHostName=Object(s.i)(t,"uih")||"N/A",o.HostDomain=location?location.hostname:"",o}(e.applicationUrl,e.sessionInformation);r.Build=Object(o.a)(),r.Region=Object(s.j)(e.applicationUrl);var c=Object(n.a)({},e.rebootOverrideData);delete c.ackExpected,delete c["ui-language"],delete c.wdUserSession,delete c.rebootMode,delete c.documentUrl,r.RebootOverride=c,e.diagnostics.HostInitDiagnostics&&(t.ULS.$e(596444238,d.a.Xt,l.a.Info,"HostInitDiagnostics: "+JSON.stringify(e.diagnostics.HostInitDiagnostics)),r.SessionOrigin=e.diagnostics.HostInitDiagnostics.entryPoint),i&&t.ULS.$e(595937313,d.a.Xt,l.a.Info,JSON.stringify(i));var a=e.wopiInfo;a&&a.AccessToken&&a.AccessTokenExpiry||t.ULS.$e(595894553,d.a.Xt,l.a.Warning,"There are some missing parameters"),a&&(a.AccessToken&&(r.AccessTokenLength=a.AccessToken.length),r.AccessTokenExpiry=a.AccessTokenExpiry);var f=p.a.pi;r.JsApiVersion=e.featureManager.isFeatureEnabled(f)?"v1Wrapper":"v1",t.ULS.$e(596444237,d.a.Xt,l.a.Info,JSON.stringify({session:r,client:Object(u.h)()}))}catch(e){t.ULS.$e(590915460,d.a.Xt,l.a.Error,"Failed to log initialization info: "+Object(u.l)(e))}}var I,C=i(24),y=i(76),T=i(77),_=i(78),A=i(79),P=i(38),R=i(7),U=i(31),E=i(32),F=i(33);function W(t,e){var i={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?I.forceSingleStepBoot:I.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot||(i=function(t,e){var i=Object(R.a)(t.applicationUrl),n=Object(R.b)(t.applicationUrl),o=Object(w.c)(t.applicationUrl),r=Object(w.b)(t.applicationUrl);return e.ULS.$e(595640900,d.a.Xt,l.a.Info,"gotUiEmbedUrl:"+o+", gotEditUrl:"+i+", gotViewUrl:"+n),!i&&t.wopiPrecheckInfo.IrmEnabled?{isSingleStepBoot:!0,bootFlowType:o?I.wordUiEmbedIrmEnabledEarlyRedirect:I.unifiedIrmEnabled,ignoreWacFramePostMessages:!1}:(t.canSupportConsumption=t.Bi.getValue(C.a.Ci,!1)&&(Object(s.k)(t.applicationUrl)||t.featureManager.isFeatureEnabled(p.a.mi))&&!o&&!r&&(t.isCreateNew&&!t.wopiInfo||Object(U.a)(t.wopiPrecheckInfo.FileName))&&Object(E.a)(t.sessionInformation.HostName),t.canSupportConsumption&&n&&!Object(P.a)(F.a.yi,!1)?{isSingleStepBoot:!0,bootFlowType:I.wordViewToUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:i?(e.ULS.$e(575980770,d.a.Xt,l.a.Info,"readOnly:"+t.wopiPrecheckInfo.ReadOnly),t.wopiPrecheckInfo.ReadOnly&&o?{isSingleStepBoot:!0,bootFlowType:I.wordUiEmbedReadOnlyEarlyRedirect,ignoreWacFramePostMessages:!1}:t.wopiInfo||Object(f.e)()?{isSingleStepBoot:!0,bootFlowType:I.unifiedSingleFlush,ignoreWacFramePostMessages:t.isCreateNew||!1}:{isSingleStepBoot:!1,bootFlowType:I.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1}):{isSingleStepBoot:!0,bootFlowType:n?I.unifiedViewActionUrl:I.unifiedNotEditOrViewActionUrl,ignoreWacFramePostMessages:!n})}(t,e)),i.isSingleStepBoot){var n={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};e.ULS.$e(596444182,d.a.Xt,n.irmEnabled?l.a.Warning:l.a.Info,JSON.stringify(n))}else e.ULS.$e(596444183,d.a.Xt,l.a.Info,"Received input valid for two step flow");return i}function N(t,e,i){void 0===i&&(i=!1);var o=t.applicationUrl;var r={};r.jsApi="1";var c=p.a.pi;if(r.jsapiver=t.featureManager.isFeatureEnabled(c)?"v1Wrapper":"v1",i&&(r.NewSession="1"),r.corrid=t.sessionId,r.usid=t.sessionId,r.sftc="1",t.applicationCustomSettings&&t.applicationCustomSettings.IsCore&&(r.core="1"),t.sessionInformation.HideViewerToolbar&&(r.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(r.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(r.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAtMentions&&(r.sams="1"),t.sessionInformation.SupportsAccessibilityLoop&&(r.accloop="1"),t.sessionInformation.SupportsDocReboot){var a=t.sessionInformation.SupportsDocReboot;r.sdr=!0===a?"1":a.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(r.scnd="1"),t.sessionInformation.SupportsAuthToken&&(r.sat="1"),t.sessionInformation.SupportsCustomAuthConfig&&(r.cac="1"),t.sessionInformation.SupportsMoveToFolder&&(r.mtf="1"),t.sessionInformation.SupportsSharedFilePicker&&(r.sfp="1"),t.sessionInformation.HideHeader&&(r.hhdr="1"),t.sessionInformation.HideBreadCrumbInViewer&&(r.hbcv="1"),t.sessionInformation.HideTitleInViewer&&(r.htv="1"),t.sessionInformation.HideWACOneDriveFileLocationPicker&&(r.hodflp="1"),t.sessionInformation.NoBrowserModalDialogs&&(r.nbmd="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(r.fixdiag="1"),(t.wopiPrecheckInfo.ReadOnly||e.bootFlowType===I.wordViewToUnifiedReadRedirect)&&(r.readOnly="1"),e.bootFlowType===I.wordViewToUnifiedReadRedirect&&(r.cons="1"),t.canSupportConsumption&&(r.csc="1"),t.sessionInformation.UIEmbed&&(r.uiEmbed="1"),t.sessionInformation.UiHostIntegrationType&&(r.uihit=encodeURIComponent(t.sessionInformation.UiHostIntegrationType)),t.sessionInformation.MetaUiHostVersion&&(r.muv=encodeURIComponent(t.sessionInformation.MetaUiHostVersion)),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(r.InAppDocPreview="1"),e.isSingleStepBoot?(e.bootFlowType===I.unifiedSingleFlush&&(t.isCreateNew||(r.instantedit="1",r.wopicomplete="1")),r.wdRedirectionReason=e.bootFlowType):(r.instantedit="1",r.fileSrc=encodeURIComponent(t.sessionInformation.HostName),r.pmOrigin=encodeURIComponent(Object(s.g)(window.location.href)),t.isCreateNew&&(r.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(r.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(r.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(r.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(r.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(r.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(r=Object(n.a)(Object(n.a)({},t.applicationCustomSettings.additionalApplicationParameters),r)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(r=Object(n.a)(Object(n.a)({},r),t.rebootOverrideData.queryOverrides)),function(t,e,i,o,r){var c=Object(s.o)(t);"teams"!==c.uih&&"owa"!==c.uih||(c.hhdr="1");var a=t.indexOf("?"),u=-1===a?t.concat("?"):t.substring(0,a+1);e.UiLocale&&(c.ui=encodeURIComponent(e.UiLocale));e.DataLocale&&(c.rs=encodeURIComponent(e.DataLocale));e.HostSessionId&&(c.hid=encodeURIComponent(e.HostSessionId));e.DisableChat&&(c.dchat="1");e.SessionContext&&(c.sc=encodeURIComponent(e.SessionContext));i&&i.WopiSrc&&(c.wopisrc=encodeURIComponent(i.WopiSrc));e.CookieCompliant&&(c.mscc="1");o&&(o.entryPoint&&(c.wdorigin=encodeURI(o.entryPoint)),o.userClickTime&&(c.wdhostclicktime=o.userClickTime.toString()));c=Object(n.a)(Object(n.a)(Object(n.a)({},c),e.WdParams),r);var f={};for(var h in c)f[h.toLowerCase()]=c[h];var d=[];for(var h in f)f[h]&&d.push(h.concat("=",f[h]));return u.concat(d.join("&"))}(o,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitDiagnostics,r)}function x(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",t.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(I||(I={}));var M=i(65);function k(t,e,i,n,o,r,c){return function(t,e,i,n){Object(y.b)(t,n);var o=e.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=i,r.target=t.name,r.method="POST",n){var c=o.createElement("input");c.type="hidden",c.name=s,c.value=n[s],r.appendChild(c)}return e.appendChild(r),r.submit(),t}(function(t,e,i,n){var o=t.ownerDocument.createElement("iframe");o.name=i||"WebApplicationFrame",o.id="WebApplicationFrame",o.src="",o.title="Office Online Frame",o.width="100%",o.height="100%",o.marginWidth="0",o.marginHeight="0",o.style.left="0",o.style.top="0",o.style.right="0",o.style.bottom="0",o.style.display="block",o.style.position="absolute",o.style.backgroundColor="transparent",o.style.border="none",o.frameBorder="0",o.setAttribute("allowfullscreen","true"),o.setAttribute("allowTransparency","true");var r=Object(s.g)(e);return o.setAttribute("allow","microphone "+r+"; camera "+r+";"),n&&(o.onload=n),t.appendChild(o),o}(t,e,c),t,e,i)}var H,D=function(){function t(t,e,i,n,o,s){var c=this;if(this.Vi=!1,this.Ji=[],this.logWarningOnNoAppComplete=function(t){c.Vi||Object(u.j)(c.Ri,t)},void 0===e)throw new TypeError("bootFlowInfo");if(e.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.Li=t,this.zi=e,this.Ri=i,this.Ei=n,this.qi=o,this.Gi=s,this.Ki=t.diagnostics.AppInitDiagnostics,this.Zi=t.diagnostics.SessionTraces,this.Zi.wopiInitializeTime=Object(r.a)()}return t.prototype.Boot=function(){var t=this;this.Ri.ULS.$e(596444241,d.a.Xt,l.a.Info,"Initializing WAC frame");var e=N(this.Li,this.zi,!0),i=function(t,e){var i={};if(t.wopiInfo&&(i[y.a.$i]=t.wopiInfo.AccessToken,i[y.a.Xi]=x(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[y.a.Qi]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var n=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();e.ULS.$e(593503580,d.a.Xt,l.a.Info,"Content bundle staleness - "+n),i[y.a.Yi]=n}else e.ULS.$e(593503581,d.a.Xt,l.a.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(i[y.a.tn]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.FileName){var o=t.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==o){var r=t.wopiPrecheckInfo.FileName.substring(o+1);r&&(i[y.a.en]=r)}i[y.a.in]=t.wopiPrecheckInfo.FileName}t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?i[y.a.nn]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(i[y.a.nn]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(i[y.a.on]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(i[y.a.rn]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(i[y.a.sn]=t.sessionInformation.SessionContext),t.diagnostics.HostInitDiagnostics&&(i[y.a.cn]=JSON.stringify({HostInitializeDiagnostics:t.diagnostics.HostInitDiagnostics})),i[y.a.an]=Object(M.b)(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(i[y.a.un]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),i[y.a.fn]=String(window.devicePixelRatio>1.24),i[y.a.hn]=String(Object(f.f)()),i[y.a.dn]=t.sessionInformation.HostName;var s=t.newFileTemplateSource;return s&&s.FileGetUrl&&(i[y.a.ln]=s.FileGetUrl),s&&s.DocUniqueId?i[y.a.pn]=s.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(i[y.a.pn]=t.wopiPrecheckInfo.DocUniqueId),s&&s.ETag?i[y.a.vn]=s.ETag:t.wopiPrecheckInfo.ETag&&(i[y.a.vn]=t.wopiPrecheckInfo.ETag),i}(this.Li,this.Ri);if(Object(u.e)(Object(s.k)(e),this.Li.Bi,this.Ri,this.logWarningOnNoAppComplete),this.Ei.registerMessagePayloadHandler(h.a._,(function(e){t.handleWacAppBootState(e)})),this.Ei.registerMessagePayloadHandler(h.a.U,(function(){t.handleCloseTab()})),this.Ei.registerMessagePayloadHandler(h.a.it,(function(e){t.handleTrustFrameRequest(e)})),this.Ei.registerMessagePayloadHandler(h.a.Tt,(function(e){t.handleSetOverlayContent(e)})),this.Ei.registerMessagePayloadHandler(h.a.st,(function(e){t.handleGetHostKeyValue(e)})),this.Ei.registerMessagePayloadHandler(h.a.Rt,(function(e){t.handleStoreHostKeyValue(e)})),this.zi.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(e,i),this.zi.ignoreWacFramePostMessages){var n=this.getApplicationState();this.qi(n)}return this.Ri.ULS.$e(595661019,d.a.Xt,l.a.Info,"Created Wac Frame"),this.Ui},t.prototype.bootWacFrame=function(t,e){this.Ki.officeFrameCreateTime=Object(r.a)(),this.Zi.frameCreateStartTime=this.Ki.officeFrameCreateTime;var i=this.Li.applicationCustomSettings&&this.Li.applicationCustomSettings.appFrameName;this.Ui=k(this.Li.container,t,e,this.Li.featureManager,this.Ri,this.Li.sessionId,i),this.Ei.activate(this.Ui)},t.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var t=this;this.Ei.registerMessagePayloadHandler(h.a.A,(function(e){t.handleWacCompleteMessage(e)})),this.Ei.registerMessagePayloadHandler(h.a.O,(function(e){t.handleWacFailureMessage(e)})),this.Ji.push(window.setTimeout((function(){return t.timeoutWacAppCompleteOrFail()}),15e3)),this.Ji.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(1)}),this.Li.Bi.getValue(C.a.bi,u.a))),this.Ji.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(2)}),this.Li.Bi.getValue(C.a.wi,u.b)))},t.prototype.handleWacAppBootState=function(t){var e=t&&t.state?t.state:"unknown";this.Ri.ULS.$e(595714271,d.a.Xt,l.a.Info,"WAC Boot App state:["+e+"]")},t.prototype.handleTrustFrameRequest=function(t){var e=Object(y.f)(this.Ri);this.Ri.ULS.$e(595653903,d.a.Xt,l.a.Info,"Top frame is trusted: "+e),this.sendWacPostMessage(v.a.it,{isTopFrameTrusted:e})},t.prototype.handleSetOverlayContent=function(t){var e=Object(T.b)(t&&t.overlayContent);this.Ri.ULS.$e(587487432,d.a.Xt,l.a.Info,"Overlay content: "+e),this.sendWacPostMessage(v.a.Le,void 0)},t.prototype.handleWacCompleteMessage=function(t){if(this.Ri.ULS.$e(595986314,d.a.Xt,l.a.Info,"Received wac complete message"),this.Ri.ULS.flush(),Object(u.g)(),this.clearLogTimers(),this.Vi)this.Ri.ULS.$e(596444234,d.a.Xt,l.a.Info,"Received multiple wac complete or failure messages");else{this.Vi=!0,this.sendWacPostMessage(v.a.je,{}),O(this.Ki,t);var e=this.getApplicationState();this.qi(e),this.sendJsApiDiagnosticsToWacFrame(this.Li.diagnostics)}},t.prototype.handleCloseTab=function(){this.Ri.ULS.$e(579342464,d.a.Xt,l.a.Info,"Received close tab message");try{window.close()}catch(t){this.Ri.ULS.$e(579213188,d.a.Xt,l.a.Warning,"Failed to close the browser tab")}},t.prototype.getApplicationState=function(){return{innerApplicationFrame:this.Ui}},t.prototype.handleWacFailureMessage=function(t){if(this.Ri.ULS.$e(595986315,d.a.Xt,l.a.Error,"Received wac failed message"),this.Ri.ULS.flush(),Object(u.g)(),this.clearLogTimers(),this.Vi)this.Ri.ULS.$e(596444235,d.a.Xt,l.a.Info,"Received multiple wac complete or failure messages");else{this.Vi=!0,this.sendWacPostMessage(v.a.ge,{});var e={errorType:b.a.WacFailed,errorObject:{}};t&&(e.errorObject=t.Error,this.Zi.error=e),this.Gi(e)}},t.prototype.handleGetHostKeyValue=function(t){var e=t.hostKey;this.Ri.ULS.$e(574433173,d.a.Xt,l.a.Info,"GetHostKeyValue "+e);var i=Object(_.b)(t);null!=i&&this.sendWacPostMessage(v.a._e,{hostKey:e,hostValue:i})},t.prototype.handleStoreHostKeyValue=function(t){var e=t.hostKey,i=t.hostValue;this.Ri.ULS.$e(574433174,d.a.Xt,l.a.Info,"storeHostKeyValue "+e+": "+i),Object(A.b)(t)},t.prototype.timeoutWacAppCompleteOrFail=function(){this.Vi||this.Ri.ULS.$e(596444236,d.a.Xt,l.a.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.Zi))},t.prototype.clearLogTimers=function(){Object(u.f)(this.Ji),this.Ji=[]},t.prototype.sendJsApiDiagnosticsToWacFrame=function(t){this.sendWacPostMessage(v.a.Ae,{HostInitializeDiagnostics:t.HostInitDiagnostics})},t.prototype.sendWacPostMessage=function(t,e){this.Ui&&this.Ui.contentWindow?this.Ei.sendPostMessage(this.Ui,t,e):this.Ri.ULS.$e(595955718,d.a.Xt,l.a.Info,"Attempted to send postmessage: "+t)},t}(),B=i(18),V=function(){function t(t,e,i,n,o,s,c){var a=this;this.mn=!1,this.bn=!1,this.wn=!1,this.On=null,this.gn=!0,this.jn=!1,this.Sn=!1,this.Li=t,this.zi=e,this.Ki=t.diagnostics.AppInitDiagnostics,this.Ri=i,this.Ei=n,this.qi=s,this.Gi=c,this.Zi=t.diagnostics.SessionTraces,this.Zi.wopiPendingInitializeTime=Object(r.a)(),this.In=o,Object(B.b)(),window.setTimeout((function(){return a.timeoutCompleteOrFail()}),5e3)}return t.prototype.Complete=function(t,e){if(this.wn)this.Ri.ULS.$e(596444184,d.a.Xt,l.a.Warning,"Complete called after Complete/Fail already called");else{this.Ri.ULS.$e(596444185,d.a.Xt,l.a.Info,"Complete called."),this.wn=!0,this.Cn=t,this.Zi.wopiPendingCompleteTime=Object(r.a)();try{this.zi.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.mn&&this.sendWacPostMessage(v.a.ze,{}),this.updateBrowserHistoryForCreateNew(e)}catch(t){this.Ri.ULS.$e(596444186,d.a.Xt,l.a.Error,"Unexpected script error: "+Object(u.l)(t))}finally{this.Ri.ULS.flush()}}},t.prototype.Fail=function(t){this.wn?this.Ri.ULS.$e(596444187,d.a.Xt,l.a.Warning,"Fail called after Complete/Fail already called"):(this.Ri.ULS.$e(596444188,d.a.Xt,l.a.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.wn=!0,this.zi.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(t),this.Ri.ULS.flush())},t.prototype.Dispose=function(t,e,i){var n=this;Object(B.a)(t||!1,this.Ri,this.Ei,this.Ui,(function(){delete n.Ui,e&&e(),n.In(),n.Ei.dispose()}),void 0,i)},t.prototype.Boot=function(){this.zi.isSingleStepBoot||this.bootTwoStepFlow(),this.Ri.ULS.flush()},t.prototype.bootTwoStepFlow=function(){var t=this;this.Ri.ULS.$e(596444231,d.a.Xt,l.a.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return t.timeoutWacReadyMessage()}),5e3),this.Ei.registerMessagePayloadHandler(h.a.v,(function(e){t.handleWacReadyMessage(e)})),this.Ei.registerMessagePayloadHandler(h.a.yt,(function(e){t.handleWacFrameSessionCompleteAckMessage(e)}));var e=new D(this.Li,this.zi,this.Ri,this.Ei,this.qi,this.Gi);this.Ui=e.Boot()},t.prototype.completeTwoStepFlow=function(){var t={ParallelizeStartSession:this.gn,WacFrameIsLoaded:this.mn,WacAcceptsStartSessionComplete:this.jn};this.Ri.ULS.$e(596444232,d.a.Xt,l.a.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.gn||this.mn&&!this.jn?this.mn&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},t.prototype.completeSingleStepFlow=function(){this.Ri.ULS.$e(596444233,d.a.Xt,l.a.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.Li.wopiInfo=this.Cn;var t=new D(this.Li,this.zi,this.Ri,this.Ei,this.qi,this.Gi);this.Ui=t.Boot()},t.prototype.failTwoStepFlow=function(t){this.mn?(this.Ri.ULS.$e(595968481,d.a.Xt,l.a.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(t)):(this.Ri.ULS.$e(595968482,d.a.Xt,l.a.Warning,"Fail was called on the session prior to WacReady."),this.On=t)},t.prototype.sendFailurePostMessageToWacFrame=function(t){this.Ri.ULS.$e(596444189,d.a.Xt,l.a.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(v.a.Je,t)},t.prototype.failSingleStepFlow=function(){this.Ri.ULS.$e(596444190,d.a.Xt,l.a.Warning,"Fail called during single step boot, calling host failure callback..."),this.Gi({errorType:b.a.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},t.prototype.timeoutWacReadyMessage=function(){this.mn||(this.Ri.ULS.$e(596444191,d.a.Xt,l.a.Warning,"Timeout Wac Ready"),this.Gi({errorType:b.a.TimeoutWacReady,errorObject:void 0}))},t.prototype.timeoutCompleteOrFail=function(){this.wn||(this.Zi.timeoutCompleteOrFail=Object(r.a)(),this.Ri.ULS.$e(596444192,d.a.Xt,l.a.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.Zi)))},t.prototype.timeoutWacSessionCompletionMessageAck=function(t,e,i){this.Sn||(this.Ri.ULS.$e(596444193,d.a.Xt,l.a.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(t,e,i+1))},t.prototype.handleWacReadyMessage=function(t){if(this.Zi.readyMessageReceiveTime=Object(r.a)(),this.sendWacPostMessage(v.a.be,{}),this.mn)this.Ri.ULS.$e(596444194,d.a.Xt,l.a.Info,"Received multiple ready messages - frame is already loaded.");else{this.mn=!0,this.jn=t&&t.CanAcceptStartSessionComplete;var e={AcceptStartSessionComplete:this.jn,ParallelizeStartSession:this.gn,StartSessionResponseAvailable:!!this.yn,WopiInfoAvailable:!!this.Cn};this.Ri.ULS.$e(596444195,d.a.Xt,l.a.Info,"HandleWacReadyMessage - "+JSON.stringify(e)),this.wn&&(this.On?this.sendFailurePostMessageToWacFrame(this.On):this.sendWacPostMessage(v.a.ze,{})),this.gn&&this.jn?this.yn&&this.startSessionCompleted():this.Cn&&this.sendWopiInfoToWacFrame(),O(this.Ki,t)}},t.prototype.handleWacFrameSessionCompleteAckMessage=function(t){this.Sn=!0,this.Zi.sessionCompleteAckReceivedTime=Object(r.a)()},t.prototype.sendWacPostMessage=function(t,e){this.Ei.sendPostMessage(this.Ui,t,e)},t.prototype.sendSessionCompletionMessageWithRetry=function(t,e){this.sendSessionCompletionMessageWithRetryHelper(t,e,1)},t.prototype.sendSessionCompletionMessageWithRetryHelper=function(t,e,i){var n=this;if(i>3)this.Ri.ULS.$e(596444224,d.a.Xt,l.a.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Object(r.a)());else{this.Ri.ULS.$e(596444225,d.a.Xt,l.a.Info,"Sending completion message to frame. Attempt number: "+i+", Time: "+Object(r.a)());var o=Object(r.a)();1===i&&(this.yn&&this.yn.Diagnostics&&(this.yn.Diagnostics.completeMessageCreateTime=o),this.Zi.completeMessageCreateTime=o),e.Diagnostics.completeMessageSendTime=o,this.Zi.completeMessageSendTime=o,this.sendWacPostMessage(t,e),window.setTimeout((function(){return n.timeoutWacSessionCompletionMessageAck(t,e,i)}),1e3)}},t.prototype.makeStartSessionRequest=function(){var t=this;this.Ri.ULS.$e(596444226,d.a.Xt,l.a.Info,"Making parallelized startSession request.");var e=this.buildStartSessionUrl(this.Cn),i={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(this.Cn.AccessToken)+"&access_token_ttl="+encodeURIComponent(x(this.Cn));this.Zi.startSessionStartTime=Object(r.a)(),Object(m.a)(e,n,i,(function(e){return t.onStartSessionRequestCompleted(e)}))},t.prototype.onStartSessionRequestCompleted=function(t){if(this.Zi.startSessionCompleteTime=Object(r.a)(),this.Zi.startSessionResponseStatus=t.status,this.yn={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.Zi.wopiPendingInitializeTime,wopiPendingCompleteTime:this.Zi.wopiPendingCompleteTime,startSessionStartTime:this.Zi.startSessionStartTime,startSessionCompleteTime:this.Zi.startSessionCompleteTime,readyMessageReceiveTime:this.Zi.readyMessageReceiveTime}},this.Ri.ULS.$e(596444227,d.a.Xt,l.a.Info,"StartSession request completed with status code: "+this.yn.StartSessionResponse.RequestStatus+", Time: "+Object(r.a)()),this.mn&&this.jn)this.startSessionCompleted();else{var e={WacFrameIsLoaded:this.mn,InitializeCompleted:this.bn};this.Ri.ULS.$e(596444228,d.a.Xt,l.a.Info,"StartSessionCompleted not called - "+JSON.stringify(e))}},t.prototype.sendWopiInfoToWacFrame=function(){if(!this.bn){this.bn=!0,this.Ri.ULS.$e(596444229,d.a.Xt,l.a.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:this.Cn.WopiSrc,AccessToken:this.Cn.AccessToken,AccessTokenTtl:x(this.Cn)},Diagnostics:{wopiPendingInitializeTime:this.Zi.wopiPendingInitializeTime,wopiPendingCompleteTime:this.Zi.wopiPendingCompleteTime,readyMessageReceiveTime:this.Zi.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(v.a.Ie,t)}},t.prototype.startSessionCompleted=function(){200===this.yn.StartSessionResponse.RequestStatus?this.bn||(this.bn=!0,this.sendSessionCompletionMessageWithRetry(v.a.Se,this.yn)):this.sendWopiInfoToWacFrame()},t.prototype.buildStartSessionUrl=function(t){var e=this.Li.applicationBasePath+R.g,i=N(this.Li,this.zi,!1);return e+="?"+i.substring(i.indexOf("?")+1),e=Object(s.b)(e,"WOPISrc",encodeURIComponent(t.WopiSrc)),e=Object(s.b)(e,"build",encodeURIComponent(Object(o.a)())),e=Object(s.b)(e,"WacUserType",encodeURIComponent("WOPI")),this.Li.wopiPrecheckInfo.FileGetUrl&&(e=Object(s.b)(e,"fileGetUrlPresent","1")),e},t.prototype.updateBrowserHistoryForCreateNew=function(t){if(this.Li.isCreateNew){if(!t||!t.NewFilePath)return void this.Ri.ULS.$e(596444230,d.a.Xt,l.a.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},t}(),J=function(){function t(t,e,i,n,o,r,s){this.Tn=!1,this._n=!1,this.An=!1,this.Pn=6e4,this.Li=t,this.Ki=t.diagnostics.AppInitDiagnostics,this.Ri=i,this.Ei=n,this.Zi=t.diagnostics.SessionTraces,this.In=o;var c=window.navigator.userAgent;c.indexOf("Mobi")>=0&&c.indexOf("iPad")<0&&(this.An=!0),this.qi=r,this.Gi=s,this.Rn=this.An?r:this.getSuccessCallbackProxy(),this.Un=this.An?s:this.getFailureCallbackProxy(),this.En=!(!this.Li.applicationCustomSettings||!this.Li.applicationCustomSettings.IsCore),this.Li.sessionInformation&&this.Li.sessionInformation.WdParams&&(this.Li.applicationCustomSettings&&this.Li.applicationCustomSettings.ForceAccessibilityMode?this.Li.sessionInformation.WdParams.wdAccPdf="1":this.En&&(this.Li.sessionInformation.WdParams.wdAccPdf="0")),this.Fn=new V(this.Li,e,i,n,o,this.Rn,this.Un)}return t.prototype.Complete=function(t){this.Li.diagnostics.HostInitDiagnostics&&(this.Li.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(r.a)()),this.Fn.Complete(t)},t.prototype.Fail=function(t){this.Fn.Fail(t)},t.prototype.Dispose=function(t,e,i){var n=this;Object(B.a)(t||!1,this.Ri,this.Ei,this.Ui,(function(){delete n.Ui,e&&e(),n.In(),n.Ei.dispose()}),void 0,i)},t.prototype.Boot=function(){var t=this;if(this.An)this.Ri.ULS.$e(595932544,d.a.qt,l.a.Info,"Mobile Endpoint detected, skipping first page viewer optimization");else{this.Ri.ULS.$e(595989253,d.a.qt,l.a.Info,"Boot WordViewer"),this.Ei.registerMessagePayloadHandler(h.a.Ft,(function(e){t.handleWacPageCountInit(e)})),this.Ei.registerMessagePayloadHandler(h.a.pt,(function(e){t.handleWacCurrentPageInit(e)})),this.Ei.registerMessagePayloadHandler(h.a.kt,(function(e){t.handleWacZoomLevelInit(e)}));var e=this.Li.rebootOverrideData;e&&e.reason&&"translate"===e.reason.toLowerCase()?this.Ri.ULS.$e(591209105,d.a.qt,l.a.Info,"Skip first page optimization"):this.Li.wopiPrecheckInfo.BundleInfo?this.kickOffFirstPageOptimization(this.Li.wopiPrecheckInfo.BundleInfo,this.Li.container,(function(){t.Wn=Object(r.a)(),t.Ri.ULS.$e(595998873,d.a.qt,l.a.Info,"FirstPageFromHostLoadTime: "+t.Wn),t.Ki.documentLoadedTime=t.Ki.documentLoadedTime||t.Wn,t.Ui&&t.Ui.contentWindow&&t.postFastBootOptimizationTime(t.Ui,t.Wn)}),(function(e){t.removeFirstPageContainer(),t.Ri.ULS.$e(595994571,d.a.qt,l.a.Warning,"Cannot load first page from cache"),t.Ki.errorObject=e})):this.Ri.ULS.$e(596121033,d.a.qt,l.a.Warning,"Missing Bundle Info"),window.setTimeout((function(){return t.timeoutAppInitialize()}),this.Pn)}},t.prototype.postFastBootOptimizationTime=function(t,e){this.Ei.sendPostMessage(t,v.a.Te,{HostCacheLoadTime:e})},t.prototype.kickOffFirstPageOptimization=function(t,e,i,n){var o=this;if(this.Ri.ULS.$e(595989254,d.a.qt,l.a.Info,"Kick off OptimizationView"),!this.Li.applicationCustomSettings||!this.Li.applicationCustomSettings.ForceAccessibilityMode)if(t.Url){var r=e.ownerDocument;if(r){this.Nn=r.createElement("div"),this.Nn.id="FirstPageContainer",this.Nn.style.left="0",this.Nn.style.textAlign="center",this.Nn.style.width="1px",this.Nn.style.bottom="0",this.Nn.style.zIndex="900",this.Nn.style.height="1px",this.Nn.style.position="absolute",this.Nn.style.padding="0 29px",this.Nn.style.right="0",this.Nn.style.overflow="auto",this.Nn.style.marginLeft="auto",this.Nn.style.marginRight="auto",this.Nn.style.maxWidth="100%",this.En?this.Nn.style.top="0":this.Nn.style.top="90px",e.appendChild(this.Nn);var s=r.createElement("img");s.id="FirstPageImage",s.style.marginTop="11px",s.style.marginBottom="11px",s.style.maxWidth="100%",s.style.border="solid 1px #d2d5d8",s.draggable=!1,s.onload=function(){o.Ri.ULS.$e(595989255,d.a.qt,l.a.Info,"OptimizationView Loaded"),o.Nn.style.width="",o.Nn.style.height="",i()},s.onerror=function(t){n({errorType:b.a.CannotLoadFirstPage,errorObject:"string"==typeof t?t:t.returnValue})},s.src=t.Url.replace("{0}","p1.img"),this.Nn.appendChild(s)}}else this.Ri.ULS.$e(595722645,d.a.qt,l.a.Info,"Missing Url in provided Bundle Info, from host: "+this.Li.sessionInformation.HostName)},t.prototype.tryInitializeApplication=function(){if(!this._n&&this.Tn&&(!this.En||this.xn&&this.Mn&&this.kn)){this.Ei.removeMessageHandler(h.a.Ft),this.Ei.removeMessageHandler(h.a.pt),this.Ei.removeMessageHandler(h.a.kt);var t={isCore:this.En,pageCount:this.Mn,currentPage:this.xn,zoomLevel:this.kn,innerApplicationFrame:this.Ui};this.qi(t),this.Ri.ULS.$e(595989256,d.a.qt,l.a.Info,"Word Viewer Initialize Complete"),this._n=!0,this.Ri.ULS.flush()}},t.prototype.getSuccessCallbackProxy=function(){var t=this;return function(e){t.Ri.ULS.$e(595986312,d.a.qt,l.a.Info,"SuccessCallbackProxy called"),t.Ui=e.innerApplicationFrame,t.Wn&&t.postFastBootOptimizationTime(t.Ui,t.Wn),t.removeFirstPageContainer();var i=t.Ki.documentLoadedTime;i&&t.Wn&&t.Wn<i?(t.Ki.documentLoadedTime=t.Wn,t.Ki.documentLoadedFromWopiPrecheckInfo=!0,t.Ri.ULS.$e(595994572,d.a.qt,l.a.Info,"First page load from cache was faster")):t.Ki.documentLoadedFromWopiPrecheckInfo=!1,t.sendAckMessages(),t.Tn=!0,t.Ri.ULS.$e(595986313,d.a.qt,l.a.Info,"WordViewerInitializer received wac complete message"),t.tryInitializeApplication(),t.Ri.ULS.flush()}},t.prototype.getFailureCallbackProxy=function(){var t=this;return function(e){t.Ri.ULS.$e(595972122,d.a.qt,l.a.Error,"FailureCallbackProxy called"),t._n=!0,t.Gi(e)}},t.prototype.removeFirstPageContainer=function(){this.Nn&&this.Nn.parentElement&&this.Nn.parentElement.removeChild(this.Nn)},t.prototype.timeoutAppInitialize=function(){if(!this._n){this.Zi.timeoutAppInitialize=Object(r.a)();var t="Didn't receive app initialize post messages. {'appComplete': "+this.Tn+", 'currentPage': "+(void 0!==this.xn)+", 'zoomLevel': "+(void 0!==this.kn)+", 'pageCount': "+(void 0!==this.Mn)+"}";this.Ri.ULS.$e(596120771,d.a.qt,l.a.Warning,t)}},t.prototype.handleWacPageCountInit=function(t){if(!t||"number"!=typeof t.pageCount)throw new TypeError("values: PageCount not found");this.Mn=t.pageCount,this.sendWacPostMessage(v.a.Ke,{}),this.tryInitializeApplication()},t.prototype.handleWacCurrentPageInit=function(t){if(!t||"number"!=typeof t.newPage)throw new TypeError("values: CurrentPage not found");this.xn=t.newPage,this.sendWacPostMessage(v.a.Pe,{}),this.tryInitializeApplication()},t.prototype.handleWacZoomLevelInit=function(t){if(!t||"number"!=typeof t.newLevel)throw new TypeError("values: ZoomLevel not found");this.kn=t.newLevel,this.sendWacPostMessage(v.a.Ze,{}),this.tryInitializeApplication()},t.prototype.sendAckMessages=function(){this.xn&&this.sendWacPostMessage(v.a.Pe,{}),this.Mn&&this.sendWacPostMessage(v.a.Ke,{}),this.kn&&this.sendWacPostMessage(v.a.Ze,{})},t.prototype.sendWacPostMessage=function(t,e){this.Ui&&this.Ui.contentWindow?this.Ei.sendPostMessage(this.Ui,t,e):this.Ri.ULS.$e(595955717,d.a.qt,l.a.Info,"Attempted to send WordViewer postmessage: "+t)},t}(),L=i(8),z=((H={})[L.a.blurFocus]=v.a.Oe,H[L.a.continueAccessibilityLoop]=v.a.Ce,H[L.a.grabFocus]=v.a.ye,H[L.a.moveToFolder]=v.a.ft,H[L.a.openFile]=v.a.ht,H[L.a.popState]=v.a.Re,H[L.a.rename]=v.a.Ee,H[L.a.saveACopy]=v.a.It,H[L.a.sendAccessToken]=v.a.Fe,H[L.a.sendAuthToken]=v.a.We,H[L.a.sendCustomAuthConfig]=v.a.Ne,H[L.a.sendEmbeddedViewUrl]=v.a.Me,H[L.a.sendSessionInfo]=v.a.ke,H[L.a.sendUserAccessAndPermissions]=v.a.He,H[L.a.sendWopiInfo]=v.a.De,H[L.a.switchMode]=v.a.qe,H),q=function(){function t(t,e){var i=this;if(this.Hn=!1,this.Ti={},this.Dn="",this.Bn="",this.Vn=!1,this.Jn=!1,this.Ln=!1,this.zn=function(t){var e=!1,n=!0,o="",r=!1;if(i.Ui&&i.Ui.contentWindow&&(e=!0,n=t.source===i.Ui.contentWindow),t.origin&&(r=(o=Object(s.f)(t.origin,2).toLowerCase())===i.Bn),!i.Jn&&(!i.Ln||r&&n)||i.Ri.ULS.$e(595730526,d.a.Xt,l.a.Info,"Window is available: "+e+", window is valid: "+n+", origin is valid: "+r+", expected origin: "+i.Bn+", actual origin: "+o),r&&(!i.Vn||n)){var c;try{c=JSON.parse(t.data)}catch(t){return void i.Ri.ULS.$e(596464282,d.a.Xt,l.a.Info,"Failed to parse event data: "+Object(u.l)(t)+".")}var a=c.MessageId;if(a){i.Ri.ULS.$e(595714715,d.a.Xt,l.a.Info,"Received messageId: "+a+", correlation: "+c.CorrelationId),a!==h.a.A&&a!==h.a.at||i.setOrigin(t.origin),c.Values&&c.Values.ackExpected&&i.sendAckBack(t.source,t.origin,c.CorrelationId);var f=i.Ti[a];if(f){i.Ri.ULS.$e(596464288,d.a.Xt,l.a.Info,"Processing message: "+a);try{f(c.Values||{})}catch(t){i.Ri.ULS.$e(593773704,d.a.Xt,l.a.Error,"Handler error: "+Object(u.l)(t))}}else i.Ri.ULS.$e(596464289,d.a.Xt,l.a.Info,"No handler found for message id: "+a)}else(i.Jn||i.Ln)&&i.Ri.ULS.$e(595730520,d.a.Xt,l.a.Info,"Could not find message id")}},!t)throw new Error("Missing origin for PostMessageHandler");this.Jn=Object(s.k)(t),this.Ln=Object(s.l)(t),this.Ri=e,this.setOrigin(t)}return t.prototype.registerMessagePayloadHandler=function(t,e){if(this.Ti[t])throw new Error("Duplicate registration!");this.Ti[t]=e},t.prototype.removeMessageHandler=function(t){delete this.Ti[t]},t.prototype.sendPostMessage=function(t,e,i){if(t&&t.contentWindow){this.Ri.ULS.$e(596464334,d.a.Xt,l.a.Info,"Sending message: "+e);var n={MessageId:e,SendTime:Object(r.a)(),Values:i};this.sendPostMessageInternal(t.contentWindow,JSON.stringify(n),this.Dn)}else this.Ri.ULS.$e(595948308,d.a.Xt,l.a.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,e){this.Ui=t,this.Vn=!!e,this.Hn||(window.addEventListener("message",this.zn,!1),this.Hn=!0)},t.prototype.postMessageForCommand=function(t,e,i){var n=z[e];n?(this.Ri.ULS.$e(595702598,d.a.Xt,l.a.Info,"Sending message "+n+" for command "+e),this.sendPostMessage(t,n,i)):this.Ri.ULS.$e(595702599,d.a.Xt,l.a.Warning,"No mapping for command "+e)},t.prototype.dispose=function(){this.Ti={},this.Hn&&(window.removeEventListener("message",this.zn,!1),this.Hn=!1)},t.prototype.sendAckBack=function(t,e,i){if(t){var n={MessageId:v.a.me,CorrelationId:i,SendTime:Object(r.a)()};this.Ri.ULS.$e(595732176,d.a.Xt,l.a.Info,"Sending Ack back"),t.postMessage(JSON.stringify(n),e)}else this.Ri.ULS.$e(595736136,d.a.Xt,l.a.Info,"Missing target to send Ack back")},t.prototype.sendPostMessageInternal=function(t,e,i){t.postMessage(e,i)},t.prototype.setOrigin=function(t){var e=t.toLowerCase();this.Dn&&this.Dn!==e&&this.Ri.ULS.$e(596128131,d.a.Xt,l.a.Warning,"Updating origin: ["+this.Dn.substring(8)+"]->["+e.substring(8)+"]"),this.Dn=e,this.Bn=Object(s.f)(e,2),this.Jn=Object(s.k)(e),this.Ln=Object(s.l)(e)},t}(),G=function(){function t(){var t=this;if(this.qn=[],this.Ti=[],this.Gn=function(){return t.handleVisibilityChange()},"hidden"===document.visibilityState){var e={visibility:document.visibilityState,time:Object(r.a)(),initialState:!0};this.qn.push(e)}document.addEventListener("visibilitychange",this.Gn)}return t.prototype.RegisterEventHandler=function(t){this.Ti.push(t)},t.prototype.RemoveEventHandler=function(t){if(t){var e=this.Ti.indexOf(t);this.Ti.splice(e,1)}},t.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.Gn)},t.prototype.GetVisibilityChangeEvents=function(){return this.qn},t.prototype.Dispose=function(){this.Stop(),this.Ti=[],this.qn=[]},t.prototype.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:Object(r.a)(),initialState:!1};this.qn.push(t);for(var e=0,i=this.Ti;e<i.length;e++){var n=i[e];n&&n(t)}},t}();var K=i(64);function Z(t,e,i,n,r,c){void 0===c&&(c=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,e){var i=t.SessionInformation;i.WdParams||(i.WdParams={});if(i.WdParams.wd)return;e.substring(1).split("&").filter((function(t){if(0===t.indexOf("wd")){var e=t.split("=");e[0].length>2&&(i.WdParams[e[0]]=e[1])}}));var n=t.RebootOverrideData;n&&n.previousSessionId&&(i.WdParams.wdprevioussession=n.previousSessionId)}(t,window.location.search);var a=r||new K.a("Word",i),u={container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:t.Diagnostics,AppInitDiagnostics:{officeSessionId:e,officeBootstrapperVersion:Object(o.a)(),hostName:t.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:e,applicationBasePath:Object(w.a)(t.ApplicationUrl),wopiInfo:t.WopiInfo,forceSingleStepBoot:c,isCreateNew:t.WopiPrecheckInfo.IsNewFile||Object(s.m)(t.ApplicationUrl),featureManager:n||Object(M.a)(t.FnIsFeatureEnabled,i),Bi:a,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData,canSupportConsumption:!1};return u}i.d(e,"a",(function(){return $}));var $=function(){function t(t,e){this.Kn=t,this.Zn=e}return t.prototype.GetVersion=function(){return Object(o.a)()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var e=document.createElement("link");e.rel="prefetch";var i=t.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),e.href=i;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(e)}},t.prototype.InitializeWopiPending=function(t,e,i,n,o,v){var m,O,C,y,T,_=!1;try{var A,P=Object(r.a)();!function(t){if(void 0===t)throw new TypeError("initParams");var e=t.Container;if(void 0===e||void 0===e.appendChild)throw new TypeError("Container");var i=t.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=t.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),t.ApplicationUrl=Object(s.q)(t.ApplicationUrl,Object(s.i)(t.ApplicationUrl,"region")),t.ApplicationUrl=Object(s.s)(t.ApplicationUrl,"region"),function(t){var e,i=t.RebootOverrideData;i&&(e=i.mode)&&("view"===(e=e.toLowerCase())&&Object(R.a)(t.ApplicationUrl)?t.ApplicationUrl=Object(R.c)(t.ApplicationUrl):"edit"===e&&Object(R.b)(t.ApplicationUrl)&&(t.ApplicationUrl=Object(R.d)(t.ApplicationUrl)))}(t),i?C=i:(C=(m=Object(c.a)())[0],y=m[1]),O=e||Object(a.a)({remoteUlsEndpoint:Object(w.a)(t.ApplicationUrl)+s.p,sessionId:C}),T=Z(t,C,O,o,v,this.Zn.forceSingleStepBoot),v||(T.Bi.addSettingsChangeListener(O.settingsChangeHandler),T.Bi.initializePeriodicFetch(T.applicationBasePath,C)),T.diagnostics.HostInitDiagnostics&&(T.diagnostics.HostInitDiagnostics.hostInitializeCallTime=P),S(O,T,y),_=!0,Object(u.c)(O,!0);var U=t.BootstrapperUrl;U&&(A=this.periodicPrefetch(U,O));var E=function(){T.Bi.dispose(),Object(u.k)(),window.clearInterval(A)},F=Object(s.g)(t.ApplicationUrl),N=n||new q(F,O),x=new G,M=W(T,O),k=function(t,e,i,n,o,r,s,c){return function(a){j(t,o),g(t.SessionTraces,n,l.a.Info);var f=Q(t);n.ULS.$e(596448985,d.a.Xt,l.a.Info,JSON.stringify(f));var h=c(e,n,i,r,a);try{s(h,f)}catch(t){n.ULS.$e(595719171,d.a.Xt,l.a.Error,"Exception thrown from host's success callback: "+Object(u.l)(t))}Object(u.m)("word",n),X(n)}}(T.diagnostics,T.sessionId,N,O,x,E,t.FnOnInitializeSuccess,this.Kn),H=function(t,e,i,n){return function(o){j(t,i),g(t.SessionTraces,e,l.a.Warning);var r=Q(t);e.ULS.$e(596448986,d.a.Xt,l.a.Error,JSON.stringify({error:o,appInitDiagnostics:r}));try{n(o,r)}catch(t){e.ULS.$e(595719172,d.a.Xt,l.a.Error,"Exception thrown from host's failure callback: "+Object(u.l)(t))}Object(u.m)("word",e),X(e)}}(T.diagnostics,O,x,t.FnOnInitializeFailure);if(Object(f.b)(),t.FnOnAppModeSwitched&&N.registerMessagePayloadHandler(h.a.ut,t.FnOnAppModeSwitched),this.Zn.useViewerInitializer||M.bootFlowType===I.unifiedViewActionUrl||M.bootFlowType===I.wordUiEmbedReadOnlyEarlyRedirect||M.bootFlowType===I.wordUiEmbedIrmEnabledEarlyRedirect){!this.Zn.useViewerInitializer&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),M.bootFlowType===I.wordUiEmbedReadOnlyEarlyRedirect&&(T.applicationUrl=Object(R.c)(T.applicationUrl,!0)),T.sessionInformation.HideViewerToolbar&&(T.applicationCustomSettings?T.applicationCustomSettings.IsCore=!0:T.applicationCustomSettings={IsCore:!0},delete T.sessionInformation.HideViewerToolbar);var D=new J(T,M,O,N,E,k,H);return D.Boot(),D}if(M.bootFlowType===I.wordViewToUnifiedReadRedirect&&(O.ULS.$e(578324612,d.a.Xt,l.a.Info,"Redirecting Viewer request to unified read"),T.applicationUrl=Object(R.d)(T.applicationUrl)),t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),U&&this.Zn.preloader&&this.Zn.preloader.shouldPreload(T.applicationUrl))try{var B=U;0,T.featureManager.isFeatureEnabled(p.a.si)&&(O.ULS.$e(595645891,d.a.Xt,l.a.Info,"HTTP2 preload enabled"),B=Object(s.r)(U));var L=T.sessionInformation.UiLocale;L||(L=decodeURIComponent(Object(s.i)(T.applicationUrl,"ui"))),this.Zn.preloader.preload(B,L,O,T.featureManager)}catch(t){O.ULS.$e(595943884,d.a.Xt,l.a.Error,Object(u.l)(t))}var z=new V(T,M,O,N,E,k,H);return z.Boot(),z}catch(e){return O&&(O.ULS.$e(596459925,d.a.Xt,l.a.Error,b.a.AppInitError+": "+Object(u.l)(e)),_||S(O,T||Z(t,C,O,o,v,this.Zn.forceSingleStepBoot),y),O.ULS.flushOnClose()),void t.FnOnInitializeFailure({errorType:b.a.AppInitError,errorObject:e},void 0)}},t.prototype.periodicPrefetch=function(t,e){var i=this;return window.setInterval((function(){i.Prefetch({BootstrapperUrl:t}),e.ULS.$e(595895774,d.a.Xt,l.a.Info,"Prefetching "+Object(s.h)(t))}),36e5)},t}();function X(t){t.ULS.$e(590914655,d.a.Xt,l.a.Info,"Time spent logging: "+t.getTimeSpentLogging())}function Q(t){return Object(n.a)(Object(n.a)(Object(n.a)({},t.AppInitDiagnostics),t.HostInitDiagnostics),{SessionTraces:t.SessionTraces})}},,,,,function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.Unknown="UNKNOWN",t.Initialized="INITIALIZED",t.Prebooted="PREBOOTED",t.Booting="BOOTING",t.Booted="BOOTED",t.Failed="FAILED",t.Disposing="DISPOSING",t.Disposed="DISPOSED"}(n||(n={}))},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i(5),o=i(0),r=i(9),s=i(3),c=i(4),a=i(34),u=i(1),f=i(10),h=function(t){function e(e,i,n,r,s){var c=t.call(this,e,i,n,r,s)||this;return c.$n=5e3,c.Ui=s.innerApplicationFrame,c.Ei=n,c.Ri=i,c.Ti={},c.En=s.isCore,c.Xn=s.currentPage,c.kn=s.zoomLevel,c.Mn=s.pageCount,c.Qn=!c.En,c.Ei.registerMessagePayloadHandler(o.a.kt,c.handleZoomChange.bind(c)),c.Ei.registerMessagePayloadHandler(o.a.pt,c.handlePageChange.bind(c)),c.Ei.registerMessagePayloadHandler(o.a.et,c.handleIsDisabled.bind(c)),c.Ei.registerMessagePayloadHandler(o.a.K,c.raiseError.bind(c)),c}return Object(n.b)(e,t),e.prototype.SetCurrentPage=function(t){var e=this;this.Qn?this.raiseError({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.En}}):(this.Yn=t,this.Ei.sendPostMessage(this.Ui,r.a.Be,{newPage:this.Yn}),window.setTimeout((function(){e.Yn!==e.Xn&&e.Ri.ULS.$e(596444179,s.a.qt,c.a.Info,'Did not receive the page change update. {"RequestedPage": '+e.Yn+', "CurrentPage": '+e.Xn+"}")}),this.$n))},e.prototype.GetPageCount=function(){return this.Qn&&this.raiseError({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.En}}),this.Mn},e.prototype.GetCurrentPage=function(){return this.Qn&&this.raiseError({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.En}}),this.Xn},e.prototype.SetZoomLevel=function(t){var e=this;this.Qn?this.raiseError({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.En}}):(this.to=Number(t.toFixed(2)),this.Ei.sendPostMessage(this.Ui,r.a.Ve,{newLevel:this.to}),window.setTimeout((function(){e.to!==e.kn&&e.Ri.ULS.$e(596444180,s.a.qt,c.a.Info,'Did not receive the zoom change update. {"RequestedZoom": '+e.to+', "CurrentZoom": '+e.kn+"}")}),this.$n))},e.prototype.GetZoomLevel=function(){return this.Qn&&this.raiseError({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.En}}),this.kn},e.prototype.GetIsDisabled=function(){return this.Qn},e.prototype.GetApplicationType=function(){return"Word Viewer"},e.prototype.RegisterEventHandler=function(t,e){switch(t){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.Ti[t])throw new Error("Duplicate registration");this.Ti[t]=e;break;default:this.Ei.registerMessagePayloadHandler(t,e)}},e.prototype.RemoveEventHandler=function(t,e){switch(t){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.Ti[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ti[t];break;default:this.Ei.removeMessageHandler(t)}},e.prototype.RegisterErrorHandler=function(t){this.eo=t},e.prototype.RemoveErrorHandler=function(t){if(this.eo!==t)throw new Error("The handler requested to be removed does not exist");delete this.eo},e.prototype.raiseError=function(t){var e={errorType:"",errorObject:{}};if(e.errorType=t.errorType,e.errorObject=t.errorObject,!e.errorType||!e.errorObject)throw new TypeError("Error object is missing errorType or errorObject");this.eo&&this.eo(e)},e.prototype.handleZoomChange=function(t){this.kn=t.newLevel,this.raiseEvent(u.a.ZoomChanged,t)},e.prototype.handlePageChange=function(t){this.Xn=t.newPage,this.raiseEvent(u.a.PageChanged,t)},e.prototype.handleIsDisabled=function(t){this.Qn=t.isDisabled,this.raiseEvent(u.a.IsDisabled,t)},e}(a.a);function d(t,e,i,n,o){return new h(t,e,i,n,o)}},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(){function t(t){var e=this;this.io=!1,this.no=[],this.cancel=function(){e.io||(e.io=!0,e.no.map((function(t){return t()})),e.no=[])},window.setTimeout(this.cancel,t)}return Object.defineProperty(t.prototype,"isCancelled",{get:function(){return this.io},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.io?t():this.no.push(t)},t}();function o(t){return new n(t)}},function(t,e,i){"use strict";var n=i(21),o=i(12),r=i(5),s=i(0),c=i(2),a=i(3),u=i(4),f=function(t,e,i,n,o){return t!==s.a.wt?Promise.reject("Wrong flow"):new Promise((function(t){i.pendingReboot=!0;var n=void 0;if(e.queryOverrides)try{n=JSON.parse(e.queryOverrides)}catch(t){i.logger.ULS.$e(592217694,a.a.Xt,u.a.Error,"Failed to parse queryOverrides: "+n)}i.raiseEvent(c.a.Reboot,Object(r.a)(Object(r.a)({},e),{previousSessionId:i.sessionId,queryOverrides:n})),t({completion:"success"})}))},h=function(t,e,i){return new Promise((function(e){i.logger.ULS.$e(590111070,a.a.Xt,u.a.Error,"Unsupported flow: "+t),e({completion:"failure"})}))},d=i(8),l=i(61),p=i(88);function v(t,e){if(void 0===t)throw new TypeError("SessionBootParams");var i=t.appUrl,n=t.appBaseUrl;if(void 0===i&&void 0===n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(void 0!==i&&"string"!=typeof i)throw new TypeError("AppUrl");if(void 0!==n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=t.file;if(void 0===o||void 0===o.name)throw new TypeError("FileInfo");var r=t.container;if(void 0===r||!(r instanceof p.a)&&void 0===r.appendChild)throw new TypeError("Container");if(!e&&!Object(l.a)(t.wopi))throw new TypeError("WopiInfo")}var m=i(45),b=i(15),w=i(63),O=i(7);function g(t,e,i,n,o,r){return t!==d.a.boot?Promise.reject("Wrong flow"):new Promise((function(t){var s;v(n,e.skipWopiValidation),e.state=m.a.Booting,e.pendingReboot=!1,e.appBaseUrl=n.appBaseUrl?n.appBaseUrl.toLowerCase():Object(b.g)(n.appUrl).toLowerCase(),e.appUrl=n.appUrl||"",e.bootParams=n.bootParams||{},e.appUrl&&Object(b.m)(e.appUrl)&&(e.bootParams.isNewFile=!0),e.rebootOverride=n.rebootOverride,e.appBasePath=o.buildAppBasePath(e),e.intent=n.intent,e.file=n.file,e.wopi=n.wopi,e.contentBundle=n.contentBundle,e.newFileTemplate=n.newFileTemplate,e.ownerId=n.ownerId,e.sessionContext=n.sessionContext,e.actNavId=n.actNavId,e.wdParams=n.wdParams,e.preseededSession=n.preseededSession,e.throttling=n.throttling,e.hostInitDiagnostics=n.diagnostics,e.appInitDiagnostics={};var c,f=n.hostGeneratedSessionId;f&&(e.sessionId=f,e.logger.ULS.$e(573072217,a.a.Xt,u.a.Info,"Using Host generated sessionId.["+e.sessionId+"]")),n.rebootOverride&&(f||(s=Object(w.a)(),e.sessionId=s[0],c=s[1]),e.Bi.addSettingsChangeListener(e.logger.settingsChangeHandler)),e.logger.configure({remoteUlsEndpoint:Object(b.e)(e.appBasePath),sessionId:e.sessionId}),e.Bi.initializePeriodicFetch(e.appBasePath,e.sessionId),c&&e.logger.ULS.$e(589842332,a.a.Xt,u.a.Info,JSON.stringify(c));var h=function(n,o){i.error=n,i.appInitDiagnostics=o,e.appInitDiagnostics=o,e.state=m.a.Failed,t({completion:"failure",error:n})};r&&r.subscribe((function(){h({errorType:"Cancelled",errorObject:void 0})}));var d=function(t,e,i,n){var o=t.appBasePath+(Object(O.a)(t.appUrl)?O.f:O.j)+"?";if(t.appUrl){var r=Object(b.o)(t.appUrl);Object.keys(r).forEach((function(t){o+=t+"="+r[t]+"&"}))}var s=t.ui;s&&s.uiEmbed&&(o=Object(b.b)(o,"uiembed","1"));var c=t.host;c.uiHostName&&(o=Object(b.b)(o,"uih",c.uiHostName));var a=t.user;a.isLicensed&&(o=Object(b.b)(o,"islicenseduser","1"));e.actNavId&&(o=Object(b.b)(o,"actnavid",e.actNavId));var u=e.container,f=u instanceof p.a?u.element:u,h=e.bootParams,d=t.viewMode,l=c.capabilities,v=e.file,m=e.contentBundle,w=e.preseededSession,g=e.throttling,j=e.wopi,S=e.newFileTemplate;return{BootstrapperUrl:t.bootstrapperUrl,Container:f,SessionInformation:{HostName:t.hostName,HostSessionId:t.hostSessionId,UserId:a.id,OwnerId:e.ownerId,UiLocale:s&&s.language,DataLocale:h&&h.dataLanguage,DisableChat:h&&h.disableChat,CookieCompliant:h&&h.cookieCompliant,WdParams:e.wdParams,SessionContext:e.sessionContext,DisableFocusOnBoot:d&&d.disableFocusOnBoot,HighContrastMode:s?s.highContrast:void 0,HideViewerToolbar:d&&d.hideToolbar,SupportsAccessibilityLoop:l&&l.accessibilityLoop,SupportsAtMentions:l&&l.atMentions,SupportsDocReboot:l&&l.rebootDoc,SupportsCreateNewDocument:l&&l.createNewDoc,SupportsAuthToken:l&&l.authToken,SupportsCustomAuthConfig:l&&l.customAuthConfig,SupportsMoveToFolder:l&&l.moveToFolder,SupportsSharedFilePicker:l&&l.sharedFilePicker,SupportsExcelExternalLinks:l&&l.excelExternalLinks,SupportsRefreshAccessToken:l&&l.refreshAccessToken,HideHeader:s&&s.hideHeader,NoBrowserModalDialogs:l&&l.noBrowserModalDialogs,HideBreadCrumbInViewer:d&&d.hideBreadCrumb,HideTitleInViewer:d&&d.hideTitle,HideWACOneDriveFileLocationPicker:s&&s.hideFileLocationPicker,UiHostIntegrationType:c&&c.uiHostIntegrationType,MetaUiHostVersion:c&&c.metaUiHostVersion},ApplicationUrl:o,WopiPrecheckInfo:{FileName:v.name,FileGetUrl:v.getUrl,FileSize:v.size,BundleInfo:m?{MajorVersion:m.majorVersion,Url:m.url,BundleStaleness:m.staleness}:void 0,IsNewFile:h&&h.isNewFile,IsNewFileFromHostTemplate:h&&h.isFromHostTemplate,ReadOnly:h&&h.readOnly,IrmEnabled:h&&h.irmEnabled,ETag:v.eTag,PreseededSessionKey:w&&w.key,PreseededWacSessionId:w&&w.id,DocUniqueId:v.uniqueId,ClientThrottlingProtection:g&&g.protection,RequestedCallThrottling:g&&g.request},ApplicationCustomSettings:{HostUIControls:s&&s.controls},Diagnostics:e.diagnostics,WopiInfo:{WopiSrc:j.source,AccessToken:j.accessToken,AccessTokenExpiry:new Date(j.expiry)},FnOnInitializeSuccess:i,FnOnInitializeFailure:n,NewFileTemplateSource:S?{FileGetUrl:S.getUrl,FileSize:S.size,ETag:S.eTag,DocUniqueId:S.uniqueId}:void 0,RebootOverrideData:e.rebootOverride}}(e,n,(function(n,o){r&&r.isCancelled||(i.application=n,i.appInitDiagnostics=o,e.appInitDiagnostics=o,n.RegisterAllEventsHandler((function(t){e.onMessage(t)})),e.state=m.a.Booted,t({completion:"success"}))}),h),l=i.bootstrapper.InitializeWopiPending(d,e.logger,e.sessionId,void 0,e.featureManager,e.Bi);l&&l.Complete(d.WopiInfo),i.pendingApplication=l}))}var j=i(1);var S=i(52);var I=i(54);function C(t){var e=t.appContext;e.canSupportConsumption=!1,e.isUnifiedRead=!1}var y=i(24),T=i(38),_=i(14),A=i(31),P=i(32),R=i(33);function U(t){var e=t.appBaseUrl.indexOf(O.h)>-1,i=t.rebootOverride;if(i){var o=i.mode;o&&("view"===(o=o.toLowerCase())&&e?t.appBaseUrl=Object(O.c)(t.appBaseUrl):"edit"!==o||e||(t.appBaseUrl=Object(O.d)(t.appBaseUrl)))}else{var r=!(!t.ui||!t.ui.uiEmbed),s=r&&!(!t.bootParams||!t.bootParams.readOnly),a=Object(_.b)(t.appUrl),u=t.Bi.getValue(y.a.Ci,!1)&&(Object(b.k)(t.appBaseUrl)||t.featureManager.isFeatureEnabled(n.a.mi))&&!a&&(t.bootParams&&t.bootParams.isNewFile&&!t.wopi||t.file&&Object(A.a)(t.file.name))&&Object(P.a)(t.host.storageHostName)&&!r;t.appContext.canSupportConsumption=u,!u||e||Object(T.a)(R.a.yi,!1)?(e&&!s||t.raiseEvent(c.a.ModeSwitched,{NewMode:"view"}),e&&s&&(t.appBaseUrl=Object(O.c)(t.appBaseUrl))):(t.appBaseUrl=Object(O.d)(t.appBaseUrl),t.appContext.isUnifiedRead=!0)}return e=t.appBaseUrl.indexOf(O.h)>-1,t.appBaseUrl+(e?O.e:O.i)}var E=function(){var t,e,i={bootstrapper:I.Application};return[(t={},t[o.a.appReboot]=f,t[o.a.boot]=function(t,e,n,o,r){return g(t,n,i,e,o,r)},t[o.a.closeTab]=h,t[o.a.createNew]=h,t[o.a.dispose]=function(t,e,n,o,r){return function(t,e,i,n){return t!==d.a.dispose?Promise.reject("Wrong flow"):new Promise((function(t){e.state=m.a.Disposing;var o=!!e.host.requireExplicitUnload,r=function(){e.state=m.a.Disposed,t({completion:"success"})};if(n&&n.subscribe((function(){t({completion:"cancelled"})})),i.application){var s=i.application;o&&s.registerEventHandlerInternal(j.a.Disposed,r),s.Dispose(o),o||r()}else i.pendingApplication?i.pendingApplication.Dispose(o,r):r()}))}(t,n,i,r)},t[o.a.frameTrust]=h,t[o.a.getHostKeyValue]=h,t[o.a.handleBootState]=h,t[o.a.postMessage]=function(t,e,n,o,r){return function(t,e,i,n,o){return i.application.PostCommand(t,n),Promise.resolve({completion:"success"})}(t,0,i,e)},t[o.a.rename]=function(t,e,n,o,r){return function(t,e,i,n,o){return new Promise((function(r){var c=function(t,e){var i={completion:e.NewName===n.NewName?"success":"failure"};u(i)},a=function(t,e){u({completion:"failure"})},u=function(t){e.removeActionHandler(s.a.X,c),e.removeActionHandler(s.a.Y,a),r(t)};e.addActionHandler(s.a.X,c),e.addActionHandler(s.a.Y,a),(o||new S.a(5e3)).subscribe((function(){u({completion:"cancelled"})})),i.application&&i.application.PostCommand(t,n)}))}(t,n,i,e,r)},t[o.a.setOverlayContent]=h,t[o.a.storeHostKeyValue]=h,t[o.a.switchMode]=function(t,e,n,o,r){return function(t,e,i,n,o){return new Promise((function(r){var c=function(t,e){a({completion:"success"})},a=function(t){e.removeActionHandler(s.a.ut,c),r(t)};e.addActionHandler(s.a.ut,c),(o||new S.a(5e3)).subscribe((function(){a({completion:"cancelled"})})),i.application&&i.application.PostCommand(t,n)}))}(t,n,i,e,r)},t),(e={},e[o.a.boot]={initializeAppContext:C,buildAppBasePath:U,buildBootRequestParams:function(){return{appPageName:"",queryParamsOverrides:{},postDataOverrides:{}}}},e)]},F=i(9),W=i(13),N=i(37),x=i(17),M=i(19),k=i(65),H=i(76);function D(t,e,i){var n=Object(r.a)(Object(r.a)(Object(r.a)({},Object(b.o)(t.appUrl)),function(t){var e={};Object(b.a)(e,"jsapi","1"),Object(b.a)(e,"jsapiver","v2"),Object(b.a)(e,"corrid",t.sessionId),Object(b.a)(e,"usid",t.sessionId),Object(b.a)(e,"newsession","1"),Object(b.a)(e,"sftc","1"),t.hostSessionId&&Object(b.a)(e,"hid",encodeURIComponent(t.hostSessionId));var i=t.host;i.uiHostName&&Object(b.a)(e,"uih",i.uiHostName),i.uiHostIntegrationType&&Object(b.a)(e,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&Object(b.a)(e,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&Object(b.a)(e,"accloop","1"),n.rebootDoc&&Object(b.a)(e,"sdr",n.rebootDoc.toString()),n.createNewDoc&&Object(b.a)(e,"scnd","1"),n.authToken&&Object(b.a)(e,"sat","1"),n.customAuthConfig&&Object(b.a)(e,"cac","1"),n.excelExternalLinks&&Object(b.a)(e,"xlel","1"),n.refreshAccessToken&&Object(b.a)(e,"rat","1"),n.atMentions&&Object(b.a)(e,"sams","1"),n.moveToFolder&&Object(b.a)(e,"mtf","1"),n.noBrowserModalDialogs&&Object(b.a)(e,"nbmd","1"),n.sharedFilePicker&&Object(b.a)(e,"sfp","1"));var o=t.ui;o&&(o.language&&Object(b.a)(e,"ui",encodeURIComponent(o.language)),o.uiEmbed&&Object(b.a)(e,"uiembed","1"),o.hideHeader&&Object(b.a)(e,"hhdr","1"),o.highContrast&&Object(b.a)(e,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&Object(b.a)(e,"hodflp","1"));var r=t.wopi;r&&r.source&&Object(b.a)(e,"wopisrc",encodeURIComponent(r.source));var s=t.bootParams;s&&(s.dataLanguage&&Object(b.a)(e,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&Object(b.a)(e,"readonly","1"),s.disableChat&&Object(b.a)(e,"dchat","1"),s.cookieCompliant&&Object(b.a)(e,"mscc","1"),s.isNewFile&&(Object(b.a)(e,"new","1"),s.isFromHostTemplate&&Object(b.a)(e,"wdtpl","fromhost"))),t.user.isLicensed&&Object(b.a)(e,"islicenseduser","1"),t.actNavId&&Object(b.a)(e,"actnavid",t.actNavId),t.sessionContext&&Object(b.a)(e,"sc",encodeURIComponent(t.sessionContext));var c=t.wdParams;if(c)for(var a in c)Object(b.a)(e,a,c[a]);var u=t.preseededSession;u&&(u.key&&Object(b.a)(e,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&Object(b.a)(e,"preseededwacsessionid",encodeURIComponent(u.id)));var f=t.throttling;f&&(f.protection&&Object(b.a)(e,"ctp",f.protection),f.request&&Object(b.a)(e,"rct",f.request));var h=t.hostInitDiagnostics;h&&(h.entryPoint&&Object(b.a)(e,"wdorigin",encodeURI(h.entryPoint)),h.userClickTime&&Object(b.a)(e,"wdhostclicktime",h.userClickTime.toString()));var d=t.rebootOverride;return d&&d.previousSessionId&&Object(b.a)(e,"wdprevioussession",d.previousSessionId),Object(b.n)(e,"region"),e}(t)),i),o=t.rebootOverride;return o&&o.queryOverrides&&(n=Object(r.a)(Object(r.a)({},n),o.queryOverrides)),Object(b.d)(t.appBasePath,e,n)}function B(t,e){var i=function(t){var e={};Object(b.a)(e,H.a.fn,String(window.devicePixelRatio>1.24)),Object(b.a)(e,H.a.hn,String(Object(M.f)())),Object(b.a)(e,H.a.dn,t.hostName),Object(b.a)(e,H.a.an,Object(k.b)(t.featureManager,t.wdParams));var i=t.wopi;i&&(Object(b.a)(e,H.a.$i,i.accessToken),Object(b.a)(e,H.a.Xi,i.expiry.toString()));var n=t.contentBundle;if(n&&n.url&&n.url.length>0){Object(b.a)(e,H.a.Qi,n.url);var o=n.staleness,r=null!=o;r&&Object(b.a)(e,H.a.Yi,o.toString()),t.logger.ULS.$e(577783775,a.a.Xt,u.a.Info,"Content bundle staleness: "+(r?o:"N/A"))}var s=t.file,c=s.name;if(c){Object(b.a)(e,H.a.in,c);var f=c.lastIndexOf(".");if(-1!==f){var h=c.substring(f+1);h&&Object(b.a)(e,H.a.en,h)}}s.getUrl&&Object(b.a)(e,H.a.tn,s.getUrl),s.size&&Object(b.a)(e,H.a.nn,s.size.toString()),s.eTag&&Object(b.a)(e,H.a.vn,s.eTag),s.uniqueId&&Object(b.a)(e,H.a.pn,s.uniqueId);var d=t.newFileTemplate;d&&(d.getUrl&&Object(b.a)(e,H.a.ln,d.getUrl),d.size&&Object(b.a)(e,H.a.nn,d.size.toString()),d.eTag&&Object(b.a)(e,H.a.vn,d.eTag),d.uniqueId&&Object(b.a)(e,H.a.pn,d.uniqueId)),t.user.id&&Object(b.a)(e,H.a.on,t.user.id),t.ownerId&&Object(b.a)(e,H.a.rn,t.ownerId),t.sessionContext&&Object(b.a)(e,H.a.sn,t.sessionContext);var l=t.ui;return l&&l.controls&&Object(b.a)(e,H.a.un,JSON.stringify(l.controls)),e}(t);return Object.keys(e).forEach((function(t){e[t]?i[t]=e[t]:delete i[t]})),i}var V=[],J=function(t,e,i,o,c){return t!==d.a.boot?Promise.reject("Wrong flow"):new Promise((function(t){var f,h=Object(x.a)();v(e,i.skipWopiValidation),i.state=m.a.Booting,i.pendingReboot=!1,Object(W.c)(i.logger,!0),o.initializeAppContext(i),i.appBaseUrl=e.appBaseUrl?e.appBaseUrl.toLowerCase():Object(b.g)(e.appUrl).toLowerCase(),i.appUrl=e.appUrl||"",i.appBaseUrl=Object(b.q)(i.appBaseUrl,Object(b.i)(i.appUrl,"region")),i.bootParams=e.bootParams||{},i.appUrl&&Object(b.m)(i.appUrl)&&(i.bootParams.isNewFile=!0),i.rebootOverride=e.rebootOverride,i.appBasePath=o.buildAppBasePath(i),i.intent=e.intent,i.file=e.file,i.wopi=e.wopi,i.contentBundle=e.contentBundle,i.newFileTemplate=e.newFileTemplate,i.ownerId=e.ownerId,i.sessionContext=e.sessionContext,i.actNavId=e.actNavId,i.preseededSession=e.preseededSession,i.throttling=e.throttling,i.hostInitDiagnostics=Object(r.a)(Object(r.a)({},e.diagnostics),{hostInitializeCallTime:h}),i.wdParams=e.wdParams||{},window.location.search.substring(1).split("&").forEach((function(t){if(/^wd\w+=\w+/.test(t)){var e=t.split("=");i.wdParams[e[0]]=e[1]}}));var d,l=e.hostGeneratedSessionId;if(l&&(i.sessionId=l,i.logger.ULS.$e(573072218,a.a.Xt,u.a.Info,"Using Host generated sessionId.["+i.sessionId+"]")),e.rebootOverride&&(l||(f=Object(w.a)(),i.sessionId=f[0],d=f[1]),i.Bi.addSettingsChangeListener(i.logger.settingsChangeHandler)),i.logger.configure({remoteUlsEndpoint:Object(b.e)(i.appBasePath),sessionId:i.sessionId}),i.Bi.initializePeriodicFetch(i.appBasePath,i.sessionId),d&&i.logger.ULS.$e(590966790,a.a.Xt,u.a.Info,JSON.stringify(d)),Object(W.i)(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:Object(N.a)(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var O=e.container;i.container=O instanceof p.a?O:i.application.createContainer(O)}i.container.setMessageHandler(i.onMessage);var g=!!o.ignoreCompletionMessage&&o.ignoreCompletionMessage(i),j=function(t,e){g||(i.container.postMessage(F.a.je,void 0),Object(W.d)(i.appInitDiagnostics,e.Diagnostics)),o.onBootSuccess&&o.onBootSuccess(i),i.logger.ULS.$e(596448985,a.a.Xt,u.a.Info,JSON.stringify(i.diagnostics)),i.logger.ULS.flush(),i.container.postMessage(F.a.Ae,{HostInitializeDiagnostics:i.hostInitDiagnostics}),i.state=m.a.Booted,C({completion:"success"}),Object(W.m)(i.appInfo.name,i.logger)},I=function(t,e){i.logger.ULS.$e(596448986,a.a.Xt,u.a.Error,JSON.stringify({error:e.Error,diagnostics:i.diagnostics})),i.logger.ULS.flush(),i.state=m.a.Failed,C({completion:"failure"}),Object(W.m)(i.appInfo.name,i.logger)},C=function(e){g||(Object(W.g)(),Object(W.f)(V),V=[],i.removeActionHandler(s.a.A,j),i.removeActionHandler(s.a.O,I)),t(e)};(c||new S.a(3e5)).subscribe((function(){C({completion:"cancelled"})})),g||(i.addActionHandler(s.a.A,j),i.addActionHandler(s.a.O,I));var T=o.buildBootRequestParams(i),_=D(i,T.appPageName,T.queryParamsOverrides);if(i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(_))try{o.beforePreload&&o.beforePreload(i);var A=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(n.a.si)&&(i.logger.ULS.$e(590966791,a.a.Xt,u.a.Info,"HTTP2 preload enabled"),A=Object(b.r)(A));var P=void 0;i.ui&&(P=i.ui.language),P||(P=decodeURIComponent(Object(b.i)(_,"ui"))),i.preloader.preload(A,P,i.logger,i.featureManager)}catch(t){i.logger.ULS.$e(590966792,a.a.Xt,u.a.Error,Object(W.l)(t))}var R=B(i,T.postDataOverrides);o.beforeContainerBoot&&o.beforeContainerBoot(i,_),i.appInitDiagnostics.officeFrameCreateTime=Object(x.a)(),i.container.boot(_,R,i.logger),g?j(s.a.A,{Diagnostics:{}}):(Object(W.e)(Object(b.k)(i.appBaseUrl),i.Bi,i.logger,(function(){return Object(W.j)(i.logger)})),V.push(window.setTimeout((function(){return Object(W.j)(i.logger,1)}),i.Bi.getValue(y.a.bi,W.a))),V.push(window.setTimeout((function(){return Object(W.j)(i.logger,2)}),i.Bi.getValue(y.a.wi,W.b))))}))},L=i(80),z=function(t,e,i,n,o){return t!==d.a.createNew?Promise.reject("Wrong flow"):new Promise((function(c){var f={wopiPendingInitializeTime:Object(x.a)()},h=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),p=!1,v=!1,b=!1,w=!1,O=void 0,g=void 0,j=!1,S=!1;if(Object(M.e)())!function(){i.logger.ULS.$e(578074079,a.a.Xt,u.a.Info,"Waiting for WOPI info to start boot");var t=function(t,s){if(p)i.logger.ULS.$e(578074080,a.a.Xt,u.a.Warning,"completeCreateNew already called");else{if(p=!0,f.wopiPendingCompleteTime=Object(x.a)(),"failure"===s.state)return k(s.reason),i.state=m.a.Failed,void n({completion:"failure"});q(s.newFile),i.run(d.a.boot,Object(r.a)(Object(r.a)({},e),{wopi:s.wopi}),o).then((function(t){n(t)}))}};i.addActionHandler(d.a.completeCreateNew,t);var n=function(e){i.removeActionHandler(d.a.completeCreateNew,t),c(e)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var I=function(t,e){p?i.logger.ULS.$e(587236372,a.a.Xt,u.a.Warning,"completeCreateNew already called"):(p=!0,f.wopiPendingCompleteTime=Object(x.a)(),"failure"!==e.state?(O=e.wopi,Object(l.a)(O)?(i.logger.ULS.$e(587286030,a.a.Xt,u.a.Info,"WOPI info received. Access token: "+JSON.stringify({length:O.accessToken.length,expiry:O.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:h,wacFrameLoaded:v,wacCanAcceptStartSessionResponse:b})),!h||v&&!b?v&&P():y(),v&&i.container&&i.container.postMessage(F.a.ze,void 0),q(e.newFile)):C("InvalidWopiInfo")):C(e.reason))},C=function(t){k(t),v&&i.container&&i.container.postMessage(F.a.Je,void 0)},y=function(){i.logger.ULS.$e(587233056,a.a.Xt,u.a.Info,"Making parallelized StartSession request");var e=n.buildStartSessionRequestParams(i,t,O),o=D(i,e.appPageName,e.queryParamsOverrides),r={"Content-Type":"application/x-www-form-urlencoded"},s="access_token="+encodeURIComponent(O.accessToken)+"&access_token_ttl="+encodeURIComponent(O.expiry.toString());f.startSessionStartTime=Object(x.a)(),Object(L.a)(o,s,r,T)},T=function(t){var e=Object(x.a)();f.startSessionCompleteTime=e,i.logger.ULS.$e(587233057,a.a.Xt,u.a.Info,"StartSession request completed. Status code: "+t.status+", time: "+e),g={RequestStatus:t.status,ResponseText:t.responseText},v&&b?A():i.logger.ULS.$e(587233058,a.a.Xt,u.a.Info,"Abandon StartSession response: "+JSON.stringify({wacFrameLoaded:v,wacCanAcceptStartSessionResponse:b,wopiInfoSent:j,startSessionResponseSent:S}))},_=function(t,e){f.readyMessageReceiveTime=Object(x.a)(),i.container&&i.container.postMessage(F.a.be,void 0),v||(v=!0,b=e.CanAcceptStartSessionComplete,i.logger.ULS.$e(587321567,a.a.Xt,u.a.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:h,wacCanAcceptStartSessionResponse:b,startSessionResponseAvailable:!!g,wopiInfoAvailable:!!O})),p&&i.container&&i.container.postMessage(O?F.a.ze:F.a.Je,void 0),h&&b?A():P(),Object(W.d)(i.appInitDiagnostics,e.Diagnostics))},A=function(){S||j||!g||(200===g.RequestStatus?(S=!0,f.completeMessageCreateTime=Object(x.a)(),R(F.a.Se,{StartSessionResponse:g,Diagnostics:f},3)):P())},P=function(){S||j||!O||(j=!0,f.completeMessageCreateTime=Object(x.a)(),R(F.a.Ie,{WopiDetails:{WopiSrc:O.source,AccessToken:O.accessToken,AccessTokenTtl:O.expiry.toString()},Diagnostics:f},3))},R=function(t,e,n){var o=Object(x.a)();n<=0?i.logger.ULS.$e(587233165,a.a.Xt,u.a.Error,"Attempted to complete but no ack. Time: "+o):(i.logger.ULS.$e(587233166,a.a.Xt,u.a.Info,"Sending complete message. Retries left: "+(n-1)+", Time: "+o),f.completeMessageSendTime=o,i.container&&i.container.postMessage(t,e),window.setTimeout(U,1e3,t,e,n-1))},U=function(t,e,n){w||(i.logger.ULS.$e(587233167,a.a.Xt,u.a.Info,"Timeout session complete ack. Iteration: "+n),R(t,e,n+1))},E=function(t,e){w=!0},N=function(t){i.removeActionHandler(d.a.completeCreateNew,I),i.removeActionHandler(s.a.v,_),i.removeActionHandler(s.a.yt,E),c(t)};i.addActionHandler(d.a.completeCreateNew,I),i.addActionHandler(s.a.v,_),i.addActionHandler(s.a.yt,E),window.setTimeout((function(){v||(i.logger.ULS.$e(596444191,a.a.Xt,u.a.Warning,"Timeout app ready"),N({completion:"failure"}),o&&o.cancel())}),5e3),o&&o.subscribe((function(){N({completion:"cancelled"})})),i.skipWopiValidation=!0,i.wopi=void 0,i.run(d.a.boot,e,o).then((function(t){i.skipWopiValidation=!1,i.wopi=O,N(t)}))}function k(t){i.logger.ULS.$e(596444188,a.a.Xt,u.a.Warning,"Fail with reason: "+(t?JSON.stringify(t):"N/A"))}}))};function q(t){t&&(t.path&&history.replaceState({},"",t.path),t.title&&(document.title=t.title))}var G=function(t,e,i,n,o){return t!==d.a.dispose?Promise.reject("Wrong flow"):new Promise((function(t){var e=i.host.requireExplicitUnload,n={disposeStartTime:Object(x.a)(),forceAppUnload:e};i.state=m.a.Disposing;var r=function(){i.state=m.a.Disposed,t({completion:"success"})},c=function(t){i.dispose(),n.disposeEndTime=Object(x.a)(),function(t,e,i){if(i){var n=Number(i.hostMessageReceived);e.appUnloadStartTime&&!isNaN(n)&&(e.hostToAppPostMessageLatency=n-e.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.appUnloadEndTime&&(e.appToHostPostMessageLatency=e.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(e.appUnloadLatency=s-r),i.serverTimings){var c=i.serverTimings;for(var f in c)e["st-"+f.toString()]=c[f]}}t.logger.ULS.$e(592524822,a.a.Xt,u.a.Info,"App disposed: "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(i,n,t),Object(W.k)(),i.container?i.container.dispose(i.pendingReboot,e).then(r):r()};if(e){n.appUnloadStartTime=Object(x.a)();i.addActionHandler(s.a.Ut,(function(t,e){n.appUnloadEndTime=Object(x.a)(),c(e)})),(o||new S.a(5e3)).subscribe((function(){i.state===m.a.Disposing&&(n.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(F.a.Ge,void 0)}else c()}))};var K=function(t,e,i,n,o){return t!==s.a.it?Promise.reject("Wrong flow"):new Promise((function(t){var e=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.$e(592445957,a.a.Xt,u.a.Info,"Top frame is trusted: "+e),i.container&&i.container.postMessage(F.a.it,{isTopFrameTrusted:e}),t({completion:"success"})}))},Z=i(78),$=function(t,e,i,n,o){return t!==s.a._?Promise.reject("Wrong flow"):new Promise((function(t){var o=e&&e.state?e.state:"Unknown";i.logger.ULS.$e(592839750,a.a.Xt,u.a.Info,"Boot state: ["+o+"]"),n&&n.beforeComplete&&n.beforeComplete(o),t({completion:"success"})}))},X=function(t,e,i,n,o){return t!==d.a.rename?Promise.reject("Wrong flow"):new Promise((function(t){var n=function(t,i){var n={completion:i.NewName===e.NewName?"success":"failure"};c(n)},r=function(t,e){c({completion:"failure"})},c=function(e){i.removeActionHandler(s.a.X,n),i.removeActionHandler(s.a.Y,r),t(e)};i.addActionHandler(s.a.X,n),i.addActionHandler(s.a.Y,r),(o||new S.a(5e3)).subscribe((function(){c({completion:"cancelled"})})),i.container&&i.container.postMessage(F.a.Ee,e)}))},Q=i(77),Y=i(79),tt=function(t,e,i,n,o){return t!==d.a.switchMode?Promise.reject("Wrong flow"):new Promise((function(t){var n=function(t,e){r({completion:"success"})},r=function(e){i.removeActionHandler(s.a.ut,n),t(e)};i.addActionHandler(s.a.ut,n),(o||new S.a(5e3)).subscribe((function(){r({completion:"cancelled"})})),i.container&&i.container.postMessage(F.a.qe,e)}))};function et(t){return t.appBasePath.indexOf(O.h)>-1&&!!(t.wopi&&t.bootParams&&t.bootParams.isNewFile)}function it(t,e,i){var n=t.appBasePath.indexOf(O.h)>-1,o=n?e===d.a.createNew?O.g:O.f:O.j,r={},s=t.viewMode;s&&(s.hideToolbar&&Object(b.a)(r,n?"hvt":"core","1"),s.hideBreadCrumb&&Object(b.a)(r,"hbcv","1"),s.hideTitle&&Object(b.a)(r,"htv","1"),s.disableFocusOnBoot&&Object(b.a)(r,"disablefocusonboot","1"),s.forceAccessibilityMode&&!s.hideToolbar&&Object(b.a)(r,"wdaccpdf","1"));var c=t.wopi,a=t.bootParams,u=t.ui;return n&&(c?a&&a.isNewFile||(t.appContext.canSupportConsumption&&Object(b.a)(r,"csc","1"),t.appContext.isUnifiedRead?(Object(b.a)(r,"cons","1"),Object(b.a)(r,"readonly","1")):Object(b.a)(r,"instantedit","1"),Object(b.a)(r,"wopicomplete","1")):(Object(b.a)(r,"instantedit","1"),Object(b.a)(r,"filesrc",encodeURIComponent(t.hostName)),Object(b.a)(r,"pmorigin",encodeURIComponent(Object(b.g)(window.location.href)))),e===d.a.createNew&&(Object(b.n)(r,"newsession"),Object(b.a)(r,"build",encodeURIComponent(Object(N.a)())),Object(b.a)(r,"wacusertype","WOPI"),t.file.getUrl&&Object(b.a)(r,"filegeturlpresent","1"),i&&Object(b.a)(r,"wopisrc",encodeURIComponent(i.source)))),c&&Object(b.a)(r,"wdredirectionreason",function(t,e,i,n){return t?"Unified_SingleFlush":e?"Unified_IrmEnabled":i&&n?"Unified_UiEmbedReadOnly":"Unified_ViewActionUrl"}(n,!(!a||!a.irmEnabled),!(!u||!u.uiEmbed),!(!a||!a.readOnly))),{appPageName:o,queryParamsOverrides:r,postDataOverrides:{}}}var nt,ot;function rt(t){if(!(t.appBaseUrl.indexOf(O.h)>-1)){t.logger.ULS.$e(577843778,a.a.Xt,u.a.Info,"Boot Word viewer");var e=window.navigator.userAgent;if(!(e.indexOf("Mobi")>=0&&e.indexOf("iPad")<0)){var i=t.rebootOverride;if(!i||!i.reason||"translate"!==i.reason.toLowerCase()){var n=t.viewMode;if(!n||!n.forceAccessibilityMode){var o=t.contentBundle;if(o&&o.url){var r=t.container;if(r){var s=r.element,c=s.ownerDocument;if(c){t.logger.ULS.$e(577843779,a.a.Xt,u.a.Info,"Kick off first page optimization"),(nt=c.createElement("div")).id="FirstPageContainer",nt.style.top=n&&n.hideToolbar?"0":"90px",nt.style.left="0",nt.style.textAlign="center",nt.style.width="1px",nt.style.bottom="0",nt.style.zIndex="900",nt.style.height="1px",nt.style.position="absolute",nt.style.padding="0 29px",nt.style.right="0",nt.style.overflow="auto",nt.style.marginLeft="auto",nt.style.marginRight="auto",nt.style.maxWidth="100%",s.appendChild(nt);var f=c.createElement("img");f.id="FirstPageImage",f.style.marginTop="11px",f.style.marginBottom="11px",f.style.maxWidth="100%",f.style.border="solid 1px #d2d5d8",f.draggable=!1,f.onload=function(){t.logger.ULS.$e(577843780,a.a.Xt,u.a.Info,"First page optimization loaded"),nt.style.width="",nt.style.height="",ot=Object(x.a)()},f.onerror=function(e){ct(),t.logger.ULS.$e(577843781,a.a.Xt,u.a.Warning,"Cannot load first page from cache"),t.appInitDiagnostics.errorObject={errorType:"CannotLoadFirstPage",errorObject:"string"==typeof e?e:e.returnValue}},f.src=o.url.replace("{0}","p1.img"),nt.appendChild(f)}}}}}}}}function st(t){if(ct(),ot){t.container&&t.container.postMessage(F.a.Te,{HostCacheLoadTime:ot});var e=t.appInitDiagnostics;e.documentLoadedTime?ot<e.documentLoadedTime?(e.documentLoadedTime=ot,e.documentLoadedFromWopiPrecheckInfo=!0,t.logger.ULS.$e(577843782,a.a.Xt,u.a.Info,"First page loaded from cache was faster")):e.documentLoadedFromWopiPrecheckInfo=!1:e.documentLoadedTime=ot}}function ct(){nt&&nt.parentElement&&nt.parentElement.removeChild(nt)}function at(){return!0}i.d(e,"a",(function(){return ut}));var ut=function(t){return t&&(t.isFeatureEnabled(n.a.vi)||t.isFeatureEnabled(n.a.di))?[(e={},e[o.a.appReboot]=f,e[o.a.boot]=J,e[o.a.closeTab]=h,e[o.a.createNew]=z,e[o.a.dispose]=G,e[o.a.frameTrust]=K,e[o.a.getHostKeyValue]=Z.a,e[o.a.handleBootState]=$,e[o.a.postMessage]=h,e[o.a.rename]=X,e[o.a.setOverlayContent]=Q.a,e[o.a.storeHostKeyValue]=Y.a,e[o.a.switchMode]=tt,e),(i={},i[o.a.boot]={initializeAppContext:C,buildAppBasePath:U,ignoreCompletionMessage:et,buildBootRequestParams:it,beforeContainerBoot:rt,onBootSuccess:st},i[o.a.createNew]={parallelizeStartSessionRequest:at,buildStartSessionRequestParams:it},i)]:E();var e,i}},function(t,e,i){"use strict";i.r(e),i.d(e,"Application",(function(){return f})),i.d(e,"Viewer",(function(){return h})),i.d(e,"createApplication",(function(){return d}));var n=i(67),o=i(40),r=i(34),s=i(48),c=i(53),a=i(1);i.d(e,"ApplicationEvents",(function(){return a.a}));var u=i(6);i.d(e,"DocRebootSupportMode",(function(){return u.b})),i.d(e,"CommandIds",(function(){return u.a})),i.d(e,"EventIds",(function(){return u.c})),i.d(e,"createCancellationToken",(function(){return u.d}));var f=new o.a(r.b,{forceSingleStepBoot:!1}),h=new o.a(s.a,{forceSingleStepBoot:!0,useViewerInitializer:!0}),d=function(t){return new n.a(t,{name:"Word"},c.a)}},,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var n=i(45),o=i(3),r=i(4),s=i(66),c=i(21),a=i(65),u=i(64),f=i(12),h=i(35),d=i(63),l=i(52),p=i(13),v=function(){function t(t,e,i,v,m,b,w){var O,g=this;this.pendingReboot=!1,this.skipWopiValidation=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.oo={},this.onMessage=function(t){var e=t.MessageId,i=t.Values||{},n=g.oo[e];if(n&&n.length>0)g.ro(e,i);else{var s=h.a[e];if(s){var c=s.Ni,a=s.Wi,u=s.Mi;c?(g.logger.ULS.$e(574654543,o.a.Xt,r.a.Info,"Running flow: "+c),g.so[c](e,i,g,g.co[c]).catch((function(t){g.ao(c,t)}))):a?g.raiseEvent(a,i):u&&g.uo(u,i)}}},this.ao=function(t,e){g.logger.ULS.$e(596459925,o.a.Xt,r.a.Error,t+" flow error: "+Object(p.l)(e))},this.ro=function(t,e){return g.logger.ULS.$e(574654544,o.a.Xt,r.a.Info,"Dispatching action: "+t),g.oo[t].map((function(i){try{i(t,e)}catch(e){g.logger.ULS.$e(596444186,o.a.Xt,r.a.Error,t+" action handler error: "+Object(p.l)(e))}})),Promise.resolve({completion:"success"})},this.fo=function(){var t=!1;return"Word"===g.appInfo.name?t=g.featureManager.isFeatureEnabled(c.a.vi)||g.featureManager.isFeatureEnabled(c.a.di):"Excel"===g.appInfo.name&&(t=g.featureManager.isFeatureEnabled(c.a.ni)||g.featureManager.isFeatureEnabled(c.a.fi)),t},this.ho=function(t,e,i){g.fo()?g.container&&g.container.postMessage(t,i):g.so[f.a.postMessage](e,i,g,void 0)},this.uo=function(t,e){var i=function(e,i){g.ho(t.Hi,t.ki,i),n()},n=function(){g.removeActionHandler(t.ki,i)};(g.addActionHandler(t.ki,i),void 0!==t.Di)&&new l.a(t.Di).subscribe(n);g.raiseEvent(t.Wi,e)},this.state=n.a.Unknown;var j=Object(d.a)(),S=j[0],I=j[1];this.logger=Object(s.a)(),this.logger.ULS.$e(593506837,o.a.Xt,r.a.Info,JSON.stringify(I)),this.sessionId=S,this.hostSessionId=i.hostSessionId,this.host=t.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=t.user,this.bootstrapperUrl=t.bootstrapperUrl,this.ui=t.ui,this.viewMode=t.viewMode,this.application=v,this.appInfo=e,this.session=m,this.featureManager=Object(a.a)(t.host.capabilities&&t.host.capabilities.isFeatureEnabledCallback,this.logger),this.Bi=new u.a(e.name,this.logger),this.preloader=e.preloader,O=b(this.featureManager),this.so=O[0],this.co=O[1],this.do=w,this.Bi.addSettingsChangeListener(this.logger.settingsChangeHandler)}return Object.defineProperty(t.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!0,configurable:!0}),t.prototype.raiseEvent=function(t,e){this.logger.ULS.$e(574654541,o.a.Xt,r.a.Info,"Raising event: "+t);try{this.do(t,e)}catch(t){this.logger.ULS.$e(593506838,o.a.Xt,r.a.Error,"Event handler error: "+Object(p.l)(t))}},t.prototype.addActionHandler=function(t,e){this.oo[t]||(this.oo[t]=[]),this.oo[t].push(e)},t.prototype.removeActionHandler=function(t,e){var i=this.oo[t];if(i&&i.length>0){var n=i.indexOf(e);n>-1&&i.splice(n,1)}},t.prototype.run=function(t,e,i){var n=this,s=[],c=this.oo[t];if(c&&c.length>0)s.push(this.ro(t,e));else{var a=h.a[t];if(a){var u=a.Ni,f=a.xi;if(u){this.logger.ULS.$e(574654542,o.a.Xt,r.a.Info,"Running flow: "+u);var d=this.so[u](t,e,this,this.co[u],i).catch((function(t){return n.ao(u,t),{completion:"failure",error:t}}));s.push(d)}else f&&(this.ho(f,t,e),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.$e(593500189,o.a.Xt,r.a.Warning,"Unhandled command: "+t)}return Promise.race(s)},t.prototype.dispose=function(){if(this.Bi.dispose(),this.oo={},!this.pendingReboot){var t=this.application.sessions,e=t.indexOf(this.session);e>-1&&t.splice(e,1)}},t}()},function(t,e,i){"use strict";function n(t){return!(!(t&&t.source&&t.accessToken)||!t.expiry&&0!==t.expiry)}i.d(e,"a",(function(){return n}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function t(){this.lo=[]}return t.prototype.add=function(t){t&&this.lo.push(t)},t.prototype.remove=function(t){if(t){var e=this.lo.indexOf(t);e>-1&&this.lo.splice(e,1)}},t.prototype.removeAll=function(){this.lo=[]},t.prototype.dispatch=function(t,e){this.lo.forEach((function(i){try{i(t)}catch(t){e&&e(t)}}))},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(13),o=i(17);function r(){var t=new Uint8Array(31),e=function(t){var e={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){e.crypto=!0;try{return i.getRandomValues(t),e}catch(t){e.exceptions.push("crypto: "+Object(n.l)(t))}}e.perfNow=o.c;for(var r=0;r<t.length;r+=1){try{if(o.c){var s=Math.floor(100*window.performance.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(t){e.exceptions.push("Math.random: "+Object(n.l)(t))}t[r]=Math.floor(16*Math.random())}return e}(t),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=15&t[i];return i+=1,("x"===e?n:3&n|8).toString(16)})),e]}},function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var n=i(3),o=i(4),r=i(13),s=i(24),c=i(15),a=i(37),u=i(62),f=function(){function t(t,e){var i=this;this.po=0,this.vo=function(){if(i.mo){var t=new XMLHttpRequest;t.open("GET",i.mo),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(i.setSettingsOnIdle(t.response),i.po=0):(i.Ri.ULS.$e(592836771,n.a.Xt,o.a.Error,"Fetch settings error. Status: "+t.status+", curErrors: "+i.po),i.po+=1),!(i.po>7)){var e=i.getValue(s.a.ji,3e5);i.po>3&&(e+=(i.po-3+1)*(e/2)),i.bo=window.setTimeout(i.vo,e)}}}},this.wo=t,this.Oo="Prod"+t+"Settings",this.Ri=e,this.jo=new u.a,this.getCurrentSettings()}return t.prototype.initializePeriodicFetch=function(t,e){this.Oo=(Object(c.k)(t)?"FF":"Prod")+this.wo+"Settings",this.getCurrentSettings(),this.mo=t+c.c+"?app="+this.wo+"&usid="+e+"&build="+Object(a.a)(),this.bo||(this.bo=window.setTimeout(this.vo,3e4))},t.prototype.getValue=function(t,e){if(this.So||this.getCurrentSettings(),!this.So||!this.So.hasOwnProperty(t))return e;var i=this.So[t],n=typeof e;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return e},t.prototype.addSettingsChangeListener=function(t){this.jo.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.jo.remove(t)},t.prototype.dispose=function(){this.bo&&window.clearTimeout(this.bo),this.Io&&self.cancelIdleCallback(this.Io),this.bo=void 0,this.Io=void 0,this.So=void 0,this.jo.removeAll()},t.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(this.Oo);if(!t)return;var e=JSON.parse(t);this.updateCurrentSettings(e)}catch(t){this.Ri.ULS.$e(592836768,n.a.Xt,o.a.Warning,"Failed to get settings from localStorage: "+Object(r.l)(t))}},t.prototype.updateCurrentSettings=function(t){var e=this;return!!this.isValidSettings(t)&&(this.So=t,this.jo.dispatch({Bi:this},(function(t){e.Ri.ULS.$e(592836769,n.a.Xt,o.a.Error,"Settings listener error: "+Object(r.l)(t))})),!0)},t.prototype.isValidSettings=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(s.a.Si)&&!isNaN(t.timestamp))return!0;this.Ri.ULS.$e(592836770,n.a.Xt,o.a.Error,"Received invalid settings")}return!1},t.prototype.setSettingsOnIdle=function(t){var e=this;"requestIdleCallback"in window?(this.Io&&self.cancelIdleCallback(this.Io),this.Io=window.requestIdleCallback((function(){return e.setSettings(t)}),{timeout:1e4})):window.setTimeout((function(){return e.setSettings(t)}),0)},t.prototype.setSettings=function(t){if(this.updateCurrentSettings(t)&&window&&window.localStorage){var e=JSON.stringify(t);try{window.localStorage.setItem(this.Oo,e)}catch(t){this.Ri.ULS.$e(592836800,n.a.Xt,o.a.Warning,"Failed to set localStorage: "+Object(r.l)(t))}}},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return a}));var n=i(3),o=i(4),r=i(13),s=i(21);function c(t,e){return{isFeatureEnabled:function(i){return function(t,e,i){if(!e)return;try{return e(t)}catch(t){i&&i.ULS.$e(594883024,n.a.Xt,o.a.Error,"IsFeatureEnabled callback error: "+Object(r.l)(t))}return}(i,t,e)}}}function a(t,e){var i={};if(Object.keys(s.a).forEach((function(e){var n=t.isFeatureEnabled(s.a[e]);void 0!==n&&(i[s.a[e]]=n?"1":"0")})),e&&e.wdFlights)for(var n=0,o=e.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[s.a.ti]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}},function(t,e,i){"use strict";var n;!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(n||(n={}));var o=i(4);function r(t,e,i,n){var o=t.map((function(t){return function(t,e){var i={};i.G=t.tag,i.T=t.timestamp-e,i.M=t.message,i.C=t.category;var n=1e3*t.type+t.level;return i.D=n,i}(t,n)})),r=function(t,e,i,n){var o={};return o.T=t,o.L=e,o.S=i,o.I=n,o.V=1,o}(n,o,e,i);return JSON.stringify(r)}var s,c=i(17),a=i(37),u=function(){function t(t){var e=this;this.Co=3e4,this.yo=30,this.To=0,this._o=[],this.Ao=Object(c.a)(),this.Po="",this.Ro=0,this.flushOnClose=function(){e.Uo(!1,!1)},this.flush=function(){e.Eo()},this.Eo=function(){window.setTimeout((function(){return e.Uo(!0,!0)}),0)},this.Uo=function(t,i){var n=Object(c.b)();if(window.clearTimeout(e.Fo),e.Wo){if(e._o.length>0)e.To+=1,!function(t,e,i){if(""!==e)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(e,t);else{var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",e,i),n.send(t))}}(r(e._o.splice(0,t?e.yo:e._o.length),e.Po,e.To,e.Ao),e.Wo,i),e.Ao=Object(c.a)();t&&(e.Fo=window.setTimeout(e.Eo,e._o.length>e.yo?1e3:e.Co)),e.Ro+=Object(c.b)()-n}},t&&this.configure(t)}return t.prototype.getTimeSpentLogging=function(){return this.Ro},t.prototype.addLoggingTime=function(t){this.Ro+=t},t.prototype.configure=function(t){var e=this,i=Object(c.b)();if(t.uploadCadenceInMs&&(this.Co=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.yo=t.uploadTriggerSize),t.sessionId&&(this.Po=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Wo)throw new Error("Remote ULS endpoint is already set");this.Wo=t.remoteUlsEndpoint+"?usid="+this.Po+"&officeserverversion="+Object(a.a)(),this.Ao=Object(c.a)(),window.setTimeout((function(){return e.Uo(!0,!0)}),0)}this.Ro+=Object(c.b)()-i},t.prototype.handleTrace=function(t){var e=Object(c.b)();t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this._o.push(t),(this._o.length>this.yo||t.level===o.a.Error)&&this.Eo(),this.Ro+=Object(c.b)()-e},t}(),f=[];var h=i(24);i.d(e,"a",(function(){return d}));function d(t){var e=new u(t);function i(t,i,o,r){var s=Object(c.b)();if(!function(t){return 1===f[t]}(t)){var a={timestamp:Object(c.a)(),category:i,tag:t,level:o,type:n.Trace,message:r};e.addLoggingTime(Object(c.b)()-s),e.handleTrace(a)}}return{ULS:{$e:function(t,e,n,o){i(t,e,n,o)},shipAssertTag:function(t,e,n,r){n&&i(t,e,o.a.Error,r)},debugAssertTag:function(t,e,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose},configure:function(t){e.configure(t)},settingsChangeHandler:function(t){var i,n;i=t.Bi.getValue(h.a.gi,""),n=t.Bi.getValue(h.a.Oi,""),s&&n===s||(f=[],s=n,i&&i.split(",").forEach((function(t){var e=parseInt(t,10);e&&(f[e]=1)}))),e.configure({uploadCadenceInMs:t.Bi.getValue(h.a.Ii,6e4)})},getTimeSpentLogging:function(){return e.getTimeSpentLogging()}}}},function(t,e,i){"use strict";var n=i(60),o=i(45);var r=i(8),s=function(){function t(t,e,i,r,s,c){var a=this;!function(t){if(void 0===t)throw new TypeError("SessionInitParams");if(void 0===t.hostSessionId)throw new TypeError("HostSessionId")}(i);this.No=new n.a(t,e,i,r,this,c,(function(t,e){return s({type:t,data:e,session:a})})),this.No.state=o.a.Initialized}return Object.defineProperty(t.prototype,"id",{get:function(){return this.No.sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diagnostics",{get:function(){return this.No.diagnostics},enumerable:!0,configurable:!0}),t.prototype.run=function(t,e,i){return this.No.run(t,e,i)},t.prototype.boot=function(t,e){return this.No.run(r.a.boot,t,e)},t.prototype.dispose=function(t){return this.No.run(r.a.dispose,void 0,t)},t}(),c=i(88),a=i(37),u=i(62),f=i(19);i.d(e,"a",(function(){return h}));var h=function(){function t(t,e,i){var n=this;this.sessions=[],this.containers=[],this.xo=function(t){n.Mo.dispatch(t)},function(t){if(void 0===t)throw new TypeError("ApplicationInitParams");var e=t.host;if(void 0===e||void 0===e.storageHostName)throw new TypeError("HostInfo");var i=t.user;if(void 0===i||void 0===i.id)throw new TypeError("UserInfo")}(t),this.ko=t,this.Ho=e,this.Do=i,this.Mo=new u.a,Object(f.b)()}return Object.defineProperty(t.prototype,"name",{get:function(){return this.Ho.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return Object(a.a)()},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t){this.Mo.add(t)},t.prototype.removeEventListener=function(t){this.Mo.remove(t)},t.prototype.createContainer=function(t){var e="WacFrame_"+this.Ho.name+"_"+this.containers.length,i=new c.a(t,e);return this.containers.push(i),i},t.prototype.createSession=function(t){var e=new s(this.ko,this.Ho,t,this,this.xo,this.Do);return this.sessions.push(e),e},t.prototype.dispose=function(t){var e=this,i=this.sessions.map((function(e){return e.dispose(t).catch((function(t){}))}));return Promise.all(i).then((function(t){return e.Mo.removeAll(),e.sessions=[],e.containers=[],{completion:"success"}}))},t}()},,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return f})),i.d(e,"c",(function(){return h})),i.d(e,"b",(function(){return d})),i.d(e,"f",(function(){return l}));var n,o=i(3),r=i(4),s=i(13),c=i(19),a=i(15);!function(t){t.$i="access_token",t.Xi="access_token_ttl",t.Qi="bundleSrc",t.Yi="bundleStaleness",t.pn="DocID",t.vn="ETag",t.an="feature_status",t.en="fileExtension",t.tn="fileGetUrl",t.in="fileName",t.nn="fileSize",t.Bo="forceSLR",t.Vo="frameHeightPx",t.Jo="frameWidthtPx",t.Lo="highContrast",t.fn="highDpi",t.cn="host_diagnostics",t.dn="hostName",t.un="huictrls",t.rn="owner_id",t.sn="sc",t.hn="softBlockedBrowser",t.ln="templateUrl",t.zo="touchMode",t.on="user_id",t.qo="hfck",t.Go="hfcv",t.Ko="timeZoneId"}(n||(n={}));function u(t,e,i,n){var o=t.ownerDocument.createElement("iframe");return o.id=e,o.name=e,o.src="",o.title="Office on the web Frame",o.width="100%",o.height="100%",o.marginWidth="0",o.marginHeight="0",o.style.left="0",o.style.top="0",o.style.right="0",o.style.bottom="0",o.style.display="block",o.style.position="absolute",o.style.backgroundColor="transparent",o.style.border="none",o.frameBorder="0",o.setAttribute("allowfullscreen","true"),o.setAttribute("allowTransparency","true"),f(o,i),n&&o.addEventListener("load",n,{once:!0}),t.appendChild(o),o}function f(t,e){var i=Object(a.g)(e);t.setAttribute("allow","microphone "+i+"; camera "+i+";")}function h(t,e,i,n,o){var r=t.ownerDocument,s=r.createElement("form");for(var c in s.id=i,s.name=i,s.action=n,s.target=e,s.method="POST",o){var a=r.createElement("input");a.type="hidden",a.name=c,a.value=o[c],s.appendChild(a)}return t.appendChild(s),s}function d(t,e){Object(a.a)(e,n.Vo,String(t.offsetHeight)),Object(a.a)(e,n.Jo,String(t.offsetWidth)),Object(a.a)(e,n.zo,String(Object(c.g)())),Object(a.a)(e,n.Lo,String(Object(c.d)())),Object(a.a)(e,n.Bo,String(Object(c.h)()))}function l(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(e){return t&&t.ULS.$e(591525084,o.a.Xt,r.a.Info,"Trust check error: "+Object(s.l)(e)),!1}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return s}));var n=i(0),o=i(9);function r(t){var e=window.navigator;if(e&&e.virtualKeyboard&&void 0!==e.virtualKeyboard.overlaysContent&&window===top)return e.virtualKeyboard.overlaysContent=t}var s=function(t,e,i,s,c){return t!==n.a.Tt?Promise.reject("Wrong flow"):new Promise((function(t){r(e.overlayContent),i.container&&i.container.postMessage(o.a.Le,void 0),t({completion:"success"})}))}},function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return u}));var n=i(0),o=i(9),r=i(3),s=i(4),c=i(38);function a(t){return Object(c.b)(t.hostKey)}var u=function(t,e,i,c,u){return t!==n.a.st?Promise.reject("Wrong flow"):new Promise((function(t){var n=e.hostKey;i.logger.ULS.$e(574408915,r.a.Xt,s.a.Info,"getHostKeyValue "+n);var c=a(e);i.container&&c&&i.container.postMessage(o.a._e,{hostKey:n,hostValue:c}),t({completion:"success"})}))}},function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return a}));var n=i(0),o=i(3),r=i(4),s=i(38);function c(t){Object(s.d)(t.hostKey,t.hostValue,s.c)}var a=function(t,e,i,s,a){return t!==n.a.Rt?Promise.reject("Wrong flow"):new Promise((function(t){var n=e.hostKey,s=e.hostValue;i.logger.ULS.$e(574408914,o.a.Xt,r.a.Info,"storeHostKeyValue "+n+": "+s),c(e),t({completion:"success"})}))}},function(t,e,i){"use strict";function n(t,e,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),i)o.setRequestHeader(r,i[r]);o.send(e)}i.d(e,"a",(function(){return n}))},,,,,,,,function(t,e,i){"use strict";var n=i(3),o=i(4),r=i(15),s=i(0),c=i(13),a=i(17),u=i(9),f=function(){function t(t,e,i){var a=this;this.Dn="",this.Bn="",this.Jn=!1,this.Ln=!1,this.Vn=!1,this.Zo=function(t){var e=!1,i=!0,f="",h=!1;if(a.$o&&(e=!0,i=t.source===a.$o),t.origin&&(h=(f=Object(r.f)(t.origin,2).toLowerCase())===a.Bn),!a.Jn&&(!a.Ln||h&&i)||a.Ri.ULS.$e(593232850,n.a.Xt,o.a.Info,"Window: available["+e+"] valid["+i+"]; Origin: valid["+h+"] expected["+a.Bn+"] actual["+f+"]"),h&&(!a.Vn||i)){var d;try{d=JSON.parse(t.data)}catch(t){return void a.Ri.ULS.$e(593232851,n.a.Xt,o.a.Info,"Failed to parse event data: "+Object(c.l)(t))}var l=d.MessageId;if(l)if(a.Ri.ULS.$e(593232854,n.a.Xt,o.a.Info,"Received message: "+l+", correlation: "+d.CorrelationId),l!==s.a.A&&l!==s.a.at||a.setTargetOrigin(t.origin),d.Values&&d.Values.ackExpected&&a.postMessage(u.a.me,void 0,d.CorrelationId),a.Xo)try{a.Xo(d)}catch(t){a.Ri.ULS.$e(594556386,n.a.Xt,o.a.Error,"Message handler error: "+Object(c.l)(t))}else a.Ri.ULS.$e(591933923,n.a.Xt,o.a.Error,"No message handler");else(a.Jn||a.Ln)&&a.Ri.ULS.$e(593232853,n.a.Xt,o.a.Info,"Missing message id")}},this.Ri=e,this.setTargetOrigin(t),i&&this.setMessageHandler(i),window.addEventListener("message",this.Zo,!1)}return t.prototype.setTargetOrigin=function(t){var e=Object(r.g)(t).toLowerCase();this.Dn&&this.Dn!==e&&this.Ri.ULS.$e(593232847,n.a.Xt,o.a.Warning,"Updating origin: ["+this.Dn.substring(8)+"]->["+e.substring(8)+"]"),this.Dn=e,this.Bn=Object(r.f)(e,2),this.Jn=Object(r.k)(e),this.Ln=Object(r.l)(e)},t.prototype.setTargetWindow=function(t,e){this.$o=t,this.Vn=!!e},t.prototype.setMessageHandler=function(t){this.Xo=t},t.prototype.removeMessageHandler=function(){this.Xo=void 0},t.prototype.postMessage=function(t,e,i){if(this.$o){this.Ri.ULS.$e(593232849,n.a.Xt,o.a.Info,"Sending message: "+t);var r={MessageId:t,SendTime:Object(a.a)(),CorrelationId:i,Values:e};this.$o.postMessage(JSON.stringify(r),this.Dn)}else this.Ri.ULS.$e(593232848,n.a.Xt,o.a.Info,"Missing target to send message")},t.prototype.dispose=function(){window.removeEventListener("message",this.Zo,!1),this.Xo=void 0},t}();var h=i(76);i.d(e,"a",(function(){return d}));var d=function(){function t(t,e){var i=this;this.Qo=null,this.Yo=function(t){var e=t.target;i.Qo=e.contentWindow,i.Qo?i.tr.setTargetWindow(i.Qo):i.Ri.ULS.$e(592524689,n.a.Xt,o.a.Error,"Content window not available")},function(t){if(void 0===t||void 0===t.appendChild)throw TypeError("Container")}(t),this.er=t,this.ir=e,this.nr=e+"_Form",this.or=Object(h.f)()}return Object.defineProperty(t.prototype,"element",{get:function(){return this.er},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameId",{get:function(){return this.ir},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formId",{get:function(){return this.nr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTopFrameTrusted",{get:function(){return this.or},enumerable:!0,configurable:!0}),t.prototype.boot=function(t,e,i){this.Ri=i,this.tr=new f(t,i,this.Xo),this.rr&&this.Qo?(Object(h.e)(this.rr,t),this.tr.setTargetWindow(this.Qo),this.Ri.ULS.$e(588793045,n.a.Xt,o.a.Info,"Reuse iframe and content window")):(this.rr=Object(h.d)(this.er,this.ir,t,this.Yo),this.Ri.ULS.$e(588793046,n.a.Xt,o.a.Info,"Wac frame created")),Object(h.b)(this.rr,e),this.sr=Object(h.c)(this.er,this.ir,this.nr,t,e),this.sr.submit()},t.prototype.setMessageHandler=function(t){this.Xo=t,this.tr&&this.tr.setMessageHandler(t)},t.prototype.removeMessageHandler=function(){this.Xo=void 0,this.tr&&this.tr.removeMessageHandler()},t.prototype.postMessage=function(t,e){this.tr&&this.tr.postMessage(t,e)},t.prototype.dispose=function(t,e){var i=this;return new Promise((function(n){if(i.sr&&(i.er.removeChild(i.sr),i.sr=void 0),i.tr&&(i.tr.dispose(),i.tr=void 0,i.Xo=void 0),i.Ri=void 0,i.rr&&!t){var o=function(){i.er.removeChild(i.rr),i.rr=void 0,n()};e?o():(i.rr.src="about:blank",window.setTimeout(o,0))}else n()}))},t}()}]);

