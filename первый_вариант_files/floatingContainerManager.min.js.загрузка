var floatingContainerManager=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[12],{1481:function(t,n,e){"use strict";e.r(n);var i,o,r,a=e(30),s=e(1);function c(t){switch(t){case 0:default:return a.b.CommentThread}}!function(t){t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(i||(i={})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(o||(o={})),function(t){t[t.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(r||(r={}));var d=function(){function t(t,n,e){void 0===e&&(e=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.shouldUpdatePositions=!1,this.aggregateHeight=0,this.possibleTopForNextContainer=0,this.renderMode=a.e.Integrated,this.constructContainerId=t,this.ulsLogger=n,this.activeContainerAnchorLeft=e}return t.prototype.getAggregateHeight=function(){return this.aggregateHeight},t.prototype.calculateNewPositions=function(t,n,e){this.disableRepositioningAnimation=!!e&&!!e.disableRepositioningAnimation,this.positionFixed=!!e&&!!e.positionFixed,this.shouldUpdatePositions=!e||!1!==e.shouldUpdatePositions;var i=t[0];if(this.anchorLeft=i&&i.anchorLeft?i.anchorLeft:0,e&&e.activeContainerInfo){var o=e.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(t,n,o)}else{var r=e?e.topOfFirstContainer:void 0;this.setRestPositionOfContainers(t,n,r)}},t.prototype.updateContainersPositions=function(t,n,e){this.calculateNewPositions(t,n,e)},t.prototype.updateContainerPositionsAroundActiveContainer=function(t,n,e){var r=n[e.containerId];if(r){var a=r.floatingContainerRef,c=this.shouldUpdatePositions&&a?a.height():r.position.height;this.shouldUpdatePositions&&a&&(a.anchorPoint().y!==r.anchorTop||a.anchorPoint().x!==this.activeContainerAnchorLeft)&&a.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:r.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,e.containerId,Object(s.__assign)(Object(s.__assign)({},r.position),{x:this.activeContainerAnchorLeft,y:r.anchorTop})),this.updateContainerPositionsAboveActiveContainer(t,n,r.anchorTop,e.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(r,r.anchorTop,c),this.updateContainerPositionsDownwards(t,n,e.containerPositionIndex+1),this.aggregateHeight=e.containerPositionIndex===t.length-1?c+r.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,i.msoulscat_Wac_Telemetry,o.Error,"Floating container info does not exist for the active container Id: "+e.containerId)},t.prototype.updateContainerPositionsDownwards=function(t,n,e,i){void 0===e&&(e=0),void 0===i&&(i=!1);for(var o={},r=e;r<t.length;r+=1){if((a=t[r])&&a.contentId){if(!(s=this.getFloatingContainerInfo(a,n)))continue;o[a.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}}for(r=e;r<t.length;r+=1){var a,s=this.getFloatingContainerInfo(t[r],n),c=(a=t[r])&&a.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(t[r],n,o[c]);if(r===t.length-1&&s&&(this.aggregateHeight=o[c]+s.position.y),i&&d)return}},t.prototype.updateContainerPositionsAboveActiveContainer=function(t,n,e,i){var o=t[0]?t[0].anchorTop:void 0;this.setRestPositionOfContainers(t.slice(0,i+1),n,o);for(var r=e,a=i;a>=0;a-=1){var c=this.getFloatingContainerInfo(t[a],n);if(void 0===c||this.getBottomPositionOfContainer(c)<=r)return;var d=c.floatingContainerRef,u=r-(this.shouldUpdatePositions&&d?d.height():c.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:u},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,this.getContainerId(t[a]),Object(s.__assign)(Object(s.__assign)({},c.position),{x:this.anchorLeft,y:u})),r=u}},t.prototype.setRestPositionOfContainers=function(t,n,e){var i;if(t.length>0){var o=this.getFloatingContainerInfo(t[0],n);if(void 0===o)return;var r=null===(i=o.floatingContainerRef)||void 0===i?void 0:i.anchorPoint().y,a=this.shouldUpdatePositions&&void 0!==r&&!this.positionFixed?r:o.position.y;this.possibleTopForNextContainer=null!=e?e:Math.max(o.anchorTop,a),this.updateContainerPositionsDownwards(t,n,0)}},t.prototype.getFloatingContainerInfo=function(t,n){return n[this.getContainerId(t)]},t.prototype.getContainerId=function(t){var n=t.contentId;return this.constructContainerId({contentId:n,contentType:c(t.containerContentType),renderMode:this.renderMode})},t.prototype.updateFloatingContainerPosition=function(t,n,e){var i=this.getFloatingContainerInfo(t,n);if(void 0===i)return!1;var o=this.shouldUpdatePositions&&i.floatingContainerRef?i.floatingContainerRef.anchorPoint().y:i.position.y,r=Math.max(this.possibleTopForNextContainer,i.anchorTop);return r!==o&&(this.shouldUpdatePositions&&i.floatingContainerRef&&i.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:r},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,this.getContainerId(t),Object(s.__assign)(Object(s.__assign)({},i.position),{x:this.anchorLeft,y:r}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(i,r,e),r===o},t.prototype.getBottomPositionOfContainer=function(t,n,e){void 0===n&&(n=void 0),void 0===e&&(e=void 0);var i,o,r=t.floatingContainerRef,a=null==r?void 0:r.anchorPoint().y;return this.shouldUpdatePositions&&r&&void 0!==a?(i=a,o=r.height()):(i=t.position.y,o=t.position.height),(void 0!==n?n:i)+(void 0!==e?e:o)+10},t.prototype.updateFloatingContainerPositionInCache=function(t,n,e){t[n].position=e},t}(),u=e(1054),p=function(){function t(t){this.eventSink=t}return t.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},t}(),h=function(){function t(){this.handlers=[]}return t.prototype.subscribe=function(t){var n=new p(this);return this.handlers.push({subscription:n,handler:t}),n},t.prototype.unsubscribe=function(t){this.handlers=this.handlers.filter((function(n){return n.subscription!==t}))},t.prototype.trigger=function(t){this.handlers.forEach((function(n){return n.handler(t,n.subscription)}))},t}(),l=function(){function t(t){this.onContainerShouldBeCreated=new h,this.motionDuration=u.a.duration4,this.posUpdateAnimationsInProgress=!1,this.containerVirtualizationEnabled=!1,t&&(this.containerVirtualizationEnabled=!!t.containerVirtualizationEnabled)}return t.prototype.updateContainersVisibility=function(t,n,e,i,o){var r=this;if(void 0===e&&(e=!1),void 0===o&&(o=!1),n.height>0){var a={viewportTop:n.y-n.height/2,viewportBottom:n.y+1.5*n.height,containerIdToInfoMap:t,activeContainerId:i};if(!o&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(e,a);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(a),setTimeout((function(){r.updatePositions(a,e),window.clearTimeout(r.hideContainersTimeout),r.hideContainersTimeout=window.setTimeout((function(){r.hideContainersOutsideViewport(a),r.posUpdateAnimationsInProgress=!1}),parseInt(r.motionDuration,10))}),0)}},t.prototype.handleContainerVirtualization=function(t,n){var e=this;Object.keys(n.containerIdToInfoMap).forEach((function(i){var o=e.extractContainerInfo(i,n);e.updateContainerVisibility(o,n.activeContainerId===i),e.updateContainerPosition(o,t)}))},t.prototype.showContainersComingIntoViewport=function(t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(e){var i=n.extractContainerInfo(e,t);n.updateContainerVisibility(i,t.activeContainerId===e)}))},t.prototype.hideContainersOutsideViewport=function(t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(e){var i=n.extractContainerInfo(e,t);n.updateContainerVisibility(i,t.activeContainerId===e)}))},t.prototype.updatePositions=function(t,n){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(i){var o=e.extractContainerInfo(i,t);e.updateContainerPosition(o,n)}))},t.prototype.updateContainerVisibility=function(t,n){t.containerRef&&t.containerElement&&(t.isContainerInViewport||n?"block"!==t.containerElement.style.display&&(t.containerElement.style.display="block",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!1),n&&t.containerRef.setFocus()):!1===t.isContainerInViewport&&"none"!==t.containerElement.style.display&&(t.containerElement.style.display="none",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!0)))},t.prototype.updateContainerPosition=function(t,n){var e=t.containerElement;e&&(e.style.top=t.containerPosition.y+"px",e.style.left=t.containerPosition.x+"px",e.style.transitionDuration=n?"0ms":this.motionDuration)},t.prototype.extractContainerInfo=function(t,n){var e,i=n.containerIdToInfoMap[t],o=i.floatingContainerRef,r=i.position,a={containerElement:void 0,isContainerInViewport:r.y+r.height>=n.viewportTop&&r.y<=n.viewportBottom,containerRef:void 0,containerPosition:r};return o&&(a.containerRef=o,a.containerElement=null===(e=document.getElementById(o.parentDivId()))||void 0===e?void 0:e.firstChild),a},t}(),f=e(3),C=e(143),g=e(290),v=e(0),m=e.n(v),y=e(56),I=(e(106),m.a.createContext(null));var b=function(t){t()},T={notify:function(){}};function P(){var t=b,n=null,e=null;return{clear:function(){n=null,e=null},notify:function(){t((function(){for(var t=n;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],e=n;e;)t.push(e),e=e.next;return t},subscribe:function(t){var i=!0,o=e={callback:t,next:null,prev:e};return o.prev?o.prev.next=o:n=o,function(){i&&null!==n&&(i=!1,o.next?o.next.prev=o.prev:e=o.prev,o.prev?o.prev.next=o.next:n=o.next)}}}}var E=function(){function t(t,n){this.store=t,this.parentSub=n,this.unsubscribe=null,this.listeners=T,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var n=t.prototype;return n.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},n.notifyNestedSubs=function(){this.listeners.notify()},n.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},n.isSubscribed=function(){return Boolean(this.unsubscribe)},n.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=P())},n.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=T)},t}();var O=function(t){var n=t.store,e=t.context,i=t.children,o=Object(v.useMemo)((function(){var t=new E(n);return t.onStateChange=t.notifyNestedSubs,{store:n,subscription:t}}),[n]),r=Object(v.useMemo)((function(){return n.getState()}),[n]);Object(v.useEffect)((function(){var t=o.subscription;return t.trySubscribe(),r!==n.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[o,r]);var a=e||I;return m.a.createElement(a.Provider,{value:o},i)},R=e(98),A=e(126),S=e(261),x=e.n(S),w=e(311),_="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?v.useLayoutEffect:v.useEffect,F=[],D=[null,null];function M(t,n){var e=t[1];return[n.payload,e+1]}function V(t,n,e){_((function(){return t.apply(void 0,n)}),e)}function U(t,n,e,i,o,r,a){t.current=i,n.current=o,e.current=!1,r.current&&(r.current=null,a())}function j(t,n,e,i,o,r,a,s,c,d){if(t){var u=!1,p=null,h=function(){if(!u){var t,e,h=n.getState();try{t=i(h,o.current)}catch(t){e=t,p=t}e||(p=null),t===r.current?a.current||c():(r.current=t,s.current=t,a.current=!0,d({type:"STORE_UPDATED",payload:{error:e}}))}};e.onStateChange=h,e.trySubscribe(),h();return function(){if(u=!0,e.tryUnsubscribe(),e.onStateChange=null,p)throw p}}}var z=function(){return[null,0]};function N(t,n){void 0===n&&(n={});var e=n,i=e.getDisplayName,o=void 0===i?function(t){return"ConnectAdvanced("+t+")"}:i,r=e.methodName,a=void 0===r?"connectAdvanced":r,s=e.renderCountProp,c=void 0===s?void 0:s,d=e.shouldHandleStateChanges,u=void 0===d||d,p=e.storeKey,h=void 0===p?"store":p,l=(e.withRef,e.forwardRef),f=void 0!==l&&l,C=e.context,g=void 0===C?I:C,y=Object(A.a)(e,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),b=g;return function(n){var e=n.displayName||n.name||"Component",i=o(e),r=Object(R.a)({},y,{getDisplayName:o,methodName:a,renderCountProp:c,shouldHandleStateChanges:u,storeKey:h,displayName:i,wrappedComponentName:e,WrappedComponent:n}),s=y.pure;var d=s?v.useMemo:function(t){return t()};function p(e){var i=Object(v.useMemo)((function(){var t=e.reactReduxForwardedRef,n=Object(A.a)(e,["reactReduxForwardedRef"]);return[e.context,t,n]}),[e]),o=i[0],a=i[1],s=i[2],c=Object(v.useMemo)((function(){return o&&o.Consumer&&Object(w.isContextConsumer)(m.a.createElement(o.Consumer,null))?o:b}),[o,b]),p=Object(v.useContext)(c),h=Boolean(e.store)&&Boolean(e.store.getState)&&Boolean(e.store.dispatch);Boolean(p)&&Boolean(p.store);var l=h?e.store:p.store,f=Object(v.useMemo)((function(){return function(n){return t(n.dispatch,r)}(l)}),[l]),C=Object(v.useMemo)((function(){if(!u)return D;var t=new E(l,h?null:p.subscription),n=t.notifyNestedSubs.bind(t);return[t,n]}),[l,h,p]),g=C[0],y=C[1],I=Object(v.useMemo)((function(){return h?p:Object(R.a)({},p,{subscription:g})}),[h,p,g]),T=Object(v.useReducer)(M,F,z),P=T[0][0],O=T[1];if(P&&P.error)throw P.error;var S=Object(v.useRef)(),x=Object(v.useRef)(s),_=Object(v.useRef)(),N=Object(v.useRef)(!1),L=d((function(){return _.current&&s===x.current?_.current:f(l.getState(),s)}),[l,P,s]);V(U,[x,S,N,s,L,_,y]),V(j,[u,l,g,f,x,S,N,_,y,O],[l,g,f]);var W=Object(v.useMemo)((function(){return m.a.createElement(n,Object(R.a)({},L,{ref:a}))}),[a,n,L]);return Object(v.useMemo)((function(){return u?m.a.createElement(c.Provider,{value:I},W):W}),[c,W,I])}var l=s?m.a.memo(p):p;if(l.WrappedComponent=n,l.displayName=i,f){var C=m.a.forwardRef((function(t,n){return m.a.createElement(l,Object(R.a)({},t,{reactReduxForwardedRef:n}))}));return C.displayName=i,C.WrappedComponent=n,x()(C,n)}return x()(l,n)}}function L(t,n){return t===n?0!==t||0!==n||1/t==1/n:t!=t&&n!=n}function W(t,n){if(L(t,n))return!0;if("object"!=typeof t||null===t||"object"!=typeof n||null===n)return!1;var e=Object.keys(t),i=Object.keys(n);if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!Object.prototype.hasOwnProperty.call(n,e[o])||!L(t[e[o]],n[e[o]]))return!1;return!0}var k=e(132);function B(t){return function(n,e){var i=t(n,e);function o(){return i}return o.dependsOnOwnProps=!1,o}}function H(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function q(t,n){return function(n,e){e.displayName;var i=function(t,n){return i.dependsOnOwnProps?i.mapToProps(t,n):i.mapToProps(t)};return i.dependsOnOwnProps=!0,i.mapToProps=function(n,e){i.mapToProps=t,i.dependsOnOwnProps=H(t);var o=i(n,e);return"function"==typeof o&&(i.mapToProps=o,i.dependsOnOwnProps=H(o),o=i(n,e)),o},i}}var Q=[function(t){return"function"==typeof t?q(t):void 0},function(t){return t?void 0:B((function(t){return{dispatch:t}}))},function(t){return t&&"object"==typeof t?B((function(n){return Object(k.bindActionCreators)(t,n)})):void 0}];var G=[function(t){return"function"==typeof t?q(t):void 0},function(t){return t?void 0:B((function(){return{}}))}];function J(t,n,e){return Object(R.a)({},e,t,n)}var K=[function(t){return"function"==typeof t?function(t){return function(n,e){e.displayName;var i,o=e.pure,r=e.areMergedPropsEqual,a=!1;return function(n,e,s){var c=t(n,e,s);return a?o&&r(c,i)||(i=c):(a=!0,i=c),i}}}(t):void 0},function(t){return t?void 0:function(){return J}}];function Y(t,n,e,i){return function(o,r){return e(t(o,r),n(i,r),r)}}function X(t,n,e,i,o){var r,a,s,c,d,u=o.areStatesEqual,p=o.areOwnPropsEqual,h=o.areStatePropsEqual,l=!1;function f(o,l){var f,C,g=!p(l,a),v=!u(o,r);return r=o,a=l,g&&v?(s=t(r,a),n.dependsOnOwnProps&&(c=n(i,a)),d=e(s,c,a)):g?(t.dependsOnOwnProps&&(s=t(r,a)),n.dependsOnOwnProps&&(c=n(i,a)),d=e(s,c,a)):v?(f=t(r,a),C=!h(f,s),s=f,C&&(d=e(s,c,a)),d):d}return function(o,u){return l?f(o,u):(s=t(r=o,a=u),c=n(i,a),d=e(s,c,a),l=!0,d)}}function Z(t,n){var e=n.initMapStateToProps,i=n.initMapDispatchToProps,o=n.initMergeProps,r=Object(A.a)(n,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=e(t,r),s=i(t,r),c=o(t,r);return(r.pure?X:Y)(a,s,c,t,r)}function $(t,n,e){for(var i=n.length-1;i>=0;i--){var o=n[i](t);if(o)return o}return function(n,i){throw new Error("Invalid value of type "+typeof t+" for "+e+" argument when connecting component "+i.wrappedComponentName+".")}}function tt(t,n){return t===n}function nt(t){var n=void 0===t?{}:t,e=n.connectHOC,i=void 0===e?N:e,o=n.mapStateToPropsFactories,r=void 0===o?G:o,a=n.mapDispatchToPropsFactories,s=void 0===a?Q:a,c=n.mergePropsFactories,d=void 0===c?K:c,u=n.selectorFactory,p=void 0===u?Z:u;return function(t,n,e,o){void 0===o&&(o={});var a=o,c=a.pure,u=void 0===c||c,h=a.areStatesEqual,l=void 0===h?tt:h,f=a.areOwnPropsEqual,C=void 0===f?W:f,g=a.areStatePropsEqual,v=void 0===g?W:g,m=a.areMergedPropsEqual,y=void 0===m?W:m,I=Object(A.a)(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),b=$(t,r,"mapStateToProps"),T=$(n,s,"mapDispatchToProps"),P=$(e,d,"mergeProps");return i(p,Object(R.a)({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:b,initMapDispatchToProps:T,initMergeProps:P,pure:u,areStatesEqual:l,areOwnPropsEqual:C,areStatePropsEqual:v,areMergedPropsEqual:y},I))}}var et=nt();var it,ot,rt;function at(t,n){return{type:t,payload:n}}it=y.unstable_batchedUpdates,b=it,function(t){t[t.Enablement=0]="Enablement",t[t.Focus=1]="Focus",t[t.Hover=2]="Hover",t[t.Resize=3]="Resize",t[t.Visibility=4]="Visibility"}(ot||(ot={})),function(t){t.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",t.EmptyActionType="",t.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",t.RepositionType="REPOSITION_FLOATING_CONTAINER",t.SetContentType="SET_CONTENT",t.UpdateContainerDirectionType="UPDATE_FLOATING_CONTAINER_DIRECTION",t.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION",t.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",t.UpdateContainerWidthType="UPDATE_FLOATING_CONTAINER_WIDTH",t.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",t.UpdateContentSetItemDetailsType="UPDATE_CONTENT_SET_ITEM_DETAILS"}(rt||(rt={}));var st={anchorPoint:{x:0,y:0},isAnchorPointOnRight:!1};function ct(t,n){var e;return void 0===n&&(n=st),{anchorPoint:n.anchorPoint,contentIdentifier:t,disableRepositioningAnimation:!1,horizontalOffset:0,isAnchorPointOnRight:n.isAnchorPointOnRight,isVisible:!1,isVirtualized:!1,maxDimensions:n.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1,accessibilityMetadata:null!==(e=n.accessibilityMetadata)&&void 0!==e?e:{}}}var dt={contentId:"",contentType:a.b.Empty};function ut(t,n){switch(void 0===t&&(t=ct(dt)),void 0===n&&(n=at(rt.EmptyActionType,{})),n.type){case rt.ChangeRenderedContentIdentifierType:return function(t,n){if(t.contentIdentifier.contentId===n.payload.newContentIdentifier.contentId&&t.contentIdentifier.contentType===n.payload.newContentIdentifier.contentType)return t;return Object(s.__assign)(Object(s.__assign)({},t),{contentIdentifier:n.payload.newContentIdentifier})}(t,n);case rt.RemoveVisibilityAnimationType:return function(t){return Object(s.__assign)(Object(s.__assign)({},t),{useVisibilityAnimation:!1})}(t);case rt.RepositionType:return function(t,n){if(t.anchorPoint.x===n.payload.anchorPoint.x&&t.anchorPoint.y===n.payload.anchorPoint.y&&t.disableRepositioningAnimation===n.payload.disableRepositioningAnimation&&t.positionFixed===n.payload.positionFixed&&t.isAnchorPointOnRight===n.payload.isAnchorPointOnRight)return t;return Object(s.__assign)(Object(s.__assign)({},t),{anchorPoint:n.payload.anchorPoint,disableRepositioningAnimation:n.payload.disableRepositioningAnimation,positionFixed:n.payload.positionFixed,isAnchorPointOnRight:n.payload.isAnchorPointOnRight})}(t,n);case rt.SetContentType:return function(t,n){return Object(s.__assign)(Object(s.__assign)({},t),{content:n.payload.content,isVisible:!!n.payload.content&&t.isVisible})}(t,n);case rt.UpdateContainerDirectionType:return function(t,n){return Object(s.__assign)(Object(s.__assign)({},t),{isAnchorPointOnRight:n.payload.isAnchorPointOnRight,horizontalOffset:n.payload.isAnchorPointOnRight?n.payload.currentWidth:0})}(t,n);case rt.UpdateContainerWidthType:return function(t,n){return Object(s.__assign)(Object(s.__assign)({},t),{horizontalOffset:t.isAnchorPointOnRight?n.payload.width:0})}(t,n);case rt.UpdateContentMaxDimensionsType:return function(t,n){if(t.maxDimensions.height===n.payload.maxDimensions.height&&t.maxDimensions.width===n.payload.maxDimensions.width)return t;return Object(s.__assign)(Object(s.__assign)({},t),{maxDimensions:n.payload.maxDimensions})}(t,n);case rt.UpdateContentSetItemDetailsType:return function(t,n){var e,i=null===(e=t.accessibilityMetadata)||void 0===e?void 0:e.setItem,o=n.payload.setItemDetails;if(i===o)return t;if(i&&o&&i.positionInSet===o.positionInSet&&i.setSize===o.setSize&&i.level===o.level)return t;return Object(s.__assign)(Object(s.__assign)({},t),{accessibilityMetadata:Object(s.__assign)(Object(s.__assign)({},t.accessibilityMetadata),{setItem:o})})}(t,n);case rt.UpdateContainerVisibilityType:return function(t,n){return Object(s.__assign)(Object(s.__assign)({},t),{isVisible:n.payload.isVisible,useVisibilityAnimation:n.payload.useVisibilityAnimation})}(t,n);case rt.UpdateContainerVirtualizationType:return function(t,n){return Object(s.__assign)(Object(s.__assign)({},t),{isVirtualized:n.payload.isVirtualized})}(t,n);default:return t}}function pt(t){return at(rt.SetContentType,{content:t})}var ht=function(t){return t.isVirtualized},lt=e(2),ft=e(8),Ct=Object(lt.bb)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),gt=Object(lt.bb)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),vt=Object(ft.c)((function(t,n,e,i){return{floatingContainerView:Object(lt.eb)({animationName:n?t?Ct:gt:void 0,animationDuration:"300ms",animationTimingFunction:u.b.decelerate,background:"transparent",position:i?"fixed":"absolute",transitionDuration:t&&!e?u.a.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:u.b.decelerate,visibility:t?"visible":"hidden"})}}));var mt=e(121),yt=e(882);function It(t){return"floatingContainerView"+t.contentId+"Type"+t.contentType}var bt=function(t){function n(n){var e=t.call(this,n)||this;return e.handleResizeUpdates=function(t){t.forEach((function(t){e.props.updateHorizontalOffset(t.contentRect.width),e.props.onContainerStateChanged.trigger({stateChangeType:ot.Resize,contentIdentifier:e.props.contentIdentifier,contentRect:t.contentRect})}))},e.triggerVisibilityUpdateNotification=function(){e.props.onContainerStateChanged.trigger({stateChangeType:ot.Visibility,contentIdentifier:e.props.contentIdentifier,isVisible:e.props.isVisible})},e.getHostedResource=function(t){return{id:t}},e.onFocusChange=function(t,n){var i=t.relatedTarget||document.activeElement;e.parentDivRef&&i instanceof HTMLElement&&e.parentDivRef.contains(i)||e.props.onContainerStateChanged.trigger({stateChangeType:ot.Focus,contentIdentifier:e.props.contentIdentifier,isFocused:n})},e.onFocusOut=function(t){e.onFocusChange(t,!1)},e.onFocusIn=function(t){e.onFocusChange(t,!0)},e.onMouseEnter=function(){e.props.onContainerStateChanged.trigger({stateChangeType:ot.Hover,contentIdentifier:e.props.contentIdentifier,isHovered:!0})},e.onMouseLeave=function(){e.props.onContainerStateChanged.trigger({stateChangeType:ot.Hover,contentIdentifier:e.props.contentIdentifier,isHovered:!1})},e.setContentRef=function(t){e.contentRef=t},e.setParentDivRef=function(t){t!==e.parentDivRef&&(e.parentDivRef&&(e.resizeObserver.unobserve(e.parentDivRef),e.parentDivRef.removeEventListener("focusin",e.onFocusIn,!0),e.parentDivRef.removeEventListener("focusout",e.onFocusOut,!0)),t&&(e.resizeObserver.observe(t),t.addEventListener("focusin",e.onFocusIn,!0),t.addEventListener("focusout",e.onFocusOut,!0))),e.parentDivRef=t},e.contentRef=void 0,e.parentDivRef=void 0,e.resizeObserver=new yt.a((function(t){window.requestAnimationFrame((function(){e.handleResizeUpdates(t)}))})),e.setContentRef=e.setContentRef.bind(e),e.setParentDivRef=e.setParentDivRef.bind(e),e.getHostedResource=Object(mt.h)(e.getHostedResource.bind(e)),e}return Object(s.__extends)(n,t),n.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},n.prototype.componentDidUpdate=function(t){var n=this,e=!1;t.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?e=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){e&&n.triggerVisibilityUpdateNotification(),n.props.removeVisibilityAnimation()}),300)},n.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},n.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},n.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},n.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var t=vt(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),n=this.props.content;return v.createElement("div",{key:It(this.props.contentIdentifier),id:It(this.props.contentIdentifier),ref:this.setParentDivRef,className:t.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x-this.props.horizontalOffset,top:this.props.anchorPoint.y}},v.createElement(n,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized,accessibilityMetadata:this.props.accessibilityMetadata}))},n}(v.Component);var Tt,Pt=et((function(t){return{accessibilityMetadata:t.accessibilityMetadata,anchorPoint:t.anchorPoint,content:t.content,contentIdentifier:t.contentIdentifier,disableRepositioningAnimation:t.disableRepositioningAnimation,horizontalOffset:t.horizontalOffset,isVisible:t.isVisible,isVirtualized:t.isVirtualized,maxDimensions:t.maxDimensions,positionFixed:t.positionFixed,useVisibilityAnimation:t.useVisibilityAnimation}}),(function(t,n){return{removeVisibilityAnimation:function(){t(at(rt.RemoveVisibilityAnimationType,{}))},updateHorizontalOffset:function(n){t(function(t){return at(rt.UpdateContainerWidthType,{width:t})}(n))}}}),void 0,{forwardRef:!0})(bt),Et=function(){function t(t,n,e,i){var o;this.onContainerStateChanged=new h,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===i.isDraftContainer&&(this.floatingContainerCreationActivity=Object(f.g)().createActivityObject("FloatingContainerCreation",Object(f.h)(f.f.GlobalAPI),f.a.None,f.b.NecessaryServiceDataEvent)),this.store=(o=ct(e,i))?Object(k.createStore)(ut,o):Object(k.createStore)(ut),this.extensionProvider=n,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=i.containerId||Object(C.a)(),t.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(e),this.render()}return t.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},t.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},t.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},t.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},t.prototype.isAnchorPointOnRight=function(){return this.store.getState().isAnchorPointOnRight},t.prototype.parentDivId=function(){return this.parentDiv.id},t.prototype.observeStore=function(t){var n=this;if(Object(a.h)(this.extensionProvider)){var e=t;this.unsubscribeStoreListener=this.store.subscribe((function(){var t=n.contentIdentifier();e.contentId===t.contentId&&e.contentType===t.contentType||(e=t,n.removeExtensionUpdatedEventSubscription(),n.setContentFromExtension())}))}},t.prototype.setContentFromExtension=function(){var t=this,n=void 0;if(Object(a.h)(this.extensionProvider)){if(n=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=n.onUpdated.subscribe((function(n){t.onUpdatedEventHandler()}))),n.priority===a.d.Disabled)return this.canShow=!1,void this.store.dispatch(pt(void 0))}else n=this.extensionProvider.getExtension();this.canShow=!0,Object(g.b)().getComponent(n.componentKey).then((function(n){t.store.dispatch(pt(n.component)),t.floatingContainerCreationActivity&&(t.floatingContainerCreationActivity.successTag(593872975),t.floatingContainerCreationActivity=void 0)})).catch((function(t){Object(f.g)().assertConditionTag(!1,"Error when registering component in setContentFromExtension "+t,595632583)}))},t.prototype.render=function(){var t={onContainerStateChanged:this.onContainerStateChanged};y.render(v.createElement(O,{store:this.store},v.createElement(Pt,Object(s.__assign)({ref:this.setFloatingContainerRef},t))),this.parentDiv)},t.prototype.updateContainerPosition=function(t){var n,e,i,o;this.store.dispatch((n=t.anchorPoint,e=!!t.disableRepositioningAnimation,i=!!t.positionFixed,o=!!t.isAnchorPointOnRight,at(rt.RepositionType,{anchorPoint:n,disableRepositioningAnimation:e,positionFixed:i,isAnchorPointOnRight:o})))},t.prototype.updateMaximumDimensions=function(t){this.store.dispatch(function(t){return at(rt.UpdateContentMaxDimensionsType,{maxDimensions:t})}(t))},t.prototype.updateSetItemDetails=function(t){this.store.dispatch(function(t){return at(rt.UpdateContentSetItemDetailsType,{setItemDetails:t})}(t))},t.prototype.updateContainerVirtualization=function(t){t&&!ht(this.store.getState())?this.store.dispatch(at(rt.UpdateContainerVirtualizationType,{isVirtualized:!0})):ht(this.store.getState())&&this.store.dispatch(at(rt.UpdateContainerVirtualizationType,{isVirtualized:!1}))},t.prototype.showFloatingContainer=function(t){return!!this.canShow&&(this.store.dispatch(function(t){return at(rt.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:t})}(!!t)),!0)},t.prototype.hideFloatingContainer=function(t){this.store.dispatch(function(t){return at(rt.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:t})}(!!t))},t.prototype.destroyFloatingContainer=function(t){var n=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(t),t?setTimeout((function(){n.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},t.prototype.cleanupDomOnDestroy=function(){y.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},t.prototype.isShowing=function(){return this.store.getState().isVisible},t.prototype.setFocus=function(){this.floatingContainerRef&&this.floatingContainerRef.setFocus()},t.prototype.changeRenderedContentIdentifier=function(t){this.store.dispatch(function(t){return at(rt.ChangeRenderedContentIdentifierType,{newContentIdentifier:t})}(t))},t.prototype.onUpdatedEventHandler=function(){var t=this.canShow;this.setContentFromExtension(),t!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:ot.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},t.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},t.prototype.setFloatingContainerRef=function(t){this.floatingContainerRef=null!=t?t:void 0},t}(),Ot=new(function(){function t(){}return t.prototype.createFloatingContainer=function(t,n,e,i){return new Et(t,n,e,i)},t}()),Rt=e(53);!function(t){t[t.DeselectionEnabled=0]="DeselectionEnabled",t[t.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",t[t.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",t[t.ShouldInitialize=3]="ShouldInitialize",t[t.ScrollingPerfImprovementEnabled=4]="ScrollingPerfImprovementEnabled",t[t.SynchronousContainerPositioningEnabled=5]="SynchronousContainerPositioningEnabled"}(Tt||(Tt={}));var At=e(55),St=e(221),xt=e(1040),wt=e(1495);function _t(t){return t.contentId+"_"+t.contentType+"_"+t.renderMode}var Ft={width:0,height:0,x:0,y:0};function Dt(t){return void 0!==t.hasBeenRendered}var Mt=function(){function t(t,n,e,i,o){var r=this;this.supportedContentTypes=[a.b.CommentThread],this.getContentCardIndex=function(t,n){if(!r.containerIdToInfoMap[t])return r.ULS.sendTraceTag(595883362,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[getContentCardIndex]Container with id "+t+" does not exist."),-1;var e=r.containerIdToInfoMap[t].anchorTop;e=n?Math.max(e,n):e;for(var i=r.getContentCardInsertionPoint(e),o=i;o<r.contentAnchorPositions.length;o+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(t,o))return o;for(o=0;o<i;o+=1)if(r.checkIfContainerIdCorrespondsToGivenPosition(t,o))return o;return-1},this.initializeExtensionProviderCollection=function(t){r.extensionProviderCollection=r.contentExtensionHostAPIGetter().getExtensions(r.supportedContentTypes,a.c),r.updateContentTypeToExtensionProviderMap(t),r.extensionProviderCollection.onUpdated.subscribe((function(){return r.updateContentTypeToExtensionProviderMap(t)}))},this.getContentCardInsertionPoint=function(t){for(var n,e=0,i=r.contentAnchorPositions.length;e<i;){n=e+Math.floor((i-e)/2),r.contentAnchorPositions[n].anchorTop<t-4?e=n+1:i=n}return e},this.getContainerStateChangedCallback=function(t){return function(n,e){switch(n.stateChangeType){case ot.Resize:t(n,e);break;case ot.Visibility:n.isVisible&&(Object(xt.c)(xt.b,{component:"canvas",subComponent:"comment:"+n.contentIdentifier.contentId,state:wt.b}),Object(xt.c)(xt.b,{component:"canvas",subComponent:"comment:"+n.contentIdentifier.contentId,state:wt.a}))}}},this.renderFloatingContainerAtAnchorPosition=function(t){var n=r.containerIdToInfoMap[t];n&&n.floatingContainerRef&&n.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=function(t){r.contentTypeToExtensionProviderMap.clear(),void 0!==r.extensionProviderCollection?(r.areCommentExtensionProvidersDefinedOnce||(r.areCommentExtensionProvidersDefinedOnce=0!==r.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===a.b.CommentThread&&t.scope.renderMode===a.e.Integrated})).length),r.extensionProviderCollection.providers.forEach((function(t){t.scope.renderMode===a.e.Integrated&&r.contentTypeToExtensionProviderMap.set(t.scope.contentType,t)})),t()):r.ULS.sendTraceTag(595886287,At.a.msoulscat_Wac_Telemetry,St.a.Error,"extensionProviderCollection should not be null")},this.contentExtensionHostAPIGetter=t,this.dhcContainerPanel=n,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=o||Ft,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=e,this.ULS=i,this.processedContainersVisibleAtBoot=!1}return t.prototype.addContentAnchorPosition=function(t,n,e){void 0===n&&(n=0),void 0===e&&(e=-1);var i=e>-1?e:this.getContentCardInsertionPoint(t.anchorTop)+n;return this.contentAnchorPositions.splice(i,0,t),i},t.prototype.getContainerIdToInfoMap=function(){return this.containerIdToInfoMap},t.prototype.getContentAnchorPositions=function(){return this.contentAnchorPositions},t.prototype.getContentAnchorPosition=function(t){var n=this.getContentCardIndex(t);if(n>-1)return this.contentAnchorPositions[n]},t.prototype.initializeAndRenderFloatingContainer=function(t,n,e,i,o){void 0===i&&(i=!0),void 0===o&&(o=!1);var r;return r=this.initializeFloatingContainerState(t,e,i,o),o&&this.renderFloatingContainerAtAnchorPosition(n),r},t.prototype.isContainerInViewPort=function(t){return t.anchorTop>this.viewportInfo.y-.5*this.viewportInfo.height&&t.anchorTop<this.viewportInfo.y+1.5*this.viewportInfo.height},t.prototype.removeContentAnchorPosition=function(t){var n=this.getContentCardIndex(t);return-1===n?(this.ULS.sendTraceTag(595736577,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[RemoveContentAnchorPosition]Content anchor position for id "+t+" does not exist."),-1):(this.contentAnchorPositions.splice(n,1),n)},t.prototype.checkIfContainerIdCorrespondsToGivenPosition=function(t,n){return t===this.getContainerIdUsingPositionalIndex(n)},t.prototype.getContainerIdUsingPositionalIndex=function(t){var n=this.contentAnchorPositions[t];return _t({contentId:n.contentId,contentType:c(n.containerContentType),renderMode:a.e.Integrated})},t.prototype.createFloatingContainer=function(t,n,e,i){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,t,{contentId:n.contentId,contentType:c(n.containerContentType)},{anchorPoint:{x:0,y:e},isAnchorPointOnRight:!1,isDraftContainer:i});this.ULS.sendTraceTag(595883361,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")},t.prototype.initializeFloatingContainerState=function(t,n,e,i){if(t){var o=this.contentTypeToExtensionProviderMap.get(c(t.containerContentType));if(void 0===o)return this.ULS.sendTraceTag(595883363,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[initializeFCState]ExtensionProvider not found for contentType "+t.containerContentType),!1;var r=t.contentId;if(!r)return this.ULS.sendTraceTag(595883407,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[initializeFCState]ContentId is null or empty."),!1;var d=_t({contentId:r,contentType:c(t.containerContentType),renderMode:a.e.Integrated}),u=void 0;if(e){if(!(u=this.createFloatingContainer(o,{contentId:r,containerContentType:t.containerContentType},t.anchorTop,i)))return this.ULS.sendTraceTag(595886286,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[createFloatingContainer] Could not create fc for content id "+r),!1;u.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(n))}if(this.containerIdToInfoMap[d])this.containerIdToInfoMap[d].floatingContainerRef=u;else{var p=Object(s.__assign)(Object(s.__assign)({position:{height:0,width:0,x:0,y:t.anchorTop}},this.containerIdToInfoMap[d]),{anchorTop:t.anchorTop,floatingContainerRef:u,hasBeenRendered:!1});this.containerIdToInfoMap[d]=p}return!0}return!1},t}(),Vt=function(){function t(t,n,e,i,o,r){var s=this;this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.timeoutsToCreateContainer={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.emitEvent=function(t,n){if(s.store.isCommentPaneOpen||!s.store.dhcContainerPanel||!s.store.areCommentExtensionProvidersDefinedOnce)return s.store.ULS.sendTraceTag(595886288,At.a.msoulscat_Wac_Telemetry,St.a.Warning,"FCM not handling the event. {\n          isCommentPaneOpen: "+s.store.isCommentPaneOpen+",\n          dhcContainerPanelNotDefined: "+!s.store.dhcContainerPanel+",\n          extensionProvidersNotDefined: "+!s.store.areCommentExtensionProvidersDefinedOnce+"\n        }"),void(n&&n.viewportInfo&&(s.store.viewportInfo=n.viewportInfo));switch(t){case 0:if(n&&n.contentAnchorPosition){var e=n.contentAnchorPosition.contentId,i=n.noOfPrecedingThreadsOnSameLine?n.noOfPrecedingThreadsOnSameLine:0;if(!e)return void s.store.ULS.sendTraceTag(595903774,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[AddContainer]ContentId is null.");var o=_t({contentId:e,contentType:c(n.contentAnchorPosition.containerContentType),renderMode:a.e.Integrated});if((C=s.store.getContainerIdToInfoMap()[o])&&C.floatingContainerRef)return void s.store.ULS.sendTraceTag(595097123,At.a.msoulscat_Wac_Telemetry,St.a.Warning,"[AddContainer]Container already exists.");if(s.store.initializeAndRenderFloatingContainer(n.contentAnchorPosition,o,s.onContainerResize,void 0,!0)){s.store.addContentAnchorPosition(n.contentAnchorPosition,i);var r={contentId:e,containerContentType:n.contentAnchorPosition.containerContentType};n.shouldSetFocus&&s.emitEvent(2,{containerContentDescriptor:r})}}break;case 1:if(n&&n.containerContentDescriptor){if(!n.containerContentDescriptor.contentId)return void s.store.ULS.sendTraceTag(595903775,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[DeleteContainer]ContentId is null.");o=_t({contentId:n.containerContentDescriptor.contentId,contentType:c(n.containerContentDescriptor.containerContentType),renderMode:a.e.Integrated});if(!(C=s.store.getContainerIdToInfoMap()[o]))return void s.store.ULS.sendTraceTag(595723333,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[DeleteContainer]Container info for id "+o+" does not exist.");var d=C.position.y,u=s.deleteContainer(o,!!n.animateOutOnDeletion);if(-1===u)return;s.store.activeContainerId&&s.store.activeContainerId!==o?s.positionFloatingContainers(s.store.getContentAnchorPositions(),void 0,s.store.activeContainerId):s.positionFloatingContainers(s.store.getContentAnchorPositions().slice(u),d)}break;case 2:if(n&&n.containerContentDescriptor){if(!n.containerContentDescriptor.contentId)return void s.store.ULS.sendTraceTag(595903777,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[FocusContainer]ContentId is null.");var p=_t({contentId:n.containerContentDescriptor.contentId,contentType:c(n.containerContentDescriptor.containerContentType),renderMode:a.e.Integrated});if(!s.store.getContainerIdToInfoMap()[p])return s.store.ULS.sendTraceTag(595903778,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[FocusContainer]Container with id "+p+" does not exist"),void s.setInitialActiveContainerIdV2(n.containerContentDescriptor,null);s.store.activeContainerId!==p&&(s.clearSelection(!0),s.positionFloatingContainers(s.store.getContentAnchorPositions(),void 0,p,void 0,!0));var h=s.store.getContainerIdToInfoMap()[p].floatingContainerRef;n.shouldSetFocus&&h&&h.setFocus(),s.store.activeContainerId=p}break;case 3:n&&n.contentAnchorPositions&&s.processContentAnchorPositionsInView(n.contentAnchorPositions);break;case 4:n&&n.viewportInfo&&(s.store.viewportInfo=n.viewportInfo,s.featureSettings.SynchronousContainerPositioningEnabled||s.positionFloatingContainers());break;case 5:if(n&&n.infoToReplaceContent){var l=n.infoToReplaceContent.currentContentId,f=n.infoToReplaceContent.newContentId;if(!l||!f)return void s.store.ULS.sendTraceTag(595855174,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[ReplaceContainerContent]"+(l?"NewContentId":"CurrentContentId")+" is null.");var C,g=_t({contentId:l,contentType:c(n.infoToReplaceContent.containerContentType),renderMode:a.e.Integrated});if(!(C=s.store.getContainerIdToInfoMap()[g]))return void s.store.ULS.sendTraceTag(595855175,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[ReplaceContainerContent]ContainerInfo for id "+g+" does not exist");if(!C.floatingContainerRef)return void s.store.ULS.sendTraceTag(595855176,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[ReplaceContainerContent]FloatingContainerRef with id "+g+" does not exist");C.floatingContainerRef.changeRenderedContentIdentifier({contentId:f,contentType:c(n.infoToReplaceContent.containerContentType)}),s.replacementContentId=f;var v=_t({contentId:f,contentType:c(n.infoToReplaceContent.containerContentType),renderMode:a.e.Integrated}),m=s.store.getContentCardIndex(g);if(-1===m)return void s.store.ULS.sendTraceTag(595855178,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[ReplaceContainerContent]Positional index for content id "+l+" should not be negative");s.store.activeContainerId=s.store.activeContainerId===g?v:s.store.activeContainerId,s.store.getContainerIdToInfoMap()[v]=C,delete s.store.getContainerIdToInfoMap()[g],s.store.getContentAnchorPositions()[m].contentId=f}break;case 6:s.positionFloatingContainers()}},this.getAreContainersEnabled=function(){return!s.store.isCommentPaneOpen&&s.store.areCommentExtensionProvidersDefinedOnce},this.getContentAnchorPosition=function(t){if(!t)return null;var n=_t({contentId:t,contentType:a.b.CommentThread,renderMode:a.e.Integrated}),e=s.store.getContentCardIndex(n);return-1!==e?s.store.getContentAnchorPositions()[e]:null},this.containerShouldBeCreatedEventHandler=function(t){var n=s.store.getContentCardIndex(t.containerId);s.store.initializeAndRenderFloatingContainer(s.store.getContentAnchorPositions()[n],t.containerId,s.onContainerResize)},this.updateCommentPaneState=function(){s.store.isCommentPaneOpen=!0,s.store.extensionProviderCollection&&(s.store.isCommentPaneOpen=0===s.store.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===a.b.CommentThread&&t.scope.renderMode===a.e.Integrated})).length),s.onCommentPaneStateChange()},this.onContainerResize=function(t){if(!s.store.isCommentPaneOpen&&t.stateChangeType===ot.Resize&&0!==t.contentRect.height){var n=t.contentIdentifier,e=_t({contentId:n.contentId,contentType:n.contentType,renderMode:a.e.Integrated}),i=s.store.getContainerIdToInfoMap()[e];if(i){var o=i.position.height!==t.contentRect.height;if(s.isInitialActiveIdSet&&s.store.activeContainerId===e&&i.floatingContainerRef&&(s.onInitialActiveContainerRender?(s.onInitialActiveContainerRender(),s.onInitialActiveContainerRender=void 0):i.floatingContainerRef.setFocus()),o){if(i.position.height=t.contentRect.height,i.position.width=t.contentRect.width,s.firstContainerBeingRendered){var r=window.performance&&window.performance.now?window.performance.now():Date.now();s.store.ULS.sendTraceTag(595718473,At.a.msoulscat_Wac_Telemetry,St.a.Info,r.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),s.firstContainerBeingRendered=!1}var c=void 0!==s.timeoutsToCreateContainer[e];s.featureSettings.DeselectionEnabled?s.positionContainersOnResize(e,i,c):s.positionFloatingContainers(s.store.getContentAnchorPositions(),void 0,s.store.activeContainerId,c),s.isInitialActiveIdSet&&s.store.activeContainerId===e&&i.floatingContainerRef&&(s.isInitialActiveIdSet=!1),i.floatingContainerRef&&i.floatingContainerRef.showFloatingContainer(c),t.contentIdentifier.contentId===s.replacementContentId&&(s.replacementContentId=void 0),c&&(delete s.timeoutsToCreateContainer[e],s.stallDetectorUsed||(window.clearTimeout(s.stallDetectorTimeoutId),s.processContainerQueue()))}}else s.store.ULS.sendTraceTag(595646153,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[ContainerResize] ContainerInfo does not exist, id: "+e+", size: "+t.contentRect.height)}},this.store=e,this.floatingContainerPositioner=t,this.floatingContainerVirtualizer=n,this.paneClosedCallback=i,this.paneOpenedCallback=o,this.featureSettings=r,r.ShouldInitialize&&this.initialize()}return t.prototype.initialize=function(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)},t.prototype.enterFixedPositionMode=function(){this.inFixedMode=!0},t.prototype.exitFixedPositionMode=function(){this.inFixedMode=!1},t.prototype.setContainerCreationPauseState=function(t){this.pauseContainerCreation=t,t&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)},t.prototype.clearSelection=function(t){if(void 0===t&&(t=!1),this.store.activeContainerId){var n=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!n)return;if(n.position.x=0,t)return;this.positionFloatingContainers()}},t.prototype.setInitialActiveContainerId=function(t){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=_t({contentId:t.contentId,contentType:c(t.containerContentType),renderMode:a.e.Integrated}))},t.prototype.setInitialActiveContainerIdV2=function(t,n){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=_t({contentId:t.contentId,contentType:c(t.containerContentType),renderMode:a.e.Integrated}),n&&(this.onInitialActiveContainerRender=n))},t.prototype.insertContentAnchorPosition=function(t,n,e){var i=e&&Math.abs(t.anchorTop-n)<=4?this.store.getContentCardIndex(e)+1:-1;this.store.addContentAnchorPosition(t,0,i)},t.prototype.processContentAnchorPositionsInView=function(t){var n=this,e=!1,i=void 0,o=void 0,r=0;if(t.forEach((function(t){if(t){var s=t.contentId;if(!s)return void n.store.ULS.sendTraceTag(595903808,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[processContentAnchorPosition]ContentId is null.");!n.store.processedContainersVisibleAtBoot&&n.store.isContainerInViewPort(t)&&Object(xt.c)(xt.a,{component:"canvas",subComponents:["comment:"+s]});var d=_t({contentId:s,contentType:c(t.containerContentType),renderMode:a.e.Integrated}),u=n.store.getContainerIdToInfoMap()[d];if(!u){var p=n.store.initializeAndRenderFloatingContainer(t,d,n.onContainerResize,!1);return p&&(n.containerCreationQueue.push(d),n.containerCreationEnqueueTimes[d]=Date.now()),void(p&&(n.insertContentAnchorPosition(t,r,i),i=d,r=t.anchorTop))}var h=n.store.getContentCardIndex(d,t.anchorTop);if(-1===h)return void n.store.ULS.sendTraceTag(595883392,At.a.msoulscat_Wac_Telemetry,St.a.Error,"[processContentAnchorPosition]Container was supposed to be found.");var l=n.store.getContentAnchorPositions()[h],f=void 0!==o&&u.position.y>=o.position.y&&u.position.y<=o.position.y+o.position.height,C=Math.abs(l.anchorTop-t.anchorTop)>4;if(e=e||C||f,C){var g=_t({contentId:s,contentType:c(t.containerContentType),renderMode:a.e.Integrated});n.store.removeContentAnchorPosition(g),n.insertContentAnchorPosition(t,r,i)}i=d,r=t.anchorTop,u.anchorTop=t.anchorTop,o=u}})),this.store.processedContainersVisibleAtBoot=!0,this.isContainerQueueInProgress||this.processContainerQueue(),e||this.inFixedMode){var s=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),s,this.store.activeContainerId)}},t.prototype.processContainerQueue=function(){var t=this;if(0===this.containerCreationQueue.length||this.pauseContainerCreation)this.isContainerQueueInProgress=!1;else{this.isContainerQueueInProgress=!0;var n=this.containerCreationQueue.shift(),e=this.store.getContentAnchorPosition(n);e&&(this.store.isContainerInViewPort(e)?this.timeoutsToCreateContainer[n]=window.setTimeout((function(){t.createContainer(e,n),t.setupStallDetector(n)}),this.containerDelayTimeMs):(this.deleteContainer(n),this.processContainerQueue()))}},t.prototype.setupStallDetector=function(t){var n=this;this.stallDetectorUsed=!1,this.stallDetectorTimeoutId=window.setTimeout((function(){n.stallDetectorUsed=!0,n.processContainerQueue(),n.store.ULS.sendTraceTag(593281990,At.a.msoulscat_Wac_Telemetry,St.a.Warning,"[CommentCreationQueueStallDetector]: Container "+t+" creation resize call not received or took too long")}),this.queueStallDetectionTimeMs)},t.prototype.createContainer=function(t,n){if(this.store.initializeAndRenderFloatingContainer(t,n,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[n]){var e=Date.now();this.store.ULS.sendTraceTag(593891910,At.a.msoulscat_Wac_Telemetry,St.a.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:"+(e-this.containerCreationEnqueueTimes[n])),delete this.containerCreationEnqueueTimes[n]}}else this.deleteContainer(n),this.processContainerQueue()},t.prototype.onCommentPaneStateChange=function(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()},t.prototype.deleteContainer=function(t,n){void 0===n&&(n=!1);var e=this.store.removeContentAnchorPosition(t);if(-1===e)return-1;var i=this.store.getContainerIdToInfoMap()[t].floatingContainerRef;if(i){i.destroyFloatingContainer(n),clearTimeout(this.timeoutsToCreateContainer[t]),delete this.timeoutsToCreateContainer[t];var o=this.containerCreationQueue.indexOf(t);o>-1&&this.containerCreationQueue.splice(o,1)}return delete this.store.getContainerIdToInfoMap()[t],delete this.containerCreationEnqueueTimes[t],e},t.prototype.destroyAllContainers=function(){var t=this;Object.keys(this.store.getContainerIdToInfoMap()).forEach((function(n){t.deleteContainer(n)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.timeoutsToCreateContainer={},this.containerCreationQueue=[]},t.prototype.positionFloatingContainers=function(t,n,e,i,o){if(void 0===i&&(i=!1),void 0===o&&(o=!1),t&&t.length>0){var r=e?{containerId:e,containerPositionIndex:this.store.getContentCardIndex(e)}:void 0;this.floatingContainerPositioner.calculateNewPositions(t,this.store.getContainerIdToInfoMap(),{activeContainerInfo:r,disableRepositioningAnimation:i||this.inFixedMode,topOfFirstContainer:n,shouldUpdatePositions:!1})}this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,i||this.inFixedMode||void 0!==this.replacementContentId,this.isInitialActiveIdSet?void 0:this.store.activeContainerId,o)},t.prototype.positionContainersOnResize=function(t,n,e){var i=this.store.getContentCardIndex(t),o=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==o&&o>=i?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,e):(i-=!(Dt(n)&&n.hasBeenRendered)&&i>0?1:0,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(i)));Dt(n)&&(n.hasBeenRendered=!0)},t}(),Ut=new(function(){function t(){}return t.prototype.getFCManagerInstance=function(t){if(void 0===this.floatingContainerManagerInstance){if(!t)throw new Error("Floating Container Manager creation arguments are missing!");t.ulsLogger&&Rt.a.setLogger(t.ulsLogger);var n=function(t){var n=!!t.scrollingPerfImprovementEnabled;return{DeselectionEnabled:!!t.deselectionEnabled,FloatingContainerVirtualizationEnabled:!!t.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!t.improveJumpingFixEnabled,ShouldInitialize:!1!==t.shouldInitialize,ScrollingPerfImprovementEnabled:n,SynchronousContainerPositioningEnabled:!!t.synchronousContainerPositioningEnabled}}(t),e=t.isRtl?1:-1,i=t.canvasAndFcHostOffset?e*(t.canvasAndFcHostOffset-1):0,o=new d(_t,Rt.a,i),r={containerVirtualizationEnabled:n.FloatingContainerVirtualizationEnabled},s=new l(r),c=new Mt(a.f,t.containerPanel,Ot,Rt.a,t.viewportInfo);this.floatingContainerManagerInstance=new Vt(o,s,c,t.paneClosedCallback,t.paneOpenedCallback,n)}return this.floatingContainerManagerInstance},t}());e.d(n,"FactoryGlobal",(function(){return Ut}))}},[[1481,2,0,1]]]);
//# sourceMappingURL=floatingContainerManager.min.js.map