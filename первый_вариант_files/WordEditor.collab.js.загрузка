wac_VO.prototype.uab=wac_b(509,function(){if(!this.qh){var a=this;wac_SO(this.Tt).CWo(function(){wac_SO(a.Tt).rc().uab()},11)}});wac_LC.prototype.Auc=wac_b(254,function(){});wac_MO.prototype.Auc=wac_b(253,function(a){this.va.Uc("OR",a)});wac_LC.prototype.Zrc=wac_b(252,function(){});wac_MO.prototype.Zrc=wac_b(251,function(a){this.va.hb("OR",a)});wac_cYa.prototype.U4b=wac_b(220,function(){});
wac_uP.prototype.U4b=wac_b(219,function(a){var b=this.xa.Xb("PresenceRenderIpSlowDurationMilliseconds",3E3);if(!this.Eqc.Xa(a)){this.Eqc.ea(a,!1);var c=this;this.Ua.nc(new wac_D(3,1,b,function(){var d,e;e=c.Eqc.Sb(a,d={val:d},!1);d=d.val;e;d||(wac_u().recordQosError("PresenceRenderFailed",["PresenceExperienceDegraded"],!0,!0,!0,!1,null),wac_(51683551,302,15,"Presence didn't render for the selected person from people well. Veto Set At:{0}",b));c.Eqc.Ab(a)},0,null,!1,0))}});
function wac_CWb(a,b,c){if(!b)return null;if(!a.W8)return wac_(50870151,304,10,"Tried to acquire a lock for wet change before the coauthManager is ready. This will fail."),null;var d=b.pa(Number,wac__p,0),e=null;b=b.pa(Number,wac_9s,0);var f=a.jLa.Xa(d)?a.jLa.B(d):0;b&&(e=wac_2x(a,b));!e&&f&&(e=wac_2x(a,f));if(e)return a.jLa.ea(d,e.LockId),e;e=new wac_PVa;e.LockId=wac_DOb(a);e.ParagraphIds=[d];e.Type=4;if(!c)return wac_(17866973,304,10,"An attempt to acquire a Lock was made  with an empty clientId. The lockOwner cannot be empty."),
null;(f=wac_TFa(a.W8.Su,c))?f.Name===CommonUIStrings.l_AnonymousUserName&&wac_(592229833,304,15,"The looked up author has no name"):(f=new wac_Zb,f.Id=c,f.Name=CommonUIStrings.l_AnonymousUserName,a.BUa.Xa(c)||a.BUa.U(c,new (wac_h.$$(Number))(null)),a.BUa.B(c).U(e.LockId));if(!f)return wac_(7440404,304,10,"Unable to get a wetchange lock on node {0} as client {1} is not in editorstable",b,c),null;e.LockOwner=f;wac_EOb(a,e,e.LockId);a.jLa.ea(d,e.LockId);return e}
function wac_DWb(a,b){if(wac_iP.isInstanceOfType(b)){var c=b.Ia(Number,wac__p);if(a.jLa.Xa(c)){var d=a.jLa.B(c);if(d){var e=wac_2x(a,d);e&&4!==e.Type||(delete a.c8[d.toString()],a.jLa.Ab(c),b.ma(wac_9s,0),a.va.Ya("WLR",new wac_AOb(d),a))}}}else wac_(18227549,304,10,"An attempt to remove a Wet Change lock on a node that is not a paragraph node was made.")}
function wac_EWb(a,b,c,d,e){var f=wac_B9a(a,b,c,!1,0);if(f&&d){var g=b.fa;d=wac_lB(g.wa,b.za);d||(wac_ED(a,wac_yy(g,b.za+1)),wac_ED(a,wac_yy(g,b.za)),d=wac_lB(g.wa,b.za));d.gb||wac_yD(d,new wac_HD(d,wac_y(),null));1===c.length?((c=wac_lB(g.wa,b.za+1))?c.gb||wac_yD(c,new wac_HD(c,wac_y(),null)):wac_ED(a,wac_yy(g,b.za+1)),c=new wac_tF(d,null,22,"",!1),wac_GD(d,c)):2===c.length&&""!==e&&a.Waa.dS(d.gb,e)}f&&wac_C9a(a,b.fa,!1)}
function wac_PR(a){if(!a.tj.la()){a.Pke||(wac_ea(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),a.Pke=!0);if(a.Zi){var b=a.Zi.m7a();wac_PFa(a,b)}if(a.YH)for(var b=wac_QFa(a.YH),c=b.length,d=0;d<c;++d){var e=b[d];e.Id&&(e=wac_RFa(a,e.Id),wac_SFa(a,new wac_5n(0),e))}}b=[];for(a=a.tj.GetEnumerator();a.$$mn();)c=a.$$cu(),Array.add(b,c.qa());return b}function wac_FWb(a,b){var c;a=a.tj.Sb(b,c={val:c},null);c=c.val;a;return c}
var wac_GWb=null,wac_HWb=null,wac_IWb=null,wac_JWb=null;
function wac_KWb(a){var b,c,d;a=(d=wac_yWb(a,c={val:b}),b=c.val,d);if(!a)return!1;switch(b){case 0:case 1:return"number"!==typeof a.CP||null!=a.FB&&"number"!==typeof a.FB||null!=a.FE&&"number"!==typeof a.FE||null!=a.HB&&"number"!==typeof a.HB||null!=a.HE&&"number"!==typeof a.HE||null!=a.CB&&"number"!==typeof a.CB||null!=a.CE&&"number"!==typeof a.CE||null!=a.R&&"number"!==typeof a.R||null!=a.E&&"number"!==typeof a.E||null!=a.TW&&"number"!==typeof a.TW||null!=a.PB&&"number"!==typeof a.PB||null!=a.SYM&&
"number"!==typeof a.SYM||null!=a.IE&&"number"!==typeof a.IE||null!=a.OO&&"number"!==typeof a.OO||null!=a.AX&&"number"!==typeof a.AX||null!=a.CCI&&"number"!==typeof a.CCI||null!=a.DD&&"number"!==typeof a.DD?!1:!0;default:return!1}}
function wac_LWb(a){if("number"!==typeof a.RK||"number"!==typeof a.DK)return!1;var b,c=!1,d=!1,e=!1;switch(a.RK){case 0:d=b=!0;break;case 1:e=c=d=b=!0;break;case 2:if(null!=a.PE&&"number"!==typeof a.PE)return!1;b=!0;break;case 4:b=!0;break;case 3:d=b=!0;break;case 5:c=b=!0;break;default:return!1}return b&&("number"!==typeof a.PS||"number"!==typeof a.TS)||d&&("object"!==typeof a.OS||!a.OS||!wac_KWb(a.OS))||c&&("number"!==typeof a.PE||"number"!==typeof a.TE)||e&&("object"!==typeof a.OE||!a.OE||!wac_KWb(a.OE))?
!1:!0}function wac_MWb(a){return wac_Bab(a)}function wac_NWb(a){return a&&a.style?wac_Jk(a,"transform")?a.style.transform:wac_Jk(a,"msTransform")?a.style.msTransform:wac_Jk(a,"MozTransform")?a.style.MozTransform:wac_Jk(a,"webkitTransform")?a.style.webkitTransform:null:null}
function wac_OWb(a){for(var b=new (wac_e.$$(Number)),c=a.$$lge();c.$$mn();)if(a=c.$$cu())a=window.parseFloat(a),!window.isNaN(a)&&window.isFinite(a)&&b.U(a);c={};c.C=b.la();if(0<b.la()){for(var d=0,e=b.$$lge();e.$$mn();)a=e.$$cu(),d+=a;d/=b.la();c.M=d.toFixed(2);for(var e=0,f=b.$$lge();f.$$mn();)a=f.$$cu(),e+=(a-d)*(a-d);e/=b.la();b=Math.sqrt(e);c.SD=b.toFixed(2)}return wac_Jc(c)}
function wac_PWb(a){var b=0;for(a=a.$$lge();a.$$mn();){var c=a.$$cu();c&&(c=window.parseInt(c),!window.isNaN(c)&&window.isFinite(c)&&(b+=c))}return wac_Jc(b)}Type.registerNamespace("Common.App.CoauthTelemetry");wac_g=window.Common||{};wac_g.Aa=wac_g.Aa||{};wac_g.Aa.xrb=wac_g.Aa.xrb||{};function wac_QWb(a){this.CEe=Function.createDelegate(this,this.Xhf);this.ypa=Function.createDelegate(this,this.SEa);this.Qcc={};this.Vlc={};this.BZa=a}
wac_QWb.prototype={vI:null,BZa:null,KGb:null,O2b:function(a){var b=new (wac_6a.$$(Number)),c=this;this.zb().CW(function(){a in c.Qcc?wac_7a(b,c.Qcc[a]):c.Vlc[a]=b});return b.Yc},zb:function(){if(this.KGb)return this.KGb.Yc;this.KGb=new (wac_6a.$$(Object));var a=this;this.BZa.CW(function(){a.vI=a.BZa.rc();a.vI.va.hb("UU",a.ypa);wac_RWb(a);a.KGb.tg(null)});return this.KGb.Yc},SEa:function(){wac_RWb(this)},Xhf:function(a,b){return a.gba>b.gba?1:a.gba<b.gba?-1:0}};
function wac_RWb(a){var b=wac_PR(a.vI);b.sort(a.CEe);a.Qcc={};for(var c=0;c<b.length&&b[c]&&b[c].gba;c++){var d=a,e=b[c].mi(),f=c;a.Qcc[e]=f;e in d.Vlc&&(wac_7a(d.Vlc[e],f),delete d.Vlc[e])}}
function wac_SWb(a,b,c,d,e,f,g,h,k){this.Ewc=Function.createDelegate(this,this.zSc);this.pAd=Function.createDelegate(this,this.HKf);this.mC=a;this.Eib=new (wac_6a.$$(wac_g.g0b));this.xa=c;this.Tcc=b;this.Qt=d;this.qg=e;this.Xlc=f;this.BZa=g;this.n4d=h;this.Q$c=this.P$c=!1;this.OOb=0;this.I4c=1;this.rla=k;this.Fjb=this.xa.ga("PeoplesWellExtraButtonInfoIsEnabled")}
wac_SWb.prototype={mC:null,Eib:null,Tcc:null,xa:null,Qt:null,qg:null,Xlc:null,BZa:null,n4d:null,Fjb:!1,vI:null,B6d:null,Ene:null,I4c:0,Q$c:!1,P$c:!1,OOb:0,rla:null,zb:function(){var a=this;wac_Ua.WAA.call(null,this.BZa,this.Tcc,this.Xlc).CW(function(){a.vI=a.BZa.rc();a.B6d=a.Tcc.rc();a.Ene=a.Xlc.rc();wac_Ua.WAA.call(null,a.Tcc.rc().T_a.Yc,a.Xlc.rc().nqc.Yc).CW(function(){a.I4c=a.B6d.T_a.Yc.rc();a.OOb=a.Ene.nqc.Yc.rc();a.vI.va.hb("UU",a.pAd);wac_PR(a.vI).length&&a.SEa()})})},HKf:function(){this.SEa()},
SEa:function(){this.n4d(wac_PR(this.vI))?(this.vI.va.Uc("UU",this.pAd),wac_TWb(this,this.P$c)):wac_7a(this.Eib,1);this.P$c=!0},zSc:function(){var a=wac_xd(this.qg,"AppInitStatus_"+wac_g.Aa.DCa.toString(4));wac_c(42259235,325,!!this.OOb,null);var b=this.OOb-a,c={};c.InteractiveTime=a;c.ReactRenderComplete=this.OOb;c.HadTabSwitch=this.rla();c.IsModernGallery=this.Fjb;wac_(594883104,325,50,wac_Ll(c));this.Fjb?(wac_(42062997,325,15,b.toString()),a=this.Eib,c=this.xa.Xb("CoauthorGalleryTimeToRenderDurationMs",
1E4),c=b>c,this.rla()?(wac_(50455714,325,50,c.toString()),b=!1):(c&&(wac_(42062998,325,15,b.toString()),wac_u().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),b=c),wac_7a(a,b?3:2)):wac_(594883103,325,15,b.toString())}};function wac_UWb(a,b){b?a.Qt.Ok(4,a.Ewc,3):wac_7a(a.Eib,1)}
function wac_TWb(a,b){a.Q$c?a.Eib.Yc.CW(function(){wac_(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",wac_g.g0b.toString(a.Eib.Yc.rc()))}):(a.Q$c=!0,wac_UWb(a,!a.I4c&&!b))}function wac_VWb(a,b){this.ypa=Function.createDelegate(this,this.SEa);this.kid=a;this.Tne=b}function wac_WWb(a){for(var b,c=null,d=a.length,e=0;e<d;++e)if(b=a[e])if(b=b.Jx||!b.Ix?b.mi():b.Ix.toUpperCase(),!c)c=b;else if(c!==b)return!0;return!1}
wac_VWb.prototype={V4:null,Tne:null,kid:null,zb:function(){var a=this;this.kid.CW(function(){a.V4=a.kid.rc();a.V4.va.hb("UU",a.ypa)})},SEa:function(){wac_WWb(wac_PR(this.V4))&&(this.V4.va.Uc("UU",this.ypa),this.Tne.IsRealCoauthSession=!0)},H8f:function(){return this.V4?wac_WWb(wac_PR(this.V4)):!1}};function wac_XWb(){}
wac_XWb.prototype={Zb:function(){return"Common.App.CoauthTelemetry"},$b:function(a){wac_n(wac_o(wac_p(a.na(wac_VWb,null),wac_kya)),function(){return new wac_VWb(wac_yb(wac_8b,wac_m(a,wac_8b)),wac_r.Cm)});wac_n(wac_o(wac_p(a.na(wac_SWb,null),wac_sca)),function(){return new wac_SWb(wac_z(),wac_yb(wac_Tb,wac_m(a,wac_Tb)),wac_r.W,window.Common.App.AppLifecycleManager.get_instance(),wac_qd(),wac_yb(wac_9b,wac_m(a,wac_9b)),wac_yb(wac_8b,wac_m(a,wac_8b)),wac_WWb,function(){return wac_YWb()})});wac_n(wac_o(wac_p(a.na(wac_ZWb,
null),wac_ym)),function(){return new wac_ZWb(wac_yb(wac_Tb,wac_m(a,wac_Tb)),wac_yb(wac_$b,wac_m(a,wac_$b)),window.Common.App.AppLifecycleManager.get_instance(),a.H(wac_jya,null),wac_qd(),function(){return wac_YWb()},wac_r.W,null,wac_u())});wac_n(wac_o(wac_p(a.na(wac_QWb,null),wac_jya)),function(){return new wac_QWb(wac_yb(wac_8b,wac_m(a,wac_8b)))})},zb:function(){wac_ph(wac_r.W,function(){wac_k().H(wac_VWb,null).zb();wac_r.W.ga("CoauthorGalleryTelemetryIsEnabled")&&wac_k().H(wac_sca,null).zb();wac_r.W.ga("CashTelemetryIsEnabled")&&
(wac_k().H(wac_ym,null),wac_k().H(wac_jya,null))})},oa:function(){}};function wac_YWb(){return wac_yea()&&wac_wd(wac_qd(),"UserActions")?0<wac_xd(wac_qd(),"UserActions").VisiToggled:!1}
function wac_ZWb(a,b,c,d,e,f,g,h,k){this.HTe=Function.createDelegate(this,this.kDf);this.wYe=Function.createDelegate(this,this.OIf);this.Boe={};this.Hjb=new (wac_d.$$(Number))(function(){return g.q2("PresenceBootLatencyThreshold",1E4)});this.vcb=new (wac_d.$$(Number))(function(){return g.q2("PresenceBootLatencyCutoffThreshold",6E4)});this.Qt=c;this.Wne=d;this.J4c=a;this.Nkd=b;this.qg=e;this.jgb=h;this.rla=f;this.jf=k;this.g3c=!1;this.zb()}
wac_ZWb.prototype={J4c:null,Nkd:null,Zi:null,g3c:!1,jgb:null,LGb:null,Qt:null,Wne:null,aCb:null,qg:null,Bte:0,Cte:0,Hjb:null,vcb:null,rla:null,jf:null,Osb:function(a,b,c,d){c&&(wac_c(42274970,302,!this.jgb||this.jgb===c,"_myClientId is already set and you are trying to update it to something different"),this.jgb=c);var e=new (wac_6a.$$(Boolean)),f=this;this.zb().CW(function(){var c=b?b.getTime():(new Date).getTime();if(a in f.Boe)e.SZ();else{var h;h=1===f.Bte?wac_Ya(Number,f.Cte):wac__Wb(f);c=new wac_0Wb(a,
h,c,f.O2b(f.jgb||"{"+wac_r.Uf+"}"),f.O2b(a),f.Hjb,f.vcb,d,f.rla);f.Boe[a]=c;wac_1Wb(c,e)}});return e.Yc},zb:function(){if(this.LGb)return this.LGb.Yc;this.LGb=new (wac_6a.$$(Object));this.rla()&&wac_(50951700,302,15,"TabSwitched Session");var a=this;this.J4c.CW(function(){var b=a.J4c.rc(),d=b.T_a.Yc,e=b.Ete.Yc;e.CW(function(){d.CW(function(){a.jf&&a.jf.addQosPillar(window.Common.QosPillarName.toString(6));a.OZc(d.rc(),e.rc());a.LGb.tg(null)})})});var b=this;this.Nkd.CW(function(){b.Zi=b.Nkd.rc();
b.Zi.aha(b.wYe);b.Zi.ZX(b.HTe)});return this.LGb.Yc},OIf:function(a,b){if(!this.g3c&&2===b.yt){var c=Date.now(),d=wac__Wb(this),e=this;d.CW(function(){var a=d.rc(),a=c-a,b={};b.clientId=e.jgb||"{"+wac_r.Uf+"}";b.bootTime=a;e.g3c=!0;e.Zi.RF(15,b,!1)})}},kDf:function(){},OZc:function(a,b){this.Bte=a;this.Cte=b?b:(new Date).getTime()},O2b:function(a){return this.Wne.O2b(a)}};
function wac__Wb(a){if(a.aCb)return a.aCb.Yc;a.aCb=new (wac_6a.$$(Number));a.Qt.Ok(4,function(){var b=wac_xd(a.qg,"AppInitStatus_"+wac_g.Aa.DCa.toString(4));wac_7a(a.aCb,b)},3);return a.aCb.Yc}function wac_0Wb(a,b,c,d,e,f,g,h,k){this._id=a;this.Mmd=b;this.As=c;this.ykc=d;this.dqc=e;this.Hjb=f;this.vcb=g;this.FCb=h;this.rla=k}wac_0Wb.prototype={Oh:0,Mmd:null,Hjb:null,vcb:null,Nre:!1,As:0,ykc:null,dqc:null,FCb:0,_id:null,rla:null};
function wac_2Wb(a){switch(a){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}
function wac_1Wb(a,b){wac_Ua.WAA(a.Mmd,a.ykc,a.dqc).CW(function(){if(a.ykc.rc()<=a.dqc.rc())wac_7a(b,!1);else{a.Oh=a.Mmd.rc();var c=a.As-a.Oh,d=new window.Common.App.CoauthTelemetry.PL;d.id=a._id;d.et=a.As;d.st=a.Oh;d.d=a.As-a.Oh;d.mp=a.ykc.rc();d.tp=a.dqc.rc();d.ct=wac_2Wb(a.FCb);d.vc=a.rla();var e=wac_Jc(d);wac_(42078597,302,15,e);if(c>a.Hjb.qa()&&!a.Nre&&!d.vc&&c<a.vcb.qa()){a.Nre=!0;wac_7a(b,!0);var f,d=(f=new wac_3l,f.extendedProperties=new window.Map,f);d.extendedProperties.set("data",e);wac_u().recordQosError("PresenceRenderDurationIsTooLong",
["PresenceExperienceDegraded"],!1,!0,!1,!1,d);wac_(42078598,302,15,"{d:"+c+",vt:"+a.Hjb.qa()+",ct:"+a.vcb.qa()+"}")}wac_1a(b.Yc)||wac_7a(b,!1)}})}window.Common.App.CoauthTelemetry.PL=wac_g.Aa.xrb.sLf=function(){};wac_g.Aa.xrb.sLf.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};wac_QWb.registerClass("Common.App.CoauthTelemetry.CoauthorPositionFinder",null,wac_jya);wac_SWb.registerClass("Common.App.CoauthTelemetry.CoauthorGalleryTelemetry",null,wac_sca);
wac_VWb.registerClass("Common.App.CoauthTelemetry.CoauthTelemetry",null,wac_kya);wac_XWb.registerClass("Common.App.CoauthTelemetry.CoauthTelemetryPackage",null,wac_J,wac_j);wac_ZWb.registerClass("Common.App.CoauthTelemetry.PresenceBootTelemetry",null,wac_ym);wac_0Wb.registerClass("Common.App.CoauthTelemetry.PresenceLatencyActivityLogger");window.Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");wac_K(wac_E(),new wac_XWb,0);Type.registerNamespace("Common.App.CollabControls");
wac_g=window.Common||{};wac_g.Aa=wac_g.Aa||{};wac_g.Aa.RCa=wac_g.Aa.RCa||{};function wac_3Wb(){}wac_3Wb.registerInterface("Common.App.CollabControls.IPresenceTooltipControl");function wac_4Wb(){}wac_4Wb.registerInterface("Common.App.CollabControls.IPresenceTooltipFactory");wac_g.Aa.RCa.U9a=function(){};
wac_g.Aa.RCa.U9a.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};wac_g.Aa.RCa.U9a.registerEnum("Common.App.CollabControls.PresenceTooltipSettingKeys",!1);
function wac_QR(a){this.wY=Function.createDelegate(this,this.UWf);this.dispose=this.oa;wac_QR.initializeBase(this);this._element=a}
wac_QR.prototype={_element:null,Jb:function(){return this._element},Iq:function(){return"visible"===this._element.style.visibility},$r:function(a){this._element.style.visibility=a?"visible":"hidden";return a},oa:function(){this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null;wac_nd.prototype.oa.call(this)},Pj:function(a){return this._element.ownerDocument.createElement(a)},UWf:function(){return!0}};
function wac_RR(a,b){a._element.style.zIndex=b}function wac_5Wb(a,b){a._element.dir=b?"rtl":"ltr"}function wac_SR(a,b){wac_SR.initializeBase(this);this.nd=a;this.Zzc=b}wac_SR.prototype={nd:0,Zzc:null};
function wac_TR(a,b,c){this.tMa=Function.createDelegate(this,this.A9a);this.y2a=Function.createDelegate(this,this.IFf);this.tj=[];this.dispose=this.oa;wac_TR.initializeBase(this,[a]);this.jeb={};this.md=c;this.ei=c.Pk(Boolean,8,!1);this.$$c=c.Pk(Boolean,15,!1);this.Uha=c.Pk(Number,12,0);this.Kpa=c.Pk(Number,6,0);this.Sya=b;this.Epd=c.Pk(Function,16,null);this.rFb=c.Pk(Boolean,17,!1);this.lIb=0;this.Xne=new wac_6Wb(this.ei,this.rFb);this.Pab=this.ei?3:4;this.xJa=!1;this.qUa=[];this.meb=[];this._element.id=
String.format("{0}-{1}","presencetooltip",wac_7Wb++);this._element.className="prControl"+(this.ei?"Rtl":"");this.Uha&&wac_RR(this,this.Uha);wac_5Wb(this,this.ei);this.nYc(b);this.$M=this.Pj("div");this.$M.className="prFlyoutContainer";this._element.appendChild(this.$M);this.gJ=[];this.Cwa=new wac_8Wb(this.gJ,this._element,this.Kpa,4,6,32,this.ei);this.nk=c.Pk(wac_Ac,9,null);this.nk.Sa("msospPointerDown",this.Cwa.uf,this.y2a);this.nk.Sa("msospPointerOver",this.Cwa.uf,this.y2a);this.nk.Sa("msospPointerOut",
this.Cwa.uf,this.y2a)}
wac_TR.prototype={ei:!1,VHa:!1,jde:!1,Yma:!1,Sya:0,lIb:0,Ehb:!1,$$c:!1,rFb:!1,xJa:!1,jeb:null,$M:null,Cwa:null,qUa:null,meb:null,Xne:null,Pab:0,nk:null,md:null,Epd:null,rtc:function(){return wac_5d(this.tj)},gJ:null,Uha:0,Kpa:0,oa:function(){if(3!==wac_UR(this)||this.VHa){if(this.gJ)for(var a=this.gJ,b=a.length,c=0;c<b;++c){var d=a[c];d.xuc(this.tMa);wac_Lb(d)}this.gJ=null;this.nk.Nb("msospPointerDown",this.Cwa.uf,this.y2a);this.nk.Nb("msospPointerOver",this.Cwa.uf,this.y2a);this.nk.Nb("msospPointerOut",
this.Cwa.uf,this.y2a);wac_QR.prototype.oa.call(this)}else this.xJa=!0},zTa:function(){wac_VR(this,!1);this.$r(!0)},e$b:function(){this.$r(!0);wac_9Wb(this);this.VHa=!0},le:function(){wac_$Wb(this,5);this.Bsa();this.Cwa.yo(wac_UR(this),this.Ehb)},WY:function(a){var b=wac_UR(this),c=this.VHa;a.El||(a.El=(wac_7Wb++).toString());var d;if(a.El in this.jeb&&(d=this.jQa(a.El),0<=d)){d=this.tj[d];if(d.$o===a.$o&&d.Sq===a.Sq)return;this.Kta(a.El)}this.le();d=new wac_aXb(this.Pj("div"),this.md);d.iQb(this.tMa);
this.$M.insertBefore(d._element,this.$M.firstChild);this.jeb[a.El]=d;Array.add(this.tj,a);Array.add(this.gJ,d);wac_bXb(this,b,c);this.$r(!0)},Kta:function(a){if(3!==wac_UR(this)||this.VHa){var b=wac_UR(this),c=this.VHa;this.le();this.oyb(a);wac_bXb(this,b,c)}else Array.add(this.meb,a)},TJc:function(a){a=a.rb.rawEvent.relatedTarget;if(this.$M!==a&&wac_0c(this.$M,a))return!0;for(var b=this.gJ,c=b.length,d=0;d<c;++d)if(wac_0c(b[d]._element,a))return!0;return!1},Bsa:function(){var a=0,b=0;this.Ehb&&(a=
this.Pab,b=-6);for(var c=0;c<wac_WR(this);c++)this.gJ[c].le(this.tj[c],b,a);wac_RR(this,this.Uha);this.VHa=!1;this.$r(!1);this.xJa&&this.oa()},A9a:function(a,b){a=wac_UR(this);if(2===b.nd||4===b.nd&&3!==a)this.Yma&&(this.Yma=!1),3!==a&&(wac_9Wb(this),3===b.Zzc.af&&wac_cXb(this,2E3));else if(4===b.nd&&3===a)this.Yma&&(this.Yma=!1),wac_cXb(this,0);else if(3===b.nd&&3===a&&!this.VHa)if(1<wac_WR(this)){this.Yma=!0;var c=this;wac_Wa(250).CW(function(){wac_VR(c,!0);c.Yma=!1})}else wac_cXb(this,0);this.Ya("InteractivityChanged",
b,null)},IFf:function(a){3===a.af?this.A9a(this,new wac_SR(4,a)):"msospPointerOver"===a.Mo?this.A9a(this,new wac_SR(2,a)):"msospPointerOut"===a.Mo&&this.A9a(this,new wac_SR(3,a));return!1},nYc:function(a){this._element.style.width=a+"px";this._element.style.height=this.Kpa+"px"},oyb:function(a){if(-1===this.jQa(a))wac_(41706452,302,50,"Cannot remove active editor because client id is invalid");else if(Array.contains(this.qUa,a)){Array.remove(this.qUa,a);if(this.tj[0].El===a&&0<this.qUa.length){var b=
this.qUa[this.qUa.length-1];if(b in this.jeb){var c=this.jQa(b);if(c){var d=this.tj[c],b=this.jeb[b];Array.removeAt(this.tj,c);Array.insert(this.tj,0,d);Array.removeAt(this.gJ,c);Array.insert(this.gJ,0,b);this.$M.removeChild(b._element);this.$M.appendChild(b._element);wac_VR(this,!1)}}}this.tj[0].El===a&&1===wac_UR(this)&&wac_VR(this,!1)}a=this.jQa(a);0>a||(c=this.tj[a],Array.removeAt(this.tj,a),delete this.jeb[c.El],c=this.gJ[a],this.$M.removeChild(c._element),this.md.Pk(Boolean,18,!1)&&c.xuc(this.tMa),
Array.removeAt(this.gJ,a),c.oa())},jQa:function(a){for(var b=0;b<this.tj.length;b++)if(this.tj[b].El===a)return b;return-1},xXc:function(a){for(var b=0;b<wac_WR(this);b++)this.gJ[b].xXc(a)}};function wac_dXb(a,b){b?Sys.UI.DomElement.addCssClass(a.$M,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(a.$M,"prBackgroundSelection")}function wac_$Wb(a,b){if(a.meb.length){a.Iq()&&a.Bsa();for(var c=0;c<a.meb.length;c++)a.oyb(a.meb[c]);Array.clear(a.meb);0>=a.tj.length||5===b?a.le():b||a.zTa()}}
function wac_cXb(a,b){b?(a.Yma=!0,wac_Wa(b).CW(function(){a.$$c?a.Yma&&a.le():wac_VR(a,!0);a.Yma=!1})):a.$$c?a.le():wac_VR(a,!1)}
function wac_9Wb(a){a.jde&&wac_dXb(a,!1);wac_RR(a,a.Uha+1);var b,c,d,e=c={val:c},f=b={val:b},g=d={val:d};e.val=0;f.val=0;g.val=a.Pab;if(a.Epd){var h=a.Epd(a);if(h){var k=4===wac_UR(a),l;l=a.Xne;var m=wac_WR(a),n=k?6:a.Kpa,p=a.Kpa,q=a._element,r=h.y,t=h.height,u=wac_Dj(q).y,v=u+n,w=m*p+2*(m-1),p=null;1===m||u+w<=r+t?m=new wac_XR(0,0,2,4):(m=l.wKc(v,w,r,t),m.n9a-=u);l.rFb?p=new wac_XR(0,0,2,l.ei?4:3):(q=l.ei?h.width-wac_iva(q):wac_Dj(q).x,u=Math.max(0,h.x),h=h.width,n=q+n,q+150<=u+h?p=new wac_XR(0,
0,2,l.ei?3:4):150<=n-u&&(p=new wac_XR(0,0,2,l.ei?4:3)),p||(h-n>=q-u?l=4:(n=q,l=3),p=new wac_XR(0,n,2,l)));l=new wac_XR(m.n9a,p.EVd,m.S0c,p.oNc);f.val=l.n9a;1===l.S0c?f=wac_WR(a)-1:(f=Math.abs(l.n9a),f=0<f?f/(a.Kpa+2):0);a.lIb=f;g.val=l.oNc;g.val!==a.Pab&&(a.xXc(g.val),a._element.dir=3===g.val?"rtl":"ltr",a.Pab=g.val);g.val!==(a.ei?3:4)?(e.val=k?-6:-a.Kpa,a.Ehb=!0):a.Ehb=!1}}c=c.val;b=b.val;d=d.val;for(e=0;e<wac_WR(a);e++)a.gJ[e].ai(a.tj[e],c,b+(a.Kpa+2)*e+20,3,e!==a.lIb,d)}
function wac_VR(a,b){if(!b||a.Yma){a.jde&&wac_dXb(a,!0);var c=Math.min(3,wac_WR(a))-1;b=0;var d=1,e=0;a.Ehb&&(b=a.Pab,d=-1,e=-a.Kpa);for(var f=wac_WR(a)-1;f>c;f--)a.gJ[f].ai(a.tj[f],-4*c*d+e,20,2,!0,b);for(f=c;0<=f;f--)c=Array.contains(a.qUa,a.tj[f].El),a.gJ[f].ai(a.tj[f],-4*f*d+e,20,0<f?2:c?1:0,f!==a.lIb,b);a.lIb=0;a.Cwa.yo(0,a.Ehb);wac_RR(a,a.Uha);a.VHa=!1;wac_$Wb(a,0);a.xJa&&a.oa()}}function wac_bXb(a,b,c){0>=a.tj.length?a.le():3===b&&c?a.e$b():a.zTa()}
function wac_UR(a){return 0<wac_WR(a)?a.gJ[0].Rh:5}function wac_WR(a){return a.gJ?a.gJ.length:0}function wac_eXb(a){var b=wac_fXb/a,c=2*b,d=wac_gXb/2;a=(a-12-8)*b/2;var e=document.createElementNS(wac_hXb,"g");e.setAttribute("class",wac_iXb);for(var f=1;3>=f;f++)e.appendChild(wac_jXb(f,c,a+(6*f-2)*b,d));return e}
function wac_jXb(a,b,c,d){var e=document.createElementNS(wac_hXb,"circle");e.setAttribute("class",String.format("{0}-{1}",wac_kXb,a));e.setAttribute("cx",String.format("{0}",c));e.setAttribute("cy",String.format("{0}",d));e.setAttribute("r",String.format("{0}",b));return e}function wac_lXb(a){this.md=a;wac_YR(this.md,10,wac_Vf());wac_YR(this.md,9,wac_Xf());wac_YR(this.md,6,20);wac_YR(this.md,13,wac_5f());wac_YR(this.md,17,!1)}
wac_lXb.prototype={md:null,OHc:function(a,b){wac_YR(this.md,15,b);return new wac_TR(a,20,this.md)}};
function wac_aXb(a,b){this.Mha=Function.createDelegate(this,this.pSa);this.CL=Function.createDelegate(this,this.Ada);this.BL=Function.createDelegate(this,this.zO);this.Sl=Function.createDelegate(this,this.Jr);wac_aXb.initializeBase(this,[a]);this.g5=b.Pk(Boolean,8,!1);this.bma=b.Pk(Number,6,0);this.Bwe=b.Pk(Boolean,15,!1);this.md=b;this.B8c=0;this._element=a;this._element.className=wac_mXb;this.qy=document.createElement("span");this._element.appendChild(this.qy);a=b.Pk(Number,6,0);var c=document.createElementNS(wac_hXb,
"svg");c.setAttribute("viewBox",String.format(wac_nXb,wac_fXb,wac_gXb));c.appendChild(wac_eXb(a));this.w9d=c;this.az(b);this.Rh=5}
wac_aXb.prototype={kd:null,nk:null,Ut:null,md:null,qy:null,Kwa:null,w9d:null,bma:0,g5:!1,Bwe:!1,w4c:null,B8c:0,JHa:null,iQb:function(a){this.hb("InteractivityChanged",a)},xuc:function(a){this.Uc("InteractivityChanged",a)},Nf:null,Rh:0,oa:function(){this._element&&(this.kd.Nb("click",this._element,this.Sl),this.kd.Nb("dblclick",this._element,this.wY),this.nk.Nb("msospPointerDown",this._element,this.BL),this.nk.Nb("msospPointerOut",this._element,this.CL),this.nk.Nb("msospPointerOver",this._element,
this.Mha),this.Ut.Nb(this._element,this.wY));wac_QR.prototype.oa.call(this)},az:function(a){this.kd=a.Pk(wac_Cda,10,null);this.kd.Sa("click",this._element,this.Sl);this.kd.Sa("dblclick",this._element,this.wY);this.nk=a.Pk(wac_Ac,9,null);this.nk.Sa("msospPointerOver",this._element,this.Mha);this.nk.Sa("msospPointerOut",this._element,this.CL);this.nk.Sa("msospPointerDown",this._element,this.BL);this.Ut=a.Pk(wac_7i,13,null);this.Ut.Sa(this._element,this.wY)},le:function(a,b,c){this.Bwe&&a?this.ai(a,
b,15,4,!1,c):(3===this.Rh&&wac_oXb(this),this.$r(!1),this.Rh=5)},ai:function(a,b,c,d,e,f){var g;if((g=a)&&!(g=d!==this.Rh)){g=wac_Lk(this._element.style.left);var h=wac_Lk(this._element.style.top);g=!(g===b&&h===c)}if(g){if(!wac_pXb(this.Rh)||!wac_pXb(d))switch(Sys.UI.DomElement.removeCssClass(this._element,this.w4c),this.Rh){case 4:3===d?this.cra(wac_qXb,wac_rXb):wac_pXb(d)&&this.cra(wac_sXb,wac_rXb);break;case 3:4===d?this.cra(wac_tXb,wac_uXb):wac_pXb(d)&&(e&&wac_oXb(this),this.cra(wac_sXb,wac_uXb,
e?wac_vXb:""));break;case 0:case 1:case 2:4===d?this.cra(wac_tXb,wac_wXb):3===d&&(e&&wac_xXb(this),this.cra(wac_qXb,wac_wXb,e?wac_yXb:"",3===f?wac_zXb:wac_AXb));break;default:4===d?this.cra(wac_tXb):3===d?this.cra(wac_qXb):wac_pXb(d)&&this.cra(wac_sXb)}this.WY(a,d,f);this.Rh=d;4===f||!f&&!this.g5?this._element.style.left=b+"px":this._element.style.right=b+"px";this._element.style.top=c+"px";this.$r(!0)}},WY:function(a,b,c){this.Nf=a;wac__c(this.qy);this.qy.removeAttribute("style");this.qy.id="fly_"+
a.El;this.qy.style.backgroundColor=a.$o;4!==b?(this.qy.style.height=this.bma+"px",this.qy.style.lineHeight=this.bma+"px",wac_Ik(this.qy,"border-radius",this.bma+"px")):4===c||!c&&!this.g5?this.qy.style.left="0px":this.qy.style.right="0px";if(2!==b)if(4===b)wac_1c(this.qy,"");else if(1===b)this.qy.appendChild(this.w9d);else{this.qy.setAttribute("dir","auto");var d=a.Sq;d?(c=d.replace(wac_HWb||(wac_HWb=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g),""),c=c.replace(wac_GWb||
(wac_GWb=/\s+/g)," "),d=c.trim(),(wac_IWb||(wac_IWb=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/)).test(d)||(wac_JWb||(wac_JWb=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i)).test(d)?c="":(c="",d=d.split(" "),2===d.length?(c+=d[0].charAt(0),c+=d[1].charAt(0)):3===d.length?(c+=d[0].charAt(0),c+=d[2].charAt(0)):0<d.length&&(c+=d[0].charAt(0)),c=c.toUpperCase())):
c="";!a.Jx&&c||b?(a=a.Sq,b||(a=c,wac_Ik(this.qy,"text-align","center")),wac_1c(this.qy,a)):(this.Kwa||(b=document.createElement("img"),b.setAttribute("src",wac_re("doughperson_white_glyph.svg")),b.setAttribute("Unselectable","on"),b.setAttribute("role","presentation"),this.Kwa=wac_Rma(this.bma,this.bma,null,null,wac_BXb,"",!1,"",this._element.ownerDocument,b)),this.qy.appendChild(this.Kwa),wac_Ik(this.qy,"text-align","start"))}},Jr:function(a){if(!this.Rh)return this.Ya("InteractivityChanged",new wac_SR(1,
a),null),!0;3===this.Rh&&wac_(50436114,302,50,"User clicked on presence pill.");return!1},Ada:function(a){3===this.Rh&&this.Ya("InteractivityChanged",new wac_SR(3,a),null);return!1},pSa:function(a){3!==a.af&&this.Ya("InteractivityChanged",new wac_SR(2,a),null);return!1},zO:function(a){if(3!==a.af)return!0;this.Ya("InteractivityChanged",new wac_SR(4,a),null);return!1},cra:function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];this.w4c=a.join(" ");Sys.UI.DomElement.addCssClass(this._element,
this.w4c)},xXc:function(a){3===a&&wac_Jk(this._element,"left")?(a=wac_Lk(this._element.style.left),wac_Ik(this._element,"left",""),this._element.style.right=-1*a+"px"):4===a&&wac_Jk(this._element,"right")&&(a=wac_Lk(this._element.style.right),wac_Ik(this._element,"right",""),this._element.style.left=-1*a+"px")}};function wac_pXb(a){return!a||1===a||2===a}
function wac_oXb(a){window.clearTimeout(a.B8c);a.JHa&&(Sys.UI.DomElement.removeCssClass(a.JHa,wac_wXb+" "+wac_yXb),Sys.UI.DomElement.addCssClass(a.JHa,wac_CXb),wac_Wa(300).CW(function(){a._element&&a._element.parentNode===a.JHa.parentNode&&a._element.parentNode.removeChild(a.JHa)}),wac_Ik(a._element,"z-index",""))}
function wac_xXb(a){a.B8c=window.setTimeout(function(){a._element&&(a.JHa=a._element.cloneNode(!0),a._element.parentNode.appendChild(a.JHa),a._element.style.zIndex=2,a.JHa.style.zIndex=1)},300)}function wac_6Wb(a,b){this.ei=a;this.rFb=b}wac_6Wb.prototype={ei:!1,rFb:!1,wKc:function(a,b,c,d){var e=1,f=Math.max(c,a-b);b>a-c&&(e=2,f=b<d?d-b:c);return new wac_XR(f,0,e,4)}};function wac_XR(a,b,c,d){this.n9a=a;this.EVd=b;this.S0c=c;this.oNc=d}wac_XR.prototype={n9a:0,EVd:0,S0c:0,oNc:0};
function wac_8Wb(a,b,c,d,e,f,g){this.i4=a;this._parent=b;this.K4c=c;this.E6d=d;this.$ce=e;this.f0a=f;this.g5=g;this.uf=document.createElement("div");this.uf.className="prTouchTarget"}
wac_8Wb.prototype={i4:null,_parent:null,g5:!1,K4c:0,E6d:0,$ce:0,f0a:0,uf:null,yo:function(a,b){if(3!==a)if(5!==a&&this.i4&&this.i4.length){var c,d;if(4===a)c=this.$ce,d=(this.f0a-c)/2,this.uf.style.height=this.f0a+"px",this.uf.style.width=this.f0a+"px",a=wac_Lk(this.i4[0]._element.style.top),b=wac_Lk(this.g5?this.i4[0]._element.style.right:this.i4[0]._element.style.left);else{c=this.K4c;d=(this.f0a-c)/2;this.uf.style.height=this.f0a+"px";this.uf.style.width=(this.i4&&this.i4.length?this.K4c+Math.min(this.i4.length-
1,2)*this.E6d:0)+2*d+"px";a=wac_Lk(this.i4[this.i4.length-1]._element.style.top);var e=this.i4[this.i4.length-1]._element,f=c;b=this.g5&&!b?wac_Lk(e.style.right):this.g5||b?this.g5&&b?-wac_Lk(e.style.left)-f:-wac_Lk(e.style.right)-f:wac_Lk(e.style.left)}wac_Ik(this.uf,"border-radius",this.f0a+"px");this.uf.style.top=a-d-c+"px";this.g5?this.uf.style.right=b-d+"px":this.uf.style.left=b-d+"px";this.uf.parentNode||this._parent.insertBefore(this.uf,this._parent.firstChild)}else this.uf.parentNode&&this.uf.parentNode.removeChild(this.uf)}};
function wac_DXb(a,b,c){this.tMa=Function.createDelegate(this,this.A9a);this.tj=[];this.vB=[];this.dispose=this.oa;wac_DXb.initializeBase(this,[a]);this.rGb={};this.md=c;this.ei=c.Pk(Boolean,8,!1);this.aX=c.Pk(Boolean,11,!1);a=c.Pk(Number,12,0);this.Zha=c.Pk(Number,6,0);this.Sya=b;this._element.id=String.format("{0}-{1}","presencetooltip",wac_EXb++);this._element.className="prControl"+(this.ei?"Rtl":"");a&&wac_RR(this,a);wac_5Wb(this,this.ei);this.nYc(b);this.y9=this.Pj("div");this.y9.className=this.aX?
"prContainerV":"prContainerHr";this._element.appendChild(this.y9);this.bO=Array(this.wna);for(b=0;b<this.wna;b++)this.bO[b]=new wac_FXb(this.Pj("div"),this.md),this.bO[b].iQb(this.tMa),this._element.appendChild(this.bO[b]._element)}
wac_DXb.prototype={y9:null,wna:0,ei:!1,Edb:!1,aX:!1,GNb:!1,Sya:0,md:null,rGb:null,rtc:function(){return wac_5d(this.tj)},bO:null,kyc:null,Zha:0,qU:function(){return this.aX?this.Zha+2:this.Sya},Lsc:function(){return this.aX?this.Sya:this.Zha+2},oa:function(){if(this.bO)for(var a=this.bO,b=a.length,c=0;c<b;++c){var d=a[c];d.xuc(this.tMa);wac_Lb(d)}wac_cca(this.vB);this.vB=this.bO=null;wac_QR.prototype.oa.call(this)},zTa:function(){this.Bsa();wac_GXb(this);this.$r(!0);this.Edb=!1},e$b:function(){!this.vB||
1>this.vB.length||(this.Bsa(),this.$r(!0),wac_GXb(this),wac_HXb(this,this.vB[this.vB.length-1],0),this.Edb=!0)},le:function(){this.$r(!1);this.Bsa();for(var a=0;a<this.vB.length;a++)this.vB[a].le();this.Edb=!1},WY:function(a){if(!(0>=this.wna)){a.El||(a.El=(wac_EXb++).toString());if(a.El in this.rGb){var b=this.jQa(a.El);if(0<=b){b=this.tj[b];if(b.$o===a.$o&&b.Sq===a.Sq)return;this.Kta(a.El)}}var b=wac_IXb(this),c,d=0;this.tj.length<this.wna?(c=new wac_JXb(this.Pj("div"),this.md,a),c.iQb(this.tMa),
this.ei&&!this.aX&&0<this.tj.length?this.y9.insertBefore(c._element,this.y9.firstChild):(this.y9.appendChild(c._element),d=this.vB.length),Array.add(this.vB,c)):(this.ei&&!this.aX?c=this.vB[0]:(d=this.vB.length-1,c=this.vB[d]),c.WY(a));c.ai();this.rGb[a.El]=c;Array.add(this.tj,a);this.bea(c,d);b&&wac_KXb(this)}},Kta:function(a){var b=wac_IXb(this);b&&this.Bsa();this.oyb(a);this.tj.length>=this.wna&&this.vB.length<this.wna&&wac_LXb(this);0>=this.tj.length?this.le():b&&wac_KXb(this)},oyb:function(a){var b=
this.jQa(a);0>b||(a=this.tj[b],Array.removeAt(this.tj,b),b=this.rGb[a.El],delete this.rGb[a.El],b.Kta(a.El),this.bea(b,0),0>=wac_ZR(b)&&(this.y9.removeChild(b._element),Array.remove(this.vB,b),b.oa()))},jQa:function(a){for(var b=0;b<this.tj.length;b++)if(this.tj[b].El===a)return b;return-1},Bsa:function(){for(var a=0;a<this.wna;a++)this.bO[a].le();this.GNb=!1},A9a:function(a,b){var c=window.$$as(wac_JXb,a),c=c?wac_MXb(this,c):-1;if(2===b.nd||1===b.nd&&-1!==c&&!this.bO[c].Iq())wac_HXb(this,a,0);else if(1===
b.nd)this.Bsa(),this.Edb=!1;else if(3===b.nd){if(this.TJc(b.Zzc))return;this.Edb||this.Bsa()}this.Ya("InteractivityChanged",b,null)},TJc:function(a){a=a.rb.rawEvent;a=a.relatedTarget||a.toElement;for(var b=!1,c=this.bO,d=c.length,e=0;e<d;++e)if(wac_0c(c[e]._element,a)){b=!0;break}return this.y9!==a&&wac_0c(this.y9,a)||b},bea:function(a,b){var c;c=wac_MXb(this,a);(c=!!this.kyc&&a===this.kyc&&-1!==c&&this.bO[c].Iq())&&0>=wac_ZR(a)?this.bO[b].le():c?wac_HXb(this,a,0):this.bO[b].le()},nYc:function(a){this.wna=
a===this.Zha?1:Math.floor(a/(this.Zha+2));this.aX?(this._element.style.height=a+"px",this._element.style.width=this.Zha+"px"):(this._element.style.width=a+"px",this._element.style.height=this.Zha+"px")}};function wac_MXb(a,b){var c=0;a=a.vB;for(var d=a.length,e=0;e<d;++e){if(b===a[e])return c;c++}return-1}
function wac_HXb(a,b,c){if(b)if(a.kyc=b,a.aX){var d=a.Zha;if(1<b.tj.length)a.bO[c].ai(b.tj,d,a.Lsc()-a.Zha);else for(var e=a.y9.children.length,f=0;f<a.y9.children.length;f++)b._element===a.y9.children[f]&&a.bO[c].ai(b.tj,d,a.Lsc()-(e-f)*(a.Zha+2)+2)}else a.bO[c].ai(b.tj,a.qU(),0)}function wac_GXb(a){for(var b=0;b<a.vB.length;b++)a.vB[b].ai()}
function wac_LXb(a){var b=a.ei&&!a.aX?a.vB[0]:a.vB[a.vB.length-1];!b||1>=b.tj.length||(b=Array.clone(a.tj),Array.forEach(b,function(b){a.oyb(b.El)}),Array.forEach(b,function(b){a.WY(b)}))}function wac_IXb(a){if(!a.GNb)return!1;for(var b=0,c=a.bO,d=c.length,e=0;e<d;++e)c[e].Iq()&&b++;a.GNb=0<b&&(a.tj.length<=a.wna?b===a.tj.length:b===a.wna);return a.GNb}
function wac_KXb(a){if(a.vB&&!(1>a.vB.length)){a.$r(!0);wac_GXb(a);for(var b=0,c=a.vB,d=c.length,e=0;e<d;++e)wac_HXb(a,c[e],b++);a.Edb=!1;a.GNb=!0}}function wac_NXb(a){this.md=a;wac_YR(this.md,10,wac_Vf());wac_YR(this.md,9,wac_Xf());wac_YR(this.md,6,16);wac_YR(this.md,13,wac_5f())}wac_NXb.prototype={md:null,OHc:function(a){return new wac_DXb(a,16,this.md)}};
function wac_FXb(a,b){this.CL=Function.createDelegate(this,this.Ada);this.Sl=Function.createDelegate(this,this.Jr);wac_FXb.initializeBase(this,[a]);this.g5=b.Pk(Boolean,8,!1);this.bma=b.Pk(Number,6,0);this._element=a;this._element.className=wac_OXb;this.Pqc=this.Pj("ul");this._element.appendChild(this.Pqc);this.kd=b.Pk(wac_Cda,10,null);this.kd.Sa("click",this._element,this.Sl);this.nk=b.Pk(wac_Ac,9,null);this.nk.Sa("msospPointerOut",this._element,this.CL);this.nk.Sa("msospPointerDown",this._element,
this.wY);this.Ut=b.Pk(wac_7i,13,null);this.Ut.Sa(this._element,this.wY)}
wac_FXb.prototype={kd:null,nk:null,Ut:null,Pqc:null,bma:0,g5:!1,iQb:function(a){this.hb("InteractivityChanged",a)},xuc:function(a){this.Uc("InteractivityChanged",a)},udf:null,oa:function(){this._element&&(this.kd.Nb("click",this._element,this.Sl),this.nk.Nb("msospPointerDown",this._element,this.wY),this.nk.Nb("msospPointerOut",this._element,this.CL),this.Ut.Nb(this._element,this.wY));wac_QR.prototype.oa.call(this)},le:function(){this.$r(!1)},ai:function(a,b,c){this.le();if(a&&!(0>=a.length)){this.g5?
this._element.style.right=b+"px":this._element.style.left=b+"px";this._element.style.top=c+"px";this.udf=a;wac__c(this.Pqc);for(b=a.length-1;0<=b;b--)this.WY(a[b]);this.$r(!0)}},WY:function(a){var b=document.createElement("li");b.style.backgroundColor=a.$o;b.style.height=this.bma+"px";b.id="fly_"+a.El;b.style.lineHeight=this.bma+"px";wac_1c(b,a.Sq);b.setAttribute("dir","auto");this.Pqc.appendChild(b)},Jr:function(){this.le();return!1},Ada:function(a){this.Ya("InteractivityChanged",new wac_SR(3,a),
null);return!1}};
function wac_JXb(a,b,c){this.Sl=Function.createDelegate(this,this.Jr);this.CL=Function.createDelegate(this,this.Ada);this.Mha=Function.createDelegate(this,this.pSa);this.tj=[];wac_JXb.initializeBase(this,[a]);this._element.className="prGlyph";this.md=b;this.CZa=this.md.Pk(wac_Ac,9,null);this.qm=this.md.Pk(wac_Cda,10,null);this.Ut=this.md.Pk(wac_7i,13,null);this._element&&(this.CZa.Sa("msospPointerDown",this._element,this.wY),this.CZa.Sa("msospPointerOver",this._element,this.Mha),this.CZa.Sa("msospPointerOut",
this._element,this.CL),this.qm.Sa("dblclick",this._element,this.wY),this.qm.Sa("click",this._element,this.Sl),this.Ut.Sa(this._element,this.wY));this.WY(c);this.eic=!1}
wac_JXb.prototype={Kwa:null,md:null,eic:!0,qm:null,CZa:null,Ut:null,iQb:function(a){this.hb("InteractivityChanged",a)},oa:function(){this._element&&(this.CZa.Nb("msospPointerDown",this._element,this.wY),this.CZa.Nb("msospPointerOver",this._element,this.Mha),this.CZa.Nb("msospPointerOut",this._element,this.CL),this.qm.Nb("dblclick",this._element,this.wY),this.qm.Nb("click",this._element,this.Sl),this.Ut.Nb(this._element,this.wY));wac_QR.prototype.oa.call(this)},WY:function(a){Array.add(this.tj,a);
2===wac_ZR(this)?this.TZ(!0):1===wac_ZR(this)?this.TZ(!1):this.TZ(this.eic)},Kta:function(a){var b;a:{for(b=0;b<wac_ZR(this);b++)if(this.tj[b].El===a){a=this.tj[b];Array.removeAt(this.tj,b);b=a;break a}b=null}b&&(1<wac_ZR(this)&&this.TZ(!0),1===wac_ZR(this)?this.TZ(!1):1>wac_ZR(this)&&this.le())},ai:function(){this.TZ(2<=wac_ZR(this));this.$r(!0)},le:function(){this.$r(!1)},TZ:function(a){this.eic!==a&&(this.Kwa&&this._element.removeChild(this.Kwa),this.Kwa=a?wac_PXb(this,0,5):wac_PXb(this,1,4),this._element.appendChild(this.Kwa),
this.eic=a);this.Kwa.childNodes[0].style.backgroundColor=this.tj[this.tj.length-1].$o},pSa:function(a){3!==a.af&&this.Ya("InteractivityChanged",new wac_SR(2,a),null);return!1},Jr:function(a){this.Ya("InteractivityChanged",new wac_SR(1,a),null);return!0},Ada:function(a){3!==a.af&&this.Ya("InteractivityChanged",new wac_SR(3,a),null);return!1}};
function wac_PXb(a,b,c){var d=a.md.Pk(Number,6,0),e=a.md.Pk(Object,14,null);return wac_Rma(d,d,a.md.Pk(String,b,null),a.md.Pk(String,c,null),"cui-img-cont-float cui-img-16by16","",!1,"",a._element.ownerDocument,e?e.cloneNode(!0):null)}function wac_ZR(a){return a.tj.length}function wac_QXb(){this.ov={}}
wac_QXb.prototype={Pk:function(a,b,c){a=wac_g.Aa.RCa.U9a.toString(b);return"number"===typeof c?(c=this.ov[a])?Number.parseInvariant(c.toString()):0:this.ov[a]},U:function(a,b,c){this.ov[wac_g.Aa.RCa.U9a.toString(b)]=c}};function wac_YR(a,b,c){wac_g.Aa.RCa.U9a.toString(b)in a.ov||(a.ov[wac_g.Aa.RCa.U9a.toString(b)]=c)}wac_QR.registerClass("Common.App.CollabControls.BasePresenceControl",wac_nd,Sys.IDisposable);wac_SR.registerClass("Common.App.CollabControls.InteractivityChangedEventArgs",Sys.EventArgs);
wac_TR.registerClass("Common.App.CollabControls.ModernPresenceTooltipControl",wac_QR,wac_3Wb,Sys.IDisposable);(function(){}).registerClass("Common.App.CollabControls.ModernPresenceTooltipDancingDots");wac_lXb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFactory",null,wac_4Wb);wac_aXb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFlyoutControl",wac_QR);wac_6Wb.registerClass("Common.App.CollabControls.ModernPresenceTooltipPositioner");wac_XR.registerClass("Common.App.CollabControls.FlyoutsPositioningInfo");
wac_8Wb.registerClass("Common.App.CollabControls.ModernPresenceTooltipTarget");wac_DXb.registerClass("Common.App.CollabControls.PresenceTooltipControl",wac_QR,wac_3Wb,Sys.IDisposable);wac_NXb.registerClass("Common.App.CollabControls.PresenceTooltipFactory",null,wac_4Wb);wac_FXb.registerClass("Common.App.CollabControls.PresenceTooltipFlyoutControl",wac_QR);wac_JXb.registerClass("Common.App.CollabControls.PresenceTooltipGlyph",wac_QR);wac_QXb.registerClass("Common.App.CollabControls.PresenceTooltipSettings");
var wac_7Wb=0,wac_hXb="http://www.w3.org/2000/svg",wac_iXb="prDancingDots",wac_kXb="prAnimateCircle",wac_nXb="0 0 {0} {1}",wac_gXb=40,wac_fXb=120,wac_mXb="prModernFlyout UIFont",wac_tXb="flyoutIdle",wac_qXb="flyoutExpanded",wac_sXb="flyoutCollapsed",wac_rXb="flyoutFromIdle",wac_uXb="flyoutFromExpanded",wac_wXb="flyoutFromCollapsed",wac_yXb="flyoutStacked",wac_vXb="flyoutFromStacked",wac_CXb="flyoutFadeOut",wac_BXb="cui-img-cont-float cui-img-20by20",wac_AXb="flyoutLtrDir",wac_zXb="flyoutRtlDir",wac_EXb=
0,wac_OXb="prFlyout UIFont";Type.registerNamespace("Common.App.RtcHostNotificationSubscription");wac_g=window.Common||{};wac_g.Aa=wac_g.Aa||{};wac_g.Aa.yka=wac_g.Aa.yka||{};
function wac_RXb(a,b,c,d,e,f,g,h){this.f$e=Function.createDelegate(this,this.XYf);this.u6e=Function.createDelegate(this,this.cYc);this.kmb=Function.createDelegate(this,this.QTc);this.uY=Function.createDelegate(this,this.k8);this.kZe=Function.createDelegate(this,this.LJf);this.dispose=this.oa;this.Y_a=wac_SXb;this.va=new wac_nd;this.KX=new wac_cva(0);this.KX.va.hb("c",this.kZe);this.Cqe=a;this.TMb=b;this.Bqe=c;this.Ua=d;this.Sg=e;var k=this;f.jb(function(a){k.yg||(k.yhb=a,k.yhb.ZX(k.uY),k.re())});
var l=this;g.jb(function(a){l.yg||(l.Cga=a,a.Yjb(l.kmb))});this.lqc=h}
wac_RXb.prototype={Cqe:0,TMb:0,Bqe:0,va:null,Ua:null,Sg:null,KX:null,lqc:null,Y_a:null,yg:!1,$Ja:null,PX:null,yhb:null,Cga:null,re:function(){this.KX.h1?wac_(573100178,500,15,"HostNotifications: Tried starting poll when in state {0}",wac_g.Aa.yka.m$a.toString(this.KX.h1)):(this.KX.Event(1,null),this.cYc(null))},cYc:function(){this.$Ja=null;!this.Sg||wac_Ch(this.Sg)?(wac_(573100181,500,50,"HostNotifications: Send event when connected.  Current state: {0}",wac_g.Aa.yka.m$a.toString(this.KX.h1)),this.yhb.RF(14,
null,!0),wac_TXb(this,this.Cqe)):this.KX.Event(3,null)},XYf:function(){this.PX=null;2===this.KX.h1&&(this.KX.Event(1,null),wac_c(573100185,500,!!this.PX,"Missing transition to polling task"))},QTc:function(){if(3===this.KX.h1&&(!this.Sg||wac_Ch(this.Sg))){var a=2===this.KX.h1&&this.lqc()<this.Y_a?2:1;this.KX.Event(a,null);this.cYc(null)}},k8:function(a,b){if(13===b.rg){var c=b.Tga;wac_(573100183,500,50,"HostNotifications: Subscription status: {0}",{SerializableHostNotificationSubscription:c,DurationBeforeExpirationToResubscribeInSec:this.TMb});
a=c.cts;!window.isNaN(a)&&window.isFinite(a)&&0<a?b=!1:(wac_UXb(this,!1),b=!0);if(!b){if(c.sb){b=2;var c=1E3*(c.cts+this.Bqe),d=this.lqc().getTime()+c;this.Y_a=new Date(d);c-=this.TMb;this.PX?this.Ua.ZR(this.PX,c):(this.PX=wac_xk(c,this.f$e,this.TMb/2,194,"RtcHostNotificationTransitionToPolling"),this.Ua.nc(this.PX))}else b=1,this.Y_a=wac_SXb,this.PX&&(this.Ua.gf(this.PX),this.PX=null);this.KX.Event(b,null);this.$Ja?this.Ua.ZR(this.$Ja,1E3*a):wac_TXb(this,a)}}},LJf:function(a,b){a=b.yt;var c=b.sYb,
d={};d.NewState=wac_g.Aa.yka.m$a.toString(a);d.PreviousState=wac_g.Aa.yka.m$a.toString(c);d.PreviousStateHits=b.tYb;d.PreviousStateTransitionTime=b.tId.toISOString();d.IsSubscribed=2===this.KX.h1&&this.lqc()<this.Y_a;this.Y_a!==wac_SXb&&(d.SubscriptionExpiringTime=this.Y_a.toISOString());wac_(572346515,500,4===a?15:50,"HostNotificationChanged: {0}",d);this.va.Ya("HN",new wac_Rza(c,a),null)},oa:function(){this.yg||(this.yg=!0,wac_UXb(this,!0),this.PX&&(this.Ua.gf(this.PX),this.PX=null))}};
function wac_UXb(a,b){a.$Ja&&(a.Ua.gf(a.$Ja),a.$Ja=null);a.PX&&(a.Ua.gf(a.PX),a.PX=null);a.yhb&&(a.yhb.jlb(a.uY),a.yhb=null);a.Cga&&(a.Cga.Duc(a.kmb),a.Cga=null);b||a.KX.Event(4,null)}function wac_TXb(a,b){a.$Ja=wac_xk(1E3*b,a.u6e,a.TMb,192,"RtcHostNotificationSubscribe");a.Ua.nc(a.$Ja)}function wac_VXb(){}
wac_VXb.prototype={yg:!1,Jg:!1,Zb:function(){return"RtcHostNotificationSubscription"},$b:function(a){wac_n(wac_o(wac_p(a.na(wac_RXb,null),wac_Qza)),function(){return new wac_RXb(wac_r.W.Xb("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),wac_r.W.Xb("RtcHostNotificationRetryIntervalBufferInSeconds",120),wac_r.W.Xb("RtcHostNotificationSubscriptionLostBufferInSeconds",60),wac_s(),wac_Bh(),wac_m(a,wac_$b),wac_m(a,wac_ac),function(){return new Date})})},zb:function(){var a=this;wac_ph(wac_r.W,
function(){!a.yg&&wac_r.W.ga("RtcHostNotificationEnabled")&&(a.Jg=!0,wac_k().H(wac_Qza,null))})},oa:function(){this.yg||(this.yg=!0,this.Jg&&wac_k().H(wac_RXb,null).oa())}};wac_RXb.registerClass("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager",null,wac_Qza,Sys.IDisposable);wac_VXb.registerClass("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionPackage",null,wac_J,wac_j);var wac_SXb=new Date(0);wac_K(wac_E(),new wac_VXb,0);Type.registerNamespace("RealtimePresenceUI");
function wac_WXb(){}wac_WXb.registerInterface("RealtimePresenceUI.IUserTracker");
function wac_XXb(a,b,c,d){this.ITe=Function.createDelegate(this,this.lDf);this.ypa=Function.createDelegate(this,this.SEa);this.nqc=new (wac_6a.$$(Number));this.dispose=this.oa;this.hp=a;this.zSa=b;if(c){var e=this;c.CW(function(){e.vI=c.rc();e.vI.va.hb("UU",e.ypa);wac_YXb(e)})}if(d){var f=this;d.CW(function(){f.cVa=d.rc();f.cVa.Ufg(f.ypa);wac_YXb(f)})}this.O1f=new wac_1k(this.hp.El,"Anonymous user","#cccccc",new wac_2k(7),null,null,null,null,!1,!1,!1,0,null,0);this.eob=this.Lic=!0;this.Hgc=this.lid=
!1;this.o3=wac_ZXb(this.hp.El,this.hp.E3a,a.BEd)}function wac__Xb(a,b){return a.Fv.M7(1)&&b.Fv.M7(1)||!a.Fv.M7(1)&&!b.Fv.M7(1)?a.Sq.localeCompare(b.Sq)-wac_gf:a.Fv.M7(1)?-1:1}
wac_XXb.prototype={O1f:null,Lic:!1,lid:!1,Hgc:!1,hp:null,o3:null,zSa:null,vI:null,cVa:null,eob:!1,tOc:function(){return 0<this.o3.L8.la()},K0c:function(a){wac_(4482395,325,50,"PeoplesWell: Received user button click");a=a.MenuItemId;if(!a)return!1;var b=this.hp.hWb(a);if(!wac_0Xb(this,a,b,!0))return!1;wac_1Xb(this,b);return!0},SEa:function(){if(!this.Hgc){var a=this;window.setTimeout(function(){wac_YXb(a);a.Hgc=!1},3E3);this.Hgc=!0}},lDf:function(a,b,c,d,e){wac_7a(this.nqc,e.RenderTime);return 32},
oa:function(){this.vI&&(this.vI.va.Uc("UU",this.ypa),this.vI=null);this.cVa&&(this.cVa.ggg(this.ypa),this.cVa=null)}};
function wac_YXb(a){if(!a.lid&&(wac_7a(a.nqc,(new Date).getTime()),wac_(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),wac_2Xb()))return;var b;if(a.vI){b=[];for(var c=wac_PR(a.vI),d=c.length,e=0;e<d;++e){var f=c[e];f.Sq?b.push(f):wac_(592229832,304,15,"The looked up RTC User has no name")}}else b=[];b=b||[];c=b.length;for(d=0;d<c;++d)e=b[d],e.mi()||(f=wac_td().toString(),e.El=f),e.Sq||wac_3ua(e,"Anonymous user"),e.Fv||(e.Fv=new wac_2k(0)),
e.fU()||e.Quc("#cccccc"),e.gba||(e.gba=0);c=a.o3;c.L8=new (wac_Ia.$$(Array));d=b.length;for(e=0;e<d;++e)if(f=b[e],f.mi()===c.dM){c.DIc=f;break}d=b.length;for(e=0;e<d;++e)f=b[e],f.mi()!==c.dM&&c.xLd(f);a.eob&&1<=a.o3.L8.la()&&(wac_(6092429,325,50,"PeoplesWell: User is no longer forever alone."),a.eob=!1);a.Lic=!0;wac_2Xb()&&a.eob?wac_qwa("ribbon","coauthorGallery","unused",!1):(wac_Pl("ribbon","coauthorGallery",!1),wac_Ol("ribbon","coauthorGallery",!1),a.tpe(a.hp.ia()))}
function wac_3Xb(){var a=wac_4Xb;wac_r.W.ga("CoauthorGalleryTelemetryIsEnabled")&&wac_z().ta(691867605,2147483648,a.ITe);a.ha.ta(a.hp.md.LCd,1,a.wQe);wac_C(a.ha,a.hp.md.PCd,1,a.v3e,96);wac_C(a.ha,a.hp.md.NCd,1,a.vEe,96);wac_C(a.ha,a.hp.md.MCd,1,a.uEe,96);wac_C(a.ha,a.hp.md.OCd,1,a.G0e,96);a.ha.ta(a.hp.md.hyc,1,a.Aaf);wac_C(a.ha,a.hp.md.QCd,1,a.t0e,96);a.lid=!0;wac_YXb(a)}function wac_5Xb(){return wac_r.W&&wac_r.W.ga("ColorPresenceHashIsEnabled")?"Initials":"Menu32"}
function wac_6Xb(){var a;return a=new wac_bf,a.Id="BasicChat",a.Command="2288458806",a.LabelText=CommonUIStrings.l_StartGroupChat,a.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",a}
function wac_7Xb(a,b){if(!b.Fv.M7(1))return b.Hv?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;var c=b.Hv,d=a.hp.E3a(b.mi());b=a.hp.hWb(b.mi());if(!d)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(d.ud){case 1:var e;if(b){if(c)a=CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline;else{var f,g;a=((g=wac_8Xb(a,b,f={val:e}),e=f.val,g)&&e.Nf&&e.Nf.yba&&"0"!==e.Nf.yba?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,
e.Nf.yba):CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}e=a}else e=CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;return e;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}
function wac_0Xb(a,b,c,d){if(!c)return d&&wac_(4482393,325,50,"User does not have any presence data"),!1;if(wac_9Xb(a,c)){var e,f,g;(g=wac_8Xb(a,c,f={val:e}),e=f.val,g)&&a.T5d(e.Jm().LG(),e.Jm().UL.Lf())?c=!0:(wac_(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),c=!1)}else wac_(41236612,325,50,"Cannot jump to user location because presence is not valid"),c=!1;return c?(a=a.hp.E3a(b))&&2===a.ud?!1:!0:(d&&wac_(4482394,325,50,"User has presence data but app can't use it"),
!1)}function wac_2Xb(){return wac_r.W?wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled"):!1}function wac_$Xb(a,b,c,d,e){this.md=a;this.El=b;this.BEd=e;this.hWb=c||function(){return null};this.E3a=d||function(){return null}}function wac_aYb(a,b,c,d){var e=wac_r.W.ga("WordEditorPresenceDedupeMultipleCoauthorInstances");return new wac_$Xb(a,b,c,d,e)}
wac_$Xb.prototype={md:null,ia:function(){return this.md.Db},zze:function(){return this.md.yJd},lsd:function(){return this.md.zJd},bze:function(){return this.md.AHd},El:null,hWb:null,E3a:null,BEd:!1};function wac_bYb(a){this.L8=new (wac_Ia.$$(Array));this.dM=a}wac_bYb.prototype={dM:null,DIc:null};function wac_cYb(a,b,c){b=b.toUpperCase();var d,e,f;(f=a.L8.Sb(b,e={val:d},null),d=e.val,f)||(d=[],a.L8.ea(b,d));Array.add(d,c)}
function wac_dYb(a){for(var b=[],c=a.L8.Zj().$$ge();c.$$mn();){var d=c.$$cu(),d=a.KZd(d);Array.add(b,d)}return b}function wac_ZXb(a,b,c){return c?new wac_eYb(a,b):new wac_fYb(a)}function wac_eYb(a,b){wac_eYb.initializeBase(this,[a]);this.xbe=b}
wac_eYb.prototype={xbe:null,xLd:function(a){a.Jx||!a.Ix?wac_cYb(this,a.mi(),a):this.DIc&&wac_pa().Ca(this.DIc.Ix,a.Ix)||wac_cYb(this,a.Ix,a)},KZd:function(a){for(var b=new Date(0),c=0<a.length?a[0]:null,d=a.length,e=0;e<d;++e){var f=a[e],g=this.xbe(f.El);g&&b.getTime()<g.JRa.getTime()&&(b=g.JRa,c=f)}return c}};function wac_fYb(a){wac_fYb.initializeBase(this,[a])}wac_fYb.prototype={xLd:function(a){wac_cYb(this,a.mi(),a)},KZd:function(a){return a[0]}};
wac_XXb.registerClass("RealtimePresenceUI.APeoplesWell",null,wac_9b,Sys.IDisposable);wac_$Xb.registerClass("RealtimePresenceUI.PeoplesWellSettings");wac_bYb.registerClass("RealtimePresenceUI.UserTracker",null,wac_WXb);(function(){}).registerClass("RealtimePresenceUI.UserTrackerFactory");wac_eYb.registerClass("RealtimePresenceUI.UniqueUserTracker",wac_bYb);wac_fYb.registerClass("RealtimePresenceUI.UserInstanceTracker",wac_bYb);Type.registerNamespace("AppRealtimeChannel");
wac_cm=window.AppRealtimeChannel||{};function wac_gYb(){}wac_gYb.registerInterface("AppRealtimeChannel.IConnectedUsageKpiLogger");window.AppRealtimeChannel.ApiType=wac_cm.Fqb=function(){};wac_cm.Fqb.prototype={SendNotification:0,SendPersistentState:1,FindSession:2,Last:3};window.AppRealtimeChannel.ApiType.registerEnum("AppRealtimeChannel.ApiType",!1);window.AppRealtimeChannel.EventCountType=wac_cm.eqf=function(){};
wac_cm.eqf.prototype={AttemptCount:0,SuccessCount:1,DropCount:2,FailedCount:3,LatencyOverThresholdCount:4,LatencyUnderThresholdCount:5,ThrottledCount:6,Last:7};window.AppRealtimeChannel.EventCountType.registerEnum("AppRealtimeChannel.EventCountType",!1);function wac_hYb(){}wac_hYb.registerInterface("AppRealtimeChannel.IAssignRtcMachineStrategy");function wac_iYb(){}wac_iYb.registerInterface("AppRealtimeChannel.IRealtimeChannel");function wac_jYb(){}wac_jYb.registerInterface("AppRealtimeChannel.IRealtimeChannelMetrics");
function wac_kYb(){}wac_kYb.registerInterface("AppRealtimeChannel.IRealtimeChannelClientProxy");function wac_lYb(){}wac_lYb.registerInterface("AppRealtimeChannel.IRealtimeChannelServerProxy");function wac_mYb(){}wac_mYb.registerInterface("AppRealtimeChannel.IRealtimeChannelEventHub");function wac_nYb(){}wac_nYb.registerInterface("AppRealtimeChannel.IRealtimeChannelSettings");function wac_oYb(){}wac_oYb.registerInterface("AppRealtimeChannel.IMessageStatus");function wac_pYb(){}wac_pYb.registerInterface("AppRealtimeChannel.IMessageHandler");
function wac_qYb(){}wac_qYb.registerInterface("AppRealtimeChannel.IThrottle");function wac_rYb(){}wac_rYb.registerInterface("AppRealtimeChannel.IThrottleMaxRate");function wac_sYb(){}wac_sYb.registerInterface("AppRealtimeChannel.IMaxOutstandingThrottler");function wac_tYb(){}wac_tYb.registerInterface("AppRealtimeChannel.IThrottlerFactory");function wac_uYb(){}wac_uYb.registerInterface("AppRealtimeChannel.IThrottlerManager");
function wac_vYb(a){this.ZXe=Function.createDelegate(this,this.gIf);this.c_e=Function.createDelegate(this,this.pKf);this.sPe=Function.createDelegate(this,this.wwf);this.u2a=Function.createDelegate(this,this.G2);this.Iu=a;this.Iu.aha(this.u2a)}wac_vYb.prototype={Iu:null,$ib:null,zia:0,v3a:!1,G2:function(a,b){this.zia=b.yt},pKf:function(){wac_(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");wac_wYb(this.Iu,null)},wwf:function(a){this.$ib.zb(a)}};
function wac_xYb(a){this.pRe=Function.createDelegate(this,this.Qzf);this.yOa=wac_yYb;this.WMa=wac_zYb;this.dHd=this.pRe;this.Qp=a}function wac_yYb(a,b){return window.setTimeout(a,b)}function wac_zYb(a){window.clearTimeout(a)}wac_xYb.prototype={H$:!1,n0a:0,c5c:!1,Qp:null,yOa:null,WMa:null,dHd:null,Qzf:function(){wac_(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Qp)},V1:function(){this.H$&&this.WMa(this.n0a);this.n0a=0;this.H$=!1}};
function wac_AYb(a){a.V1();a.c5c||(a.c5c=!0,a.dHd())}function wac_BYb(a){a.H$||(a.n0a=a.yOa(function(){a.H$=!1;wac_AYb(a)},8E3),a.H$=!0,a.c5c=!1)}function wac_CYb(){}wac_CYb.prototype={oHd:0,nHd:0,mHd:0,oFd:0,bXb:!1,Wpa:null,mzc:null,ZBa:null,ZN:null,mD:null};
function wac__R(a,b,c,d,e,f,g,h,k,l,m,n,p){this.b4e=Function.createDelegate(this,this.vQf);this.u2a=Function.createDelegate(this,this.G2);this.n5e=Function.createDelegate(this,this.DRf);this.rhe=(new Date(0)).getTime();this.t4f="enabled errorMessage url connectionString queryString throttling_globalMaxNumberOfOutstandingMessages throttling_maxNumberOfOutstandingMessages throttling_timeToWaitForResponse throttling_messageDelay".split(" ");this.s4f=["enabled","errorMessage"];this.S8c=new wac_DYb(m?
m:function(){return wac_r.Gk},e,f,g,a,b);this.B5a=n;this.yc=d;this.Ad=b;this.oFb=c;this.Qp=h;this.Iu=k;this.vdb=p;this.T8c=!1;this.oNa=9E4;if(l){var q=this;l.jb(function(a){a.Yjb(function(){wac_(40768456,500,50,"Connection parameters refresh requested for client [{0}]",q.Qp);var a=q.S8c;a.kga=a.ljd()})})}2>=100*Math.random()&&(this.zWc=3E5);wac_0R&&(wac_0R.QEd=this.zWc)}function wac_EYb(a,b,c,d,e,f,g,h,k,l,m){a=a||wac_td().toString();a=new wac__R(a,b,c,d,e,1,f,g,h,k,null,l,m);a.zb();return a}
wac__R.prototype={S8c:null,oFb:null,Ad:null,pje:0,Xjc:!1,yc:null,Iu:null,Qp:null,Jre:null,zWc:36E5,T$d:0,kcb:1E3,$Eb:0,vdb:null,T8c:!1,oOa:null,zia:0,jEd:null,Y4a:null,B5a:null,gHd:null,vRb:function(){return this.gHd},ZN:null,oNa:0,zb:function(){this.Iu.va.hb("RMID",this.n5e);this.Iu.aha(this.u2a)},G2:function(a,b){this.zia=b.yt;2===b.yt&&(this.$Eb=0)},vQf:function(){this.Xjc=!1;var a=this,b=this;this.v2b(function(b){var d=a.jEd!==b.ZBa,e=a.ZN!==b.ZN,f=a.ZN;wac_FYb(a,b);a.zia&&(e?(wac_(17956955,500,
15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",f||"null",b.ZN),wac_wYb(a.Iu,null)):(a.Iu.va.Ya("SPC",new wac_GYb(d,e),null),wac_HYb(a)))},function(){wac_0R&&wac_1R(wac_0R,2,3);wac_HYb(b)},!0)},DRf:function(){this.kcb=1E3},v2b:function(a,b,c){var d=null;wac_(4317445,500,50,"Getting MachineId from server for [{0}]",this.Qp);var e={},f=wac_IYb(this.S8c);e["X-CorrelationId"]=wac_td().toString();this.Y4a&&""!==this.Y4a?f=String.format("{0}&{1}={2}",f,"rr",this.Y4a):this.B5a&&
""!==this.B5a&&(f=String.format("{0}&{1}={2}",f,"rr",this.B5a),e["RTC-TokenProofkey"]="True",e["RTC-IsWacJsBootFsRequest"]="True");f=this.oFb+"?"+f;c&&(e.FSType="polling");var g={};g.IsNetworkOfflineBeforeSendRequest=!!this.Ad.Sg.gs;g.HasAvailableConnectionsBeforeSendRequest=wac_Ioa(this.Ad);g.MaxConnectionsAllowed=this.Ad.r4a;g.IsRefreshMachineId=c;if(this.vdb&&!this.T8c)wac_JYb(this,wac_KYb(this,null,g,a,b,c),wac_LYb(this,null,g,b,c)),this.T8c=!0;else if(this.yc&&(d=this.yc.Ze("WebServiceCall",
"GetMachineIdFromTheServer")),wac_0R&&wac_1R(wac_0R,2,0),wac_2R(0,0,!1),0>wac_Hi(this.Ad,f,1,null,e,["RtcErrorCode","X-OfficeCluster"],1,wac_KYb(this,d,g,a,b,c),wac_LYb(this,d,g,b,c),null,this.oNa,"3",!0,null,null)){5<this.$Eb&&200>this.$Eb&&wac_(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.$Eb);var h=this;window.setTimeout(function(){h.$Eb++;b("-1")},1E3)}}};
function wac_MYb(a,b,c){b||(b={});b.ConnectionState=wac_g.H_b.toString(a.zia);c||a.Iu.va.Ya("RCF",new wac_NYb(1,b),null)}
function wac_OYb(a,b,c,d){d||(d={});d.IsNetworkOfflineAfterRequestComplete=!!a.Ad.Sg.gs;d.IsRequestSucceeded=c;b&&(d.EnqueueTime=b.y7,d.InvokedTime=b.bC,d.CompletedTime=b.nO,b.Hj&&("X-CorrelationId"in b.Hj&&(d.CorrelationId=b.Hj["X-CorrelationId"]),"X-OfficeCluster"in b.Hj&&(d["X-OfficeCluster"]=b.Hj["X-OfficeCluster"])));(b=!c||40>a.T$d)&&a.T$d++;wac_(38633565,500,b?15:50,wac_3R(d))}
function wac_LYb(a,b,c,d,e){return function(f){wac_2R(0,1,!1);b&&b.hd();a.Y4a=null;a.B5a=null;wac_OYb(a,f.Ea,!1,c);var g=null,h="unknown",k="unknown";f.Ea&&((h=f.Ea.Hj)&&"RtcErrorCode"in h&&(g=h.RtcErrorCode.toString()),h=wac_g.uka.toString(f.Ea.ud),k=f.Ea.If.toString());c.FindSessionFailureReason="FindSessionRequestFailed";c.HttpErrorCode=k;c.HttpErrorStatus=h;c.RtcErrorCode=g;wac_(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
h,k,a.Qp,g,e);wac_MYb(a,c,e);d(k)}}
function wac_KYb(a,b,c,d,e,f){return function(g){wac_2R(0,1,!1);b&&b.hd();a.Y4a=null;a.B5a=null;wac_OYb(a,g.Ea,!0,c);if(g=wac_PYb(g.Ea.ae,"FindSession",null,!0)){var h;if(Object.getType(g)!==Object)h=null;else{for(var k in g);b:if("enabled"in g){for(var l=(k=g.enabled)?a.t4f:a.s4f,m=l.length,n=0;n<m;++n)if(!(l[n]in g)){h=null;break b}l=(h=new wac_CYb,h.bXb=g.enabled,h.Wpa=g.errorMessage,h.mD=wac_td().toString(),h);k&&(l.mzc=g.url,l.ZBa=g.queryString,l.ZN=g.connectionString,l.oFd=g.throttling_globalMaxNumberOfOutstandingMessages,
l.mHd=g.throttling_maxNumberOfOutstandingMessages,l.nHd=g.throttling_timeToWaitForResponse,l.oHd=g.throttling_messageDelay);h=l}else h=null}if(h){if(h.bXb&&h.ZBa&&h.ZN){wac_(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",a.Qp);d(h);return}c.FindSessionFailureReason="FindSessionInvalidResponse";c.IsRtcEnabled=h.bXb;c.IsQueryStringEmpty=!h.ZBa;c.IsConnectionStringEmpty=!h.ZN;wac_(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
a.Qp,h.bXb,!h.ZBa,!h.ZN)}else c.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",wac_(8745097,500,15,"Could not translate server response to findSession response for [{0}]",a.Qp)}else c.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",wac_(7372827,500,10,"Could not deserialize response data for [{0}]",a.Qp);wac_MYb(a,c,f);e(null)}}
function wac_JYb(a,b,c){wac_(50448152,500,50,"Using FindSessionUtils find session response");a.vdb.Jfc.Yc.CW(function(){a.vdb.Jfc.Yc.rc()?(wac_(50448153,500,50,"FindSessionUtils find Session resulted in success"),b(a.vdb.bWb)):(wac_(50448154,500,15,"FindSessionUtils find Session resulted in error"),c(a.vdb.bWb))})}function wac_QYb(a){a.Xjc&&(window.clearTimeout(a.pje),a.Xjc=!1)}function wac_HYb(a){wac_QYb(a);a.Xjc=!0;a.pje=window.setTimeout(a.b4e,a.zWc)}
function wac_FYb(a,b){try{a.oOa=b,a.gHd=b.mzc+"?"+b.ZBa,a.ZN=b.ZN,a.jEd=b.ZBa,a.Jre=b.mzc}catch(c){wac_(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",c.toString())}}function wac_RYb(a){var b=(new Date).getTime();a=a.rhe+a.kcb-b;0>a&&(a=0);return a}
function wac_SYb(a,b,c,d,e){wac_(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",a.ZN);if(a.ZN)b();else{var f=wac_RYb(a);window.setTimeout(function(){a.sendFindSessionRequestToServerInternal(b,c,d,e)},f)}}
function wac_TYb(a,b,c,d,e,f){wac_SYb(a,function(){e(f,"GetMachineIdSuccess")&&(wac_(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",a.ZN,a.Qp),b(a.Jre),d(new wac_UYb(a.oOa.oHd,a.oOa.nHd,a.oOa.mHd,a.oOa.oFd)))},function(b){e(f,"GetMachineIdFailure")&&(wac_(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",a.Qp),c(b))},e,f)}function wac_VYb(a,b){b.val=a.oOa.mD;return String.format("{0}&{1}={2}",a.oOa.ZBa,"corrid",wac_qf(b.val))}
wac__R.prototype.Sbg=function(a,b,c,d){if(c(d,"RequestMachineId")){this.rhe=(new Date).getTime();c=wac_Di();var e=this,f=this;this.v2b(function(b){var c=wac_Di();wac_FYb(e,b);wac_HYb(e);a();b=wac_Di()-c;wac_(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",b)},function(a){var c=wac_Di();f.ZN=null;wac_QYb(f);wac_0R&&wac_1R(wac_0R,2,3);b(a);a=wac_Di()-c;wac_(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",a)},!1);c=wac_Di()-c;wac_(577599296,345,50,"SFSRTS - TimeElapsed: {0}",c)}};
wac__R.prototype.sendFindSessionRequestToServerInternal=wac__R.prototype.Sbg;
function wac_DYb(a,b,c,d,e,f){this.ljd=a;a=String.format("{0}={1}","ClientId",wac_qf(d));a=String.format("{0}&{1}={2}",a,"usid",wac_qf(e));a=String.format("{0}&{1}={2}",a,"UserApp",wac_qf(c.toString()));a=String.format("{0}&{1}={2}",a,"UserType",wac_qf((1).toString()));a=String.format("{0}&{1}={2}",a,"UserVersion",wac_qf(b));a=String.format("{0}&{1}={2}",a,"clientProtocol",wac_qf("1.0"));(b=4===c?String.format("{0}={1}","NoAuth","1"):f?wac_Soa():null)&&(a=String.format("{0}&{1}",a,b));this.W6d=a}
wac_DYb.prototype={kga:null,ljd:null,W6d:null};function wac_IYb(a){a.kga&&""!==a.kga||(a.kga=a.ljd(),wac_(575784194,500,a.kga&&""!==a.kga?50:15,"Query signature delegate called for refresh returned: {0} ",a.kga));var b=String.format("{0}={1}","qs",wac_qf(a.kga));return String.format("{0}&{1}",b,a.W6d)}
function wac_WYb(a){this.mRe=Function.createDelegate(this,this.IUd);this.Ad=a;this.Gs=Array(3);for(a=0;3>a;a++){this.Gs[a]=Array(7);for(var b=0;7>b;b++)this.Gs[a][b]=0}this.ZVb=this.$8c=this.nkc=!1;this.Rfb=0}
wac_WYb.prototype={ZVb:!1,aFd:null,iEd:null,QEd:0,Gs:null,Ad:null,nkc:!1,$8c:!1,Ged:0,mje:0,Rfb:0,IUd:function(){if(this.nkc){this.Rfb++;if((new Date).getTime()-this.Ged<5E3+this.mje){for(var a={},b=0;3>b;b++)for(var c=0;7>c;c++)if(2!==b||3===c||!c){var d=window.AppRealtimeChannel.ApiType.toString(b)+window.AppRealtimeChannel.EventCountType.toString(c);a[d]=this.Gs[b][c]}a.FSDomain=this.aFd;a.ConnectionDomain=this.iEd;a.FSRetryInterval=this.QEd;a.LogNumber=this.Rfb;1===this.Rfb&&(b=wac_XYb().Ifc.toString(),
a.FSLatencies=b,b=wac_XYb().aDb.toString(),a.ConLatencies=b);a=wac_Ll(a);wac_(50644352,500,15,a)}this.Ged=(new Date).getTime();for(a=0;3>a;a++)for(b=0;7>b;b++)this.Gs[a][b]=0;this.nkc=!1}}};function wac_1R(a,b,c){2!==b&&!a.$8c||a.ZVb||!window.navigator.onLine||a.Ad.Sg.gs||(a.Gs[b][c]++,a.nkc=!0)}function wac_YYb(a,b){a.mje=b;window.setInterval(a.mRe,b);a.Ged=(new Date).getTime()}
function wac_ZYb(a,b,c,d,e,f,g,h,k,l,m,n){this.aEe=Function.createDelegate(this,this.ahf);this.T8e=Function.createDelegate(this,this.w0d);this.zCd=Function.createDelegate(this,this.t2d);this.PUe=Function.createDelegate(this,this.WVd);this.LEe=Function.createDelegate(this,this.gif);this.$Ye=Function.createDelegate(this,this.zJf);this.ZYe=Function.createDelegate(this,this.yJf);this.eZe=Function.createDelegate(this,this.FJf);this.D$e=Function.createDelegate(this,this.CZf);this.n_e=Function.createDelegate(this,
this.BKf);this.o_e=Function.createDelegate(this,this.CKf);this.WJe=Function.createDelegate(this,this.i1b);this.QP=new (wac_Ia.$$(wac_Ea.$$(wac_cm.Fxb,wac__Yb)));this.udd=(new Date(0)).getTime();this._clientId=a;this.hPb=b;this.BS=0;this.yc=d;this.fdc=h;this.j_a=g;this.QB=k;this.V6d=e;this.sGa=f;this.Qp=c;this.Gs=l;this.md=m;this.Ad=n;this.xJd=1>100*Math.random()}function wac_0Yb(a,b,c,d,e,f,g,h,k){return wac_1Yb(a,b,c,k,d,e,f,g,h)}
wac_ZYb.prototype={_clientId:null,Tmd:!1,l_:null,BS:0,md:null,vRb:function(){return this.sGa.vRb()},V6d:null,dDb:1,k_:null,hPb:null,yc:null,ete:0,fdc:null,sGa:null,j_a:null,Qp:null,Gs:null,Ad:null,QB:null,zb:function(){this.QB.va.hb("RC",this.WJe);this.QB.va.hb("UPSR",this.o_e);this.QB.va.hb("UPSC",this.n_e);wac_wi(this.Ad,this.Gs);var a=this;wac_Kg(function(){a.Gs.fYd();wac_0R&&wac_0R.IUd()});wac_2Yb(this);wac_3Yb();this.QB.va.hb("SPC",this.D$e)},t2d:function(a,b){return a!==this.dDb?(wac_(4309017,
500,50,"ConnectionToken verification failed for {0}",b),!1):!0},q0b:function(){if(2!==this.BS&&1!==this.BS){wac_(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Qp);wac_BYb(this.fdc);var a=wac_XYb();a.Rid=a.qAc();this.G2(1,this.BS);this.w0d()}},w0d:function(){var a=this.dDb;this.Tmd=!1;this.Gs.YXd();wac_TYb(this.sGa,this.LEe,this.PUe,this.j_a.sPe,this.zCd,a)},WVd:function(a){this.Gs.$Xd();var b=null;!a||"documentsessiondeleted"!==(b=a.toLowerCase())&&"documentsessionexpired"!==
b?this.i1b(null,null):(wac_(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Qp,a),this.R6a())},i1b:function(a,b){wac_(4309018,500,50,"Disconnecting the connection [{0}]",this.l_);a=(a=2===this.BS||1===this.BS)&&!this.j_a.v3a;var c=!0,d=0;b&&Object.getType(b)!==Object.getType(Sys.EventArgs.Empty)&&b.AYb&&""!==b.AYb&&(a=!0,this.sGa.Y4a=b.AYb,c=b.hJd,d=b.PCc);a&&this.G2(1,this.BS);++this.dDb;this.j_a.lW();wac_4Yb(this,
c);b=this.sGa;b.ZN=null;wac_QYb(b);b.kcb+=3E3;b.kcb=Math.min(b.kcb,3E5);wac_2Yb(this);a&&window.setTimeout(this.T8e,Math.min(d,3E4))},CZf:function(){var a=null,b,c,d=(c=wac_VYb(this.sGa,b={val:a}),a=b.val,c);this.k_.qs=d;wac_(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Qp,a)},gif:function(a){this.udd=(new Date).getTime();var b=null,c,d;this.k_.qs=(d=wac_VYb(this.sGa,c={val:b}),b=c.val,d);this.md.ryc&&(this.k_.url=a,wac_0R&&(wac_0R.iEd=wac_Qg(a)));
var e=null;this.yc&&(e=this.yc.Ze("WebServiceCall","ConnectToServer"));wac_(3290048,500,50,"Connecting to server for client [{0}]",this.Qp);a={};this.hPb&&(a.transport=1===this.hPb.length?this.hPb[0]:this.hPb);a.pingInterval=null;wac_2R(1,0,!1);var f=this,g=this;this.k_.start(a,null).done(function(a){f.Gs.aYd();wac_2R(1,1,!0);wac_(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",a.id,b)}).fail(function(a){wac_(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",
g.sGa.ZN,b,wac_3R(a),g.Qp);g.WVd(null);g.Gs.ZXd(a);wac_2R(1,1,!1);a={CorrelationId:b,ErrorDetails:a,ConnectionState:wac_g.H_b.toString(g.BS)};g.QB.va.Ya("RCF",new wac_NYb(0,a),null)}).always(function(){e&&e.hd();wac_0R&&(wac_0R.ZVb=!1)})},R6a:function(){this.BS?(this.Gs.bYd(),wac_0R&&(wac_0R.ZVb=!0),wac_(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Qp),this.j_a.v3a=!0,this.fdc.V1(),this.G2(0,this.BS),this.i1b(null,null),this.j_a.v3a=!1):wac_(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",
this.Qp)},Eoa:function(){return this.BS},aha:function(a){this.QB.aha(a)},TSb:function(a){this.QB.TSb(a)},VZd:function(a){return this.Uyb(0,a)},Uyb:function(a,b){var c=new (wac_6a.$$(Object));this.QB.va.Ya("SP",new wac_5Yb(a,b,c),null);return c.Yc},mLa:function(a){this.QB.mLa(a)},Y1a:function(a){this.QB.Y1a(a)},dsc:function(a){this.QB.dsc(a)},Fuc:function(a){this.QB.Fuc(a)},csc:function(a){this.QB.csc(a)},Euc:function(a){this.QB.Euc(a)},juf:function(a){return this.QP.Xa(a)&&this.QP.B(a).Xa(0)?this.QP.B(a).B(0).hNa:
null},m7a:function(){return this.eLc(0)},eLc:function(a){for(var b={},c=this.QP.GetEnumerator();c.$$mn();){var d=c.$$cu();d.qa().Xa(a)&&(b[d.Kd()]=d.qa().B(a).hNa)}return b},CKf:function(a,b){for(a=b.AKd.GetEnumerator();a.$$mn();){var c=a.$$cu();this.QP.Xa(c.Kd())||this.QP.ea(c.Kd(),new (wac_Ea.$$(wac_cm.Fxb,wac__Yb)));var d=c.qa();this.QP.B(c.Kd()).ea(b.nd,new wac__Yb(d.Presence,new Date(d.TimeStamp)));c.Kd()!==this._clientId||b.nd||this.QB.va.Ya("MPU",new wac_Ama(d.Presence),null)}},BKf:function(a,
b){a=b.X2a;b=a.length;for(var c=0;c<b;++c)this.QP.Ab(a[c])},RF:function(a,b,c){var d=new (wac_6a.$$(Object));this.QB.va.Ya("SUN",new wac_6Yb(a,b,c,d),null);return d.Yc},ZX:function(a){this.QB.ZX(a)},jlb:function(a){this.QB.jlb(a)},hRd:function(a){var b,c,d,e,f,g;(e=this.QP.Sb(a,d={val:b},null),b=d.val,e)&&(g=b.Sb(0,f={val:c},null),c=f.val,g)?(a=(a=c)&&a.F1?(new Date).getTime()-a.F1.getTime()>(this.md.Jyc?6E4:this.md.Iyc)?2:1:1,c=new wac_Dma(a,c.F1)):c=null;return c},stb:function(){for(var a={},b=
this.QP.GetEnumerator();b.$$mn();){var c=b.$$cu(),d,e,f;if(f=c.qa().Sb(0,e={val:d},null),d=e.val,f)a[c.Kd()]=this.hRd(c.Kd())}return a},mi:function(){return this._clientId},xJd:!1,G2:function(a,b){if((1!==this.BS||b||1!==a)&&this.BS!==b){var c=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.BS,b,a]));wac_(3290053,500,10,c)}if(this.BS!==a){switch(a){case 2:wac_0R&&(wac_0R.$8c=!0);this.l_=this.k_.id;
wac_(3249539,500,50,"Established connection [{0}] for client [{1}]",this.l_,this.Qp);if((c=this.k_)&&c.transport&&c.transport.name){var c=c.transport.name,d=c.toLowerCase();"websockets"===d?wac_(4290723,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"serversentevents"===d?wac_(4290752,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"foreverframe"===d?wac_(4290753,500,50,"Transport name - {0} for [{1}]",c,this.Qp):"longpolling"===d?wac_(4290754,500,50,"Transport name - {0} for [{1}]",c,this.Qp):
"mocktransport"!==d&&wac_(4290755,500,15,"Unknown transport protocol encountered - '{0}'",c)}else wac_(4290722,500,10,"Transport protocol name is missing");wac_(4298369,500,50,"Retrieving complete session state");c=null;this.yc&&(c=this.yc.Ze("WebServiceCall","Receive First Presence"));var d=this.QB,e=this.zCd,f=this.dDb,g=this.fdc,h=this.aEe;var k=new (wac_Ea.$$(wac_cm.Fxb,Object));if(this.QP.Xa(this._clientId))for(var l=this.QP.B(this._clientId).$$ge();l.$$mn();){var m=l.$$cu();k.ea(m.Kd(),m.qa().hNa)}d.va.Ya("RPS",
new wac_7Yb(e,f,g,h,k,c),null);break;case 1:2===b&&wac_(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.l_);break;case 0:if(this.j_a.v3a)wac_(3249543,500,50,"Connection [{0}] has been explicitly closed",this.l_);else{1===b&&(wac_(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.l_),this.Gs.cYd());2===b&&wac_(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.l_);this.i1b(null,null);return}}this.BS=a;this.QB.va.Ya("CSC",new wac_zma(a,b),null)}},FJf:function(){wac_(3249544,500,50,"Detected that the connection [{0}] is slow",this.l_)},yJf:function(a){wac_(3249545,600,10,"SignalR ERROR for connection [{0}]: {1}",this.l_,wac_3R(a)||"<empty>")},zJf:function(a){a=wac_3R(a);this.xJd&&2E3>this.ete&&!a.startsWith("Invok")&&!a.startsWith("Trigger")&&(wac_(578950464,500,50,"SignalR lib: {0}",a),this.ete++)},ahf:function(){var a,b=[],c,d;(d=this.QP.Sb(this._clientId,
c={val:a},null),a=c.val,d)&&this.QP.Ab(this._clientId);for(d=this.QP.Mg().$$ge();d.$$mn();)c=d.$$cu(),Array.add(b,c);d=b.length;for(var e=0;e<d;++e)c=b[e],this.QP.Ab(c);a&&this.QP.ea(this._clientId,a);this.QB.va.Ya("IPSC",new wac_yh(b),null)}};function wac_8Yb(a){switch(a){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",a,"Unknown SignalR state");}}
function wac_9Yb(a){var b=0;a.k_.state||(b=a.udd+15E3-(new Date).getTime(),0>b&&(b=0));return b}
function wac_4Yb(a,b){function c(){if(a.Tmd)wac_(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{a.Tmd=!0,e.stop(!0,b)}catch(c){wac_(591692191,500,15,"Stopping connection failed: {0}",c.message)}}var d=wac_9Yb(a),e=a.k_,f=a.l_;0<d?(wac_(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",f,d),window.setTimeout(c,d)):(wac_(36804372,500,50,"Stopping connection [{0}].",f),c())}
function wac_2Yb(a){var b=++a.dDb;a.udd=(new Date(0)).getTime();a.k_=a.V6d();a.QB.va.Ya("RP",new wac_$Yb(a.k_),null);a.k_.stateChanged(function(c){a.t2d(b,"StateChangedSignalR")&&a.G2(wac_8Yb(c.newState),wac_8Yb(c.oldState))});a.k_.connectionSlow(a.eZe);a.k_.error(a.ZYe);a.k_.log=a.$Ye}function wac_aZb(){return function(){return!1}}
function wac_3Yb(){try{var a=$.signalR;if(!a)throw Error.invalidOperation("Failed to retrieve Signalr object");var b=a.version;if(!b)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===b){var c=a.transports;if(!c)throw Error.invalidOperation("Failed to retrieve transports object");var d=c.longPolling;if(!d)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!d.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");
d.supportsKeepAlive=wac_aZb()}}catch(e){wac_(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",e.message)}}function wac__Yb(a,b){this.hNa=a;this.F1=b}wac__Yb.prototype={hNa:null,F1:null};
function wac_1Yb(a,b,c,d,e,f,g,h,k){var l=null,m=null,n=wac_bZb(),p=wac_r.Aq?wac_r.Aq:"1.0",q=wac_cZb(a,b),r=n.jzc?wac_dZb(q):new wac_eZb,t;wac_0R||(wac_0R=new wac_WYb(e));t=wac_0R;n.$Id&&wac_YYb(t,n.ZId);var u="",u=h&&""!==h?h:"/rtc2/";t.aFd=wac_Qg(u);var v=u+"signalr";h=u+"findsession";u=new wac_fZb;m=m||wac_gZb||(wac_gZb=new wac_hZb);t=new wac_iZb(n,new wac_jZb(u),a,q,function(a){return new wac_kZb(a.createHubProxy("realtimeChannelHub"))},g,m,r,t);l||(l=wac_EYb(b,e,h,g,p,a,q,m,f,d,k));l.oNa=n.oNa;
b=new wac_xYb(q);c=c?c.split(","):null;a=new wac_ZYb(a,c,q,g,function(){return window.$.hubConnection(v)},l,t,b,m,r,n,e);a.zb();return a}function wac_cZb(a,b){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",a,wac_lZb(wac_cm.OXc.toString(1)),wac_lZb(wac_cm.PXc.toString(1)),b)}function wac_lZb(a){return a?a.charAt(0).toLocaleUpperCase()+a.substring(1,a.length):a}function wac_mZb(){}
function wac_dZb(a){wac_nZb||(wac_nZb=new wac_mZb,wac_(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",a));return wac_nZb}
wac_mZb.prototype={fgd:0,XJb:0,kle:0,ile:0,jle:0,nle:0,mle:0,lle:0,wdb:null,Kfc:null,sdd:null,lfb:null,eIb:null,OIa:null,tdd:null,Edd:null,Ddd:null,qIb:null,Mdd:null,Nfc:null,k6d:0,Gre:0,dJb:0,Sed:0,YXd:function(){this.fgd++;this.sdd=new Date;this.wdb||(this.wdb=new Date)},aYd:function(){this.XJb++;this.OIa=new Date;this.Kfc||(this.Kfc=this.OIa);this.qIb=this.OIa;this.wdb&&1===this.XJb&&(this.dJb=Math.max(this.dJb,this.OIa.getTime()-this.wdb.getTime()));this.lfb&&1<this.XJb&&(this.dJb=Math.max(this.dJb,
this.OIa.getTime()-this.lfb.getTime()));this.eIb&&1<this.XJb&&(this.Sed=Math.max(this.Sed,this.OIa.getTime()-this.eIb.getTime()))},$Xd:function(){this.kle++;this.tdd=new Date},cYd:function(){this.ile++;this.lfb=new Date},bYd:function(){this.jle++;this.eIb=new Date},wWc:function(){this.Edd=new Date;this.nle++},byb:function(){this.Nfc||(this.Nfc=new Date);this.mle++},LSa:function(){this.Ddd=new Date;this.lle++},Yje:!1,fYd:function(){!this.Yje&&this.fgd&&(wac_(39321871,500,15,wac_Ll({numberOfConnectionAttempts:this.fgd,
numberOfSuccessfulConnections:this.XJb,numberOfFailedConnections:this.kle,numberOfDisconnectedConnections:this.ile,numberOfExplicitDisconnectedConnections:this.jle,numberOfSentMessages:this.nle,numberOfReceivedMessages:this.mle,numberOfLostMessages:this.lle,firstConnectionAttempt:this.wdb?this.wdb:null,firstMessageReceived:this.Nfc?this.Nfc:null,firstConnectionSuccess:this.Kfc?this.Kfc:null,lastConnectionAttempt:this.sdd?this.sdd:null,lastConnectionSuccess:this.OIa?this.OIa:null,lastConnectionFailure:this.tdd?
this.tdd:null,lastMessageSent:this.Edd?this.Edd:null,lastMessageLost:this.Ddd?this.Ddd:null,lastDisconnect:this.lfb?this.lfb:null,lastExplicitDisconnect:this.eIb?this.eIb:null,lastTimeOnline:this.qIb?this.qIb:null,lastTimeOffline:this.Mdd?this.Mdd:null,maxDisconnectedTimeMs:this.dJb,maxExplicitDisconnectedTimeMs:this.Sed,clientConnectionErrors:this.k6d,serverConnectionErrors:this.Gre})),this.Yje=!0)},ZXd:function(a){var b,c,d,e=b={val:b},f=c={val:c},g=d={val:d};e.val=0;f.val=null;g.val=null;if(a)try{var h=
a.source;h&&Object.getType(h)===String&&(g.val=h);var k=a.context;k&&(a=k,e.val=a.status?a.status:0,f.val=a.statusText?a.statusText:null)}catch(l){}b=b.val;c=c.val;d=d.val;b&&200!==b&&(wac_(40157596,500,15,wac_Ll({HttpErrorCode:b,HttpErrorStatus:c,Exception:d})),400<=b&&499>=b&&this.k6d++,500<=b&&599>=b&&this.Gre++)},fta:function(){this.Mdd=new Date},gta:function(){this.lfb=this.qIb=new Date}};function wac_eZb(){}
wac_eZb.prototype={YXd:function(){},aYd:function(){},$Xd:function(){},cYd:function(){},bYd:function(){},wWc:function(){},byb:function(){},LSa:function(){},fYd:function(){},ZXd:function(){},fta:function(){},gta:function(){}};function wac_kZb(a){this.yr=a}wac_kZb.prototype={yr:null,RF:function(a,b){return this.yr.invoke("SendUpdateNotification",a,b)}};function wac_oZb(){}
function wac_bZb(){var a=wac_r.W;if(!a){var b;return b=new wac_oZb,b.vDd=!1,b.Jyc=!1,b.Iyc=9E5,b.ryc=!1,b.GBc=!0,b.CDc=!1,b.DDc=!0,b.jzc=!1,b.oNa=9E4,b}var c;return c=new wac_oZb,c.vDd=a.ga("AwayStatusManagerIsEnabled"),c.Jyc=a.ga("AwayStatusOneMinuteTimeoutIsEnabled"),c.Iyc=a.Xb("AwayCoauthorThresholdMs",9E5),c.ryc=a.ga("RtcAllowCrossDomainAccessEnabled"),c.GBc=a.ga("RTCLogUpdateNotificationHintOnDeserializationFailure"),c.CDc=a.ga("ShouldLogOnContentNotification"),c.DDc=a.ga("ShouldLogOnHostSubscriptionNotification"),
c.jzc=a.ga("RtcClientMetricsEnabled"),c.oNa=a.Xb("RtcFindSessionRequestTimeoutInMS",6E4),c.$Id=a.ga("RtcJsClientFrequentlyLogsMetrics"),c.mDc=a.Xb("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),c.ZId=a.Xb("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),c}wac_oZb.prototype={vDd:!1,Jyc:!1,Iyc:0,ryc:!1,GBc:!1,CDc:!1,DDc:!1,jzc:!1,oNa:0,$Id:!1,mDc:0,ZId:0};function wac_hZb(){this.va=new wac_nd}
wac_hZb.prototype={va:null,aha:function(a){this.va.hb("CSC",a)},TSb:function(a){this.va.Uc("CSC",a)},mLa:function(a){this.va.hb("PU",a)},Y1a:function(a){this.va.Uc("PU",a)},ZX:function(a){this.va.hb("UNR",a)},jlb:function(a){this.va.Uc("UNR",a)},dsc:function(a){this.va.hb("PSU",a)},Fuc:function(a){this.va.Uc("PSU",a)},csc:function(a){this.va.hb("PSC",a)},Euc:function(a){this.va.Uc("PSC",a)}};function wac_wYb(a,b){a.va.Ya("RC",b,null)}
function wac_5Yb(a,b,c){wac_5Yb.initializeBase(this);this.nd=a;this.iO=b;this.Npb=c}wac_5Yb.prototype={nd:0,iO:null,Npb:null};function wac_6Yb(a,b,c,d){wac_6Yb.initializeBase(this);this.nd=a;this.zKd=b;this.zEd=c;this.Npb=d}wac_6Yb.prototype={nd:0,zKd:null,zEd:!1,Npb:null};function wac_$Yb(a){wac_$Yb.initializeBase(this);this.KFd=a}wac_$Yb.prototype={KFd:null};function wac_7Yb(a,b,c,d,e,f){wac_7Yb.initializeBase(this);this.EEc=a;this.oVb=b;this.hEd=c;this.$zc=e;this.ZDd=d;this.h5a=f}
wac_7Yb.prototype={h5a:null,$zc:null,ZDd:null,hEd:null,oVb:0,EEc:null};function wac_pZb(a,b){wac_pZb.initializeBase(this);this.nd=a;this.AKd=b}wac_pZb.prototype={nd:0,AKd:null};function wac_qZb(a){wac_qZb.initializeBase(this);this.X2a=a}wac_qZb.prototype={X2a:null};function wac_rZb(a,b,c,d){wac_rZb.initializeBase(this);this.AYb=a;this.PCc=b;this.BId=c;this.hJd=d}wac_rZb.prototype={AYb:null,PCc:0,BId:null,hJd:!1};function wac_GYb(a,b){wac_GYb.initializeBase(this);this.qbf=a;this.ocf=b}
wac_GYb.prototype={qbf:!1,ocf:!1};function wac_NYb(a,b){wac_NYb.initializeBase(this);this.Gbf=a;this.Wpa=b}wac_NYb.prototype={Gbf:0,Wpa:null};function wac_sZb(a){wac_sZb.initializeBase(this);this.Ncf=a}wac_sZb.prototype={Ncf:null};
function wac_iZb(a,b,c,d,e,f,g,h,k){this.uY=Function.createDelegate(this,this.k8);this.cmb=Function.createDelegate(this,this.b7b);this.dmb=Function.createDelegate(this,this.bxb);this.U0=Function.createDelegate(this,this.Bda);this.s6e=Function.createDelegate(this,this.Uyb);this.jWe=Function.createDelegate(this,this.bGf);this.kWe=Function.createDelegate(this,this.cGf);this.mWe=Function.createDelegate(this,this.eGf);this.lWe=Function.createDelegate(this,this.dGf);this.Pxc=Function.createDelegate(this,
this.RF);this.WXe=Function.createDelegate(this,this.eIf);this.iid=new (wac_Ea.$$(wac_cm.HAb,Object));wac_iZb.initializeBase(this,[g]);this.md=a;this.egd=this.cgd=0;this.$ib=b;this.$ib.fsc(this.c_e);this._clientId=c;this.Toe=e;this.Iu.va.hb("RP",this.ZXe);this.Iu.va.hb("RPS",this.WXe);this.Iu.va.hb("SUN",this.Pxc);this.Iu.va.hb("IPU",this.lWe);this.Iu.va.hb("IUNR",this.mWe);this.Iu.va.hb("IPSU",this.kWe);this.Iu.va.hb("IPSC",this.jWe);this.Iu.va.hb("SP",this.s6e);this.yc=f;this.Qp=d;this.Gs=h;this.cN=
k}
wac_iZb.prototype={md:null,yr:null,cgd:0,egd:0,eje:!1,_clientId:null,Toe:null,yc:null,mkc:0,Qp:null,Gs:null,cN:null,gIf:function(a,b){this.yr=this.Toe(b.KFd);this.$ib.Kc();this.yr.yr.on("presenceUpdated",this.U0);this.yr.yr.on("persistentStateUpdated",this.dmb);this.yr.yr.on("persistentStateCleared",this.cmb);this.yr.yr.on("updateNotification",this.uY)},G2:function(a,b){this.zia=b.yt;if(2===b.yt){for(a=this.iid.$$ge();a.$$mn();)b=a.$$cu(),this.RF(null,new wac_6Yb(b.Kd(),b.qa(),!1,new (wac_6a.$$(Object))));this.iid=
new (wac_Ea.$$(wac_cm.HAb,Object))}},eIf:function(a,b){b.ZDd();for(a=0;2>a;++a)wac_tZb(this,a,b)},Uyb:function(a,b){a=b.iO;var c,d=b.Npb;try{c=wac_uZb(a)}catch(l){wac_(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",l.message);d.SX(l);return}var e=new (wac_Ia.$$(window.Common.PresenceDataEntryForClients)),f;e.ea(this._clientId,(f=new window.Common.PresenceDataEntryForClients,f.Presence=a,f.TimeStamp=(new Date).getTime(),f));this.Iu.va.Ya("UPSR",new wac_pZb(b.nd,
e),null);wac_1R(this.cN,1,0);if(2!==this.zia)this.Gs.LSa(),wac_1R(this.cN,1,2),d.tg(null);else{var g=this.mkc.toString();++this.mkc;var h=this;f=new wac_vZb(function(){return wac_wZb(h,b.nd,c,g)},g);f=wac_xZb(this.$ib,"0,"+b.nd).U(f);var k=this;wac_yZb(f,function(a){2===a&&wac_1R(k.cN,1,6);d.tg(null)});wac_zZb(f,function(){})}},RF:function(a,b){var c=b.nd;a=b.zKd;var d=b.zEd,e=b.Npb,f;try{f=wac_uZb(a)}catch(l){wac_(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",
l.message);e.SX(l);return}wac_1R(this.cN,0,0);if(2!==this.zia)d?this.iid.ea(c,a):(this.Gs.LSa(),wac_1R(this.cN,0,2)),e.tg(null);else{var g=this.mkc.toString();++this.mkc;var h=this;b=new wac_vZb(function(){return wac_AZb(h,c,f,g)},g);b=wac_xZb(this.$ib,"1,"+c).U(b);var k=this;wac_yZb(b,function(a){2===a&&wac_1R(k.cN,0,6);e.tg(null)});wac_zZb(b,function(){})}},lW:function(){this.yr.yr.off("presenceUpdated",this.U0);this.yr.yr.off("persistentStateUpdated",this.dmb);this.yr.yr.off("persistentStateCleared",
this.cmb);this.yr.yr.off("updateNotification",this.uY)},dGf:function(a,b){this.Bda(b.Tba,b.pnb)},Bda:function(a){this.Gs.byb();this.bxb(0,a)},cGf:function(a,b){this.bxb(b.nd,b.Tba)},bxb:function(a,b){this.Gs.byb();wac_BZb(this,a,b,null)},bGf:function(a,b){this.b7b(b.X2a)},b7b:function(a){this.Gs.byb();if(wac_ga.z8(500,100))for(var b=0;b<a.length;++b);a.length&&(this.Iu.va.Ya("UPSC",new wac_qZb(a),null),this.Iu.va.Ya("PSC",new wac_yh(a),null),this.Iu.va.Ya("PU",new wac_xh({},a),null))},eGf:function(a,
b){this.k8(b.rg,b.Tga)},k8:function(a,b){this.md.CDc&&!a&&wac_(40128990,500,100,"Received ContentUpdate notification from the server");this.md.DDc&&13===a&&wac_(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",b||"<none>"));this.Gs.byb();if(5===a){var c;try{if(b&&""!==b){var d=JSON.parse(b);c=new wac_rZb(d.rr,d.rbp,d.rd,d.sa)}else c=null}catch(e){wac_(593844380,500,15,"Error when parsing reconnect hint: {0}",e.message),c=null}a=c?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",
c.BId,c.PCc):"Received client reconnection request from the server without params.";wac_(18637071,500,50,a);wac_wYb(this.Iu,c)}else c=wac_PYb(b,String.format("UpdateNotification-{0}",wac_cm.HAb.toString(a)),null,this.md.GBc),this.Iu.va.Ya("UNR",new wac_Bma(a,c),null)}};
function wac_BZb(a,b,c,d){if(wac_ga.z8(500,100))for(var e in c);delete c[a._clientId];if(!wac_5e(c)){for(var f in c){e={key:f,value:c[f]};var g=e.key;c[g]=wac_PYb(e.value,"Presence",g,!1)}f=new (wac_Ia.$$(window.Common.PresenceDataEntryForClients));var h=(new Date).getTime(),k;for(k in c){e={key:k,value:c[k]};var g=e.key,l;if(d)l=d[g],l.Presence=e.value;else{var m;l=(m=new window.Common.PresenceDataEntryForClients,m.Presence=e.value,m.TimeStamp=h,m)}f.ea(g,l)}a.Iu.va.Ya("UPSR",new wac_pZb(b,f),null);
b?a.Iu.va.Ya("PSU",new wac_Cma(b,c),null):(a.eje||(wac_(4539734,500,50,"Raising first presence update notification for [{0}]",a.Qp),a.eje=!0,wac_r.Cm&&(wac_r.Cm.IsCoauthSession=!0)),a.Iu.va.Ya("PU",new wac_xh(c,[]),null))}}
function wac_AZb(a,b,c,d){var e=null,f=new wac_CZb,g=new wac_4R;wac_(3249505,500,50,"Sending update notification for [{0}]",a.Qp);if(2!==a.zia)return a.Gs.LSa(),wac_1R(a.cN,0,2),wac_(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",a.Qp),wac_DZb(g),g;a.yc&&3===b&&20>a.egd&&(e=a.yc.Ze("WebServiceCall","Send WetContent Update"),a.egd++);f.re();wac_5R(g.FYa,1);a.yr.RF(b,c).done(function(){a.Gs.wWc();wac_1R(a.cN,0,1);wac_(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",
d,a.Qp);wac_5R(g.pna,1);f&&(f.hd(),f.Zg()>a.md.mDc?wac_1R(a.cN,0,4):wac_1R(a.cN,0,5))}).fail(function(b){a.v3a||(a.Gs.LSa(),wac_1R(a.cN,0,3),wac_(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",d,wac_3R(b),a.Qp));wac_5R(g.pna,2)}).always(function(){e&&e.hd()});return g}
function wac_wZb(a,b,c,d){var e=null,f=new wac_CZb,g=new wac_4R;wac_(3249501,500,50,"Sending presence update for [{0}]",a.Qp);if(2!==a.zia)return a.Gs.LSa(),wac_1R(a.cN,1,2),wac_(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",a.Qp),wac_DZb(g),g;a.yc&&20>a.cgd&&(e=a.yc.Ze("WebServiceCall","Send Presence Message"),a.cgd++);f.re();wac_5R(g.FYa,1);try{a.yr.yr.invoke("UpdatePersistentState",b,c).done(function(){a.Gs.wWc();wac_1R(a.cN,1,1);wac_(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",
d,a.Qp);wac_5R(g.pna,1);f&&(f.hd(),f.Zg()>a.md.mDc?wac_1R(a.cN,1,4):wac_1R(a.cN,1,5))}).fail(function(b){a.v3a||(a.Gs.LSa(),wac_1R(a.cN,1,3),wac_(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",d,wac_3R(b),a.Qp));wac_5R(g.pna,2)}).always(function(){e&&e.hd()})}catch(h){wac_(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",h.message),wac_1R(a.cN,1,3),wac_5R(g.pna,2)}return g}
function wac_tZb(a,b,c){try{a.yr.yr.invoke("GetCompletePersistentStateWithMetadata",b).done(function(d){if(c.EEc(c.oVb,"GetCompletePresenceSuccess")){wac_AYb(c.hEd);wac_(3249540,500,50,"Successfully retrieved complete session state for [{0}]",a.Qp);a.Iu.va.Ya("RMID",null,null);var e={},f;for(f in d){var g={key:f,value:d[f]};e[g.key]=g.value.Presence}wac_BZb(a,b,e,d);a.Iu.va.Ya("CPSWM",new wac_sZb(d),null);c.$zc.Xa(b)&&(d=c.$zc.B(b),e=new (wac_6a.$$(Object)),a.Iu.va.Ya("SP",new wac_5Yb(b,d,e),null))}}).fail(function(b){c.EEc(c.oVb,
"GetCompletePresenceFail")&&(wac_(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",wac_3R(b),a.Qp),wac_wYb(a.Iu,null))}).always(function(){c.h5a&&c.h5a.hd()})}catch(d){wac_(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",c.oVb,d.message)}}
function wac_uZb(a){var b;try{b=wac_Jc(a)}catch(c){throw a=String.format("Failed to JSON-serialize payload : {0}",c),wac_(18637072,500,10,a),Error.argument("payload",a);}if(8E3<b.length)throw a=String.format("Payload exceeds maximum length: {0} > {1}.",b.length,8E3),wac_(18637074,500,10,a),Error.argument("payload",a);return b}
function wac_PYb(a,b,c,d){if(!a)return null;if(Object.getType(a)!==String){var e;if(d)try{e=wac_uZb(a)}catch(f){e=String.format("Failed to JSON serialize the object with exception [{0}]",f)}else e="not allowed to log the object";a=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}]. Object: [{3}].",b,Object.getType(a).getName(),c,e);wac_(18637075,500,10,a);return null}e=null;try{e=wac_Kc(a)}catch(f){a=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}]. Object: [{3}]",
b,f,c,d?a:"not allowed to log the object"),wac_(18637077,500,10,a)}return e}function wac_3R(a){if(!a)return"";if(String.isInstanceOfType(a))return a.toString();try{return wac_Jc(a)}catch(b){return a.toString()}}function wac_CZb(){}wac_CZb.prototype={Oh:null,Vmd:null,Zg:function(){return this.Oh?this.Vmd?this.Vmd.getTime()-this.Oh.getTime():(new Date).getTime()-this.Oh.getTime():0},re:function(){this.Oh=new Date},hd:function(){this.Vmd=new Date}};
function wac_4R(){this.FYa=new (wac_6R.$$(wac_g.vQc));this.pna=new (wac_6R.$$(wac_g.uQc))}wac_4R.prototype={FYa:null,pna:null};function wac_DZb(a){wac_5R(a.FYa,2);wac_5R(a.pna,2)}function wac_zZb(a,b){a=a.pna;a.TG=b;wac_EZb(a)}function wac_yZb(a,b){a=a.FYa;a.TG=b;wac_EZb(a)}function wac_6R(){this.R6d=this.gc["AppRealtimeChannel.CompletionTask$1"].T===Number||Type.isEnum(this.gc["AppRealtimeChannel.CompletionTask$1"].T)?0:this.gc["AppRealtimeChannel.CompletionTask$1"].T===Boolean?!1:null}
wac_6R.$$=function(a){var b=wac_cm.__tc=wac_cm.__tc||{},c="CompletionTask$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_6R.apply(this,a)};d.registerClass("AppRealtimeChannel.__tc."+c);d.prototype.gc={"AppRealtimeChannel.CompletionTask$1":{T:a},ctor:wac_6R};a=wac_6R.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};wac_6R.prototype={X4c:!1,M5d:!1,TG:null};
function wac_EZb(a){a.X4c&&a.TG&&!a.M5d&&(a.M5d=!0,a.TG(a.R6d))}function wac_5R(a,b){a.X4c||(a.X4c=!0,a.R6d=b,wac_EZb(a))}function wac_vZb(a,b){this.ure=a;this.u4a=b}wac_vZb.prototype={tH:function(){return this.ure()},u4a:null,ure:null};function wac_FZb(a,b){this.old=a;this.jEc=b;this.yOa=wac_GZb;this.QKa=this.LOb=this.uEb=0}function wac_GZb(a,b){return window.setTimeout(a,b)}wac_FZb.prototype={QKa:0,LOb:0,uEb:0,old:null,AIa:!1,jqc:null,Zib:null,afb:!1,jEc:null,yOa:null};
function wac_HZb(a,b){a.AIa=!1;a.Zib&&b&&(a.uEb++,wac_DZb(a.Zib));a.jqc=null;a.Zib=null}function wac_IZb(a,b,c){a.LOb++;wac_HZb(a,!0);a.AIa=!0;a.jqc=b;a.Zib=c}function wac_JZb(a){0<a.QKa&&0<a.uEb&&wac_(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",a.jEc,a.uEb,a.QKa);0<a.QKa&&0<a.LOb&&wac_(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",a.jEc,a.LOb,a.QKa)}
function wac_KZb(a,b){this.w6e=Function.createDelegate(this,this.FTf);wac_KZb.initializeBase(this,[a,b]);this.sfb=(new Date(0)).getTime();this.Izc=function(){return(new Date).getTime()}}
wac_KZb.prototype={VBc:0,sfb:0,Izc:null,zb:function(a){this.afb||(this.VBc=a,this.afb=!0)},U:function(a){this.afb||this.zb(200);this.QKa++;var b=this.Izc(),c=new wac_4R;this.sfb>b&&(this.sfb=b);this.AIa?(wac_HZb(this,!0),wac_IZb(this,a,c)):this.sfb+this.VBc<=b?this.Tyb(a,c):(wac_IZb(this,a,c),this.yOa(this.w6e,this.sfb+this.VBc-b));return c},FTf:function(){if(this.AIa){var a=this.jqc,b=this.Zib;wac_HZb(this,!1);this.Tyb(a,b)}},Tyb:function(a,b){this.sfb=this.Izc();a=this.old(a);wac_yZb(a,function(a){wac_5R(b.FYa,
a)});wac_zZb(a,function(a){wac_5R(b.pna,a)})}};function wac_LZb(a,b){this.x6e=Function.createDelegate(this,this.GTf);this.VWe=Function.createDelegate(this,this.LGf);this.va=new wac_nd;wac_LZb.initializeBase(this,[a,b]);this.WJb=0;this.ROb=[];this.WMa=wac_MZb}function wac_MZb(a){window.clearTimeout(a)}
wac_LZb.prototype={g1d:0,OBc:0,WMa:null,WJb:0,ROb:null,$eb:!1,Und:0,gdc:0,Edc:0,U:function(a){this.afb||this.zb(15E3,5);this.QKa++;var b=new wac_4R;this.AIa?wac_IZb(this,a,b):this.WJb<this.OBc?this.Tyb(a,b):(wac_IZb(this,a,b),this.$eb=!1);return b},Tyb:function(a,b){a=this.old(a);var c=this.yOa(this.VWe,this.g1d);++this.WJb;Array.add(this.ROb,c);var d=this.gdc;wac_yZb(a,function(a){wac_5R(b.FYa,a)});var e=this;wac_zZb(a,function(a){e.gdc===d&&(e.gdc===d&&(--e.WJb,e.WMa(c),Array.remove(e.ROb,c),e.AIa&&
e.AIa&&!e.$eb&&(e.Und=e.yOa(e.x6e,0),e.$eb=!0)),wac_5R(b.pna,a))})},GTf:function(){this.$eb=!1;if(this.AIa){var a=this.jqc,b=this.Zib;wac_HZb(this,!1);this.Tyb(a,b)}},LGf:function(){++this.Edc;var a=Math.floor(this.OBc/2);this.Edc>a&&(this.Edc=-1E9,this.va.Ya("TMUDM",null,null))},fsc:function(a){this.va.hb("TMUDM",a)},Kc:function(){this.QKa=this.LOb=this.uEb=this.Edc=0;++this.gdc;for(var a=this.ROb,b=a.length,c=0;c<b;++c)this.WMa(a[c]);this.WJb=0;this.ROb=[];wac_HZb(this,!0);this.$eb&&(this.WMa(this.Und),
this.Und=0,this.$eb=!1)},zb:function(a,b){this.afb||(this.g1d=a,this.OBc=b,this.afb=!0)}};function wac_fZb(){}wac_fZb.prototype={};function wac_NZb(a,b){return new wac_KZb(a,b)}function wac_OZb(a,b){return new wac_LZb(a,b)}function wac_jZb(a){this.va=new wac_nd;this.dkc=new (wac_Ia.$$(wac_rYb));this.ckc=new (wac_Ia.$$(wac_sYb));this.l5f=a;this.Vdb=wac_OZb(function(a){return a.tH()},"GlobalMaxOustandingThrottler");var b=this;this.Vdb.fsc(function(){b.va.Ya("TMUDM",null,null)})}
wac_jZb.prototype={l5f:null,dkc:null,ckc:null,Vdb:null,md:null,Jg:!1,zb:function(a){this.Jg||(this.md=a,this.Vdb.zb(this.md.kEc,this.md.nFd),this.Jg=!0)},Kc:function(){for(var a=this.dkc.GetEnumerator();a.$$mn();){var b=a.$$cu();wac_JZb(b.qa())}for(a=this.ckc.GetEnumerator();a.$$mn();)b=a.$$cu(),wac_JZb(b.qa()),b.qa().Kc();wac_JZb(this.Vdb);this.Vdb.Kc()},fsc:function(a){this.va.hb("TMUDM",a)}};
function wac_xZb(a,b){a.Jg||a.zb(new wac_UYb(200,15E3,5,1E3));var c,d,e;if(e=a.dkc.Sb(b,d={val:c},null),c=d.val,!e){var f,g,h;(h=a.ckc.Sb(b,g={val:f},null),f=g.val,h)||(f="MaxOutstandingThrottler-"+b,c=a.Vdb,f=wac_OZb(c.kvc||(c.kvc=Function.createDelegate(c,c.U)),f),f.zb(a.md.kEc,a.md.lHd),f.fsc(function(){a.va.Ya("TMUDM",null,null)}),a.ckc.U(b,f));c="MaxRateThrottler-"+b;c=wac_NZb(f.kvc||(f.kvc=Function.createDelegate(f,f.U)),c);c.zb(a.md.wHd);a.dkc.U(b,c)}return c}
function wac_UYb(a,b,c,d){this.wHd=a;this.kEc=b;this.lHd=c;this.nFd=d}wac_UYb.prototype={wHd:0,kEc:0,lHd:0,nFd:0};function wac_PZb(){this.N5c=0;this.Ifc=wac_QZb();this.aDb=wac_QZb();this.OGa=this.GWa=0;this.qAc=function(){return new Date}}function wac_XYb(){wac_RZb||(wac_RZb=new wac_PZb);return wac_RZb}wac_PZb.prototype={TJd:!1,Rid:null,Ifc:null,aDb:null,GWa:0,OGa:0,N5c:0,qAc:null};function wac_SZb(a,b){var c=b.getTime()-a.Rid.getTime();a.Rid=b;return c}
function wac_2R(a,b,c){var d=wac_XYb();d.TJd||(c&&(d.TJd=!0),c=d.qAc(),!a&&5<d.GWa||1===a&&5<d.OGa||(d.N5c<a?(1===d.GWa%2&&(d.Ifc[d.GWa]=-1,d.GWa++),d.N5c=a,1===b&&(d.aDb[d.OGa]=-1,d.OGa++),d.aDb[d.OGa]=wac_SZb(d,c),d.OGa++):a?(d.aDb[d.OGa]=wac_SZb(d,c),d.OGa++):(d.Ifc[d.GWa]=wac_SZb(d,c),d.GWa++)))}function wac_QZb(){for(var a=Array(6),b=0;b<a.length;b++)a[b]=0;return a}wac_vYb.registerClass("AppRealtimeChannel.ARtcMessageHandler");
wac_xYb.registerClass("AppRealtimeChannel.ConnectedUsageKpiLogger",null,wac_gYb);wac_CYb.registerClass("AppRealtimeChannel.FindSessionResponse");wac__R.registerClass("AppRealtimeChannel.FindSessionStrategy",null,wac_hYb);wac_DYb.registerClass("AppRealtimeChannel.FindSessionStrategy.FindSessionQueryStringGenerator");wac_WYb.registerClass("AppRealtimeChannel.FrequentLoggingMetrics");wac_ZYb.registerClass("AppRealtimeChannel.RealtimeChannel",null,wac_iYb,wac_$b);wac__Yb.registerClass("AppRealtimeChannel.RealtimeChannel.PresenceData");
(function(){}).registerClass("AppRealtimeChannel.RealtimeChannel.RealtimeChannelFactory");wac_mZb.registerClass("AppRealtimeChannel.RealtimeChannelMetrics",null,wac_jYb,wac_pc);wac_eZb.registerClass("AppRealtimeChannel.NoopRealtimeChannelMetrics",null,wac_jYb,wac_pc);wac_kZb.registerClass("AppRealtimeChannel.RealtimeChannelProxy",null,wac_kYb,wac_lYb);wac_oZb.registerClass("AppRealtimeChannel.RealtimeChannelSettings",null,wac_nYb);wac_hZb.registerClass("AppRealtimeChannel.RtcEventHub",null,wac_mYb);
wac_5Yb.registerClass("AppRealtimeChannel.SendPersistentStateEventArgs",Sys.EventArgs);wac_6Yb.registerClass("AppRealtimeChannel.SendUpdateNotificationEventArgs",Sys.EventArgs);wac_$Yb.registerClass("AppRealtimeChannel.RefreshProxyEventArgs",Sys.EventArgs);wac_7Yb.registerClass("AppRealtimeChannel.RefreshAllPersistentStateEventArgs",Sys.EventArgs);wac_pZb.registerClass("AppRealtimeChannel.UpdatePersistentStateRequestEventArgs",Sys.EventArgs);
wac_qZb.registerClass("AppRealtimeChannel.UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs);wac_rZb.registerClass("AppRealtimeChannel.RefreshConnectionReconnectArgs",Sys.EventArgs);wac_GYb.registerClass("AppRealtimeChannel.SessionPropertiesChangedEventArgs",Sys.EventArgs);wac_NYb.registerClass("AppRealtimeChannel.RtcConnectFailedEventArgs",Sys.EventArgs);wac_sZb.registerClass("AppRealtimeChannel.GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs);
wac_iZb.registerClass("AppRealtimeChannel.RtcMessageHandler",wac_vYb);(function(){}).registerClass("AppRealtimeChannel.RtcUtils");wac_CZb.registerClass("AppRealtimeChannel.SimpleStopwatch");wac_4R.registerClass("AppRealtimeChannel.MessageStatus",null,wac_oYb);wac_vZb.registerClass("AppRealtimeChannel.MessageHandler",null,wac_pYb);wac_FZb.registerClass("AppRealtimeChannel.ThrottlerBase");wac_KZb.registerClass("AppRealtimeChannel.MaxRateThrottler",wac_FZb,wac_rYb,wac_qYb);
wac_LZb.registerClass("AppRealtimeChannel.MaxOutstandingThrottler",wac_FZb,wac_sYb,wac_qYb);wac_fZb.registerClass("AppRealtimeChannel.ThrottlerFactory",null,wac_tYb);wac_jZb.registerClass("AppRealtimeChannel.ThrottlerManager",null,wac_uYb);wac_UYb.registerClass("AppRealtimeChannel.ThrottlerManagerSettings");wac_PZb.registerClass("AppRealtimeChannel.LatencyMetrics");var wac_0R=null,wac_nZb=null,wac_gZb=null,wac_RZb=null;Type.registerNamespace("RealtimePresenceUI");
function wac_TZb(a,b,c,d){this.t0e=Function.createDelegate(this,this.hMf);this.Aaf=Function.createDelegate(this,this.E_f);this.G0e=Function.createDelegate(this,this.zMf);this.uEe=Function.createDelegate(this,this.Ghf);this.vEe=Function.createDelegate(this,this.Hhf);this.v3e=Function.createDelegate(this,this.GPf);this.wQe=Function.createDelegate(this,this.Qxf);this.Baf=Function.createDelegate(this,this.F_f);this.H0e=Function.createDelegate(this,this.AMf);this.w3e=Function.createDelegate(this,this.HPf);
wac_TZb.initializeBase(this,[a,c,d,null]);this.jma=function(){return!0};this.ha=b}
wac_TZb.prototype={jma:null,ha:null,HPf:function(a){if(this.Lic){this.eob||(a[wac_7R.Visible]=!0);var b,c,d,e,f,g=b={val:b},h=c={val:c},k=d={val:d},l=e={val:e},m=f={val:f},n,p,q,r;2<=this.o3.L8.la()?r=[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.o3.L8.la())]:1===this.o3.L8.la()?(n=wac_dYb(this.o3)[0],r=(p=this.hp.E3a(n.mi()))&&2===p.ud?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,n.Sq]:[n.Hv?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
n.Sq]):r=[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself];this.o3.L8.la()?1===this.o3.L8.la()?(n=!0,p=this.hp.zze().vVb,q=wac_dYb(this.o3)[0].fU()):(n=!0,p=this.hp.bze().vVb,q=""):(n=!1,q=p="");g.val=r[0];h.val=r.slice(1);k.val=n;l.val=p;m.val=q;b=b.val;c=c.val;d=d.val;e=e.val;f=f.val;a[wac_7R.LabelText]=b;c&&c.length&&(a[wac_7R.LabelTextUserGeneratedPlaceholderReplacements]=c);a.ImageIsVisible=d;a[wac_7R.Image16by16Class]=e;a.ImageBackColor=f;this.Lic=!1}return!0},AMf:function(a){if(0>=this.o3.L8.la())a=
!1;else{var b=wac_dYb(this.o3),c=[];Array.addRange(c,b);c.sort(wac__Xb);for(var b=[],d=c.length,e=0;e<d;++e){var f=c[e],g=String.format("buttonPeoplesWellUser-{0}",f.mi()),h=f.mi(),k=wac_7Xb(this,f),l=f.Sq,m=f.fU(),n=void 0,g=(n=new wac_ll,n.Id=g,n.Command=this.hp.md.hyc.toString(),n.LabelText="{0}",n.Image32by32=this.hp.lsd().bEd,n.Image32by32Class=this.hp.lsd().vVb,n.MenuItemId=h,n.CommandValueId=h,n.Alt=l,n.DisplayMode=wac_5Xb(),n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",
n.Description=k,n.ImageBackColor=m,n.IsAnonymous=f.Jx,n.LabelTextUserGeneratedPlaceholderReplacements=wac_UZb([l]),n.Upn=f.Ix,n);wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled")&&this.zSa&&(n=f,n=this.zSa.ftc()?this.zSa.dsb(n.Ix,"O365",wac_r.Gk,0):void 0,h=this.hp.E3a(f.mi()),h=!h||h&&1===h.ud?!0:!1,g.ImageUrl=n,g.ActiveStatus=h,g.JoinTimeInMS=f.gba,h=wac_0Xb(this,f.mi(),this.hp.hWb(f.mi()),!1),f=this.cVa?this.cVa.Peg(f.mi()):f.Fv.M7(4),g.CanJump=h,g.ChatCapable=f,""===n&&wac_(40969413,302,50,"ImageURL collection failed"));
Array.add(b,g)}var p,c=(p=new wac_1e,p.Id="menuCoauthors",p.MaxWidth="220px",p.MenuSectionList=[],p),q;p=(q=new wac_8e,q.Id="msCoauthors",q.ControlsId="msCoauthorsControls",q.DisplayMode=wac_5Xb(),q.ControlList=b,q);wac_r.W.ga("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.zSa&&(p.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,p.TitleId="menuCoauthorsTitle",p.Theme="Light");Array.add(c.MenuSectionList,p);if(wac_r.W.ga("DocChatIsEnabled")&&wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled")&&wac_t()&&
wac_cg().Vm()){q=[];Array.add(q,wac_6Xb());var r;q=(r=new wac_8e,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=q,r);Array.add(c.MenuSectionList,q)}wac_t()&&wac_cg().Vm()?a.MenuItems=c:a.PopulationXML=wac_Bl(c);a=!0}return a},F_f:function(a){return this.K0c(a)},Asa:function(a,b,c,d,e,f,g){a=!1;switch(c){case 1:a=f(e);break;case 2:a=g(e)}return a?32:8},Qxf:function(a,b,c,d,e){var f=this;return this.Asa(a,b,c,d,e,function(){return f.tOc()},this.jma)},GPf:function(a,b,c,d,e){return this.Asa(a,
b,c,d,e,this.w3e,this.jma)},zMf:function(a,b,c,d,e){return this.Asa(a,b,c,d,e,this.jma,this.H0e)},Hhf:function(a,b,c,d,e){return this.Asa(a,b,c,d,e,this.jma,this.jma)},Ghf:function(a,b,c,d,e){return this.Asa(a,b,c,d,e,this.jma,this.jma)},E_f:function(a,b,c,d,e){return this.Asa(a,b,c,d,e,this.jma,this.Baf)},hMf:function(a,b,c,d,e){var f=this;return this.Asa(a,b,c,d,e,this.jma,function(){wac_YXb(f);return!0})},oa:function(){wac_XXb.prototype.oa.call(this)}};
wac_TZb.registerClass("RealtimePresenceUI.ABox4PeoplesWell",wac_XXb);Type.registerNamespace("BPr");function wac_VZb(){}wac_VZb.registerInterface("BPr.IMyPresenceUser");window.BPr.SerializablePresenceData=function(a,b){this.ip=a;this.user=b};window.BPr.SerializablePresenceIpData=function(a,b,c,d,e){this.paragraphId=a;this.cp=b;this.length=c;this.shapeId=d;this.dryDeletion=e};
function wac_WZb(a,b,c,d,e,f,g,h){this.rZe=Function.createDelegate(this,this.OJf);this.M5e=Function.createDelegate(this,this.ySf);this.YId=a;this.ngc=b;this.z6d=c;this.dve=e;this.C9d=f;this.Kad=g;this.GIa=d;this.F0d=h;this.YId.ZX(this.M5e)}
wac_WZb.prototype={YId:null,F0d:null,ngc:null,z6d:null,dve:!1,C9d:0,Kad:null,GIa:null,ySf:function(a,b){b.rg||(this.Kad.tf("CU"),a=this.z6d,a=(a.Su?a.Su.hB:0)>=this.C9d,this.dve&&a?(a=this.ngc())?(a.n5c=!0,b=a.rN.via,wac_u7a(a.rN,a.Gpe),b&&this.Kad.tf("PI")):wac_(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.Ox())},Ox:function(){var a=this.ngc();if(!a)wac_(19682514,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");
else if(!this.GIa()&&!a.KP.MQ){var b=-1;wac_LC.isInstanceOfType(a)&&(b=a.nh.tka());var c=this.F0d.Ze("Task","ShoulderTapInboundReplicationTimer");a.Ox(this.rZe,null,new wac_XZb(b,c,a.yp))}},OJf:function(a){var b=window.$$as(wac_XZb,a);if(b){a=b.qSd.Zg().toString();var c=this.ngc(),d=c.yp,e="";if(d!==b.DPc)if(wac_(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",b.yZd.toString()),b=b.DPc,e=new Sys.StringBuilder,c=wac_Nt(wac_ot(c.sg().gd()),d)){for(e.append(c.ia().KD);d!==
b;){e.append(", ");e.append(d.KD);c=c.jl;if(!c)break;d=c.ia()}e=e.toString()}else wac_(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{lastRevisionId:d}),e="";wac_(19964237,500,50,"Revisions: {0}, InboundDuration: {1}",e,a)}else wac_(19964235,500,10,"The callback data was null")}};function wac_YZb(a,b){this.Vlb=Function.createDelegate(this,this.YRc);this.dispose=this.oa;this.Zi=a;b&&(this.YH=b,this.YH.hb(wac_4n,this.Vlb));wac_ZZb(this.Zi,this)}
wac_YZb.prototype={_started:!1,Zi:null,YH:null,Nhc:!1,re:function(){this._started||(this._started=!0,this.YH?wac__Zb(this):this.Zi.RF(1,null,!1))},YRc:function(){this._started&&wac__Zb(this)},hd:function(){this._started&&(this._started=this.Nhc=!1)},oa:function(){wac_0Zb(this.Zi,this);this.YH&&this.YH.Uc(wac_4n,this.Vlb)}};function wac__Zb(a){var b=a.Nhc;a.Nhc=!!a.YH.Ru;a.Nhc&&!b&&a.Zi.RF(1,null,!1)}function wac_8R(){wac_8R.initializeBase(this)}wac_8R.prototype={FBc:null,O4a:null};
function wac_1Zb(a){var b=wac_r.Xz,c=wac_r.W.mb("UserPrincipalName"),d=a.FBc?a.FBc.MB:null,e=wac_r.fUa||wac_r.B2,f;a.O4a?(f=a.O4a,f=wac_1a(f.VH)&&f.VH.rc()?f.VH.rc().Fsc().toString():"0"):f=null;return new wac_9R(a.El,b,a.$o,a.Fv,d,a.V2a,c,a.XMa,a.U2a,e,a.oBa,a.Hv,f)}function wac_2Zb(a,b,c,d){this.saa=Function.createDelegate(this,this.Cda);this.zzd=Function.createDelegate(this,this.SHf);this.dispose=this.oa;this.Zi=d;this.ua=b;this.Vdc=a;this.Gi=c;wac_ZZb(this.Zi,this)}
wac_2Zb.prototype={ua:null,Vdc:null,qcb:null,ybd:!1,Gi:null,Zi:null,_started:!1,H0a:null,re:function(){this._started||(this._started=!0,this.H0a={},this.Vdc.hb("PPC",this.zzd),wac_0y(this.ua,this.saa),wac_3Zb(this,this.ua.nb()))},hd:function(){this._started&&(this._started=!1,this.H0a=null,this.Vdc.Uc("PPC",this.zzd),wac_tC(this.ua,this.saa))},Cda:function(a,b){if(!wac_r.Th&&(a=wac_3Zb(this,b.Hl),this.qcb&&a)){a=wac_4Zb(this.Vdc,this.qcb.toString(),-1,-1,!0);for(b=0;b<a.length;b++)this.H0a[a[b].Nf.mi()]=
a[b];if(!(0>=a.length)){if(1===a.length)a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,a[0].Nf.Sq);else{b=[];for(var c=a.length,d=0;d<c;d++)Array.add(b,a[d].Nf.Sq);a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,b.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}this.Gi.Yx(a,!0)}}},SHf:function(a,b){this.ua.nb()&&!wac_r.Th&&this.ybd&&this.qcb&&this.qcb.Ca(b.Iv)&&(a=null,!b.BWb||b.iO.Nf.mi()in this.H0a?b.BWb||(a=String.format(Box4Intl.Box4Strings.l_UserLeavingParagraph,
b.iO.Nf.Sq),delete this.H0a[b.iO.Nf.mi()]):(a=String.format(Box4Intl.Box4Strings.l_UserJoiningParagraph,b.iO.Nf.Sq),this.H0a[b.iO.Nf.mi()]=b.iO),a&&this.Gi.Yx(a,!0))},oa:function(){wac_0Zb(this.Zi,this);this.hd()}};function wac_3Zb(a,b){if(!b)return!1;b=b.kb();if(!b)return!1;b=b.Ga();if(!b)return!1;a.ybd=wac_cz(b);b=b.fa.ia();if(b.Ca(a.qcb)||!a.ybd)return!1;a.qcb=b;a.H0a={};return!0}function wac_5Zb(a,b){wac_5Zb.initializeBase(this);this.Iv=a;this.WGd=b}wac_5Zb.prototype={Iv:null,WGd:!1};
function wac_$R(a,b,c,d,e,f,g){wac_$R.resolveInheritance();this.dispose=this.oa;wac_$R.initializeBase(this,[null]);this.zm=a;this.q0a=b;this.nk=c;this.Df=d;this.BW=e;wac_aS=0;this.wqd=new (wac_Ia.$$(Boolean));this.wud=new (wac_Ia.$$(Boolean));this.Wp=f;this.xa=g;this.cT=this.xa.Xb("PresenceIpRenderedFloodgateTimeLapseSec",30);this.XT=this.xa.Xb("PresenceIpRenderedFloodgateTriggerThreshold",3);this.Lla=0}
function wac_6Zb(){wac_7Zb||(wac_7Zb=!0,wac_(4006594,302,50,"First presence ip rendered on the page"))}wac_$R.prototype={q0a:null,nk:null,Df:null,Nj:null,kad:null,BW:null,O7d:0,xa:null,cT:0,XT:0,Wp:null,Lla:0,sob:!1,zm:null,wqd:null,wud:null,QY:0};function wac_8Zb(a){!a.Wp||a.Lla>=a.XT||a.Wp.CW(function(){a.Wp.rc().Em("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",a.cT)&&a.Lla++})}
function wac_9Zb(a){if(wac_TR.isInstanceOfType(a.Nj)){var b=window.$$as(wac_TR,a.Nj);wac_aS=0<wac_aS?wac_aS+1:b.Uha+1;wac_RR(b,wac_aS);a._element.style.zIndex=wac_aS}}function wac_$Zb(a){a.Ya("CR",new wac_5Zb(a.zm.Jm().LG(),a.sob),null)}function wac_bS(){return wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled")}function wac_a_b(a,b,c,d,e,f){this.ncb={};this.mcb={};this.o6d={};this.q0a=a;this.nk=b;this.hh=c;this.BW=d;this.Wp=e;this.xa=f}wac_a_b.prototype={q0a:null,nk:null,hh:null,BW:null,Wp:null,xa:null};
function wac_cS(a,b,c){wac_cS.initializeBase(this);this.Iv=a;this.iO=b;this.BWb=c}wac_cS.prototype={Iv:null,iO:null,BWb:!1};function wac_dS(){this.UKb={};this.dva={};wac_dS.initializeBase(this)}
wac_dS.prototype={X$d:!1,E7a:function(a){return a.Jm().LG().toString()},oFc:function(a,b){this.X$d||(this.X$d=!0,wac_(4289312,302,50,"First presence added to data manager"));var c,d;c=d={val:!1};var e=this.dva[a.Nf.mi()],f=!e||0>=e.length?null:e[e.length-1],e=!!f&&this.E7a(f)===this.E7a(a);c.val=e&&f.Jm().UL.Ca(a.Jm().UL)&&f.Nf.Ca(a.Nf);wac_b_b()&&c.val&&f.Jm().Gy&&a.Jm().Gy&&f.Jm().Gy!==a.Jm().Gy&&(c.val=!1);d=(c=d.val,e);c&&!b?(d=this.dva[a.Nf.mi()])&&0<=d.length&&d[d.length-1].Jm().FBe(a.Jm().JY):
(d||wac_c_b(this,a.Nf.mi()),wac_b_b()&&d&&(b=this.dva[a.Nf.mi()],!(b=!b||0>=b.length?null:b[b.length-1])||!b.Jm().Gy||a.Jm().Gy&&a.Jm().Gy===b.Jm().Gy||(c=b.Jm().LG(),this.Ya("PPC",new wac_cS(c,b,!1),null))),b=this.E7a(a),c=a.Nf.mi(),e=this.UKb[b]||[],f=this.dva[c]||[],f.length>=wac_d_b&&(f=f.splice(-wac_e_b,wac_d_b)),d||Array.add(e,c),Array.add(f,a),this.UKb[b]=e,this.dva[c]=f,a.Jm().LG().Ca(wac_y())||(d=a.Jm().LG(),this.Ya("PPC",new wac_cS(d,a,!0),null)))},qLc:function(a){return this.UKb[a]},wsf:function(a){if(!a||
!a.Ga()||!a.Ga().fa)return null;a=a.Ga().fa;a=wac_4Zb(this,a.ia().toString(),0,0,!0);a=wac_f_b(a);a.sort(function(a,c){return a.Sq.localeCompare(c.Sq)-wac_gf});return a}};function wac_f_b(a){if(!a||!a.length)return[];for(var b=[],c=new (wac_za.$$(String))(wac_pa()),d=0;d<a.length;d++){var e=a[d].Nf;e.Jx&&c.yb(e.mi())||!e.Jx&&e.Ix&&c.yb(e.Ix)||(b.push(e),c.U(e.Jx?e.mi():e.Ix))}return b}
function wac_4Zb(a,b,c,d,e){var f=[],g=a.qLc(b);if(!g)return f;for(var h=0;h<g.length;h++){for(var k=g[h],l=a.dva[k],m=!1,n=l.length-1;0<=n;n--){var p=l[n];if(e){if(p.iia&&p.Jm().LG().Ca(wac_sk(b))){m=!0;Array.add(f,p);break}}else if(wac_eS.isInstanceOfType(p)?p.Jm().JY===c:p.Jm().JY===d){m=!0;p.CBe(!0);Array.add(f,p);a.dva[k]=l.splice(n,l.length);break}}!m&&0<l.length&&l[0].Xye()&&l[0].Jm().LG().Ca(wac_sk(b))&&Array.add(f,l[0])}return f}
function wac_c_b(a,b){var c=a.dva[b];if(c&&0<c.length){var d=c[0].Jm().LG(),e=a.E7a(c[0]);delete a.dva[b];Array.remove(a.UKb[e],b);d.Ca(wac_y())||a.Ya("PPC",new wac_cS(d,c[0],!1),null)}}function wac_b_b(){return!!wac_r.W&&wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled")}function wac_eS(a,b){this.zfa=b;this.Nf=a}
wac_eS.prototype={zfa:null,Jm:function(){return this.zfa},AXb:!1,Xye:function(){return this.AXb},CBe:function(a){return this.AXb=a},iia:!1,lTb:function(a){return this.iia=a},Uqa:!1,Wuc:function(a){return this.Uqa=a},Nf:null,GBe:function(a){return this.Nf=a},iMc:function(){return new window.BPr.SerializablePresenceData(this.zfa?this.zfa.$B():null,this.Nf.$B())},Ltb:function(){return this.Nf.mi()+(this.zfa?this.zfa.LG().toString():wac_y().toString())},Hk:function(){var a=!!this.Nf&&this.Nf.Hk(),b=!this.zfa||
this.zfa.Hk();return a&&b},Oc:function(){var a=new wac_eS;a.Nf=this.Nf?this.Nf.Oc():null;a.zfa=this.zfa?this.zfa.Oc():null;a.iia=this.iia;a.AXb=this.AXb;a.Uqa=this.Uqa;return a}};function wac_g_b(a){this.Qa=a}wac_g_b.prototype={Qa:0,Lf:function(){return this.Qa},Ca:function(a){return a?this.Qa===a.Qa:!1},Oc:function(){return new wac_g_b(this.Qa)}};function wac_fS(a,b,c,d,e){a&&(this.Iv=wac_sk(a));this.UL=new wac_g_b(b);this.JY=c;this.Gy=d;this.CU=e}
wac_fS.prototype={Iv:null,LG:function(){return this.Iv},UL:null,JY:0,FBe:function(a){return this.JY=a},Gy:0,CU:0,Hk:function(){return 0<=this.UL.Lf()&&!!this.Iv&&!this.Iv.Ca(wac_y())},$B:function(){return new window.BPr.SerializablePresenceIpData(this.Iv.toString(),this.UL.Lf(),this.JY,this.Gy,this.CU)},Oc:function(){var a=new wac_fS;a.Iv=this.Iv;a.UL=this.UL?this.UL.Oc():null;a.JY=this.JY;a.Gy=this.Gy;a.CU=this.CU;return a}};
function wac_h_b(a,b,c,d,e,f,g){this.uUb=Function.createDelegate(this,this.RTc);this.CL=Function.createDelegate(this,this.Ada);wac_h_b.initializeBase(this,[a,b,c,d,e,f,g])}
wac_h_b.prototype={pne:null,Kta:function(a){this.Nj&&this.Nj.Kta(a)},Bvd:function(a){if(this._element&&this._element.parentNode){var b=wac_i_b(this,a);if(b){var c,d,e,f,g=Sys.UI.DomElement.getBounds(this._element.parentNode),h=this._element.parentNode,k=this.Df.Ha(),l=c={val:c},m=d={val:d},n=e={val:e},p=f={val:f};m.val=b.y;l.val=b.x;n.val=b.height;p.val=b.width;(1<Math.abs(g.width-h.offsetWidth)||1<Math.abs(g.height-h.offsetHeight))&&k&&(m.val=Math.round(m.val/k.Yh),l.val=Math.round(l.val/k.Yh),n.val=
Math.round(n.val/k.Yh),p.val=Math.round(p.val/k.Yh));c=c.val;d=d.val;e=e.val;f=f.val;this._element.style.top=d+"px";this._element.style.left=c+"px";this._element.style.height=e+"px";this._element.style.width=f+"px";b=wac_j_b(this,a);wac_4j(this._element,b);a=wac_k_b(this,a,this.zm.Jm().Gy);wac_l_b(this,b,f,this.Sx(a));this.ATa()}}},Zw:function(a){a&&this._element&&a===this.pne&&(wac_Yc(this._element),this.Nj.Kta(this.zm.Nf.mi()),wac_$Zb(this))},KNd:function(a,b,c){var d=new wac_m_b;if(!c||!b)return d;
b=wac_i_b(this,a);if(!b)return d;d.JFa=b.y;d.iEa=b.x;d.ml=b.height;d.Ml=b.width;a=this._element&&this._element.parentNode&&wac_n_b(wac_NWb(this._element.parentNode))?wac_n_b(wac_NWb(this._element)):wac_j_b(this,a);d.Q8b=a;d.uzb=!0;return d},LYd:function(a,b,c,d){wac_6Zb();this.kad=a;if(d){var e=wac_k_b(this,a,this.zm.Jm().Gy);if(!e)return;var f=!this._element;f&&this.QHc(b.ownerDocument);f||!this._element.parentNode?e.appendChild(this._element):this._element.parentNode!==e&&(this._element.parentNode.removeChild(this._element),
e.appendChild(this._element));this.Nj.WY(this.zm.Nf);this.pne=b;this.O7d=a.zc();this._element.style.borderColor=this.zm.Nf.fU();this._element.id="ipId_"+this.zm.Ltb();c.uzb&&(this._element.style.height=c.ml+"px",this._element.style.top=c.JFa+"px",this._element.style.left=c.iEa+"px",this._element.style.width=c.Ml+"px",wac_4j(this._element,c.Q8b),wac_4j(this.Nj.Jb(),-1*c.Q8b),wac_l_b(this,c.Q8b,c.Ml,this.Sx(e)),this.ATa())}this.sob=!d;wac_$Zb(this)},RBe:function(a){this._element.style.borderColor=this.zm.Nf.fU();
this._element.id="ipId_"+this.zm.Ltb();this.Bvd(a)},QHc:function(a){this._element=a.createElement("div");this._element.setAttribute("data-presence-control",!0);wac_3i(this._element,"OverlayControlElementOwner",this);this._element.className="WACImgPresenceHighlight";this._element.dir=wac_pg?"rtl":"ltr";this.Nj=this.q0a.OHc(this.Pj("div"),!0);this.Nj.WY(this.zm.Nf);this.Nj.le();this.nk.Sa("msospPointerOut",this.Nj.Jb(),this.CL);this.nk.Sa("msospPointerDown",this.Nj.Jb(),this.uUb);Sys.UI.DomElement.addCssClass(this.Nj.Jb(),
"WacPresence");this._element.appendChild(this.Nj.Jb())},Sx:function(a){return Sys.UI.DomElement.containsCssClass(a,"Selected")},Pi:function(a,b){var c=this.x2b(a,b);return c?c.Fh:(a=wac_o_b(a,b))?a.Na():null},x2b:function(a,b){a=wac_PH(a.Va(),5);for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e.Fh.Ia(Number,wac_Js)===b)return e}return null},Ada:function(){this.Nj&&(this.Nj.zTa(),this.QY=1);return!1},RTc:function(a){this.Nj&&3===a.af&&(2!==this.QY?(wac_9Zb(this),this.ATa()):this.Nj&&(this.Nj.zTa(),this.QY=
1));return!1},ATa:function(){for(var a=this.Nj.rtc(),b=a.length,c=0;c<b;++c){var d=a[c];if(d.El===this.zm.Nf.mi()&&!d.Ca(this.zm.Nf)){this.Nj.WY(this.zm.Nf);break}}if(this.zm.Uqa||2===this.QY)this.Nj.e$b(),this.zm.Wuc(!1),this.zm.lTb(!0),this.QY=2;this.zm.iia&&1!==this.QY||(this.Nj.zTa(),this.zm.lTb(!0),this.QY=1)}};
function wac_i_b(a,b){var c=a.zm.Jm();if(!c||!c.Gy)return null;var d=a.Pi(b,c.Gy);a=wac_k_b(a,b,c.Gy);if(!d||!a)return null;var e,f;b=e={val:e};c=f={val:f};b.val=wac_xe(wac_oK(d),0,!0);c.val=wac_xe(wac_pK(d),1,!0);e=e.val;f=f.val;c=b=1;d.Da(wac_yq)?(d=d.Ia(Array,wac_yq),b+=wac_xe(d[0],0,!0),c+=wac_xe(d[2],1,!0)):(b+=0<a.offsetWidth?(a.offsetWidth-e)/2:2,c+=0<a.offsetHeight?(a.offsetHeight-f)/2:2);return new Sys.UI.Bounds(Math.round(b),Math.round(c),Math.round(e),Math.round(f))}
function wac_j_b(a,b){a=a.Pi(b,a.zm.Jm().Gy);return wac_kK(a)}function wac_o_b(a,b){a=wac_R(a.Va());for(var c=a.ob(6);c;){var d=c.Na().Ia(Number,wac_Js);if(wac_Cz(c)&&d===b)return c;c=a.Fe(6)}return null}function wac_k_b(a,b,c){if(a=a.x2b(b,c))if(a=a.Bja(b.Kb))return a.Jb();return(c=wac_o_b(b,c))?wac_uy(window.$$as(wac_OG,c),b.zc()).Ma():null}
function wac_l_b(a,b,c,d){var e=wac_pg;a.Nj.Jb().style.left="auto";a.Nj.Jb().style.top="auto";a.Nj.Jb().style.right="auto";a.Nj.Jb().style.bottom="auto";d=d?Math.round(10)+6:0;0<=b&&90>b||360===b?(a.Nj.Jb().style.top=-10-d+"px",e?a.Nj.Jb().style.right=c-10+"px":a.Nj.Jb().style.left=c-10+"px"):90<=b&&180>b?(a.Nj.Jb().style.left=-10-d+"px",e?a.Nj.Jb().style.bottom="-10px":a.Nj.Jb().style.top="-10px"):180<=b&&270>b?(a.Nj.Jb().style.bottom=-10-d+"px",e?a.Nj.Jb().style.left=c-10+"px":a.Nj.Jb().style.right=
c-10+"px"):(a.Nj.Jb().style.right=-10-d+"px",e?a.Nj.Jb().style.top="-10px":a.Nj.Jb().style.bottom="-10px")}function wac_n_b(a){return a&&-1<a.indexOf("deg")&&(a=window.parseInt(a.substring(a.indexOf("(")+1,a.indexOf("deg"))),!window.isNaN(a))?a:0}function wac_m_b(){}wac_m_b.prototype={iEa:0,JFa:0,Ml:0,ml:0,Q8b:0,uzb:!1};
function wac_p_b(a,b,c,d,e,f,g){this.uUb=Function.createDelegate(this,this.RTc);this.CL=Function.createDelegate(this,this.Ada);this.Mha=Function.createDelegate(this,this.pSa);wac_p_b.initializeBase(this,[a,b,c,d,e,f,g])}
wac_p_b.prototype={wib:null,Twa:null,JNb:null,QHc:function(a){this._element=a.createElement("div");this._element.setAttribute("data-presence-control",!0);wac_3i(this._element,"OverlayControlElementOwner",this);this._element.className="PresenceIpPaddingDiv";this._element.dir=wac_pg?"rtl":"ltr";this.nk.Sa("msospPointerOver",this._element,this.Mha);wac_bS()&&(this.nk.Sa("msospPointerOut",this._element,this.CL),this.nk.Sa("msospPointerDown",this._element,this.uUb));this.Twa=this.Pj("div");this.Twa.className=
"presenceIp";wac_bS()||(this.JNb=this.Pj("div"),this.JNb.className="PresenceSmallBox",this.Twa.appendChild(this.JNb));this.Nj=this.q0a.OHc(this.Pj("div"),wac_bS());this.Nj.WY(this.zm.Nf);this.Nj.le();Sys.UI.DomElement.addCssClass(this.Nj.Jb(),wac_bS()?"WacPresence":"WacPawn");this.Twa.appendChild(this.Nj.Jb());this._element.appendChild(this.Twa)},pSa:function(a){!this.Nj||wac_bS()&&!this.Nj.TJc(a)||(wac_9Zb(this),wac_q_b(this,a));this.RBe(this.kad);return!1},Ada:function(){this.Nj&&this.t2();return!1},
RTc:function(a){this.Nj&&3===a.af&&(2!==this.QY?(wac_9Zb(this),wac_q_b(this,a)):this.t2());return!1},ATa:function(a){for(var b=this.Nj.rtc(),c=b.length,d=0;d<c;++d){var e=b[d];if(e.El===this.zm.Nf.mi()&&!e.Ca(this.zm.Nf)){this.Nj.WY(this.zm.Nf);break}}b=!1;"0xcccccc"===this.zm.Nf.fU()?(c=this.wqd.Sb(this.zm.Nf.mi(),b={val:b},!1),b=b.val,c,b||(this.wqd.ea(this.zm.Nf.mi(),!0),wac_(17954772,302,50,'{ "ClientID" : "'+this.zm.Nf.mi()+'" , "Event" : "RenderGrayPawn"}'))):(c=this.wud.Sb(this.zm.Nf.mi(),
b={val:b},!1),b=b.val,c,b||(this.wud.ea(this.zm.Nf.mi(),!0),wac_(17954773,302,50,'{ "ClientID" : "'+this.zm.Nf.mi()+'" , "Event" : "RenderColoredPawn"}')));return a||this.zm.Uqa||2===this.QY?(wac_8Zb(this),this.Nj.e$b(),this.zm.Wuc(!1),this.zm.lTb(!0),this.QY=2,2E3):this.zm.iia&&1!==this.QY?0:(wac_8Zb(this),this.Nj.zTa(),this.zm.lTb(!0),this.QY=1,7E3)},t2:function(){if(this.Nj&&this.QY){if(wac_TR.isInstanceOfType(this.Nj)){var a=window.$$as(wac_TR,this.Nj);wac_aS=a.Uha;wac_RR(a,a.Uha);this._element.style.zIndex=
a.Uha}this.Nj.le();this.QY=0}return!1},Bvd:function(a){if(this._element&&this._element.parentNode){var b=wac_r_b(this,a);if(b){a=Sys.UI.DomElement.getBounds(this._element.parentNode);var c,d,e,b=new Sys.UI.Bounds(b.x-a.x,b.y-a.y,2,b.height),f=this._element.parentNode,g=this.Df.Ha(),h=c={val:c},k=d={val:d},l=e={val:e};k.val=b.y;h.val=b.x;l.val=b.height;(1<Math.abs(a.width-f.offsetWidth)||1<Math.abs(a.height-f.offsetHeight))&&g&&(k.val=Math.round(k.val/g.Yh),h.val=Math.round(h.val/g.Yh),l.val=Math.round(l.val/
g.Yh));c=c.val;d=d.val;e=e.val;this._element.style.height=10+e+"px";this._element.style.top=d-5+"px";this._element.style.left=c-5+"px";this.Twa.style.height=Math.max(10,e)+"px";wac_q_b(this,null)}}},Zw:function(a){a&&this._element&&a===this._element.parentNode&&(wac_Yc(this._element),wac_$Zb(this))},KNd:function(a,b,c,d){var e=new wac_s_b;if(!c||!b)return e;a=wac_r_b(this,a);if(!a)return e;c=new Sys.UI.Bounds(a.x-b.x,a.y-b.y,2,a.height);b=c.y;a=c.x;c=c.height;var f=this.Df.Ha();d&&f&&(d=f.Yh,b=Math.round(b/
d),a=Math.round(a/d),c=Math.round(c/d));e.JFa=b-5;e.iEa=a-5;e.ml=10+c;e.LSd=Math.max(10,c);e.uzb=!0;return e},LYd:function(a,b,c,d){wac_6Zb();this.kad=a;if(d){var e=!this._element;e&&this.QHc(b.ownerDocument);e||!this._element.parentNode?b.appendChild(this._element):this._element.parentNode!==b&&(this._element.parentNode.removeChild(this._element),b.appendChild(this._element));this.O7d=a.zc();a=this.zm.Nf.fU();this.Twa.style.borderColor=a;wac_bS()||(this.JNb.style.borderColor=a);this._element.id=
"ipId_"+this.zm.Ltb();c.uzb&&(this._element.style.height=c.ml+"px",this._element.style.top=c.JFa+"px",this._element.style.left=c.iEa+"px",this.Twa.style.height=c.LSd+"px",wac_q_b(this,null))}this.sob=!d;wac_$Zb(this)},oa:function(){this._element&&(this.Zw(this._element.parentNode),this.nk.Nb("msospPointerOver",this._element,this.Mha),wac_bS()&&(this.nk.Nb("msospPointerOut",this._element,this.CL),this.nk.Nb("msospPointerDown",this._element,this.uUb)),wac_Lb(this.Nj),this._element=this.Nj=null)},RBe:function(a){var b=
this.zm.Nf.fU();this.Twa.style.borderColor=b;wac_bS()||(this.JNb.style.borderColor=b);this._element.id="ipId_"+this.zm.Ltb();this.Bvd(a)}};function wac_r_b(a,b){a=a.zm.Jm();if(!a)return null;var c;try{var d=a.UL.Lf();c=wac_Jub(d,b,0<d,!1,!1,!1)}catch(e){wac_(4301318,302,50,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",wac_s().Bv(),e.message,e.stack),c=null}return c}
function wac_t_b(a,b){a.wib=new wac_D(2,1,b,function(){a.wib=null;a.t2()},56,null,!1,0);wac_s().nc(a.wib)}function wac_q_b(a,b){a.wib&&(wac_s().gf(a.wib),a.wib=null);var c=a.ATa(!!b);wac_bS()&&b&&"msospPointerOver"===b.Mo||wac_t_b(a,c)}function wac_s_b(){}wac_s_b.prototype={LSd:0,iEa:0,JFa:0,ml:0,uzb:!1};
function wac_u_b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,B,C){this.Hyd=Function.createDelegate(this,this.zFf);this.c6=Function.createDelegate(this,this.vta);this.Qwc=Function.createDelegate(this,this.THf);this.f0e=Function.createDelegate(this,this.GLf);this.U0=Function.createDelegate(this,this.Bda);this.FAd=Function.createDelegate(this,this.cNf);this.soa=Array(5);this.Coe=new (wac_za.$$(String))(wac_pa());this.eLb={};this.dispose=this.oa;this.yr=a;this.ua=d;this.vI=e;this.GJa=f;this.QKb=k;this.G7c=
l;this.eya=m;this.nv=c;this.o$c=n;this.igc=p;this.jgc=q;this.a3d=g;this.D9d=h;this.S_=r;this.Ah=t;this.wb=u;this.Ua=v;this.KOb=z;this.ZZa=B;this.lpe=C;this.rmc=x;this.xa=y;this.FKb=b;this.jz=w;wac_v_b=new (wac_Ia.$$(Boolean));for(a=0;a<this.FKb.length;a++)b=this.FKb[a],b.QE.Ab(this),b.QE.U(this);this.GJa.hb("PPC",this.FAd);this.yr.mLa(this.U0);A&&this.QKb.bha(this.f0e);wac_ZZb(this.yr,this)}function wac_w_b(a){return a?a?1===a?1:2===a?2:0:2:0}
wac_u_b.prototype={yr:null,vI:null,ua:null,GJa:null,FKb:null,nv:null,a3d:null,D9d:null,eya:null,G7c:0,pld:!1,igc:null,jgc:null,o$c:null,_started:!1,S_:null,Ah:null,wb:null,Ua:null,KOb:!1,QKb:null,bpd:!1,ZZa:null,rmc:null,Eid:null,xa:null,jz:null,yic:!1,Qjd:!1,lpe:!1,GLf:function(){if(!this.bpd){var a=this,b=new wac_D(0,1,20,function(){var b=new (wac_e.$$(wac_I)),d=a.eya.ncb,e;for(e in d){var f={key:e,value:d[e]},f=f.value;f.sob&&b.U(f.zm.Jm().LG())}if(wac_x_b(a)){var d=a.eya.mcb,g;for(g in d)f={key:g,
value:d[g]},e=f.value,e.sob&&!b.yb(e.zm.Jm().LG())&&b.U(e.zm.Jm().LG())}wac_y_b(a,b,!0);a.bpd=!1},72,null,!1,0);this.Ua.nc(b);this.bpd=!0}},zFf:function(){this.pld&&(wac_z_b(this),this.pld=!1)},vta:function(a,b){a=b.Hl.kb();wac_A_b(this,a,!1)},zGc:function(a){var b=a.Ga().za,c=a.Ga().fa.ia();a=this.igc(a.Ga().fa);return new wac_fS(c.toString(),b,a,0,0)},Bda:function(a,b){a=b.Tba;for(var c in a){var d=a[c];this.xa.ga("CashTelemetryIsEnabled")&&this.Osb(d,new Date,null);d.Jm()?wac_B_b(this,d):this.pyb(d.Nf.mi())}b=
b.pnb;for(c=0;c<b.length;++c){a=b[c];this.pyb(a);if(d=this.eya.ncb[a])d.Uc("CR",this.Qwc),d.oa();wac_x_b(this)&&(d=this.eya,a=d.mcb[d.o6d[a]],a=!a||a.Nj&&a.Nj.rtc().length?null:a)&&(a.Uc("CR",this.Qwc),a.oa())}this.KOb||wac_C_b(this)},Osb:function(a,b,c){if(this.rmc)if(a&&a.Nf&&a.Nf.mi()){var d=a.Nf.mi();if(!this.Coe.yb(d))if(this.Eid)this.Eid.Osb(d,b,null,wac_w_b(c||a.Nf.XMa)),this.Coe.U(d);else{var e=this;this.rmc.CW(function(){e.Eid=e.rmc.rc();e.Osb(a,b,c)})}}else wac_(42262876,302,15,"invalid presence")},
sRd:function(){},pyb:function(a){wac_c_b(this.GJa,a)},K2b:function(a){if(12!==a.get_type())return new (wac_e.$$(wac_iv));a=wac_4Zb(this.GJa,a.ia().toString(),this.igc(a),this.jgc(a),!1);if(0>=a.length)a=new (wac_e.$$(wac_iv));else{for(var b=new (wac_e.$$(wac_iv)),c=0;c<a.length;c++)b.U(wac_D_b(this,a[c]));a=b}return a},THf:function(a,b){if(b.Iv){a=b.Iv.toString();var c=b.WGd;b=this.eLb;var d=this.yic,e=this.Qjd;c&&e||(c?this.ZZa.tf("RendersSaved-OutOfView"):(this.ZZa.tf("Renders"),e&&this.ZZa.tf("RendersDueToScroll"),
(c=a in b)&&delete b[a],d&&c&&this.ZZa.tf("RendersSaved-ContentUpdate")))}else wac_c(8758481,302,!1,"null paraid")},oa:function(){this.hd();this.GJa.Uc("PPC",this.FAd);this.yr.Y1a(this.U0);wac_0Zb(this.yr,this);for(var a=0;a<this.FKb.length;a++)this.FKb[a].QE.Ab(this);wac_cca([this.a3d,this.D9d,this.yr]);var b=this.eya,c=b.ncb,d;for(d in c)a={key:d,value:c[d]},a.value.dispose();d=b.mcb;for(var e in d)a={key:e,value:d[e]},a.value.dispose()},cNf:function(a,b){b.Iv&&(a=this.nv.Mb(b.Iv))&&((wac_eS.isInstanceOfType(b.iO)?
this.igc(a):this.jgc(a))===b.iO.Jm().JY?wac_E_b(this,b.Iv):this.ZZa.tf("RendersSaved-VersionCheck"),wac_x_b(this)&&b.iO.Jm().Gy&&!b.BWb&&(a=b.iO.Jm().Gy.toString(),(a=this.eya.mcb[a])&&a.Kta(b.iO.Nf.mi())))},hd:function(){this._started&&(this._started=!1,wac_tC(this.ua,this.c6),this.o$c.Auc(this.Hyd))},re:function(){if(!this._started){this._started=!0;wac_0y(this.ua,this.c6);this.o$c.Zrc(this.Hyd);var a=this.yr.m7a();delete a[this.S_.mi()];this.Bda(null,new wac_xh(a,[]));wac_z_b(this)}}};
function wac_E_b(a,b){b.toString()in a.eLb&&a.ZZa.tf("RendersSavedByAlreadyPending");a.eLb[b.toString()]=null;a.KOb&&!a.yic&&(b=new wac_D(0,1,200,function(){a.yic=!1;wac_C_b(a)},70,null,!1,0),a.Ua.nc(b),a.yic=!0)}
function wac_y_b(a,b,c){if(b.la()){var d=new (wac_e.$$(wac_zB));for(b=b.$$lge();b.$$mn();){var e=b.$$cu(),f=wac_F_b(a,e);f?d.U(f):wac_G_b(a,e)}if(d.la()){b=a.wb.Hc(2,0);try{b.Set(a.Ah);for(var g=d.$$lge();g.$$mn();)f=g.$$cu(),d=a,e=f,e.YA(d.QKb.zc(),32,!0),e.YA(d.G7c,32,!0);c&&(a.Qjd=!0)}finally{b&&b.dispose()}c&&(a.Qjd=!1)}}}
function wac_G_b(a,b){b=wac_4Zb(a.GJa,b.toString(),-1,-1,!0);if(!wac_El(b)){for(var c=[],d=b.length,e=0;e<d;++e){var f=a.eya.ncb[b[e].Nf.mi()];f&&Array.add(c,f)}c.length&&a.jz.qa().E2(function(){for(var a=c.length,b=0;b<a;++b){var d=c[b];d._element&&d.Zw(d._element.parentNode)}})}}
function wac_F_b(a,b){b=a.nv.Mb(b);if(!b)return a.soa[0]||(wac_(4281420,302,50,"Could not find the node in object space"),a.soa[0]=!0),null;if(!wac_W(b))return a.soa[1]||(wac_(4281421,302,50,"Not a paragraph node"),a.soa[1]=!0),null;if(!wac_uy(b,a.QKb.zc()))return a.soa[2]||(wac_(4281422,302,50,"No ViewElement found for this node"),a.soa[2]=!0),null;if(!b.Cb)return a.soa[3]||(wac_(4281423,302,50,"node is not anchored"),a.soa[3]=!0),null;a.soa[4]||(wac_(4564931,302,50,"Valid paragraph node found for rendering ip"),
a.soa[4]=!0);return b}function wac_D_b(a,b){var c,d,e=a.eya,f=c={val:!1},g=!!e.xa&&e.xa.ga("PeoplesWellExtraButtonInfoIsEnabled");if(b.Jm().Gy&&g){g=b.Jm().Gy.toString();e.o6d[b.Nf.mi()]=g;var h=e.mcb[g];h?(h.zm=b,f.val=!0,b=h):(f.val=!1,b=e.mcb[g]=new wac_h_b(b,e.q0a,e.nk,e.hh,e.BW,e.Wp,e.xa))}else g=b.Nf.mi(),(h=e.ncb[g])&&h.zm.Nf.Ca(b.Nf)?(h.zm=b,f.val=!0,b=h):(f.val=!1,b=e.ncb[g]=new wac_p_b(b,e.q0a,e.nk,e.hh,e.BW,e.Wp,e.xa));b=(d=b,c=c.val,d);c||b.hb("CR",a.Qwc);return b}
function wac_B_b(a,b){var c=null;b&&b.Nf&&(c=b.Nf.XMa);b=b.Oc();b.GBe(wac_FWb(a.vI,b.Nf.mi())||b.Nf);a.xa.ga("CashTelemetryIsEnabled")&&a.Osb(b,new Date,c);if(b.Hk()&&!b.Nf.qZ()){c=b.Nf.mi();wac_v_b.Xa(c)||a.sRd(c);var d,e;e=wac_v_b.Sb(c,d={val:!1},!1);d=d.val;e;d||(wac_v_b.ea(c,!0),wac_(17954774,302,50,'{ "ClientID" : "'+c+'" , "Event" : "CreateAnonymousGrayPawn"}'));wac_3ua(b.Nf,CommonUIStrings.l_AnonymousUserName)}a.GJa.oFc(b,!1)}
function wac_A_b(a,b,c){if(!a.lpe)if(wac_Ht(a.nv.ph)||c)if(b){a:{if(wac_x_b(a)&&wac_S4a(b))c=b;else if(c=wac_vy(b,!0,!1,!0),!wac_Qy(c)){c=null;break a}c=a.zGc(c)}c?wac_H_b(a.yr,c):(wac_H_b(a.yr,null),wac_(4281418,302,50,"Not supported selection context {0}",b.Ga().Fa))}else wac_H_b(a.yr,null);else a.pld=!0}function wac_z_b(a){if(a.ua.nb()){var b=a.ua.nb().kb();wac_A_b(a,b,!0)}}function wac_C_b(a){var b=new (wac_e.$$(wac_I)),c=a.eLb,d;for(d in c)b.U(wac_sk(d));wac_y_b(a,b,!1);a.eLb={}}
function wac_x_b(a){return!!a.xa&&a.xa.ga("PeoplesWellExtraButtonInfoIsEnabled")}function wac_9R(a,b,c,d,e,f,g,h,k,l,m,n,p){wac_9R.initializeBase(this,[a,b,c,d,f,g,h,k,l,m,n,0,null,0]);this.MB=e;this.yba=p}
wac_9R.prototype={MB:null,$B:function(){return new window.Box4.Presence.SerializablePresenceUserData(this.El,this.MB,this.V2a,this.U2a,this.oBa,this.Fv.Fv,this.Ix,this.Hv,this.Sq,this.Jx,this.yba)},cMc:function(a){return(a=a.value)?a.Nf:null},Oc:function(){return new wac_9R(this.El,this.Sq,this.$o,this.Fv.Oc(),this.MB,this.V2a,this.Ix,this.XMa,this.U2a,this.Jx,this.oBa,this.Hv,this.yba)}};
function wac_I_b(a,b,c,d,e,f,g){this.uY=Function.createDelegate(this,this.k8);this.cmb=Function.createDelegate(this,this.b7b);this.dmb=Function.createDelegate(this,this.bxb);this.U0=Function.createDelegate(this,this.Bda);this.u2a=Function.createDelegate(this,this.G2);this.zxd=Function.createDelegate(this,this.hCf);this.va=new wac_nd;this.dispose=this.oa;this.S_=f;this.S_.El=a.mi();this.Pl=a;this.zS=b;this.oB=d;this.rae=e;this.Ua=c;this.Hva=new (wac_h.$$(wac_ft))(null);this.Fm=g;if(this.zS){var h=
this;this.zS.CW(function(){wac_0a(h.zS)||wac__a(h.zS)||wac_R0a(h.zS.rc(),h.zxd)})}}
wac_I_b.prototype={Hva:null,rae:null,oB:null,dje:!1,Ua:null,$cd:!1,S_:null,Fm:null,Kge:!1,afe:!1,zS:null,grc:0,dpd:0,yjb:null,Pl:null,Eoa:function(){return this.Pl.Eoa()},mLa:function(a){this.va.hb("PU",a)},Y1a:function(a){this.va.Uc("PU",a)},aha:function(a){this.va.hb("CSC",a)},TSb:function(a){this.va.Uc("CSC",a)},dsc:function(a){this.va.hb("PSU",a)},Fuc:function(a){this.va.Uc("PSU",a)},csc:function(a){this.va.hb("PSC",a)},Euc:function(a){this.va.Uc("PSC",a)},VZd:function(){return null},mi:function(){return this.Pl.mi()},
ZX:function(a){this.va.hb("UN",a)},jlb:function(a){this.va.Uc("UN",a)},zb:function(){this.Pl.aha(this.u2a);this.Pl.mLa(this.U0);this.Pl.dsc(this.dmb);this.Pl.csc(this.cmb);this.Pl.ZX(this.uY);wac_J_b(this);wac_K_b(this)},q0b:function(){this.$cd||this.Pl.q0b()},R6a:function(){this.Pl.R6a()},AOd:function(a){var b;a?(b=a.user,b=b.clientId?new wac_9R(b.clientId,b.userName,null,new wac_2k(wac_tb(b.capabilities)?0:b.capabilities),b.localColbaltSessionId,b.SkypeChatThreadId,b.email,null,b.chatThreadDiscoveryUri,
b.isAnonymous,b.inChat,b.isReadOnly,b.presenceStatus):null,a.ip?(a=a.ip,a=!a.paragraphId||wac_i(a.cp)||wac_i(a.length)?null:new wac_fS(a.paragraphId,a.cp,a.length,0,a.dryDeletion)):a=null,b=new wac_eS(b,a)):b=null;return b},gYc:function(a,b){return(new wac_eS(a,b)).iMc()},Uyb:function(a,b){return this.Pl.Uyb(a,b)},eLc:function(a){return this.Pl.eLc(a)},stb:function(){return this.Pl.stb()},RF:function(a,b,c){return this.Pl.RF(a,b,c)},m7a:function(){return wac_L_b(this,this.Pl.m7a())},vRb:function(){return this.Pl.vRb()},
G2:function(a,b){2===b.yt&&this.Hva.Rd(function(a){a.re();return!0});b.yt||this.Fm.ga("SendRTCMessagesWhileDisconnectedIsEnabled")&&!this.$cd||this.Hva.Rd(function(a){a.hd();return!0});this.va.Ya("CSC",b,null)},Bda:function(a,b){if(!this.oB()){a=wac_L_b(this,b.Tba);b=wac_M_b(b.pnb);var c=new wac_xh(a,b),d=this;b=new wac_D(0,1,0,function(){d.va.Ya("PU",c,null)},57,null,!1,0);this.Ua.nc(b)}},bxb:function(a,b){if(!this.oB()){var c={};a=b.Tba;for(var d in a){var e={key:d,value:a[d]};c[e.key.toLowerCase()]=
e.value}var f=this;d=new wac_D(0,1,0,function(){f.va.Ya("PSU",new wac_Cma(b.nd,c),null)},80,null,!1,0);this.Ua.nc(d)}},b7b:function(a,b){if(!this.oB()){a=wac_M_b(b.X2a);var c=new wac_yh(a),d=this;a=new wac_D(0,1,0,function(){d.va.Ya("PSC",c,null)},81,null,!1,0);this.Ua.nc(a)}},k8:function(a,b){if(this.Kge)wac_N_b(this,b);else{var c=this;a=new wac_D(0,1,0,function(){wac_N_b(c,b)},58,null,!1,0);this.Ua.nc(a)}},oa:function(){this.Hva=new (wac_h.$$(wac_ft))(null);this.Pl.TSb(this.u2a);this.Pl.Y1a(this.U0);
this.Pl.Fuc(this.dmb);this.Pl.Euc(this.cmb);this.Pl.jlb(this.uY);if(this.zS){var a=this;this.zS.CW(function(){wac_0a(a.zS)||wac__a(a.zS)||a.zS.rc().va.Uc("AmIAloneChanged",a.zxd)})}this.Pl.R6a();wac_(4564935,302,50,"Disposing of rtcProxyCompleted")},hCf:function(){wac_J_b(this)},tsb:function(){this.$cd=!0;this.R6a();wac_(4564938,302,50,"DisconnectForever")}};
function wac_J_b(a){var b=!1;a.zS?a.zS.CW(function(){wac_0a(a.zS)||wac__a(a.zS)||(b=!a.zS.rc().Ao);a.Pl.Eoa()||!b&&!a.rae()?2!==a.Pl.Eoa()||b||(a.R6a(),wac_(4564937,302,50,"Disconnecting because there are no other users in the doc")):(a.q0b(),wac_(4564936,302,15,"Connecting because there are other authors in the doc"));!a.dje&&b&&(wac_(4203466,302,50,"There are other real-time authors in this session"),a.dje=!0)}):(a.q0b(),wac_(589321547,302,50,"Connecting to rtc because Rtc Always On is enabled"))}
function wac_N_b(a,b){var c=Date.now();a.va.Ya("UN",b,null);c=Date.now()-c;500<=c&&(a.grc++,wac_(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",b.rg,c),0>b.rg||16<=b.rg?wac_(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",b.rg):a.yjb[b.rg]++);a.dpd++}function wac_M_b(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c].toLowerCase();return b}
function wac_L_b(a,b){var c={},d;for(d in b){var e={key:d,value:b[d]},f=a.AOd(e.value);f&&f.Hk()?c[e.key.toLowerCase()]=f:wac_(4564932,302,50,"No Valid User {0}",wac_Jc(e.value))}return c}function wac_H_b(a,b){b&&b.Hk()&&!a.oB()?a.Pl.VZd(a.gYc(wac_1Zb(a.S_),b)):wac_Ya(Object,null)}function wac_0Zb(a,b){for(var c=0;c<a.Hva.ka();c++)if(a.Hva.B(c)===b){wac_rb(a.Hva,c);break}}function wac_ZZb(a,b){a.Hva.yb(b,function(a,b){return a===b})||(a.Hva.U(b),2===a.Eoa()&&b.re())}
function wac_K_b(a){a.yjb=Array(12);for(var b=0;12>b;b++)a.yjb[b]=0;a.Kge=a.Fm?a.Fm.ga("UpdateNotificationTaskExperimentIsEnabled"):!0;wac_Kg(function(){if(!a.afe){var b={};b.TC=a.dpd;b.HRC=a.grc;a.yjb&&0<a.grc&&(b.TBC=a.yjb);a.dpd=0;a.grc=0;a.yjb=null;wac_(42541603,302,50,"UpdateNotificationHeuristics: {0}",b);a.afe=!0}})}function wac_XZb(a,b,c){this.yZd=a;this.qSd=b;this.DPc=c}wac_XZb.prototype={yZd:0,qSd:null,DPc:null};window.BPr.SerializablePresenceData.registerClass("BPr.SerializablePresenceData");
window.BPr.SerializablePresenceIpData.registerClass("BPr.SerializablePresenceIpData");wac_WZb.registerClass("BPr.ContentNotificationManager");wac_YZb.registerClass("BPr.EditorsTableNotifier",null,Sys.IDisposable,wac_ft);wac_9R.registerClass("BPr.PresenceUser",wac_1k,wac_Vca,wac_MQa,wac_hc);wac_9R.prototype.toString=wac_1k.prototype.toString;wac_8R.registerClass("BPr.MyPresenceUser",wac_9R,wac_VZb,wac_hc);wac_8R.prototype.toString=wac_1k.prototype.toString;
wac_2Zb.registerClass("BPr.PresenceAccessibilityManager",null,Sys.IDisposable,wac_ft);wac_5Zb.registerClass("BPr.PresenceControlRenderedEventArgs",Sys.EventArgs);wac_$R.registerClass("BPr.APresenceControl",wac_QR,wac_iv,Sys.IDisposable);wac_a_b.registerClass("BPr.PresenceControlProvider");wac_cS.registerClass("BPr.ParagraphChangedEventArg",Sys.EventArgs);wac_dS.registerClass("BPr.PresenceDataManager",wac_nd,wac_BUa);wac_eS.registerClass("BPr.PresenceInfo",null,wac_IQa,wac_Sb.$$(wac_IQa));
wac_g_b.registerClass("BPr.PresenceCp",null,wac_JQa,wac_Sb.$$(wac_JQa));wac_fS.registerClass("BPr.PresenceIp",null,wac_KQa,wac_Sb.$$(wac_KQa));wac_h_b.registerClass("BPr.PresenceImageControl",wac_$R);wac_m_b.registerClass("BPr.PresenceImageControl.PresenceImageControlStyle",null,wac_5Va);wac_p_b.registerClass("BPr.PresenceIpControl",wac_$R);wac_s_b.registerClass("BPr.PresenceIpControl.PresenceIpControlStyle",null,wac_5Va);
wac_u_b.registerClass("BPr.PresenceManager",null,wac_6Va,Sys.IDisposable,wac_ft,wac_Xca,wac_Wca);wac_I_b.registerClass("BPr.RtcProxy",null,wac_LQa,Sys.IDisposable,wac_$b,wac_Cjb);wac_XZb.registerClass("BPr.SuccessfulInboundReplicationCallbackData");var wac_7Zb=!1,wac_aS=0,wac_d_b=10,wac_e_b=2,wac_v_b=null;Type.registerNamespace("Box4.Presence");wac_L=window.Box4||{};wac_L.$Ea=wac_L.$Ea||{};function wac_gS(a,b){wac_gS.initializeBase(this);this.OC=a;this.fb=b}
wac_gS.prototype={Cle:!1,fb:null,OC:null,Fid:!1,oFc:function(a,b){this.fb.ub(185)&&this.fb.ub(154)&&wac_eS.isInstanceOfType(a)?this.Cle||(this.Cle=!0,wac_(7866380,302,15,"Presence packet received in old format")):(wac_eS.isInstanceOfType(a)&&(this.Fid=!0),wac_dS.prototype.oFc.call(this,a,b))},E7a:function(a){return this.Fid?wac_dS.prototype.E7a.call(this,a):a.Jm().ir().toString()},qLc:function(a){return this.Fid?wac_dS.prototype.qLc.call(this,a):(a=this.OC.Mb(wac_sk(a)))?this.UKb[a.pa(Number,wac__p,
0).toString()]:null}};Type.registerNamespace("WordEditor.Presence");wac_M=window.WordEditor||{};wac_M.$Ea=wac_M.$Ea||{};function wac_O_b(a,b,c,d,e,f,g,h,k){this.LocalCobaltSessionId=a;this.SkypeChatThreadId=b;this.ChatThreadDiscoveryUri=c;this.InChat=d;this.Capabilities=e;this.Email=f;this.UserName=g;this.IsAnonymous=h;this.PresenceStatus=k}function wac_P_b(){}wac_P_b.registerInterface("WordEditor.Presence.IWordPresenceIp");function wac_Q_b(){}wac_Q_b.registerInterface("WordEditor.Presence.IWordPresenceCp");
function wac_R_b(){}wac_R_b.registerInterface("WordEditor.Presence.IPacketIdGenerator");function wac_S_b(){}function wac_T_b(a,b,c){null!=a&&(this.TFA=a);null!=b&&(this.PN=b);null!=c&&(this.TN=c)}function wac_U_b(a,b){null!=a&&(this.PM=a);null!=b&&(this.TM=b)}function wac_V_b(a,b,c,d){null!=a&&(this.PA=a);null!=b&&(this.TA=b);null!=c&&(this.PB=c);null!=d&&(this.TBS=d)}function wac_W_b(a,b){a&&(this.SF=a);null!=b&&(this.SL=b)}function wac_X_b(){}wac_X_b.registerInterface("WordEditor.Presence.ISequentialIdGenerator");
function wac_hS(){}wac_hS.registerInterface("WordEditor.Presence.IWordPresenceCpFactory");function wac_iS(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.m8=a;this.srb=c;this.aB=d;this.dM=b.toLowerCase();this.sJ=e;this.XFa=p;f&&(this.p3=f);null!=g&&(this.STa=g);wac_i(h)||(this.Text=h);k&&(this.K5a=k);l&&(this.A5b=l);m&&(this.GTa=m);n&&(this.Xzb=n);this.B8=q}wac_iS.prototype={m8:0,XFa:0,srb:0,aB:0,dM:null,sJ:null,p3:null,K5a:null,A5b:null,GTa:null,STa:null,Text:null,Xzb:null,B8:null};
function wac_Y_b(a,b,c){null!=a&&(this.q_c=a);null!=b&&(this.xUc=b);null!=c&&(this.dab=c)}wac_Y_b.prototype={q_c:null,xUc:null,dab:null};function wac_Z_b(a,b){null!=a&&(this.PWd=a);null!=b&&(this.cab=b)}wac_Z_b.prototype={PWd:null,cab:null};function wac___b(a,b,c,d){null!=a&&(this.vUc=a);null!=b&&(this.o_c=b);null!=c&&(this.wUc=c);null!=d&&(this.p_c=d)}wac___b.prototype={vUc:null,o_c:null,wUc:null,p_c:null};function wac_0_b(a,b){a&&(this.e_c=a);null!=b&&(this.f_c=b)}wac_0_b.prototype={e_c:null,f_c:null};
function wac_1_b(){}function wac_2_b(){}wac_2_b.prototype={V:0};function wac_3_b(){this.Ena=0}wac_3_b.prototype={Ena:0};function wac_4_b(a){a.Ena++;4294967295===a.Ena&&(a.Ena=1);return a.Ena}
function wac_5_b(a,b){b.val="";if("number"!==typeof a.I)return b.val="Invalid PacketId Type",!1;if("number"!==typeof a.O)return b.val="Invalid Operation Type",!1;if("string"!==typeof a.A)return b.val="Invalid ClientId Type",!1;if("object"!==typeof a.AN)return b.val="Invalid Anchor Object Type",!1;if(!a.AN)return b.val="Null AnchorObject",!1;if(!wac_LWb(a.AN)){var c;try{c=wac_Jc(a.AN)}catch(d){c=String.format("Failed to JSON-serialize payload : {0}",d)}8E3<c.length&&(c=String.format("Payload exceeds maximum length: {0} > {1}, not logging",
c.length,8E3));b.val="Invalid AnchorObject: "+c+", Client: "+a.C;return!1}return!a.O&&a.AN.RK?(b.val="Invalid RangeKind:"+a.AN.RK+" for Caret",!1):2===a.O&&("number"!==typeof a.TF||"undefined"!==typeof a.TX&&"string"!==typeof a.TX||1!==a.AN.RK&&a.AN.RK)?(b.val="Invalid TypingData",!1):3!==a.O||"object"===typeof a.AP&&a.AP&&"number"===typeof a.AP.TFA&&"number"===typeof a.AP.PN&&"number"===typeof a.AP.TN&&2===a.AN.RK?6!==a.O||"object"===typeof a.MP&&a.MP&&"number"===typeof a.MP.PM&&"number"===typeof a.MP.TM&&
5===a.AN.RK?4!==a.O||"object"===typeof a.SP&&a.SP&&"number"===typeof a.SP.PA&&"number"===typeof a.SP.TA&&"number"===typeof a.SP.PB&&"number"===typeof a.SP.TBS&&3===a.AN.RK&&(a.AN.PS===a.SP.PA||a.AN.PS===a.SP.PB)?7!==a.O||"object"===typeof a.SPS&&a.SPS&&"string"===typeof a.SPS.SF&&"boolean"===typeof a.SPS.SL?null!=a.ISS&&"number"!==typeof a.ISS?(b.val="invalid StrictlySequentialId",!1):!0:(b.val="Invalid SymbolData",!1):(b.val="Invalid SplitParaData",!1):(b.val="Invalid RemoveParaData",!1):(b.val=
"Invalid AddParaData",!1)}function wac_6_b(a){var b=a;if("number"===typeof b.V){if(1===b.V)return wac_7_b(a);wac_(9188758,302,15,"Unsupported Version");return null}for(var c=0,d=null,e=0;e<a.length;e++){var b=a[e],f;a:{for(f=0;f<wac_1_b.L0d.length;f++)if(b.V===wac_1_b.L0d[f]){f=!0;break a}f=!1}f&&b.V>c&&(c=b.V,d=a[e])}return 1===c?wac_7_b(d):null}
function wac_8_b(a){if(a){var b=new wac_S_b;b.I=a.m8;b.V=1;b.A=a.dM;b.C=a.srb;b.O=a.aB;b.AN=wac_vWb(a.sJ);a.p3&&(b.WD=a.p3);null!=a.STa&&(b.TF=a.STa);!wac_i(a.Text)&&0<a.Text.length&&(b.TX=a.Text);a.K5a&&(b.AP=new wac_T_b(a.K5a.q_c,a.K5a.xUc,a.K5a.dab));a.A5b&&(b.MP=new wac_U_b(a.A5b.PWd,a.A5b.cab));a.GTa&&(b.SP=new wac_V_b(a.GTa.vUc,a.GTa.o_c,a.GTa.wUc,a.GTa.p_c));a.Xzb&&(b.SPS=new wac_W_b(a.Xzb.e_c,a.Xzb.f_c));b.ISS=a.B8;a=b}else a=null;return a}
function wac_7_b(a){var b,c,d;if(d=wac_5_b(a,c={val:b}),b=c.val,!d)return wac_(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",b),null;var e=d=c=b=null,f=null,g=null,h=null,k=null;a.WD&&(b=a.WD);null!=a.TF&&(c=a.TF);wac_i(a.TX)||(d=a.TX);a.AP&&(e=new wac_Y_b(a.AP.TFA,a.AP.PN,a.AP.TN));a.MP&&(f=new wac_Z_b(a.MP.PM,a.MP.TM));a.SP&&(g=new wac___b(a.SP.PA,a.SP.TA,a.SP.PB,a.SP.TBS));a.SPS&&(h=new wac_0_b(a.SPS.SF,a.SPS.SL));null!=a.ISS&&(k=a.ISS);return new wac_iS(a.I,a.A,a.C,a.O,wac_tWb(a.AN),
b,c,d,e,f,g,h,1,k)}function wac_9_b(){this.MNb=this.LNb=0}wac_9_b.prototype={MNb:0,LNb:0};function wac_$_b(a,b,c,d,e,f,g,h){wac_$_b.initializeBase(this,[a,b,c,d,e,f,g,h])}function wac_a0b(){if(window.Box4.App.ya()){var a=window.Box4.App.ya().La;a&&(a.u5(wac_b0b),(a=a.Ec())&&(wac_c0b=a.Ee)&&window.Box4.App.Q5().CW(wac_d0b))}}function wac_d0b(){(wac_e0b=window.Box4.App.Q5().rc())&&wac_e0b.Km()&&(wac_f0b||(wac_f0b=wac_k().H(wac_et,null))).mM().CW(wac_g0b)}
function wac_g0b(){if(wac_h0b=(wac_f0b||(wac_f0b=wac_k().H(wac_et,null))).mM().rc()){var a=wac_r.W,b=a.ga("Box4ThrottleInboundRequests"),a=a.Xb("Box4ThrottleInboundsAtUserCount",20),c=new wac_iAa(11,1);wac_c0b.LFb=function(){return wac_h0b.vRb()};wac_i0b=wac_i0b||new wac_$_b(wac_h0b,function(){return wac_c0b},wac_e0b,function(){return wac_r.Th},b,a,c,wac_eg(window.Box4.App.ya()));wac_i0b.Ox()}}function wac_b0b(a){wac_i0b||(a.X1a(wac_b0b),wac_a0b())}
function wac_j0b(a,b,c){this.Ena=a;this.C6=c;this.Nf=b}
function wac_k0b(a,b,c,d,e){if(!a||!wac_l(wac_k(),wac_O).ub(185)||!b)return null;if(a.aB)return wac_(7685324,302,15,"Presence packet is of unexpected operationType {0}",a.aB),null;var f;if(wac_i(a.p3)){var g=a.dM;f=g?new wac_9R(g,null,null,new wac_2k(0),null,null,null,a.srb,null,!1,!1,!1,null):null}else g=a.dM,f=a.p3.Capabilities,f=g?new wac_9R(g,a.p3.UserName,null,new wac_2k(wac_tb(f)?0:f),a.p3.LocalCobaltSessionId,a.p3.SkypeChatThreadId,a.p3.Email,a.srb,a.p3.ChatThreadDiscoveryUri,a.p3.IsAnonymous,
a.p3.InChat,!1,a.p3.PresenceStatus):null;g=a.m8;a=a.sJ;if(b){var h=window.parseInt(a.Ata);b=new wac_jS(b,h,a.FFa,a.CEa,c,d,e,a.OYc)}else b=null;return new wac_j0b(g,f,b)}
wac_j0b.prototype={Ena:0,ZIb:!1,C6:null,Jm:function(){return this.C6},Xye:function(){return this.ZIb},CBe:function(a){(this.ZIb=a)&&this.C6.jTc();return a},iia:!1,lTb:function(a){return this.iia=a},Uqa:!1,Wuc:function(a){return this.Uqa=a},Nf:null,GBe:function(a){return this.Nf=a},iMc:function(){var a;a=wac_l0b;4294967295===a.LNb&&(a.LNb=0);a.LNb++;a=a.LNb;return new wac_iS(this.Ena,this.Nf.mi(),1,0,this.C6?this.C6.$B():null,new wac_O_b(this.Nf.MB,this.Nf.V2a,this.Nf.U2a,this.Nf.oBa,this.Nf.Fv.Fv,
this.Nf.Ix,this.Nf.Sq,this.Nf.Jx,this.Nf.yba),null,null,null,null,null,null,0,a)},Ltb:function(){return this.Nf.mi()+(this.C6?this.C6.LG().toString():wac_y().toString())},Hk:function(){var a=!!this.Nf&&this.Nf.Hk(),b=!this.C6||this.C6.Hk();return a&&b},Oc:function(){var a=new wac_j0b;a.Ena=this.Ena;a.ZIb=this.ZIb;a.Nf=this.Nf?this.Nf.Oc():null;a.C6=this.C6?this.C6.Oc():null;a.iia=this.iia;a.Uqa=this.Uqa;return a}};
function wac_m0b(a,b,c,d,e,f){this.Hid=a;this.ze=c;this.hX=d;this.kv=e;this.Ri=f;this.pCa=b}
wac_m0b.prototype={Hid:null,Qa:null,ze:null,hX:null,kv:null,Ri:null,Oc:function(){return new wac_m0b(this.Hid,this.pCa.Oc(),this.ze,this.hX,this.kv,this.Ri)},pCa:null,Lf:function(){if(null!=this.Qa)return this.Qa;var a=this.Hid.LG();if(a.Ca(wac_y()))return 0;var b=this.hX();if(!b)return 0;a=b.Mb(a);if(!a)return wac_(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;b=wac_MR(wac_OR(a.Hb,a.wa),this.pCa);if(this.kv&&this.Ri&&wac_vA(a)){var c=wac_yy(a,b);c.tc=wac_G6a(this.Ri,a,
b,this.pCa.Faa);b=wac_ny(0,c,!0)}return b},jTc:function(){null==this.Qa&&(this.Qa=this.Lf())},Ca:function(a){return a?this.pCa.Uy(a.pCa,!1):!1}};function wac_n0b(a,b){this.kv=a;this.Ri=b}wac_n0b.prototype={kv:null,Ri:null,Pa:function(a,b,c,d){return new wac_m0b(a,b,c,d,this.kv,this.Ri)}};function wac_jS(a,b,c,d,e,f,g,h){this.Vr=a;this.hX=f;this.ze=e;this.Zga=g;this.Ye=b;this.Gy=h;this.JY=c;this.UL=g.Pa(this,d,e,f)}
wac_jS.prototype={hX:null,Vr:null,Elc:null,ze:null,Zga:null,Oc:function(){return new wac_jS(this.Vr,this.Ye,this.JY,this.UL.pCa,this.ze,this.hX,this.Zga,this.Gy)},Ye:0,ir:function(){return this.Ye},LG:function(){return this.Elc?this.Elc:wac_3P(this.Vr,this.Ye)},Gy:0,jTc:function(){this.Elc||(this.Elc=this.LG(),this.UL.jTc())},UL:null,JY:0,FBe:function(a){return this.JY=a},Hk:function(){return 0<=this.UL.Lf()},$B:function(){var a=this.UL.pCa;return a?new wac_NR(0,this.Ye,this.JY,a,null,null,null,0,
this.Gy):null}};
function wac_kS(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,I,H){this.VKe=Function.createDelegate(this,this.Apf);this.WKe=Function.createDelegate(this,this.Bpf);wac_kS.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,m,p,q,r,t,w,x,y,z,A,B,C,D,E,I]);wac_C(n,1177859183,1,wac_o0b,64);wac_C(n,3460066539,1,wac_p0b,64);wac_C(n,477883041,1,wac_q0b,96);wac_C(n,761503246,1,wac_r0b,64);this.Vr=u;this.ze=v;this.Zga=F;this.S_.O4a=G;this.S_.O4a.va.hb("X",wac_s0b);var J=this;H.CW(function(){J.yf=H.rc()});
wac_(4006600,302,50,"WordPresenceManager Initialized")}function wac_t0b(){return wac_u0b||(wac_u0b=wac_k().H(wac_et,null))}
function wac_v0b(){wac_w0b||(wac_w0b=new (wac_6a.$$(wac_Xca)));wac_x0b&&(wac_(4256585,302,50,"WordPresenceManager Init"),wac_x0b=!1);if(window.Box4.App.ya()){var a=window.Box4.App.ya().La;a?(a.u5(wac_y0b),(wac_lS=a.vd)&&wac_lS.uj()?(wac_z0b=a.Ec().Ee)?(wac_A0b=a.Ec().gd())?wac_t0b().mM().CW(wac_B0b):wac_(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app"):wac_(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object"):
wac_(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):wac_(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else wac_(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}
function wac_B0b(){if(wac_C0b=wac_t0b().mM().rc()){var a=[];Array.add(a,wac_lS.tCc);Array.add(a,wac_lS.Me().csd());var b=wac_hw(),c=wac_k().H(wac_gS,null),d=new wac_2Zb(c,b,wac_k().H(wac_vb,null),wac_C0b),e=wac_r.W.ga("DoNotAddToEditorsTableOnFrameIsEnabled")?window.Box4.App.Dc.Su:null,e=new wac_YZb(wac_C0b,e),f=wac_xb(wac_k(),wac_dP),g=wac_k().H(wac_tQ,null),h=new wac_iAa(8,5),k=wac_k().H(wac_8b,null);wac_mS=new wac_kS(wac_C0b,a,wac_A0b,b,k,c,d,e,wac_lS,wac_lS.Me().zc(),wac_k().H(wac_a_b,null),wac_z(),
wac_z0b,wac_V,wac_MWb,wac_k().H(wac_8R,null),f,g,window.Box4.App.Bi.ul,new wac_zw,wac_s(),wac_Ri(),wac_yb(wac_ym,wac_m(wac_k(),wac_ym)),wac_r.W,wac_r.W.ga("Box4ThrottleAndBatchPresenceRendering"),wac_r.W.ga("Box4DoNotRenderPresenceOutOfView"),h,wac_k().H(wac_hS,null),wac_k().H(wac_Yca,null),!window.Box4.App.vw()&&!window.Box4.App.po,window.Box4.App.Q5());wac_(23196878,302,50,"WordPresenceManager instance created");wac_w0b.tg(wac_mS);wac_nS.tg(wac_mS);wac_D0b.tg(wac_mS);a=wac_k();wac_n(wac_o(wac_p(wac_p(a.na(wac_kS,
null),wac_Wca),wac_Xca)),function(){return wac_mS});a.H(wac_kS,null)}else wac_(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}function wac_y0b(a){wac_mS||(wac_(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(a=window.$$as(wac_tu,a))&&a.X1a(wac_y0b),wac_v0b())}function wac_s0b(){wac_z_b(wac_mS)}
function wac_o0b(a,b,c,d,e){c=e.split(",");if(!c||3!==c.length)return 8;a=c[0].trim();b=c[1].trim();c=Number.parseInvariant(c[2].trim());a=new wac_eS(new wac_9R(a),new wac_fS(b,c,-1,0,0));if(!wac_1a(wac_nS.Yc))return 8;b=wac_nS.Yc.rc();wac_B_b(b,a);b.KOb||wac_C_b(b);return 32}function wac_p0b(a,b,c,d,e){if(!wac_1a(wac_nS.Yc))return 8;a=wac_nS.Yc.rc();a.pyb(e);a.KOb||wac_C_b(a);return 32}
function wac_r0b(a,b,c,d,e){if(!wac_1a(wac_nS.Yc))return 8;a=wac_nS.Yc.rc();if(!a)return 8;if(e&&e.Hk()&&e.Jm()){b=wac_4Zb(a.GJa,e.Jm().LG().toString(),-1,-1,!1);c=!1;d=null;for(var f=0;f<b.length;f++)if(d=b[f],d.Nf.mi()===e.Nf.mi()){d.Wuc(!0);c=!0;break}if(c)if(b=d.Jm().LG(),e=wac_F_b(a,b)){b=a.wb.Hc(2,0);try{wac_S(b,e),e.YA(a.QKb.zc(),32,!0),e.YA(a.G7c,32,!0)}finally{b&&b.dispose()}}else wac_G_b(a,b)}return 32}
function wac_q0b(a,b,c,d,e){if(1===c)return 32;if(!wac_1a(wac_t0b().mM()))return 8;a=wac_t0b().mM().rc();if(!a)return wac_(4301136,302,10,"rtcProxy is null when trying to display RTC connection status"),8;e.Value=2===a.Eoa()?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===a.Eoa()?WordEditorIntl.WordEditorStrings.L_RtcConnecting:"";return 32}
wac_kS.prototype={Ke:function(){return wac_k().H(wac_O,null)},Zga:null,yf:null,Vr:null,ze:null,I7a:function(a){if(!a||!a.Cb)return null;for(a=a.Cb.fm;a;a=a.zt)if(wac_XJ(a))return a.En.fa;return null},zGc:function(a){var b=null,b=wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled");if(this.Ke().ub(185)&&this.Ke().ub(154)){var c=a.Ga().za,d=a.Ga().fa;b&&wac_Cz(d)&&(d=this.I7a(d));if(!d)return wac_(51242309,302,15,"selectedNode is null"),null;var d=this.jgc(d),e=a.Ga().fa.pa(Number,wac__p,0);if(!this.Vr)return wac_(35997152,
302,15,"paragraphWordIdMapping is null"),null;var f=wac_3P(this.Vr.qa(),e),g=wac_A0b.Mb(f);if(!g)return wac_(16791249,302,15,"Can't find pid "+f),null;c=wac_KR(wac_OR(g.Hb,g.wa),c);c.Faa=-1===wac_bA(a.Ga())?0:wac_bA(a.Ga());f=0;b&&wac_S4a(a)&&(f=wac_E0b(a));b=new wac_jS(this.Vr.qa(),e,d,c,this.ze,function(){return wac_A0b},this.Zga,f)}else b=wac_u_b.prototype.zGc.call(this,a);return b},sRd:function(a){this.yf&&this.yf.DU&&this.yf.DU.Ox(this.WKe,this.VKe,a)},Bpf:function(a){var b=!!wac_TFa(this.yf.Su,
a);wac_(579179741,302,50,"ClientId:{0} isPresentAfterPoll:{1}",a,b)},Apf:function(a,b){wac_(579179742,302,15,"EditorsReplicator failed with {0} when looking for ClientId {1}",b,a)}};function wac_E0b(a){var b=wac_CE(a.Ga());return b?b.Fh.pa(Number,wac_Js,0):a.Ga().fa.Na().pa(Number,wac_Js,0)}function wac_F0b(){}
function wac_G0b(){!wac_H0b&&window.Box4.App.ya()&&window.Box4.App.ya().Lv&&(wac_H0b=window.WordEditor.App.Ck().Lv.getElementsByClassName("OutlineContainerDisplayWrapper")[0]);return wac_H0b}function wac_I0b(){return wac_G0b()?wac_Dj(wac_G0b()):null}
wac_F0b.prototype={Z:null,qh:!1,Zb:function(){return"WordEditor.Presence"},zb:function(){wac_(50995799,302,50,"PresencePackage Init");window.Box4.App.K2d&&(this.Z.H(wac_oS,null).mM(),wac_v0b(),this.Z.H(wac_J0b,null));window.Box4.App.DHc&&wac_a0b();this.Z.H(wac_3n,null);this.Z.H(wac_8b,null)},oa:function(){if(!this.qh){this.qh=!0;wac_nS.Yc.CW(function(){wac_Lb(wac_nS.Yc.rc())});var a=this.Z.H(wac_8R,null);a&&a.O4a&&a.O4a.va.Uc("X",wac_s0b)}},$b:function(a){this.Z=a;wac_n(wac_o(wac_p(wac_p(wac_p(this.Z.na(wac_8R,
null),wac_VZb),wac_hc),wac_Vca)),function(){return new wac_8R});wac_n(wac_o(a.na(wac_hS,null)),function(){return new wac_n0b(a.H(wac_PB,null),a.H(wac_Jv,null))});wac_n(wac_o(a.na(wac_J0b,null)),function(){return new wac_J0b(new (wac_d.$$(wac_gu))(function(){return window.Box4.App.Dc}),wac_ey(),a.H(wac_oS,null).Vtb(),a.H(wac_VZb,null))});wac_n(wac_p(wac_p(wac_o(a.na(wac_oS,null)),wac_et),wac_iya),function(){return new wac_oS(wac_r.Aq,wac_eg(window.Box4.App.ya()),wac_s(),function(){return wac_r.Th},
wac_k().H(wac_VZb,null),wac_l(wac_k(),wac_UC),wac_k().H(wac_tQ,null),function(){return wac_t()&&window.Box4.App.ya().La&&window.Box4.App.ya().La.Ec()?window.Box4.App.ya().La.Ec().gd():null},wac_K0b,function(){return wac_l(wac_k(),wac_aP)},wac_m(wac_k(),wac_ac),wac_k().H(wac_hS,null),wac_r.W)});wac_n(wac_o(a.na(wac_a_b,null)),function(){var a;a=wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled");var c=new wac_QXb;c.U(String,0,wac_Jh(wac_Hh,"MoreUsersGlyph16"));c.U(String,5,wac_Ih);c.U(String,1,wac_Jh(wac_Hh,
a?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));c.U(String,4,wac_Ih);c.U(Number,12,1);c.U(Boolean,8,wac_pg);c.U(Function,16,wac_I0b);a=a?new wac_lXb(c):new wac_NXb(c);return new wac_a_b(a,wac_Xf(),wac_m(wac_k(),wac_gc),wac_k().H(wac_Cu,null),wac_yb(wac_ec,wac_m(wac_k(),wac_ec)),wac_r.W)});wac_n(wac_o(a.na(wac_3n,null)),function(){return new wac_3n(wac_k().H(wac_hc,null),wac_k().H(wac_oS,null).Vtb(),wac_D0b.Yc,wac_k().H(wac_Vca,null),wac_s(),wac_r.W.ga("AwayStatusOneMinuteTimeoutIsEnabled")?
6E4:wac_r.W.Xb("AwayCoauthorThresholdMs",9E5),wac_z().g1e,window.Box4.App.ya().yz,wac_r.W.ga("PeoplesWellExtraButtonInfoIsEnabled"))});wac_n(wac_p(wac_o(a.na(wac_L0b,null)),wac_Yca),function(){return new wac_L0b(wac_yb(wac_Xb,wac_m(wac_k(),wac_Xb)))});wac_n(wac_p(wac_o(a.na(wac_NFa,null)),wac_8b),function(){return new wac_NFa(a.H(wac_oS,null).Vtb(),window.Box4.App.Q5().CWR(wac_xca,function(){return window.Box4.App.Q5().rc().Su}),a.H(wac_ab,null),a.H(wac_Vca,null),wac_yb(wac_3n,wac_m(a,wac_3n)))});
wac_n(wac_p(wac_o(a.na(wac_gS,null)),wac_BUa),function(){return new wac_gS(window.Box4.App.ya().La.Ec().gd(),wac_k().H(wac_O,null))})}};function wac_L0b(a){this.va=new wac_nd;this.VH=a;var b=this;this.VH.CWR(Function,function(){return b.VH.rc().X5f(function(){b.va.Ya("X",null,null)})})}wac_L0b.prototype={VH:null};
function wac_J0b(a,b,c,d){this.U0=Function.createDelegate(this,this.Bda);this.xYe=Function.createDelegate(this,this.RIf);this.yf=a;this.zE=b;this.sN=c;c.CW(this.xYe);this.tke=d;this.tke.FBc=this.zE}
wac_J0b.prototype={zE:null,sN:null,Zi:null,tke:null,Ded:!1,b9c:!1,yf:null,Jbf:!1,RIf:function(){wac_1a(this.sN)&&this.sN.rc()?(this.Zi=this.sN.rc(),this.Zi.mLa(this.U0),wac_(5604372,302,50,"Presence Update Monitor is ready.")):wac_(5604373,302,15,"RtcTask did not complete successfully. No monitoring")},Bda:function(a,b){a=b.Tba;for(var c in a){b=a[c];if(!this.b9c&&this.yf&&this.yf.qa()){var d=b.Nf.XMa;d&&1===d||(this.Jbf=!0)}if(!this.Ded&&b.Nf.MB&&b.Nf.MB!==this.zE.MB){wac_(5604375,302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",
this.zE.MB,b.Nf.MB);this.Ded=!0;break}}this.Ded&&this.Zi.Y1a(this.U0);this.b9c||(wac_(5604374,302,50,"First presence received"),this.b9c=!0)}};function wac_M0b(a,b,c,d,e,f,g,h,k,l,m,n,p){wac_M0b.initializeBase(this,[a,b,c,d,e,f,p]);this.Vr=g;this.ze=h;this.hX=k;this.IKb=l;this.$Nb=m;this.Zga=n}
wac_M0b.prototype={zx:null,Vr:null,ze:null,hX:null,IKb:null,$Nb:null,Zga:null,pU:function(){return this.zx||(this.zx=this.$Nb())},G2:function(a,b){2===b.yt&&wac_(4315102,302,50,"RTC Connected");this.pU()&&this.pU().AO("RtcConnectionStatusLabel");wac_I_b.prototype.G2.call(this,a,b)},AOd:function(a){return wac_k0b(wac_6_b(a),this.Vr,this.ze,this.hX,this.Zga)},gYc:function(a,b){return wac_jS.isInstanceOfType(b)?(a=new wac_j0b(wac_4_b(this.IKb),a,b),wac_8_b(a.iMc())):wac_I_b.prototype.gYc.call(this,a,
b)}};function wac_oS(a,b,c,d,e,f,g,h,k,l,m,n,p){this.hl=new (wac_6a.$$(wac_LQa));this.icc=a;this.yc=b;this.Ua=c;this.oB=d;this.S_=e;this.Vr=f;this.Cza=g;this.hX=h;this.IKb=k;this.$Nb=l;this.z_a=m;this.Zga=n;this.xa=p}function wac_N0b(){return!1}wac_oS.prototype={icc:null,yc:null,Ua:null,oB:null,S_:null,Vr:null,Cza:null,hX:null,IKb:null,$Nb:null,z_a:null,Zga:null,xa:null,Sse:!0,mM:function(){wac_O0b(this);return this.hl.Yc},Vtb:function(){return wac_ci(0,wac_$b,this.mM(),function(a){return a})}};
function wac_P0b(a){var b=wac_k();wac_n(wac_o(wac_p(wac_p(b.na(wac_M0b,null),wac_LQa),wac_$b)),function(){return a});b.H(wac_$b,null)}
function wac_O0b(a){if(a.Sse)if(a.Sse=!1,window.Box4.App.lPc()&&window.Box4.App.QOc()){var b=wac_r.Se;if(b){var b=wac_0Yb("{"+wac_r.Uf+"}",wac_r.Uf,wac_r.oZd,b,a.z_a,a.yc,a.xa.mb("RtcEndpointUrl"),a.xa.ga("FindSessionOnBootIsEnabled")?wac_k().H(wac_Dc,null):null,a.xa.mb("RtcBootToken")),c=a.xa.ga("RtcAlwaysOnEnabled"),d=new wac_M0b(b,c?null:window.Box4.App.Q5(),a.Ua,a.oB,wac_N0b,a.S_,a.Vr,a.Cza,a.hX,a.IKb,a.$Nb,a.Zga,wac_r.W);window.Box4.App.pUf(d);wac_P0b(d);d.zb();window.WordEditor.App.Pta=d;a.z_a.jb(function(a){a.V0a(function(){d.tsb()})});
a.hl.tg(d)}else wac_(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else wac_(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}wac_gS.registerClass("Box4.Presence.WordPresenceDataManager",wac_dS);wac_O_b.registerClass("WordEditor.Presence.SerializableWacData");wac_S_b.registerClass("WordEditor.Presence.SerializableRTTDataV1");wac_T_b.registerClass("WordEditor.Presence.SerializableAddParaDataV1");wac_U_b.registerClass("WordEditor.Presence.SerializableMergeRemoveParaDataV1");
wac_V_b.registerClass("WordEditor.Presence.SerializableSplitParaDataV1");wac_W_b.registerClass("WordEditor.Presence.SerializableSymbolDataV1");wac_iS.registerClass("WordEditor.Presence.RTTData");wac_Y_b.registerClass("WordEditor.Presence.AddParaData");wac_Z_b.registerClass("WordEditor.Presence.MergeRemoveParaData");wac___b.registerClass("WordEditor.Presence.SplitParaData");wac_0_b.registerClass("WordEditor.Presence.SymbolData");wac_1_b.registerClass("WordEditor.Presence.RTTDataVersion");wac_2_b.registerClass("WordEditor.Presence.SerializableObjectWithVersion");
(function(){}).registerClass("WordEditor.Presence.Program");wac_3_b.registerClass("WordEditor.Presence.PacketIdGenerator",null,wac_R_b);(function(){}).registerClass("WordEditor.Presence.RTTDataHelper");(function(){}).registerClass("WordEditor.Presence.RTTDataMethods");(function(){}).registerClass("WordEditor.Presence.SerializableRTTDataV1Methods");wac_9_b.registerClass("WordEditor.Presence.StrictlySequentialIdGenerator",null,wac_X_b);
wac_$_b.registerClass("WordEditor.Presence.WordContentNotificationManager",wac_WZb);wac_j0b.registerClass("WordEditor.Presence.WordPresenceInfo",null,wac_IQa,wac_Sb.$$(wac_IQa));wac_m0b.registerClass("WordEditor.Presence.WordPresenceCp",null,wac_JQa,wac_Sb.$$(wac_JQa),wac_Q_b);wac_n0b.registerClass("WordEditor.Presence.WordPresenceCp.Factory",null,wac_hS);wac_jS.registerClass("WordEditor.Presence.WordPresenceIp",null,wac_KQa,wac_Sb.$$(wac_KQa),wac_P_b);
wac_kS.registerClass("WordEditor.Presence.WordPresenceManager",wac_u_b);wac_F0b.registerClass("WordEditor.Presence.WordPresencePackage",null,wac_J,wac_j);wac_L0b.registerClass("WordEditor.Presence.WordPresenceStatusProvider",null,wac_Yca);wac_J0b.registerClass("WordEditor.Presence.WordPresenceUpdateMonitor");wac_M0b.registerClass("WordEditor.Presence.WordRtcProxy",wac_I_b);wac_oS.registerClass("WordEditor.Presence.WordRtcProxyProvider",null,wac_et,wac_iya);wac_1_b.L0d=[1];
var wac_K0b=new wac_3_b,wac_l0b=new wac_9_b,wac_i0b=null,wac_f0b=null,wac_h0b=null,wac_c0b=null,wac_e0b=null,wac_mS=null,wac_x0b=!0,wac_w0b=new (wac_6a.$$(wac_Xca)),wac_nS=new (wac_6a.$$(wac_kS)),wac_D0b=new (wac_6a.$$(wac_Wca)),wac_A0b=null,wac_lS=null,wac_z0b=null,wac_C0b=null,wac_u0b=null,wac_H0b=null;wac_K(wac_E(),new wac_F0b,0);Type.registerNamespace("WERTT");function wac_pS(){}wac_pS.registerInterface("WERTT.IParagraphAnchoredOp");function wac_Q0b(){}wac_Q0b.registerInterface("WERTT.IRttDataStore");
function wac_R0b(){}wac_R0b.registerInterface("WERTT.IRttEditor");function wac_S0b(){}wac_S0b.prototype={unknown:0,replaceTextRangeOp:1,addParagraphOp:2,deleteParagraphOp:3,splitParagraphOp:4,mergeParagraphOp:5,replaceSymbolRangeOp:6};wac_S0b.registerEnum("WERTT.RttOpType",!1);function wac_qS(){}wac_qS.registerInterface("WERTT.IRttOp");function wac_rS(){}wac_rS.registerInterface("WERTT.IRttAppliedOp");function wac_T0b(){}wac_T0b.registerInterface("WERTT.IRttAppliedOpTracker");
function wac_U0b(){}wac_U0b.registerInterface("WERTT.IRttOpValidator");function wac_V0b(){}wac_V0b.registerInterface("WERTT.IRttSendDataStore");function wac_W0b(a,b){this.Iyd=Function.createDelegate(this,this.AFf);this.Gyd=Function.createDelegate(this,this.Twb);this.Fyd=Function.createDelegate(this,this.gSc);this.dispose=this.oa;this.Ap=a;if(this.Rm=b)a=wac_qz(this.Rm,12),wac_1G(a,this.Fyd),wac_uz(a,this.Gyd),wac_2G(a,this.Iyd)}
wac_W0b.prototype={Ap:null,Rm:null,oa:function(){if(this.Rm){var a=wac_qz(this.Rm,12);wac_$J(a,this.Fyd);wac_yz(a,this.Gyd);wac_aK(a,this.Iyd)}},gSc:function(a,b){4===this.Ap.XI()?wac_c(9204866,355,12===b.fa.get_type()||11===b.fa.get_type(),"Unexpected graph modification detected during RTT edit"):wac_c(9204867,355,!1,"Unexpected graph modification detected during RTT edit")},Twb:function(){wac_c(9204868,355,!1,"Unexpected graph modification detected during RTT edit")},AFf:function(){wac_c(9204869,
355,!1,"Unexpected graph modification detected during RTT edit")}};function wac_sS(a,b){this.pCc=a;this.BA=b}wac_sS.prototype={pCc:0,XI:function(){return this.pCc},BA:null,Cpa:null,y5a:null,Y0:null,rMc:function(){return""},zM:function(){return null}};function wac_X0b(a,b){a.Y0=b}function wac_Y0b(){this.jNe=Function.createDelegate(this,this.mtf)}
wac_Y0b.prototype={Z:null,Zb:function(){return"WordEditor.RealTimeTyping"},mtf:function(){return window.Box4.App.Dc&&window.Box4.App.Dc.Ul?window.Box4.App.Dc.Ul:(wac_(7866377,304,15,"Unable to get the lock manager"),null)},$b:function(a){var b=wac_yb(wac_Ou,wac_m(a,wac_Ou)),c=wac_yb(wac_O,wac_m(a,wac_O)),d=wac_yb(wac_lc,wac_m(a,wac_lc)),e=wac_yb(wac_tQ,wac_m(a,wac_tQ));this.Z=a;var f=new wac_zw,g=this;wac_Ua.WAA.call(null,b,c,d,e).CW(function(){wac_n(wac_o(a.na(wac_R0b,null)),function(){return new wac_Z0b(a.H(wac_Yu,
null),a.H(wac_Ou,null),f,a.H(wac_tQ,null))});wac_n(wac_o(wac_p(a.na(wac__0b,null),wac_HKb)),function(){return new wac__0b(a.H(wac_R0b,null),new wac_00b(wac_F()),new (wac_d.$$(wac_C0a))(g.jNe),new (wac_d.$$(wac_BVa))(function(){return window.Box4.App.WO}),a.H(wac_O,null),a.H(wac_UC,null),a.H(wac_et,null).mM(),new (wac_d.$$(wac_pt))(function(){return window.Box4.App.ya().La.Ec().gd()}),wac_s(),function(){return Date.now()},a.H(wac_tQ,null),wac_F(),wac_m(a,wac_lc),wac_nS.Yc,f,wac_r.W.ga("WordEditorThrottleAndBatchRTTRendering"),
new wac_10b,wac_m(a,wac_hS))});wac_n(wac_o(a.na(wac_20b,null)),function(){return new wac_20b(a.H(wac_et,null).mM(),new wac_30b,new (wac_d.$$(wac_gu))(function(){return window.Box4.App.Dc}),window.Box4.App.ya().La,a.H(wac_tQ,null),a.H(wac_O,null))});g.KNc()})},KNc:function(){this.Z.H(wac__0b,null).zb();this.Z.H(wac_20b,null).zb()},zb:function(){},oa:function(){}};function wac_40b(){this.rBb=new (wac_e.$$(wac_tS))}
wac_40b.prototype={rBb:null,U:function(a){this.rBb.U(a);return!0},J2b:function(a){for(var b=new (wac_e.$$(wac_tS)),c=this.rBb.$$lge();c.$$mn();){var d=c.$$cu();a(d)&&b.U(d)}return b},XWc:function(a){wac_50b(a.Cpa,wac_60b.toString(1));this.rBb.Ab(a)},YWc:function(a){wac_50b(a.Cpa,wac_60b.toString(0));this.rBb.Ab(a)}};function wac_tS(a,b,c,d,e,f,g,h){wac_tS.initializeBase(this,[2,h]);this.$Fa=a;this.X0d=b;this.dab=c;this.Iac=d;this.P5b=e;this.O5b=f;this.BJ=g}
wac_tS.prototype={$Fa:0,X0d:0,dab:0,Iac:null,P5b:0,O5b:0,BJ:0,zM:function(){return new wac_iS(this.BA.m8,this.BA.dM,1,3,new wac_NR(2,this.$Fa,this.X0d,null,this.Iac,null,null,this.BJ,0),null,null,null,new wac_Y_b(this.dab,this.P5b,this.O5b),null,null,null,0,this.BA.B8)}};function wac_70b(a,b){this.QYd=a;this.VR=b}wac_70b.prototype={XI:function(){return 1},Ikb:function(){return this.QYd},QYd:null,VR:null};function wac_80b(a,b){this.PYd=a;this.VR=b}
wac_80b.prototype={XI:function(){return 6},Ikb:function(){return this.PYd},PYd:null,VR:null};function wac_uS(a,b,c){this.EZc=a;this.Jzb=b;this.H6a=c}wac_uS.prototype={XI:function(){return 4},Ikb:function(){return this.EZc},EZc:null,Jzb:null,H6a:null};function wac_90b(a,b){this.LZb=a;this.VR=b}wac_90b.prototype={XI:function(){return 2},Ikb:function(){return this.LZb},LZb:null,VR:null};function wac_10b(){this.Sua=new (wac_Ia.$$(wac_e.$$(wac_rS)))}
wac_10b.prototype={Sua:null,Twb:function(a){var b=a.toString();if(!this.Sua.Xa(b))return new (wac_e.$$(wac_rS));a=this.Sua.B(b);this.Sua.Ab(b);for(b=a.$$lge();b.$$mn();){var c=b.$$cu();c.Ikb()&&wac_X0b(c.Ikb(),null)}return a}};function wac_$0b(a,b){for(a=a.Sua.Zj().$$ge();a.$$mn();){var c=a.$$cu();if(c.la()&&2===c.B(0).XI()&&(c=c.B(0),c.LZb.P5b===b))return c}return null}function wac_a1b(a,b){return a.Twb(b)}
function wac_b1b(a,b){switch(b.XI()){case 1:var c=window.$$as(wac_70b,b);wac_c1b(a,c.VR,b);break;case 6:c=window.$$as(wac_80b,b);wac_c1b(a,c.VR,b);break;case 4:c=window.$$as(wac_uS,b);wac_c1b(a,c.Jzb,b);wac_c1b(a,c.H6a,b);break;case 2:c=window.$$as(wac_90b,b),wac_c1b(a,c.VR,b)}}function wac_c1b(a,b,c){b=b.toString();a.Sua.Xa(b)||a.Sua.ea(b,new (wac_e.$$(wac_rS)));a.Sua.B(b).U(c)}function wac_00b(a){this._changes=new (wac_Ba.$$(wac_Ba.$$(wac_pS)));this.Ob=a}
wac_00b.prototype={_changes:null,Ob:null,J2b:function(a){for(var b=new (wac_e.$$(wac_pS)),c=this._changes.Mg().$$ge();c.$$mn();)for(var d=c.$$cu(),d=this._changes.B(d),e=d.Mg().$$ge();e.$$mn();){var f=e.$$cu(),f=d.B(f);a(f)&&b.U(f)}return b},XWc:function(a){wac_d1b(this,a,1)},YWc:function(a){wac_d1b(this,a,0)}};
function wac_d1b(a,b,c){var d=null,e,f;(f=a._changes.Sb(b.ir(),e={val:d},null),d=e.val,f)?(wac_50b(b.Cpa,wac_60b.toString(c)),d.Ab(b.MG()),d.la()||a._changes.Ab(b.ir())):wac_(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",b.ir(),c)}function wac_e1b(a,b,c){if(!a._changes.Xa(b))return null;a=a._changes.B(b);return a.Xa(c)?a.B(c):null}function wac_60b(){}wac_60b.prototype={expired:0,dried:1};wac_60b.registerEnum("WERTT.RttDataStore.RemoveChangeReason",!1);
function wac_f1b(a,b,c,d){wac_f1b.initializeBase(this,[3,d]);this.Ye=a;this.At=b;this.BJ=c}wac_f1b.prototype={Ye:0,ir:function(){return this.Ye},At:0,MG:function(){return this.At},Rkb:function(){return 0},BJ:0,zM:function(){return new wac_iS(this.BA.m8,this.BA.dM,1,5,new wac_NR(4,this.Ye,this.At,null,null,null,null,this.BJ,0),null,null,null,null,null,null,null,0,this.BA.B8)}};function wac_Z0b(a,b,c,d){this.xW=a;this.VYa=b;this.A9=c;this.cqc=d}
wac_Z0b.prototype={xW:null,VYa:null,A9:null,cqc:null,G8a:function(a){var b=new wac_T;b.uc(a);wac_cy(b,11);return wac_Pz(b)?(wac_(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}};
function wac_g1b(a){var b=a.fa.wa,c=a.za;a=a.Ra;for(var d=0;d<b.ka();d++){var e=b.B(d);if(e.Qa>=a)break;if(e.Qa>=c){if(e.Kf)return wac_(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(e.Dd)return wac_(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(e.vg||e.Pp&32||e.Pp&64)return wac_(8242649,355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}
function wac_h1b(a,b,c,d){for(var e=c.la()-1;0<=e;e--){var f=c.B(e);switch(f.XI()){case 4:f=window.$$as(wac_uS,f);if(!b.ia().Ca(f.Jzb)){wac_c(9204885,355,b.ia().Ca(f.H6a),null);continue}f=d.Mb(f.H6a);if(!f)break;if(!f||!wac_W(f)){wac_c(9204886,355,!1,null);break}if(!f.Cb)continue;var g,h,k,f=(k=wac_i1b(f,h={val:g}),g=h.val,k);wac_c(9204887,355,f,null);f&&wac_j1b(a,g);break;case 2:if(f=window.$$as(wac_90b,f),!b.ia().Ca(f.VR))wac_c(16820001,355,!1,null);else if(b.Cb){var l,m,f=(m=wac_i1b(b,l={val:g}),
g=l.val,m);wac_c(16820002,355,f,null);f&&wac_j1b(a,g)}}}}function wac_k1b(a,b){if(b.Cb){var c,d,e;if(e=wac_i1b(b,d={val:c}),c=d.val,e)wac_j1b(a,c);else{c=wac_ix(b).ph;a=a.A9.Hc(3,0);try{wac_S(a,b),b.zj(c.Mb(b.ia())),wac_Iz(b.Cb,4)}finally{a&&a.dispose()}}}}function wac_j1b(a,b){var c=new wac_T;c.uc(b);wac_Y(c);a=a.A9.Hc(3,0);try{wac_S(a,c.ja()),wac_vx(b)}finally{a&&a.dispose()}}function wac_i1b(a,b){b.val=wac_R(a);wac_U(b.val,23);wac_Y(b.val);return 89===b.val.vj()}
function wac_l1b(a,b,c){return b===c?wac_yy(a,b):wac_X(a,b,c)}function wac_m1b(a,b,c,d){var e=wac_3P(c,b.$Fa);if(e.Ca(wac_y()))return null;e=d.Mb(e);if(!e||!wac_W(e)||!e.Cb)return null;var f=wac_R(e);if(!wac_U(f,23))return null;if(b.Iac){b=wac_3P(c,b.Iac);if(b.Ca(wac_y()))return null;d=d.Mb(b);if(!d||!wac_W(d)||!d.Cb)return null;d=wac_R(d);if(!wac_U(d,23))return null;wac_cy(d,11);wac_yF(d);wac_gx(d);if(d.ja()!==e)return null}return a.G8a(f)?null:f}
function wac__0b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v){this.uY=Function.createDelegate(this,this.k8);this.Ywc=Function.createDelegate(this,this.uTc);this.vLe=Function.createDelegate(this,this.sqf);this.fKa=a;this.lHa=b;this.Qfb=c;this.kxa=d;this.fb=e;this.Vr=f;this.sN=g;this.fh=h;this.Ua=k;this.wp=l;this.cqc=m;this.Ob=n;this.smc=q;this.wb=r;this.Tnd=t;this.pGa=u;this.aQb=v;this.Rgb=new (wac_za.$$(String))(wac_pa());this.Sab=new wac_40b;p.jb(wac_n1b)}
function wac_n1b(a){for(var b=[3959281607,1157520733],c=b.length,d=0;d<c;++d){var e=b[d];a.bS(e,"WetChangeCount",wac_ri);a.bS(e,"NoChangesToApply",wac_ri);a.bS(e,"NodeNotConnected",wac_ri);a.bS(e,"CouldNotGetLock",wac_ri);a.bS(e,"WetChangeBlocked",wac_ri);a.bS(e,"ParagraphAlreadyDirty",wac_ri);a.bS(e,"UnsafeWetChange",wac_ri)}a.bS(1839802051,"FailedToFindInitialParaID",wac_PWb);a.bS(1839802051,"FailedToFindInitialTextID",wac_PWb);a.bS(1839802051,"MsecUntilApplied",wac_OWb);a.bS(1839802051,"RemovedBecause",
wac_ri);a.bS(1839802051,"PacketVersions",wac_ri);a.bS(1839802051,"OperationType",wac_ri)}
wac__0b.prototype={fKa:null,lHa:null,Sab:null,Qfb:null,kxa:null,fb:null,Vr:null,sN:null,Pl:null,fh:null,wp:null,Ua:null,mxe:!1,cqc:null,Ob:null,smc:null,wb:null,pGa:null,aQb:null,Rgb:null,xcd:!1,Tnd:!1,zb:function(){return this.sN?this.sN.CW(this.Ywc):wac_Ya(Boolean,!1)},uTc:function(){wac_(7685328,355,50,"All prerequisite ready for RttManager");this.Pl=this.sN.rc();wac_(7685330,355,50,"Subscribing to presence updates");this.Pl.ZX(this.uY)},k8:function(a,b){if(3===b.rg&&wac_o1b(this))if(this.kxa.qa()&&
this.kxa.qa().ld&4)wac_(8454939,355,15,"RTT channel did not get disconnected on lock release");else if(b.Tga){if(this.Bre||(wac_(8704354,355,50,"Received a wet change"),this.Bre=!0),(a=wac_p1b(this,b.Tga))&&1!==a.BA.tNd)switch(this.zre||(wac_(8185606,355,50,"Received a wet change that we could deserialize"),this.zre=!0),this.mxe||(b=new wac_D(3,2,6E4,this.vLe,0,null,!1,0),this.Ua.nc(b),this.mxe=!0),a.XI()){case 1:case 6:case 4:var c,d,e;if(e=wac_q1b(this,a,d={val:c}),c=d.val,!e)break;this.Tnd?wac_r1b(this,
c):wac_s1b(this,c);break;case 2:this.Sab.U(a),wac_t1b(this,a),this.Tnd?wac_r1b(this,wac_y()):wac_u1b(this,a)}}else wac_(7685331,355,15,"RTT packet was empty")},sqf:function(){var a=this.fh.qa();if(a){var b=this.wp()-18E4,c=this.lHa.J2b(function(a){return a.BA.w_c<b});0<c.la()&&!this.qld&&!this.Are&&(wac_(8185608,355,15,"Failed to apply any wet changes so far"),this.Are=!0);for(var d=new wac_Ka,e=c.$$lge();e.$$mn();)if(c=e.$$cu(),this.lHa.YWc(c),c.Y0)switch(c.Y0.XI()){case 1:d.U(c.Y0.VR.toString());
break;case 6:d.U(c.Y0.VR.toString());break;case 4:d.U(c.Y0.Jzb.toString()),d.U(c.Y0.H6a.toString())}for(e=this.Sab.J2b(function(a){return a.BA.w_c<b}).$$lge();e.$$mn();)c=e.$$cu(),this.Sab.YWc(c),c.Y0&&d.U(c.Y0.VR.toString());for(d=d.GetEnumerator();d.$$mn();)c=d.$$cu(),(c=a.Mb(wac_sk(c)))?c.lK?(wac_k1b(this.fKa,c),c.lK||wac_DWb(this.Qfb.qa(),c)):wac_(8765829,355,15,"Expiring wet change from paragraph with no applied changes"):wac_(8765828,355,15,"Expiring wet change with invalid object ID")}else!this.fh.Gjb&&
wac_(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")},SLd:function(a,b){wac_v1b(this,a,b)},y8b:function(a){if(wac_o1b(this)&&a.Da(wac__p)&&a.Da(wac_ar)){var b=a.Ia(Number,wac__p),c=a.pa(Number,wac_ar,0),d=this.Ob.uk(1157520733,-1),e=wac_a1b(this.pGa,a.ia());0<e.la()&&(wac_h1b(this.fKa,a,e,this.fh.qa()),wac_w1b(this,a,e,c));var f=wac_$0b(this.pGa,b);if(f&&!a.ia().Ca(f.VR)){var g=this.fh.qa(),h=this;wac_x1b(this,function(){var a=h.pGa.Twb(f.VR),b=g.Mb(f.VR);wac_c(16820032,
355,!!b,"Could not find added graph node");b&&(wac_h1b(h.fKa,b,a,g),h.Sab.XWc(f.LZb))})}wac_e1b(this.lHa,b,c)||wac_DWb(this.Qfb.qa(),a);this.SLd(a,d);d.Ld()}},axb:function(a){var b=this.pGa.Twb(a.ia());0<b.la()&&(2===b.B(0).XI()&&b.qe(0),wac_h1b(this.fKa,a,b,this.fh.qa()))},H$a:function(a){for(var b=a.ia(),c,d,e,b=((e=this.pGa.Sua.Sb(b.toString(),d={val:c},null),c=d.val,e)?c:new (wac_e.$$(wac_rS))).$$lge();b.$$mn();)if(c=b.$$cu(),4===c.XI()&&(c=window.$$as(wac_uS,c),a.ia().Ca(wac_vS(c.EZc)?c.H6a:
c.Jzb)))return!0;return!1},Bre:!1,zre:!1,Dre:!1,qld:!1,Are:!1};function wac_y1b(a){a.qld||(wac_(8185607,355,50,"Successfully applied a wet change"),a.qld=!0)}function wac_z1b(a){a.Dre||(wac_(17147533,355,50,"Received a usable wet change"),a.Dre=!0)}
function wac_w1b(a,b,c,d){for(var e=!1,f=c.la()-1;0<=f;f--){var g=c.B(f);switch(g.XI()){case 1:case 6:case 4:g=window.$$as(wac_pS,g.Ikb());break;default:continue}if(g.Rkb()===d){var e=!0,h;if(h=g.y5a){h=g.y5a;var k=b,l=h.Db===k.ia();l&&(l=h.TDd.replace("\u00a0"," "),h=k.Hb.substr(h.za,h.Yk-h.za).replace("\u00a0"," "),l=l===h);h=!l}h&&wac_(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",g.XI(),
g.rMc(),b.ia(),g.y5a.ia(),g.y5a.za,g.y5a.Yk)}e&&a.lHa.XWc(g)}e&&wac_y1b(a)}
function wac_v1b(a,b,c){if(!b)return null;if(!b.Cb)return c&&c.Na().ea("NodeNotConnected","1"),null;if(!b.Da(wac__p))return wac_(7619922,355,15,"Paragraph is missing the WordId property"),null;if(!b.Da(wac_ar))return wac_(8197722,355,15,"Paragraph is missing the TextId property"),null;if(b.Da(wac_oMa)&&b.Ia(Boolean,wac_oMa))return wac_(16815506,355,50,"RTT edit disabled in paragraph"),null;var d=b.Ia(Number,wac__p),e=wac_Bab(b);c&&(c.Na().ea("NodeTextId",e.toString()),c.Na().ea("NodeWordId",d.toString()));
e=wac_e1b(a.lHa,d,e);if(!e)return c&&c.Na().ea("NoChangesToApply","1"),null;if(!wac_A1b(a,b,e))return c&&c.Na().ea("CouldNotGetLock","1"),null;for(var f=0,g=null;e;){var h;a:{var k=a.fKa,l=e,m=b,n=a.pGa,p=c;if(m.D5())p&&p.Na().ea("ParagraphAlreadyDirty","1"),h=!1;else{var q=new wac_W0b(l,m.ui());try{if(1===l.XI()||6===l.XI()){var r=window.$$as(wac_wS,l),t,u=r,v=m,w=wac_OR(v.Hb,v.wa),x=wac_MR(w,u.PBa),y=wac_MR(w,u.C4a);t=x===y?wac_yy(v,x):wac_X(v,x,y);var z,A=t.fa.Hb,B=10<=t.za?t.za-10:0,C=t.Ra+10<=
A.length?t.Ra+10:A.length,D=A.substr(B,t.za-B),E=A.substr(t.Ra,C-t.Ra),C=C+r.Yqa.length-(t.Ra-t.za),F=D+r.Yqa+E;z=new wac_B1b(t.fa.ia(),B,C,F);var G=6===r.pCc,I="";G&&(I=r.Uaa);var H;var u=t,J=r.Yqa,v=G,K=u.fa;if(u.za===u.Ra||wac_g1b(u)){var M=k.A9.Hc(3,0);try{wac_S(M,K);var L=wac_5E(K);try{K.lK=!0,wac_EWb(k.xW,u,J,v,I)}finally{L&&L.dispose()}M.WX=-1}finally{M&&M.dispose()}H=!0}else p&&p.Na().ea("UnsafeWetChange","1"),H=!1;if(!H){h=!1;break a}p=void 0;p=1===l.XI()?new wac_70b(r,m.ia()):new wac_80b(r,
m.ia());m.lWa=l.Rkb();r.y5a=z;wac_X0b(l,p);wac_b1b(n,p)}else{var N;if(4===l.XI()){var p=k,P=window.$$as(wac_xS,l),O=wac_MR(wac_OR(m.Hb,m.wa),P.Pz);if(wac_g1b(wac_X(m,0,wac_V(m)))){var T=wac_R(m);wac_U(T,10);if(p.G8a(T))N=!1;else{var k=void 0,U=p.A9.Hc(3,0);try{wac_S(U,m);var ea=wac_5E(m);try{var Q=wac_R(m);wac_U(Q,10);wac_cy(Q,11);var W=Q.ja();wac_vS(P)&&(Q.wV(-1)?W=null:(wac_yF(Q),W=Q.ja()));wac_Y(Q);var V=p.VYa.JPa();Q.Nz(V,W,89);Q.Gg(V);var k=m.Oc(),da=wac_5E(k);try{k.ma(wac__p,wac_vS(P)?P.Jac:
P.aBb);k.ma(wac_ar,wac_vS(P)?P.cAb:P.dAb);k.yy(!1);Q.pe(k,2);Q.Gg(k);u=m;v=k;v.x2=!0;wac_SD(v,u.Hb);v.lWa=wac_Bab(u);v.wa.$d();for(I=0;I<u.wa.ka();I++){var fa=wac_CF(u.wa.B(I),v,null);v.wa.U(fa)}v.vk();if(v.Yd.ka())for(I=0;I<v.wa.ka();I++){var ja=v.wa.B(I).gb;if(ja&&-1!==ja.Kl)for(;v.Yd.ka()<=ja.Kl;)wac_zD(v.Yd,v.Yd.ka()-1,256,1)}else wac_(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");v.x2=!1;var ha=wac_vS(P)?k:m,aa=wac_vS(P)?m:k;ha.lK=!0;aa.lK=!0;wac_EWb(p.xW,wac_l1b(ha,
O,wac_V(ha)),"",!1,"");wac_EWb(p.xW,wac_l1b(aa,0,O),"",!1,"");m.lWa=P.Iia;k.lWa=wac_vS(P)?P.cAb:P.dAb}finally{da&&da.dispose()}}finally{ea&&ea.dispose()}U.WX=-1}finally{U&&U.dispose()}var Ea=new wac_uS(P,m.ia(),k.ia());wac_X0b(l,Ea);wac_b1b(n,Ea);N=!0}}else N=!1}else N=!1;h=N;break a}}finally{q&&q.dispose()}h=!0}}if(!h){c&&c.Na().ea("WetChangeBlocked","1");break}f++;g=e.Cpa;q=a.wp();g.GH&&!g.GH.Na().Xa("MsecUntilApplied")&&(q-=g.GH.O5(),g.GH.Na().ea("MsecUntilApplied",q.toString()));g=e;e=wac_Bab(b);
e=wac_e1b(a.lHa,d,e)}0<f&&wac_y1b(a);c&&c.Na().U("WetChangeCount",f.toString());return g}function wac_A1b(a,b,c){if(!a.Qfb.qa())return wac_c(7866378,355,!!a.Qfb.qa(),"Unable to apply wet changes as LockManager unavailable"),!1;var d;a=a.Qfb.qa();c=wac_CWb(a,b,c.BA.dM);var e=b.pa(Number,wac_9s,0);e&&a.va.Ya("WLA",new wac_AOb(e),a);c&&c.LockId!==e&&wac_M0a(c,b);return(d=!!c,d)?!0:(wac_(7866379,355,15,"Unable to apply a wet change lock"),!1)}
function wac_C1b(a,b){var c=b.zM();if(2!==c.aB||c.sJ.eka&&c.sJ.Ata!==c.sJ.eka)return null;var d=b.PBa.Oc();0<b.Yqa.length&&(wac_8Jb(d),d.ef+=b.Yqa.length);c.aB=0;c.Text=null;c.sJ.$xb=0;c.sJ.CEa=d;c.sJ.FFa=c.STa;c.sJ.eka=null;c.sJ.eAb=null;c.sJ.m9a=null;c.STa=null;return wac_k0b(c,a.Vr,a.cqc,function(){return a.fh.qa()},a.aQb.Ha())}function wac_D1b(a,b){a.smc.CW(function(){if(1===b.XI()){var c=wac_C1b(a,b);c&&(wac_B_b(a.smc.rc(),c),c=a.smc.rc(),wac_C_b(c))}})}
function wac_u1b(a,b){var c=wac_m1b(a.fKa,b,a.Vr,a.fh.qa());if(c){wac_z1b(a);var d=a.fKa,e=a.pGa,f=wac_k().H(wac_3u,null),g=c.ja(),h=d.A9.Hc(3,0);try{wac_S(h,g);wac_cy(c,11);var k=c.ja();wac_Y(c);var l=d.VYa.JPa();c.Nz(l,k,89);c.Gg(l);var m=wac_gt.xg.Jp(393230),n=wac_5E(m);try{m.ma(wac_Bo,""),m.x2=!0,f.SSa(m),d=[0],m.ma(wac_Zp,d),m.ma(wac_Dq,d),m.x2=!1,m.ma(wac__p,b.P5b),m.ma(wac_ar,b.O5b),m.yy(!1),c.pe(m,2),m.lK=!0,m.lWa=b.O5b}finally{n&&n.dispose()}h.WX=-1;b.Y0=new wac_90b(b,m.ia());wac_b1b(e,b.Y0)}finally{h&&
h.dispose()}c=b.Y0.VR;c=a.fh.qa().Mb(c);wac_A1b(a,c,b)}}function wac_s1b(a,b){b=a.fh.qa().Mb(b);var c,d=a.wb.Hc(3,0);try{wac_S(d,b);c=a.Ob.uk(3959281607,-1);var e=wac_v1b(a,b,c);c.Ld();e&&wac_D1b(a,e)}finally{d&&d.dispose()}}
function wac_E1b(a){for(var b=a.Sab.J2b(function(a){return!a.Y0}).$$lge();b.$$mn();){var c=b.$$cu();wac_u1b(a,c)}if(a.Rgb.la()){b=null;for(c=a.Rgb.GetEnumerator();c.$$mn();){var d=c.$$cu(),b=wac_sk(d),b=a.fh.qa().Mb(b);break}c=a.wb.Hc(3,0);try{wac_S(c,b);for(var e=a.Rgb.GetEnumerator();e.$$mn();)d=e.$$cu(),wac_s1b(a,wac_sk(d))}finally{c&&c.dispose()}a.Rgb.$d()}}
function wac_t1b(a,b){(a=a.Ob)?(a=a.uk(1839802051,48E4),a=new wac_F1b(a)):a=null;b.Cpa=a;a=b.Cpa;var c=b.BA.KWd;a.GH&&a.GH.Na().ea("PacketVersions",c.toString());a=b.Cpa;b=wac_S0b.toString(b.XI());a.GH&&a.GH.Na().ea("OperationType",b)}function wac_x1b(a,b){b=new wac_D(0,1,0,b,71,null,!1,0);a.Ua.nc(b)}function wac_r1b(a,b){b.Ca(wac_y())||a.Rgb.U(b.toString());a.xcd||(b=new wac_D(0,1,200,function(){wac_E1b(a);a.xcd=!1},71,null,!1,0),a.Ua.nc(b),a.xcd=!0)}
function wac_q1b(a,b,c){c.val=wac_y();var d;d=a.lHa;if(b){var e=b.ir(),f=b.MG();d._changes.Xa(e)||d._changes.U(e,new (wac_Ba.$$(wac_pS)));d._changes.B(e).ea(f,b);var g;b:{if(d._changes.Xa(e)&&(g=d._changes.B(e),g.Xa(f)))for(var h=g.B(f);h;){h=h.Rkb();if(h===f){g=!0;break b}if(!g.Xa(h))break;h=g.B(h)}g=!1}g?(wac_(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",e),d._changes.B(e).Ab(f),d=!1):d=!0}else wac_(7685333,355,15,"Cannot add a null change to RTTStore"),
d=!1;if(!d)return!1;wac_t1b(a,b);if(!a.Vr)return!1;d=wac_3P(a.Vr,b.ir());if(d.Ca(wac_y())||!a.fh.qa().Mb(d))return wac_G1b(b.Cpa),!1;wac_z1b(a);c.val=d;return!0}
function wac_p1b(a,b){b=wac_6_b(b);if(!b)return null;switch(b.aB){case 2:var c,d,e,f,g,h,k,l,m;(m=wac_H1b(b,g={val:c},h={val:d},k={val:e},l={val:f}),c=g.val,d=h.val,e=k.val,f=l.val,m)?(a="",b.Text&&(a=b.Text),g=wac_I1b(b),b=new wac_J1b(e,f,c,d,b.STa,a,b.sJ.BJ,g)):b=null;return b;case 7:return wac_K1b(b);case 4:return wac_L1b(a)?(c=b.sJ,d=b.GTa,b=new wac_xS(c.Ata,c.FFa,c.CEa,c.BJ,d.vUc,d.o_c,d.wUc,d.p_c,wac_I1b(b))):b=null,b;case 3:return wac_L1b(a)?(c=b.sJ,d=b.K5a,e=null,null!=b.sJ.eka&&(e=b.sJ.eka),
b=new wac_tS(c.Ata,c.FFa,d.q_c,e,d.xUc,d.dab,c.BJ,wac_I1b(b))):b=null,b;default:return wac_(8459668,355,50,"RTT packet is of unexpected operationType {0}",b.aB),null}}function wac_L1b(a){return wac_o1b(a)&&a.fb.ub(137)}function wac_o1b(a){return a.fb.ub(185)&&a.fb.ub(146)}function wac_M1b(a,b,c,d,e,f,g,h){wac_M1b.initializeBase(this,[5,h]);this.Hac=a;this.n_c=b;this.L2d=c;this.Y0d=d;this.BJ=e;this.n1c=f;this.cab=g}
wac_M1b.prototype={Hac:0,n_c:0,L2d:0,Y0d:0,BJ:0,n1c:0,cab:0,ir:function(){return this.Hac},MG:function(){return this.n_c},Rkb:function(){return this.Hac===this.n1c?this.cab:0},zM:function(){return new wac_iS(this.BA.m8,this.BA.dM,1,6,new wac_NR(5,this.Hac,this.n_c,null,this.L2d,this.Y0d,null,this.BJ,0),null,null,null,null,new wac_Z_b(this.n1c,this.cab),null,null,0,this.BA.B8)}};function wac_F1b(a){this.GH=a}wac_F1b.prototype={GH:null};
function wac_50b(a,b){a.GH&&(a.GH.Na().ea("RemovedBecause",b),a.GH.Ld())}function wac_G1b(a){a.GH&&a.GH.Na().ea("FailedToFindInitialParaID","1")}function wac_B1b(a,b,c,d){this.Db=a;this.za=b;this.Yk=c;this.TDd=d}wac_B1b.prototype={Db:null,ia:function(){return this.Db},za:0,Yk:0,TDd:null};function wac_N1b(a,b,c,d,e,f){this.m8=a;this.dM=b;this.tNd=c;this.w_c=d;this.KWd=e;this.B8=f}function wac_I1b(a){var b=null;null!=a.B8&&(b=a.B8);return new wac_N1b(a.m8,a.dM,a.srb,Date.now(),a.XFa,b)}
wac_N1b.prototype={m8:0,dM:null,tNd:0,w_c:0,KWd:0,B8:null};function wac_J1b(a,b,c,d,e,f,g,h){wac_J1b.initializeBase(this,[a,b,c,d,e,f,g,h,1])}wac_J1b.prototype={rMc:function(){return"OffsetStart: "+this.PBa+"OffsetEnd: "+this.C4a+"TextAddedLength: "+this.Yqa.length},zM:function(){var a=wac_O1b(this);return new wac_iS(this.BA.m8,this.BA.dM,1,2,a,null,this.Iia,this.Yqa,null,null,null,null,0,this.BA.B8)}};
function wac_P1b(a,b,c,d,e,f,g,h,k,l,m){wac_P1b.initializeBase(this,[d,e,f,g,h,k,l,m,6]);this.Uaa=a;this.kcf=b;this.gdf=c}
function wac_K1b(a){var b,c,d,e,f,g,h,k,l;if(l=wac_H1b(a,f={val:b},g={val:c},h={val:d},k={val:e}),b=f.val,c=g.val,d=h.val,e=k.val,!l)return null;if(1===a.Text.length)f=!1,g="\ufffc";else if(2===a.Text.length)if(f=a.Text,55296<=f.charCodeAt(0)&&56319>=f.charCodeAt(0)&&wac_tf(a.Text,1))f=!0,g=a.Text;else return wac_(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",a.aB),null;else return wac_(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",
a.aB),null;h=a.Xzb;k=wac_I1b(a);return new wac_P1b(h.e_c,h.f_c,f,d,e,b,c,a.STa,g,a.sJ.BJ,k)}wac_P1b.prototype={Uaa:null,kcf:!1,gdf:!1,rMc:function(){return"OffsetStart: "+this.PBa+"OffsetEnd: "+this.C4a},zM:function(){var a=wac_O1b(this);return new wac_iS(this.BA.m8,this.BA.dM,1,7,a,null,this.Iia,this.Yqa,null,null,null,null,0,this.BA.B8)}};function wac_wS(a,b,c,d,e,f,g,h,k){wac_wS.initializeBase(this,[k,h]);this.Ye=a;this.At=b;this.PBa=c;this.C4a=d;this.Iia=e;this.Yqa=f;this.Oaa=g}
function wac_H1b(a,b,c,d,e){a=a.sJ;if(1===a.$xb&&(a.Ata!==a.eka||a.FFa!==a.eAb))return wac_(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),b.val=c.val=null,d.val=e.val=-1,!1;if(a.BJ)return b.val=c.val=null,d.val=e.val=-1,!1;b.val=a.CEa;c.val=b.val;1===a.$xb&&(c.val=a.m9a);d.val=a.Ata;e.val=a.FFa;return!0}wac_wS.prototype={Ye:0,ir:function(){return this.Ye},At:0,MG:function(){return this.At},PBa:null,C4a:null,Iia:0,Rkb:function(){return this.Iia},Yqa:null,Oaa:0};
function wac_O1b(a){return a.PBa.Uy(a.C4a,!0)?new wac_NR(0,a.Ye,a.At,a.PBa,null,null,null,a.Oaa,0):new wac_NR(1,a.Ye,a.At,a.PBa,a.Ye,a.At,a.C4a,a.Oaa,0)}function wac_30b(){this.Shb=new (wac_yS.$$(wac_3Va))}wac_30b.prototype={Shb:null};function wac_Q1b(a){return a.Shb.Tn()?null:a.Shb.O6a()}function wac_20b(a,b,c,d,e,f){this.rzd=Function.createDelegate(this,this.HHf);this.Ywc=Function.createDelegate(this,this.uTc);this.sN=a;this.Pkd=b;this.jN=c;this.il=d;this.Cza=e;this.fb=f}
wac_20b.prototype={sN:null,Zi:null,Pkd:null,jN:null,il:null,Cza:null,fb:null,rNb:null,axa:!1,xve:0,vod:0,wwe:!1,tpc:!1,Okd:0,w5:function(){return this.jN.qa()},zb:function(){return this.sN?this.sN.CW(this.Ywc):wac_Ya(Boolean,!1)},uTc:function(){wac_(8245954,355,50,"All prerequisites ready for RttSendManager");this.Zi=this.sN.rc();wac_ZZb(this.Zi,this)},re:function(){this.axa||(wac_R1b(this)&&this.il.Ec().Mu.va.hb("PTC",this.rzd),this.axa=!0)},hd:function(){this.axa=!1;wac_R1b(this)&&this.il.Ec().Mu.va.Uc("PTC",
this.rzd)},HHf:function(a,b){if(this.Zi&&2===this.Zi.Eoa()&&(a=b.Mu,a.length))if(b.ADd)100>this.vod&&(this.vod++,wac_(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",b.BDd,this.xve,this.vod));else{for(b=0;b<a.length;b++){var c=a[b],d=c;if(!d||-1===d.Oaa||d.$c()&&(!wac_R1b(this)||!this.fb.ub(138)||3!==d.$c()&&1!==d.$c()))return}for(b=0;b<a.length;b++){var c=a[b],e=!c.$c()&&!b,d=this.Pkd;d.Shb.lMd()&&e&&d.Shb.lMd().xPa(c)||d.Shb.fja(c)}this.rNb||wac_S1b(this,this.rNb,
this.Zi)}}};
function wac_T1b(a,b){if(!b)return null;if(!a.w5())return wac_(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;var c=wac_4_b(wac_K0b);a=a.w5().s1;var d=wac_l0b;4294967295===d.MNb&&(d.MNb=0);d.MNb++;c=new wac_N1b(c,a,1,0,0,d.MNb);a=null;switch(b.$c()){case 0:b.$c()?a=null:(a=wac_OR(b.oF.eu(),b.oF.dzc),a=new wac_J1b(b.oF.ir(),b.oF.MG(),wac_KR(a,b.za),wac_KR(a,b.Yk),b.ZQ.MG(),b.t1,b.Oaa,c));break;case 4:a=4!==b.$c()?null:new wac_f1b(b.kNa.ir(),b.kNa.MG(),
b.Oaa,c);break;case 3:a=3!==b.$c()?null:new wac_tS(b.J6.ir(),b.J6.MG(),b.BHd.MG(),b.Eqa?b.Eqa.ir():null,b.ZQ.ir(),b.ZQ.MG(),b.Oaa,c);break;case 2:a=2!==b.$c()?null:new wac_M1b(b.J6.ir(),b.J6.MG(),b.Eqa.ir(),b.Eqa.MG(),b.Oaa,b.t4a.ir(),b.t4a.MG(),c);break;case 1:a=1!==b.$c()?null:new wac_xS(b.oF.ir(),b.oF.MG(),wac_KR(wac_OR(b.oF.eu(),b.oF.dzc),b.UYb),b.Oaa,b.vaa.ir(),b.vaa.MG(),b.Ipa.ir(),b.Ipa.MG(),c)}return a}
function wac_S1b(a,b,c){wac_U1b(a);b&&(wac__a(b)||wac_0a(b))&&wac_(8245956,355,15,"Task is faulted or cancelled with exception {0}",b.Lk);(b=wac_T1b(a,wac_Q1b(a.Pkd)))?(a.xve++,a.rNb=c.RF(3,wac_8_b(b.zM()),!1),wac_V1b(a),a.rNb.CW(function(b){wac_S1b(a,b,c)})):a.rNb=null}function wac_V1b(a){!a.tpc&&5>=a.Okd&&(wac_(8270469,355,50,"Sent Rtt Message"),a.tpc=!0)}function wac_U1b(a){a.tpc||(a.wwe||(wac_(8270468,355,50,"Preparing to send RTT change"),a.wwe=!0),!a.tpc&&5>=a.Okd&&a.Okd++)}
function wac_R1b(a){return a.fb.ub(185)&&a.fb.ub(153)}function wac_xS(a,b,c,d,e,f,g,h,k){wac_xS.initializeBase(this,[4,k]);this.Ye=a;this.At=b;this.Pz=c;this.BJ=d;this.Jac=e;this.cAb=f;this.aBb=g;this.dAb=h;this.Jac===this.Ye?this.Iia=this.cAb:this.aBb===this.Ye?this.Iia=this.dAb:(wac_(8397766,355,10,"Bad data passed to RttSplitParagraphOp"),this.Iia=0)}
wac_xS.prototype={Ye:0,ir:function(){return this.Ye},At:0,MG:function(){return this.At},Iia:0,Rkb:function(){return this.Iia},Pz:null,BJ:0,Jac:0,cAb:0,aBb:0,dAb:0,zM:function(){return new wac_iS(this.BA.m8,this.BA.dM,1,4,new wac_NR(3,this.Ye,this.At,this.Pz,null,null,null,this.BJ,0),null,null,null,null,null,new wac___b(this.Jac,this.cAb,this.aBb,this.dAb),null,0,this.BA.B8)}};function wac_vS(a){return a.Ye===a.aBb}wac_W0b.registerClass("WERTT.GraphChangeValidator",null,Sys.IDisposable);
wac_sS.registerClass("WERTT.RttOp",null,wac_qS);wac_Y0b.registerClass("WERTT.WordEditorRealTimeTypingPackage",null,wac_J,wac_j);wac_40b.registerClass("WERTT.RttAddParagraphDataStore");wac_tS.registerClass("WERTT.RttAddParagraphOp",wac_sS);wac_70b.registerClass("WERTT.RttAppliedReplaceTextRangeOp",null,wac_rS);wac_80b.registerClass("WERTT.RttAppliedReplaceSymbolRangeOp",null,wac_rS);wac_uS.registerClass("WERTT.RttAppliedSplitParagraphOp",null,wac_rS);
wac_90b.registerClass("WERTT.RttAppliedAddParagraphOp",null,wac_rS);wac_10b.registerClass("WERTT.RttAppliedOpTracker",null,wac_T0b);wac_00b.registerClass("WERTT.RttDataStore",null,wac_Q0b);wac_f1b.registerClass("WERTT.RttDeleteParagraphOp",wac_sS,wac_pS,wac_qS);wac_Z0b.registerClass("WERTT.RttEditor",null,wac_R0b);wac__0b.registerClass("WERTT.RttManager",null,wac_HKb);wac_M1b.registerClass("WERTT.RttMergeParagraphOp",wac_sS,wac_pS,wac_qS);wac_F1b.registerClass("WERTT.RttOpActivity");
wac_B1b.registerClass("WERTT.RttOpValidator",null,wac_U0b);(function(){}).registerClass("WERTT.RttOpValidatorFactory");wac_N1b.registerClass("WERTT.RttOpMetadata");wac_wS.registerClass("WERTT.RttReplaceRangeOp",wac_sS);wac_J1b.registerClass("WERTT.RttReplaceTextRangeOp",wac_wS,wac_pS,wac_qS);wac_P1b.registerClass("WERTT.RttReplaceSymbolRangeOp",wac_wS,wac_pS,wac_qS);wac_30b.registerClass("WERTT.RttSendDataStore",null,wac_V0b);wac_20b.registerClass("WERTT.RttSendManager",null,wac_ft);
wac_xS.registerClass("WERTT.RttSplitParagraphOp",wac_sS,wac_pS,wac_qS);wac_K(wac_E(),new wac_Y0b,0);Type.registerNamespace("RealtimePresenceUI");function wac_W1b(a,b,c,d,e,f,g,h,k,l,m,n,p,q){wac_W1b.initializeBase(this,[a,f,q,b]);this.T5d=c;this.Rqe=d;this.tpe=e;this.ua=g;wac_X1b=h;this.Vr=k;this.ze=l;this.hX=m;this.aQb=n;this.BW=p}
function wac_Y1b(a,b,c,d,e){var f=wac_m(wac_zS,wac_hS),g=wac_zS.H(wac_bb,null),h=window.Box4.App.ya().La,k=wac_z(),l=wac_hw(),m=wac_k().H(wac_Cu,null);return new wac_W1b(a,b,function(a,b){return h.vd.uj()?h.vd.GGc(a,b,!0):!1},function(a,b){h.vd.uj()&&h.vd.p$a(a,b,!0,!0)},function(){wac_fw().uab()},k,l,h,c,d,e,f,m,g)}
function wac_Z1b(a){var b=wac_X1b.Ec().gd().Mb(a.Jm().LG());if(wac_i(b))return wac_(20764576,325,15,"The node could not be obtained"),null;if(!wac_W(b))return wac_(20764577,325,15,"The obtained node is not a paragraph node"),null;a=wac_yy(b,a.Jm().UL.Lf());return new wac_Zx([a],!0,null)}wac_W1b.prototype={T5d:null,Rqe:null,tpe:null,ua:null,Vr:null,ze:null,hX:null,aQb:null,BW:null,K0c:function(a){this.BW.U4b(a.CommandValueId);return wac_XXb.prototype.K0c.call(this,a)},oa:function(){wac_TZb.prototype.oa.call(this)}};
function wac_8Xb(a,b,c){c.val=wac_9Xb(a,b);return!!c.val}function wac_9Xb(a,b){return b?(a=wac_k0b(wac_6_b(b),a.Vr,a.ze,a.hX,a.aQb.Ha()))&&a.Hk()&&a.Jm()?a:null:null}
function wac_1Xb(a,b){var c,d,e;if(e=wac_8Xb(a,b,d={val:c}),c=d.val,e)a.Rqe(c.Jm().LG(),c.Jm().UL.Lf()),wac_r.W.ga("WordEditorMoveIpToUserLocationIsEnabled")&&(b=wac_Z1b(c),wac_i(b)?wac_(20764575,325,50,"IP will not be moved since the selection is either null or undefined"):(wac_(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),a.ua.Cc(b,null,!1,!1,0),wac_uh()&&wac_vj(wac_A(),"document"))),b=new wac_D(2,1,0,function(){a.ha.Yb(761503246,2,c,null)},0,null,!1,0),
wac_s().nc(b)}Type.registerNamespace("WordEditor.PeoplesWellControl");wac_M=window.WordEditor||{};wac_M.gMf=wac_M.gMf||{};function wac__1b(){this.$wc=Function.createDelegate(this,this.wTc);this.Dv=Function.createDelegate(this,this.fv)}
wac__1b.prototype={Zb:function(){return"WordEditor.PeoplesWellControl"},$b:function(a){wac_zS=a},zb:function(){wac_ph(wac_r.W,this.Dv)},fv:function(){wac_r.eXd?(wac_01b||(wac_01b=wac_k().H(wac_et,null))).mM().CW(this.$wc):wac_(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")},wTc:function(){if(wac_11b=(wac_01b||(wac_01b=wac_k().H(wac_et,null))).mM().rc()){var a=function(){var a=window.Box4.App.ya().La;return a?a.Ec()?a.Ec().gd():(wac_(23196876,325,15,
"ActivePage is null"),null):(wac_(23196875,325,15,"Workspace is null"),null)};window.Box4.App.Q5().CW(function(){var b=window.Box4.App.Q5().rc().s1,c=wac_11b.Pl,d=wac_11b.Pl,e=wac_aYb(wac_21b(),b,c.SNe||(c.SNe=Function.createDelegate(c,c.juf)),d.UNe||(d.UNe=Function.createDelegate(d,d.hRd)));wac_n(wac_o(wac_p(wac_k().na(wac_W1b,null),wac_9b)),function(){return wac_Y1b(e,wac_yb(wac_8b,wac_m(wac_zS,wac_8b)),wac_l(wac_zS,wac_UC),wac_l(wac_zS,wac_tQ),a)});wac_4Xb=wac_k().H(wac_9b,null);wac_3Xb();wac_(23196877,
325,50,"PeoplesWellControl is fully initialized")})}else wac_(23196873,325,15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")},oa:function(){wac_4Xb&&(wac_4Xb.dispose(),wac_4Xb=null)}};wac_W1b.registerClass("RealtimePresenceUI.WordEditorPeoplesWell",wac_TZb);wac__1b.registerClass("WordEditor.PeoplesWellControl.WordEditorPeoplesWellControlPackage",null,wac_J,wac_j);(function(){}).registerClass("WordEditor.PeoplesWellControl.Program");
var wac_X1b=null,wac_4Xb=null,wac_zS=null,wac_11b=null,wac_01b=null;wac_K(wac_E(),new wac__1b,0);
