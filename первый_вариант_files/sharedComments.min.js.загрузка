var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[19],{10:function(e,t,n){"use strict";n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"s",(function(){return l})),n.d(t,"m",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"n",(function(){return C})),n.d(t,"h",(function(){return h})),n.d(t,"q",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"p",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return S})),n.d(t,"x",(function(){return E})),n.d(t,"w",(function(){return P})),n.d(t,"v",(function(){return x})),n.d(t,"t",(function(){return w})),n.d(t,"k",(function(){return k})),n.d(t,"u",(function(){return R})),n.d(t,"r",(function(){return N})),n.d(t,"e",(function(){return F}));var r=n(72),a=n(17),o=n(413),i=n(87),s=n(7),c=n(13),d=function(e){return e.commentState.contextState.isReadOnly},u=function(e){return e.commentState.atMentionState_deprecated},l=function(e){return e.commentState.topVisibleThreadId},m=function(e){return e.commentState.personaIconPropertiesMap},f=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},g=function(e){return e.commentState.commentData},C=function(e){return e.commentState.postViewState},h=function(e){return e.commentState.draftState},b=function(e){return Object(c.I)(h(e))},v=function(e){return e.commentState.selectedComment},y=function(e){return e.commentState.pendingCommentLoad},T=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},O=function(e){return e.commentState.capabilities_deprecated},I=function(e){return e.commentState.contextState},S=function(e,t,n){var r=e.commentState.createdCommentLie;if(!s.ob())return t?_(e):r;var a=h(e);return r&&t&&!Object(c.O)(r,a)||r&&n&&!Object(c.N)(r,a,n)?void 0:r},_=function(e){var t=S(e),n=h(e);return Object(c.O)(t,n)?t:void 0},E=function(){return Object(r.a)([v,g],(function(e,t){return e?{selectedComment:e,index:Object(c.o)(t,e)}:void 0}))},j={},D=function(e){return s.b()?e.taskState.tasks:j},P=function(){return Object(r.a)([g,D],i.l)},A=function(e,t){return t},x=function(e){return Object(r.a)([h,function(e){return S(e)},f,e,A],(function(e,t,n,r,s){return i.b(r,n,t,s.renderContextType!==a.a.HalfPane,Object(o.b)(e,s.renderContextType))}))},w=function(e){return e.commentState.virtualized},k=function(e){return e.commentState.modelCapabilities},R=function(){return Object(r.a)(h,(function(e){var t;return null===(t=Object(c.I)(e))||void 0===t?void 0:t.renderContextType}))},N=function(e){return e.commentState.suggestionsDetails},F=function(e,t){if(t)return g(e).find((function(e){return e.commentId===t}))}},100:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,a=n(15);function o(e,t,n,r,o){return Object(a.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:o},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.CollapseCard=1]="CollapseCard",e[e.SelectPost=2]="SelectPost"}(r||(r={}))},102:function(e,t,n){"use strict";function r(){return"web"}n.d(t,"a",(function(){return r}))},1020:function(e,t,n){"use strict";var r;n(7);!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(r||(r={}));n(17),n(102),n(140);var a=n(37);n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));r.None;var o=function(e){return"ios"===e||"android"===e};function i(e,t,n){return!e||t||n?a.a.WHITE:a.a.REST_RESOLVED_BODY}function s(e,t,n){return e&&(!n||t)}},108:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"l",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"n",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"o",(function(){return C})),n.d(t,"a",(function(){return h}));var r="Selection bug - selection is not on card after typing in the reply box",a="Selected comment not found",o="Selected thread index out of bounds",i="Invalid number of posts for display more replies string",s="Unrecognized post display mode",c="Method not implemented",d="StringId is invalid",u="LocalizationModule NativeModule not valid",l="Store state unexpected",m="Editor reference is invalid",f="Invalid arguments",p="Comment ID value is invalid in the current operation",g="Attempting to perform an operation on an inactive draft",C="Feature not running with the correct feature gates which expect view manager construction",h="CommentModel not found in a thread of RenderableItems"},110:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},1116:function(e,t,n){n(1117),e.exports=n(330).Array.includes},1117:function(e,t,n){"use strict";var r=n(474),a=n(922)(!0);r(r.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(771)("includes")},1118:function(e,t,n){var r=n(1119),a=n(1120),o=n(1122),i=Object.defineProperty;t.f=n(562)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),a)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},1119:function(e,t,n){var r=n(561);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},112:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},1120:function(e,t,n){e.exports=!n(562)&&!n(563)((function(){return 7!=Object.defineProperty(n(1121)("div"),"a",{get:function(){return 7}}).a}))},1121:function(e,t,n){var r=n(561),a=n(475).document,o=r(a)&&r(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},1122:function(e,t,n){var r=n(561);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},1123:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1124:function(e,t,n){var r=n(475),a=n(766),o=n(920),i=n(767)("src"),s=n(1125),c=(""+s).split("toString");n(330).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(o(n,"name")||a(n,"name",t)),e[t]!==n&&(d&&(o(n,i)||a(n,i,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||s.call(this)}))},1125:function(e,t,n){e.exports=n(768)("native-function-to-string",Function.toString)},1126:function(e,t){e.exports=!1},1127:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1128:function(e,t,n){var r=n(926),a=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):o(e,t)}},1129:function(e,t,n){n(1130),e.exports=n(330).Array.find},113:function(e,t,n){"use strict";var r=n(133),a=(n(864),n(228),n(513));n.d(t,"h",(function(){return r.h})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.d})),n.d(t,"g",(function(){return r.g})),n.d(t,"d",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"k",(function(){return r.k})),n.d(t,"i",(function(){return r.j})),n.d(t,"e",(function(){return a.b})),n.d(t,"j",(function(){return a.d}))},1130:function(e,t,n){"use strict";var r=n(474),a=n(928)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(771)("find")},1131:function(e,t,n){var r=n(1132);e.exports=function(e,t){return new(r(e))(t)}},1132:function(e,t,n){var r=n(561),a=n(1133),o=n(927)("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},1133:function(e,t,n){var r=n(924);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1134:function(e,t,n){n(1135),e.exports=n(330).String.trimRight},1135:function(e,t,n){"use strict";n(1136)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},1136:function(e,t,n){var r=n(474),a=n(770),o=n(563),i=n(1137),s="["+i+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,n){var a={},s=o((function(){return!!i[e]()||"​"!="​"[e]()})),c=a[e]=s?t(l):i[e];n&&(a[n]=c),r(r.P+r.F*s,"String",a)},l=u.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},1137:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1140:function(e,t,n){n(1141),e.exports=n(330).Array.findIndex},1141:function(e,t,n){"use strict";var r=n(474),a=n(928)(6),o="findIndex",i=!0;o in[]&&Array(1)[o]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(771)(o)},1142:function(e,t,n){n(1143),e.exports=n(330).Object.assign},1143:function(e,t,n){var r=n(474);r(r.S+r.F,"Object",{assign:n(1144)})},1144:function(e,t,n){"use strict";var r=n(562),a=n(1145),o=n(1149),i=n(1150),s=n(929),c=n(769),d=Object.assign;e.exports=!d||n(563)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=s(e),d=arguments.length,u=1,l=o.f,m=i.f;d>u;)for(var f,p=c(arguments[u++]),g=l?a(p).concat(l(p)):a(p),C=g.length,h=0;C>h;)f=g[h++],r&&!m.call(p,f)||(n[f]=p[f]);return n}:d},1145:function(e,t,n){var r=n(1146),a=n(1148);e.exports=Object.keys||function(e){return r(e,a)}},1146:function(e,t,n){var r=n(920),a=n(923),o=n(922)(!1),i=n(1147)("IE_PROTO");e.exports=function(e,t){var n,s=a(e),c=0,d=[];for(n in s)n!=i&&r(s,n)&&d.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(d,n)||d.push(n));return d}},1147:function(e,t,n){var r=n(768)("keys"),a=n(767);e.exports=function(e){return r[e]||(r[e]=a(e))}},1148:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1149:function(e,t){t.f=Object.getOwnPropertySymbols},1150:function(e,t){t.f={}.propertyIsEnumerable},1151:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1152:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850"}))}a.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1153:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1154:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}a.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1155:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}a.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1156:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}a.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1157:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}a.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1158:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}a.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1159:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}a.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1160:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}a.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1161:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}a.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1162:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1163:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1164:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1165:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1166:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}a.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=a,a.default=a},1167:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}a.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=a,a.default=a},1168:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166562 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579688 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874813 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z M1,12 L3.5,12 C3.9734466,12 4.4332293,12.0458255 4.87838685,12.1379271 C5.31513303,12.2282884 5.74859274,12.3602761 6.18851278,12.5375318 C6.93158683,12.8463999 7.69958736,13 8.5,13 L12.5,13 C12.5548236,13 12.602973,12.9923123 12.648616,12.977098 C12.7042395,12.9585568 12.7526835,12.9341041 12.7969807,12.9027269 C12.8337665,12.8766702 12.8664285,12.8443971 12.8972432,12.8024548 C12.9312256,12.7562009 12.9571761,12.7066171 12.9731917,12.6603347 L14.976502,6.65057182 C14.9920216,6.60556505 15,6.55689677 15,6.5 C15,6.42541757 14.9877526,6.36418032 14.9636675,6.3079818 C14.9365874,6.244795 14.9025618,6.19478151 14.8582531,6.15130876 C14.8093393,6.10331783 14.7532414,6.06591924 14.6842057,6.03633253 C14.6271661,6.01188698 14.5685237,6 14.5,6 L9.92167262,6 L10.0366316,4.89639392 C10.0695629,4.58025353 10.1325645,4.27353503 10.2257814,3.97723847 C10.311817,3.70376821 10.4161404,3.43528887 10.5459446,3.15655729 C10.6976958,2.8443835 10.8114223,2.53217213 10.8880777,2.21916252 C10.9624237,1.91558304 11,1.59305299 11,1.25 C11,1.21274116 10.9946165,1.18603901 10.9840197,1.16145435 C10.9688056,1.12615764 10.9504819,1.09907042 10.9257057,1.07429428 C10.9009296,1.04951814 10.8738424,1.03119444 10.8385457,1.01598034 C10.813961,1.0053835 10.7872588,1 10.75,1 C10.7324276,1 10.7311357,0.999063781 10.7416579,0.993076126 L10.7490693,0.989479263 C10.7056707,1.01597571 10.651885,1.05920353 10.5893502,1.12173792 L5.73054428,5.97273178 C5.3997463,6.30352976 5.02122029,6.55953769 4.60002886,6.73533933 C4.17716132,6.91184057 3.72718088,7 3.2578125,7 L1,7 L1,12 Z",id:"icon_outlined",fill:"#2B5C9C",fillRule:"nonzero"})))}a.defaultProps={width:"16px",height:"14px",viewBox:"0 0 16 14",focusable:"false",version:"1.1"},e.exports=a,a.default=a},1169:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("path",{d:"M1.08001 9.31998L1.28001 8.63998H4.28001C4.60001 8.13998 4.96001 7.59998 5.36001 7.03998C6.16001 5.91998 6.72001 5.21998 7.06001 4.93998C7.96001 4.23998 8.52001 3.77998 8.76001 3.57998C9.66001 2.77998 10.16 2.17998 10.24 1.75998C10.32 1.31998 10.46 0.999976 10.64 0.799976C10.76 0.659976 10.9 0.599976 11.04 0.599976C11.3 0.599976 11.56 0.779976 11.8 1.11998C12.16 1.59998 12.16 2.27998 11.82 3.11998C11.6 3.65998 11.38 4.09998 11.16 4.43998C10.86 4.87998 10.68 5.15998 10.62 5.29998C10.44 5.65998 10.36 6.05998 10.42 6.47998C11.08 6.51998 11.76 6.61998 12.42 6.79998C13.76 7.13998 14.42 7.67998 14.42 8.37998C14.42 8.59998 14.38 8.77998 14.32 8.97998C14.24 9.17998 14.14 9.25998 14.04 9.25998L14.34 9.47998C14.54 9.71998 14.64 10.04 14.64 10.44C14.64 10.66 14.54 10.84 14.34 11.02C14.24 11.1 14.14 11.18 14.04 11.22L14.2 11.52C14.3 11.78 14.3 12.08 14.22 12.42C14.18 12.62 14.06 12.8 13.86 12.98C13.68 13.14 13.54 13.2 13.42 13.2V13.94C13.36 14.46 13.16 14.82 12.82 14.98C12.1 15.34 11.7 15.52 11.62 15.56C11.06 15.72 10.26 15.76 9.22001 15.68C8.22001 15.6 7.12001 15.42 5.92001 15.16C5.32001 15.02 4.82001 14.9 4.42001 14.78H1.42001C1.32001 14.54 1.22001 14.24 1.12001 13.86C0.920014 13.12 0.820015 12.42 0.820015 11.76C0.880015 10.78 0.960014 9.97998 1.08001 9.31998Z",fill:"#FDCE4C",key:0}),r.createElement("path",{d:"M9.78002 9.59995C10.04 9.65995 10.2 10.0399 10.22 10.7599C10.24 11.3599 10.2 11.9799 10.06 12.5799C10.02 12.8199 10.02 13.2999 10.06 14.0199C10.08 14.4599 9.98002 14.6599 9.76002 14.6199C9.44002 14.5399 9.10002 14.2399 8.78002 13.6799C8.42002 13.0999 8.30002 12.5799 8.40002 12.0999C8.54002 11.4799 8.72002 10.9199 8.96002 10.4199C9.24002 9.83995 9.52002 9.55995 9.78002 9.59995Z",fill:"url(#paint0_linear)",key:1}),r.createElement("path",{d:"M10.34 8.84C10.5 8.58 10.4 8.86 10.06 9.72C9.69999 10.58 9.09999 11.08 8.23999 11.22C7.37999 11.38 6.71999 11.38 6.27999 11.22C7.43999 11 8.29999 10.56 8.79999 9.92C9.31999 9.28 9.59999 8.62 9.63999 7.94C9.93999 8.8 10.18 9.1 10.34 8.84Z",fill:"url(#paint1_linear)",key:2}),r.createElement("path",{d:"M11 8.89995C11.12 9.07995 11.28 9.21995 11.48 9.31995C10.98 9.69995 10.8 10.1599 10.94 10.6999C11 10.9599 11.12 11.1999 11.3 11.3799C10.76 11.7799 10.54 12.2199 10.66 12.6799C10.72 12.9199 10.82 13.0999 10.98 13.2599C10.68 13.5399 10.54 13.9799 10.54 14.5999C10.54 14.8999 10.58 15.1799 10.64 15.4199C10.08 15.2199 9.75998 14.7999 9.67998 14.1599L9.71998 13.2599C9.41998 12.8599 9.33998 12.3999 9.49998 11.8999L9.79998 11.2799C9.43998 10.9999 9.33998 10.5999 9.45998 10.0399L9.73998 9.29995C9.61998 8.85995 9.81998 8.47995 10.36 8.17995C10.64 8.01995 10.92 7.89995 11.22 7.81995C10.84 8.19995 10.76 8.55995 11 8.89995Z",fill:"#FDCE4C",key:3}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.619 13.18C13.619 13.0701 13.5299 12.981 13.42 12.981H9.82C9.71008 12.981 9.62098 13.0701 9.62098 13.18C9.62098 13.2899 9.71008 13.379 9.82 13.379H13.42C13.5299 13.379 13.619 13.2899 13.619 13.18Z",fill:"#AC8662",key:4}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 11.22C14.239 11.11 14.1499 11.0209 14.04 11.0209H9.83999C9.73008 11.0209 9.64097 11.11 9.64097 11.22C9.64097 11.3299 9.73008 11.419 9.83999 11.419H14.04C14.1499 11.419 14.239 11.3299 14.239 11.22Z",fill:"#AC8662",key:5}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 9.23997C14.239 9.13006 14.1499 9.04095 14.04 9.04095H9.83999C9.73008 9.04095 9.64097 9.13006 9.64097 9.23997C9.64097 9.34989 9.73008 9.43899 9.83999 9.43899H14.04C14.1499 9.43899 14.239 9.34989 14.239 9.23997Z",fill:"#AC8662",key:6}),r.createElement("defs",{key:7},[r.createElement("linearGradient",{id:"paint0_linear",x1:"8.14689",y1:"8.32298",x2:"11.0687",y2:"8.28505",gradientUnits:"userSpaceOnUse",key:0},[r.createElement("stop",{stopColor:"#B8895A",stopOpacity:"0.2",key:0}),r.createElement("stop",{offset:"1",stopColor:"#B57E4A",key:1})]),r.createElement("linearGradient",{id:"paint1_linear",x1:"4.86538",y1:"9.62116",x2:"7.60127",y2:"8.17258",gradientUnits:"userSpaceOnUse",key:1},[r.createElement("stop",{stopColor:"#F0C194",stopOpacity:"0.4",key:0}),r.createElement("stop",{offset:"1",stopColor:"#CBA37C",stopOpacity:"0.502",key:1})])])])}a.defaultProps={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e.exports=a,a.default=a},1170:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}a.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=a,a.default=a},1171:function(e){e.exports={SharedCommentsVersion:"2.72.10"}},120:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},123:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i}));var r="CREATE",a="EDIT",o="REPLY",i="METADATA"},124:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(214),a=n(110),o=n(123);function i(e){return e.sessionType===o.a}function s(e){return e.sessionType===o.d&&void 0!==e.threadId}function c(e){return e.sessionType===o.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:a.a.Insert,REPLY:a.a.Insert,EDIT:a.a.Modify,METADATA:a.a.Modify};function l(e){return i(e)?r.a.InitCreateCommentSession:s(e)?r.a.InitReplyCommentSession:c(e)?r.a.InitEditCommentSession:r.a.Unknown}},128:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated"}(r||(r={}))},13:function(e,t,n){"use strict";n.d(t,"S",(function(){return A})),n.d(t,"P",(function(){return x})),n.d(t,"t",(function(){return w})),n.d(t,"s",(function(){return k})),n.d(t,"j",(function(){return R})),n.d(t,"W",(function(){return N})),n.d(t,"i",(function(){return F})),n.d(t,"h",(function(){return M})),n.d(t,"K",(function(){return L})),n.d(t,"p",(function(){return V})),n.d(t,"r",(function(){return U})),n.d(t,"q",(function(){return H})),n.d(t,"V",(function(){return B})),n.d(t,"v",(function(){return G})),n.d(t,"x",(function(){return W})),n.d(t,"B",(function(){return q})),n.d(t,"w",(function(){return z})),n.d(t,"y",(function(){return Y})),n.d(t,"C",(function(){return Z})),n.d(t,"D",(function(){return J})),n.d(t,"db",(function(){return $})),n.d(t,"Q",(function(){return te})),n.d(t,"E",(function(){return ne})),n.d(t,"ab",(function(){return re})),n.d(t,"k",(function(){return ae})),n.d(t,"l",(function(){return oe})),n.d(t,"M",(function(){return se})),n.d(t,"z",(function(){return ce})),n.d(t,"O",(function(){return de})),n.d(t,"N",(function(){return ue})),n.d(t,"R",(function(){return le})),n.d(t,"a",(function(){return me})),n.d(t,"A",(function(){return fe})),n.d(t,"J",(function(){return ge})),n.d(t,"o",(function(){return Ce})),n.d(t,"Y",(function(){return ve})),n.d(t,"cb",(function(){return ye})),n.d(t,"bb",(function(){return Te})),n.d(t,"F",(function(){return Oe})),n.d(t,"G",(function(){return Se})),n.d(t,"H",(function(){return _e})),n.d(t,"I",(function(){return Ee})),n.d(t,"X",(function(){return je})),n.d(t,"Z",(function(){return De})),n.d(t,"U",(function(){return Pe})),n.d(t,"g",(function(){return Ae})),n.d(t,"b",(function(){return xe})),n.d(t,"L",(function(){return we})),n.d(t,"u",(function(){return ke})),n.d(t,"e",(function(){return Ne})),n.d(t,"T",(function(){return Fe})),n.d(t,"f",(function(){return Me})),n.d(t,"c",(function(){return Le})),n.d(t,"d",(function(){return Ve})),n.d(t,"n",(function(){return Ue})),n.d(t,"m",(function(){return He})),n.d(t,"eb",(function(){return Be}));var r=n(1),a=n(5),o=n(3),i=n(133),s=n(226),c=n(358),d=n(320),u=n(124),l=n(82),m=n(112),f=n(157),p=n(17),g=n(545),C=n(73),h=n(102),b=n(140),v=n(40),y=n(108),T=n(7),O=n(100),I=n(152),S=n(48),_=n(130),E=n(252),j=n(41),D=n(338),P=n(423);function A(e){return""===e||null===e?void 0:e}function x(e){return e.state===_.a.Placeholder||e.state===_.a.Loading}function w(e){for(var t={},n=0;n<e.length;++n)t[e[n].commentId]=k(e[n].displayDate,!1);return t}function k(e,t,n){return void 0===n&&(n=E.a.None),{displayDate:e,displayingErrorUI:t,pending:n}}function R(e,t,n){return t||(!e||isNaN(e.getDate())?"":g.a(e,n))}function N(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function F(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=M(void 0,t));return n}function M(e,t){return V(e,t===_.a.Loading||t===_.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:_.a.Loaded})}function L(e){var t,n,a={};try{for(var o=Object(r.__values)(e),i=o.next();!i.done;i=o.next()){var s=i.value;a[s.threadId]=V(void 0,{state:_.a.Placeholder,initialItemCount:s.itemCount})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}function V(e,t){return{loadState:null!=t?t:{state:_.a.Loaded},pending:I.a.None,alternateId:e}}function U(e){var t={};return t[e]={pending:E.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function H(e){var t={};return t[e]={pending:I.a.Card,loadState:{state:_.a.Loaded},alternateId:e},t}function B(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function G(e,t,n,r){if(e){var a=Object(j.c)(e.selectionDetails)?e.selectedCardId:e.selectionDetails.selectedPostId,o=t.findIndex((function(e){return e.commentId===a})),i=t.findIndex((function(t){return t.commentId===e.selectedCardId}));if(i>=n&&i<r)return;if(o>=n&&o<r){var s={expanded:!0,lowFidelityWarningType:void 0};return{selectedCardId:e.selectedCardId,selectionDetails:s}}}return e}function W(e,t){var n=!1;if(T.Cb()){var r=e.draftState.cardIdToDraftIdMap[t.parentId];n=e.draftState.drafts[r].forceCardExpanded}else{if(!e.selectedComment||!Object(j.c)(e.selectedComment.selectionDetails))throw Object(a.j)("Selection bug - selection is not on Card "+t.parentId+" after typing in the reply box"),new v.a(y.j,a.e.reserveTag(589103586),-2130957564);n=e.selectedComment.selectionDetails.expanded}var o={expanded:n,lowFidelityWarningType:void 0};return{selectedCardId:t.parentId,selectionDetails:o}}function q(e){var t={lowFidelityWarningType:void 0,expanded:!e.parentId};return{selectedCardId:Object(l.b)(e),selectionDetails:t}}function z(e,t){var n=e.commentData.find((function(e){return e.commentId===t}));if(n){var r={lowFidelityWarningType:void 0,expanded:!0};return{selectedCardId:Object(l.b)(n),selectionDetails:r}}throw new v.a(y.i,a.e.reserveTag(589103587),-2130957563)}function Y(e,t,n){return{selectedCardId:n,selectionDetails:{expanded:se(n,e,t),lowFidelityWarningType:void 0}}}function K(e){return{selectedCardId:e,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0}}}function X(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function Q(e){return{selectedCardId:e,selectionDetails:{expanded:!1,lowFidelityWarningType:void 0}}}function Z(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return K(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n)return X(Object(l.b)(n),t);throw new v.a(y.d,a.e.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n&&""===n.parentId)return Q(t);throw new v.a(y.d,a.e.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new v.a(y.c,a.e.reserveTag(589103618),-2130957532)}}function J(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":return K(e.threadId);case"EDIT":return X(e.threadId,e.commentDraft.sessionConfiguration.commentId);case"REPLY":return Q(e.threadId);default:throw new v.a(y.c,a.e.reserveTag(577610274),-2130957532)}}function $(e,t,n){var r=n.payload;if(T.L())return{selectedCardId:r.selectedCard,selectionDetails:ee(e,t,r)};switch(r.selectType){case O.a.ExpandCard:var o={expanded:!0,lowFidelityWarningType:void 0};return{selectedCardId:r.selectedCard,selectionDetails:o};case O.a.CollapseCard:o={expanded:ie(t,r.selectedCard),lowFidelityWarningType:void 0};return{selectedCardId:r.selectedCard,selectionDetails:o};case O.a.SelectPost:var i={selectedPostId:r.selectedPost,lowFidelityWarningType:void 0};return{selectedCardId:r.selectedCard,selectionDetails:i};default:Object(a.n)(r)}}function ee(e,t,n){if(n.selectType===O.a.SelectPost)return e&&!Object(j.c)(e.selectionDetails)&&n.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:n.selectedPost,lowFidelityWarningType:void 0};var r=n.selectType===O.a.ExpandCard||ie(t,n.selectedCard);return{lowFidelityWarningType:e&&Object(j.c)(e.selectionDetails)&&n.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0,expanded:r}}function te(e){return e===Object(C.w)()}function ne(e,t,n,r){var a,o=n.payload.params,i=r;return a=Object(u.f)(o)?{lowFidelityWarningType:void 0,expanded:se(o.threadId,e,t)}:Object(u.e)(o)?{lowFidelityWarningType:void 0,selectedPostId:o.commentId}:T.P()?{lowFidelityWarningType:void 0,expanded:se(i=e?e.selectedCardId:r,e,t)}:{lowFidelityWarningType:void 0,selectedPostId:Object(C.w)()},{selectedCardId:i,selectionDetails:a}}function re(e,t,n){if(t&&"CLEAR_COMMENT_SELECTION"===n.type&&Object(S.l)(e))return!1;if(t&&"CLEAR_COMMENT_SELECTION"!==n.type){if(T.Cb()&&n.payload.selectType===O.a.CollapseCard&&n.payload.selectedCard===t.selectedCardId){var r=Ee(e);if(r&&r.threadId===n.payload.selectedCard)return!1}if(Object(S.l)(e)){var a=n.payload.selectType===O.a.CollapseCard||n.payload.selectType===O.a.ExpandCard;return n.payload.selectedCard===t.selectedCardId&&Object(j.c)(t.selectionDetails)&&a}}return!0}function ae(e){var t={};return e.commentId&&(t[e.commentId]={pending:I.a.None,loadState:{state:_.a.Loaded},alternateId:e.commentId}),t}function oe(e){var t={};return e.commentId&&(t[e.commentId]={pending:E.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function ie(e,t){var n=Ee(e);return!!n&&n.forceCardExpanded&&n.threadId===t}function se(e,t,n){return T.mb()?t&&t.selectedCardId===e&&(!Object(j.c)(t.selectionDetails)||t.selectionDetails.expanded)||ie(n,e):!(!t||t.selectedCardId!==e)&&(!Object(j.c)(t.selectionDetails)||t.selectionDetails.expanded)}function ce(e,t){return e&&e.selectedCardId===t.payload.commentId?{selectedCardId:t.payload.commentId,selectionDetails:{lowFidelityWarningType:void 0,expanded:Re(e)}}:e}function de(e,t){return!!e&&(!t.drafts[e.draftId]||t.drafts[e.draftId].isInCurrentContext)}function ue(e,t,n){var r=t.drafts[e.draftId];return!r||r.renderContextType===p.a.None||r.renderContextType===n}function le(e){var t;return!!(null===(t=Ee(e))||void 0===t?void 0:t.isInCurrentContext)}function me(e,t,n,a,o){if(!de(e,a))return e;if(e&&n[e.newComment.commentId]&&(n[e.newComment.commentId].pending===I.a.None||!o)){var i=Object(r.__assign)({},e),s=t.length;if(i.index>=s)i.index=s;else if(i.index>=0&&t[i.index].parentId){var c=new d.a(t,i.index);c.next().done?i.index=s:i.index=c.currentIndex()}return i}}function fe(e){return Object(r.__assign)(Object(r.__assign)({},e),{selectionDetails:{expanded:!1,lowFidelityWarningType:void 0}})}function pe(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(j.b)(t);return e.findIndex((function(e){return e.commentId===r}))}function ge(e,t){return pe(e,t,!0)}function Ce(e,t){return pe(e,t,!1)}function he(e,t){var n=Object(r.__assign)({},e);return n[t]&&delete n[t],n}function be(e,t){if(void 0===t)return Object(o.g)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;Object(o.g)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(o.g)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518);var n=Object(r.__assign)({},e);return delete n[t.sessionConfiguration.draftId],n}function ve(e){return Object(D.a)(e)===f.a.CanAutoDiscard?Object(S.h)():e}function ye(e,t){if(!T.ob()&&!T.p())return e;var n=Object(r.__assign)({},e.drafts),a=!1;return Object.keys(n).forEach((function(e){var o=t(e);o!==n[e].renderContextType&&(n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{renderContextType:o}),a=!0)})),a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:n}):e}function Te(e,t){if(t===m.a.Closed){if(Object(b.b)(e))return p.a.None}else if(e===p.a.DiscreteIntegrated)return p.a.FullPane;return e}function Oe(e){var t=Ee(e);return t?t.commentDraft:void 0}function Ie(e){var t=Object.keys(e);if(t.length>1)throw Object(o.g)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new v.a("Only a single draft is supported at this time.",a.e.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function Se(e){return Ie(e.cardIdToDraftIdMap)}function _e(e){return Ie(e.postIdToDraftIdMap)}function Ee(e){var t=e.drafts,n=Ie(t);return n?t[n]:void 0}function je(e,t){var n,a=e.pendingDraft&&Object(u.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,o=e.cardIdToDraftIdMap[t];return o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:be(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:he(e.cardIdToDraftIdMap,t),pendingDraft:a?void 0:e.pendingDraft}):a?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function De(e,t){var n,a=e.pendingDraft&&Object(u.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,o=e.postIdToDraftIdMap[t];return o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:be(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:he(e.postIdToDraftIdMap,t),pendingDraft:a?void 0:e.pendingDraft}):a?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Pe(e,t,n){var a=je(e,t),o=_e(a);if(o){var i=a.postIdToDraftIdMap[o],s=a.drafts[i];s&&s.threadId===t&&(a=De(a,o))}if(a.pendingDraft&&Object(u.e)(a.pendingDraft)){var c=a.pendingDraft.commentId,d=n.find((function(e){return e.commentId===c}));d&&Object(l.b)(d)===t&&(a=Object(r.__assign)(Object(r.__assign)({},a),{pendingDraft:void 0}))}return a}function Ae(e,t){return Be(e.atMention===t.capability)||Object(o.g)().assertConditionTag(!1,"Mismatch between received ModelCapabilities atMention value and atMentionState. (modelCapabilities.atMention: "+e.atMention+", atMentionState: "+t.capability+")",590120397),T.R()?e.atMention:t.capability}function xe(e){if(T.R()&&("web"===Object(h.a)()||"win32"===Object(h.a)())){if(e.tasks===c.a.Unknown){if("win32"===Object(h.a)())return T.b();Object(o.g)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===c.a.Enabled&&T.b()}return T.b()}function we(e,t){return Be(e.virtualized===t)||Object(o.g)().assertConditionTag(!1,"Mismatch between received ModelCapabilities virtualized value and virtualized state. (modelCapabilities.virtualized: "+e.virtualized+", virtualized: "+t+")",590120398),T.R()?e.virtualized:t}function ke(e,t){return Be(e.resolve===t)||Object(o.g)().assertConditionTag(!1,"Mismatch between received ModelCapabilities resolve value and resolve state. (modelCapabilities.resolve: "+e.resolve+", resolveState: "+t+")",590120399),T.R()?e.resolve:t}function Re(e){return!!e&&(!Object(j.c)(e.selectionDetails)||e.selectionDetails.expanded)}function Ne(e,t){return!(!t||!t.draftWarningState||e&&e.draftWarningState&&t.commentDraft.sessionConfiguration.draftId===e.commentDraft.sessionConfiguration.draftId&&t.draftWarningState.warningCounter===e.draftWarningState.warningCounter)}function Fe(e,t,n){var r,o,i=e.pendingCommentLoad,s=void 0;if(e.pendingCommentLoad){var c=e.pendingCommentLoad.selectedThreadIndex;if(void 0!==c&&Object(P.a)({commentData:t,pendingCommentLoad:i,virtualized:n})){var d=t.filter(l.a);if(!(c>=0&&c<d.length))throw Object(a.j)("selectedThreadIndex out of bounds"),new v.a(y.l,a.e.reserveTag(589103620),-2130957565);s=function(e){return{selectedCardId:e,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0}}}(d[c].commentId)}t.length===e.pendingCommentLoad.numberOfComments&&(i=void 0)}if(e.selectedComment)if(T.Cb()){var u=Ee(e.draftState);(null!==(r=null==u?void 0:u.threadId)&&void 0!==r?r:null===(o=e.createdCommentLie)||void 0===o?void 0:o.newComment.commentId)===e.selectedComment.selectedCardId&&(s=e.selectedComment)}else Object(S.d)(e.draftState)&&(s=e.selectedComment);return{pendingCommentLoad:i,selectedComment:s}}function Me(e,t){var n=e.find((function(e){return e.commentId===t}));return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Le(e,t){return t?e.filter((function(e){return""===e.parentId&&!(e.commentFlags&s.a.Resolved)})).length>0:e.length>0}var Ve=0;function Ue(){return{atMention:i.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:Ve,tasks:c.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1}}function He(e,t){var n,a=e.cardIdToDraftIdMap[t.commentId],i=a?e.drafts[a].commentDraft:void 0;if(void 0===i)return Object(o.g)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var s=t.smartReplies,c=i.sessionConfiguration.sessionType,d=s.length;return"REPLY"===c&&(d<=3&&d>0)?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Object(r.__assign)(Object(r.__assign)({},e.drafts),(n={},n[a]=Object(r.__assign)(Object(r.__assign)({},e.drafts[a]),{smartReplies:s}),n))}):e}function Be(e){return!T.R()||"web"!==Object(h.a)()||e}},130:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.Reloading=3]="Reloading",e[e.NeedsReload=4]="NeedsReload"}(r||(r={}))},131:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return C})),n.d(t,"a",(function(){return h}));var r=n(5),a=n(3),o=n(102),i=n(1020),s=n(40),c=n(7);function d(e){return!!e&&void 0!==e.EmailAddresses}function u(e){return e?d(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!d(e))return Object(a.g)().assertConditionTag(!c.I()||Object(i.b)(Object(o.a)()),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(a.g)().assertConditionTag("win32"===Object(o.a)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new s.a("UserPrincipalName and EmailAddresses, both not available",r.e.reserveTag(589103706),-2130957499)}function m(e){return void 0!==e.DisplayName?e.DisplayName:(Object(a.g)().assertConditionTag(!1,"user.DisplayName is not undefined",595133131),e.Email?e.Email:"")}function f(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function p(e){return 0===Object.keys(e).length&&Object(a.g)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function g(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function C(e,t){return t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]})),e}function h(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}},133:function(e,t,n){"use strict";var r=n(511),a=n(210);n.d(t,"h",(function(){return r.a})),n.d(t,"i",(function(){return r.c})),n.d(t,"k",(function(){return r.e})),n.d(t,"j",(function(){return r.d})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"c",(function(){return a.c})),n.d(t,"d",(function(){return a.e})),n.d(t,"g",(function(){return a.i})),n.d(t,"e",(function(){return a.f})),n.d(t,"f",(function(){return a.g}))},140:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(17);function a(e){return e===r.a.FullPane||e===r.a.HalfPane}function o(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},141:function(e,t,n){"use strict";var r,a;!function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(a||(a={}));var o=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),i=n(263),s=n(5),c=n(3),d=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),u=void 0;function l(e,t){if(!u)throw new s.d("Running in an invalid environment, window expected to exist.",s.e.reserveTag(589103763));Object(c.g)().assertConditionTag(void 0===u.ContentNavigationAPI,"Overriding already set ContentNavigationAPI.",591726551),u.ContentNavigationAPI=e}function m(e){if(Object(c.g)().assertConditionTag(e===i.a,"Unexpected API context received.",591726552),!u)throw new s.d("Running in an invalid environment, window expected to exist.",s.e.reserveTag(589103764));return void 0===u.ContentNavigationAPI&&(Object(c.g)().assertConditionTag(!1,"GetContentNavigationAPI called prior to API being set, overriding with stub.",591726553),u.ContentNavigationAPI=new d),u.ContentNavigationAPI}function f(e){return Object(c.g)().assertConditionTag(e===i.a,"Unexpected API context received.",591726554),void 0!==u.ContentNavigationAPI}function p(e){Object(c.g)().assertConditionTag(e===i.a,"Unexpected API context received.",591726555),u.ContentNavigationAPI=void 0}"undefined"!=typeof window&&(u=window),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return p}))},1480:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(277);n(1116),n(1129),n(1134);var o=n(113);var i=n(263),s=n(5),c=n(121),d=n(34),u=n(3),l=n(117),m=n(30),f=(n(1140),n(1142),n(680)),p=n(309),g=n(513),C=n(112),h=n(193),b=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(r.__spread)(t))}))}},enumerable:!1,configurable:!0}),e}(),v=function(){function e(){this.changedEvent=new b}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e.prototype.fireEvent=function(e){this.changedEvent.invoke(e)},e}(),y=n(290),T=n(0),O=n(56),I=n(73),S=n(52);function _(e,t){return e+"-"+t}var E,j=n(141),D=n(375);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(E||(E={}));var P={sendCodeMarker:function(e){},onStartEvent:new D.EventImpl((function(){})),onStopEvent:new D.EventImpl((function(){}))},A=function(e){this.onMockUIAction=new D.EventImpl((function(){}))},x=n(598),w=n(202),k=n(343),R=n(40),N=n(7),F=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,u.c.SystemMetadata)}};function M(e){return new F(L(e),e.correlationId)}var L=function(){throw new Error("ViewManagerFactory not set")};var V=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this,n=this.instanceMap.get(e);return n||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,u.c.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPI;this.initialized||this.ensureInitialized();var a=this.instanceMap.get(t);return a?this.updateInstanceObject(a,n):(this.initializeContentNavigationAPI(t,r),a=M(e),this.instanceMap.set(t,a)),a.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new R.a("Instance is not initialized",s.e.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new R.a("Instance is not initialized",s.e.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;N.G()&&P.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),P.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(j.d)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var a=void 0;n&&N.p()&&(Object(u.g)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),u.a.None,u.b.FullEvent).successTag(592511450),a=new A(e)),this.instanceMap.set(e,M({apiContext:e,correlationId:t,initializationReason:k.a.PaneOpen,displayMode:w.b.FullPane,foldableLayoutState:x.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:a}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){Object(j.f)(e)||Object(j.g)(t||new j.b(e),e)},e}()),U=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case C.a.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):Object(u.g)().assertConditionTag(!1,"View container base identifier expected",592241222),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch(Object(S.a)(s.e.reserveTag(592241223)));break;case C.a.Closed:r.viewContainerBase.identifier&&r.rootNode&&(Object(O.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case C.a.Hidden:Object(u.g)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",592217540);break;default:Object(s.n)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var a=_("SharedCommentPane",t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(y.b)().getComponent(a),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch(Object(S.a)(s.e.reserveTag(595646038))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(u.g)().createActivityObject("RenderPaneIntoView",V.getTelemetryVisitor(this.context),u.a.None,u.b.NecessaryServiceDataEvent);if(!n)return this.lastRenderFailed&&r.failTag(595649617,-2130957502),void(this.lastRenderFailed=!0);Object(O.render)(T.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(I.x());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(595649618)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===y.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(u.g)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",595899021)})):e===y.a.Unregistered&&Object(O.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case h.a.VisibilityChanged_deprecated:Object(u.g)().assertConditionTag(!1,"ViewContainerEventType.VisibilityChanged_deprecated should not be received here. Check logic in ViewContainerProvider.",590190289);break;case h.a.VisibilityChanged:this.processVisibilityEvent(e);break;case h.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case h.a.FoldableLayoutStateChanged:case h.a.FocusTriggered:break;default:Object(s.n)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),H=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.processEvent=function(e){var t=e;if(e.eventType===h.a.VisibilityChanged_deprecated){var n=e.visible?C.a.Visible:C.a.Closed;t={eventType:h.a.VisibilityChanged,viewContainerVisibilityState:n}}r.fireEvent(t)},r.apiContext=t,n.registerForViewContainerEvents(r.processEvent),r}return Object(r.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(this.currentContainer=new U(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(v);var B=n(194),G=n(8),W=Object(G.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}}})),q=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(r.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=W();return T.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(T.PureComponent);function z(){var e=document.createElement("div");document.body.appendChild(e),O.render(T.createElement(q,{ref:K}),e),Object(B.c)({announceToScreenReader:function(e){var t=Y;t&&Object(c.d)(e)&&t.appendLiveRegionUpdate(e)}})}var Y=void 0;function K(e){Y=e}n(24);var X={LivePersonaPicker:{webSettingName:"LivePersonaPicker"},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton"},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments"},CommentsFluentUI:{webSettingName:"CommentsFluentUI"},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks"},NoDiscardOnFocusLoss:{webSettingName:"NoDiscardOnFocusLoss"},NewDraftingUI:{webSettingName:"DiscreteHostedComments"},CommentsFluentUIV2:{webSettingName:"CommentsFluentUIV2"},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply"},NewModelState:{webSettingName:"NewModelState"},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},ExtendedDrafting:{webSettingName:"ExtendedDrafting"},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair"},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewResolvedCardDesignInWeb:{webSettingName:"NewResolvedCardDesignInWeb"},NewSelectionInteractions:{},CommentReactions:{webSettingName:"CommentReactions"},LinkToComment:{webSettingName:"LinkToComment"},NewBorderAndFocusLookInWeb:{webSettingName:"NewBorderAndFocusLookInWeb"},ReenableMentionContactCard:{},AccessibilityAnnotationTarget:{},AccessibilityDescription:{}},Q=n(2);var Z={name:"OfficeSharedComments",version:n(933).a},J=n(108);function $(){if(!N.p())throw new R.a(J.o,s.e.reserveTag(589103628),-2130957516);return V.getViewManager(i.a)}function ee(){$().beginInitialization()}var te,ne=n(131),re=n(210),ae=n(511),oe=function(){function e(e,t,n,r,a){var o=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=a,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===o.sessionConfiguration.draftId&&(e.anchorHintText&&(o._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(o._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===re.d.CommentContextChanged&&Object(ae.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return o.updateDraft(e)})):e===re.d.UpdateDraftThread&&Object(ae.f)(t)&&o.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(r.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new R.a(J.h,s.e.reserveTag(589103689),-2130957526);if(!this._active)throw new R.a(J.b,s.e.reserveTag(589103690),-2130957525);var t=N.b()&&this.sessionConfiguration.sessionType===re.h;if(void 0===e&&!t||t&&void 0!==e)throw new R.a(J.c,s.e.reserveTag(589103691),-2130957507);return N.b()||N.a()?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),ie=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),N.J()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e))}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new R.a("Drafting APIs are undefined on Host Comment API",s.e.reserveTag(589103700),-2130957527);var n=Object(c.c)(),a=Object(r.__assign)(Object(r.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(a).then((function(e){return new oe(t.hostCommentAPI,Object(ne.b)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||a,e.insertIndex)}))},e}(),se=n(37),ce={themeId:1,palette:{ApplePaneTopBorder:se.a.GRAY_C,ButtonBorder:se.a.GRAY_B,CardAccent:se.a.GRAY_B,CardBackground:se.a.WHITE,CardHoveredBackground:se.a.GRAY_20,CardDraftBoxBackgroundHovered:se.a.WHITE,CardDraftBoxBorderHovered:se.a.GRAY_160,CardDraftBoxBorder:se.a.GRAY_110,CardDraftBoxBackground_HalfPane:se.a.WHITE,CardDraftBoxBackground:se.a.GRAY_A,CardExpandButtonBorder:se.a.GRAY_B,CardHeroBarBackground_HalfPane:se.a.GRAY_A,CardHeroBarBackground:se.a.WHITE,CardReplyBackground_HalfPane:se.a.GRAY_A,CardReplyBackground:se.a.GRAY_A,CardReplyTopBorder:se.a.GRAY_B,CardSelectionColor:se.a.COMMENTS_PURPLE,CardShadowColor:se.a.BLACK,CardBorder:se.a.GRAY_B,CardBorderEmphasis:se.a.COMMENTS_PURPLE,CommandBarBorder:se.a.GRAY_B,CommandBarTopBorder:se.a.GRAY_B,GhostCommentWrapperBorder:se.a.GRAY_D,IconButtonDisabledTint:se.a.GRAY_C,IconButtonFocusedTint:se.a.GRAY_I,NavigationBarBackground:se.a.WHITE,NavigationBarBorder:se.a.GRAY_B,PaneBackground_HalfPane:se.a.WHITE,PaneBackground:se.a.GRAY_A,UnreadDotColor:se.a.DOT_BLUE,UnreadDotBorderColor:se.a.WHITE,ResolvedPersonaBackground:se.a.GRAY_A,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:se.a.GRAY_150,CardPlaceholderColor:se.a.GRAY_130,ResolvedCardBackground:se.a.GRAY_20}},de=function(){function e(){}return e.prototype.getTheme=function(){return Object(u.g)().assertConditionTag(!1,"Should not be called",592986821),ce},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),ue=n(164),le=n(18),me=n(42),fe=n(423),pe=n(13),ge=n(152),Ce=n(48),he=n(180),be=n(41),ve=n(10),ye=n(62),Te=n(168);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(te||(te={}));var Oe,Ie=n(17),Se=n(102),_e=n(140);function Ee(e,t){return{type:Oe.DispatchAction,action:t,causedBy:e}}function je(e){return e.type===Oe.FocusComponent&&void 0!==e.component}function De(e,t,n){return Object(r.__assign)({type:Oe.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.FocusTag=2]="FocusTag",e[e.DispatchAction=3]="DispatchAction",e[e.Compound=4]="Compound"}(Oe||(Oe={}));var Pe=n(219),Ae=n(32);function xe(e,t){return!!(Object(Ae.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}var we=n(380);function ke(e,t){if(void 0===t&&(t=!1),t||(n=e.renderContextType,"win32"!==Object(Se.a)()&&("ios"!==Object(Se.a)()||n!==Ie.a.FullPane)&&Object(_e.b)(n))){var n;if(e.getComponent(Ae.a.ClosePaneButton))return De(void 0,{componentType:Ae.a.ClosePaneButton});Object(u.g)().assertConditionTag(t&&("win32"===Object(Se.a)()||"ios"===Object(Se.a)()&&e.renderContextType===Ie.a.FullPane),"cant find close button on platform where we should be able to find it",579086371)}}function Re(e,t){if(N.P()&&e.renderContextType===Ie.a.FullPane){if(N.W()){var n=t.getState();if(!(N.R()?ve.k(n).newThread:Object(we.a)(ve.h(n),ve.g(n))))return}if(e.getComponent(Ae.a.NewCommentButton))return De(void 0,{componentType:Ae.a.NewCommentButton});Object(u.g)().assertConditionTag(!N.E()&&!N.P(),"cant find new comment button, but its enabled",579086400)}}function Ne(){if(!(N.W()&&"ios"===Object(Se.a)()||N.W()&&"web"===Object(Se.a)()))return De(void 0,{componentType:N.W()?Ae.a.CommentsList:Ae.a.PaneRoot})}function Fe(e,t){var n,r;if(!N.W()){if(N.E()&&(!N.P()||e.renderContextType!==Ie.a.FullPane))return ke(e,!N.E());var a=Re(e,t);return a||ke(e,!N.E())}if(Object(_e.b)(e.renderContextType)){var o=null!==(r=null!==(n=Re(e,t))&&void 0!==n?n:ke(e,!N.E()))&&void 0!==r?r:Ne();if(o)return o;Object(u.g)().assertConditionTag("ios"===Object(Se.a)()&&e.renderContextType===Ie.a.FullPane,"Couldn't find a focus target",576337158)}else Object(u.g)().assertConditionTag(!1,"Shouldn't be called with renderContextType: "+e.renderContextType,576337157)}var Me=n(775);function Le(e,t,n){return t?n?{type:Oe.Compound,first:t,then:n,causedBy:e}:t:n}function Ve(e,t,n){if(!e)return te.NoCommand;var r=te.Handled;if(je(e)){var a=e.component;N.D()&&a.componentType===Ae.a.Card&&"ios"===Object(Se.a)()&&(Me.a&&Object(s.j)("Switching focus command from Card to Post to workaround iOS platform difference with card container focus"),a.componentType=Ae.a.Post),r=function(e,t){return t?(Me.a&&Object(s.j)("Calling focus for componentType: "+e.component.componentType),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),te.Handled):e.shouldRetryOnMount||e.shouldRetryOnPropsUpdate?te.ShouldRetry:N.pb()?te.ComponentNotFound:te.Handled}(e,Object(Ae.c)(a)?t.getComponentById(a):t.getComponent(a.componentType))}else!function(e){return e.type===Oe.DispatchAction&&void 0!==e.action}(e)?function(e){return e.type===Oe.Compound&&void 0!==e.first&&void 0!==e.then}(e)&&(Ve(e.first,t,n),Ve(e.then,t,n)):n.dispatch(e.action);return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),r}var Ue=function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}(),He=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,a=r.altKey,o=r.shiftKey,i=r.ctrlKey,s=r.metaKey,c=r.key;return n.altKey=a,n.shiftKey=o,n.ctrlKey=i,n.metaKey=s,n.key=Object(ue.f)(c),n}return Object(r.__extends)(t,e),t}(Ue);function Be(e,t,n){var a=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return n.apply(void 0,Object(r.__spread)([e],t))},o=function(n){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var s=a.apply(void 0,Object(r.__spread)([n],o)),c=Ve(s,n,e());t(s,c)};return o.processCommand=a,o}function Ge(e,t,n,a){var o=function(t,n){var a,o=Object(r.__read)(n),s=o[0],c=o.slice(1),d=s();Ve(i.apply(void 0,Object(r.__spread)([(a=t,new He(a)),d],c)),d,e())},i=function(e,o){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(n(o)){var c=Object(ue.d)(Object(ue.f)(e.key),t),d=a[ue.b[c]];return d?d.handler.apply(d,Object(r.__spread)([e,o],i)):void 0}},s=Object.keys(a).map((function(e){return{key:e,eventPhase:a[e].phase}})),c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return o(t,e)},getKeyDownEvents:function(){return s}}};return c.processEvent=i,c}var We=n(174),qe=n(170),ze=n(82),Ye=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(ze.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&re.e.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&re.e.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Ke=n(320),Xe=n(87),Qe=n(226),Ze=n(171),Je=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=Xe.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(Ze.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(Ze.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&Qe.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&Qe.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();var $e,et=function(){function e(e,t){this.commentStore=e,this.telemetryVisitor=t}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,a){return Ee(e,le.K(t,n,void 0,r?le.b.CollapseCard:le.b.ExpandCard,a))},e.prototype.selectPost=function(e,t,n,r,a){return Ee(e,le.K(t,n,r,le.b.SelectPost,a))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,a){if(void 0===a&&(a=!1),N.Cb()){var o=ve.g(this.commentStore.getState(),!0,N.ub()?r:void 0);if(o&&0===o.index)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:s.e.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},o.newComment.commentId,!1,n)}var i=void 0;a?i=new Ke.a(ve.d(this.commentStore.getState()),-1,a).next().value:i=ve.d(this.commentStore.getState())[0];if(i)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:s.e.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},i.commentId,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,a){void 0===a&&(a=!1);var o=ve.d(this.commentStore.getState());if(N.Cb()){var i=ve.g(this.commentStore.getState(),!0,N.ub()?r:void 0);if(i&&i.index===o.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:s.e.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},i.newComment.commentId,!1,n)}if(Object(pe.c)(o,a)){var c=new Ke.a(o,o.length,a).previous().value;if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:s.e.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},c.commentId,t,n);Object(u.g)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t,n){var r=ve.o(this.commentStore.getState());if(r){if(N.Cb()){var a=ve.g(this.commentStore.getState());if(a&&a.newComment.commentId===r.selectedCardId)return}var o=r.selectionDetails;if(!Object(be.c)(o)||Object(be.c)(o)&&o.expanded)return Le(e,De(e,{componentType:Ae.a.Card,id:r.selectedCardId,renderContextType:n}),this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:s.e.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},r.selectedCardId,!0,t))}},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,a){var o=this.commentStore.getState(),i=ve.o(o);if(N.Ab()&&(!i||n===Ie.a.DiscreteIntegrated||n===Ie.a.None&&ye.e(o)!==C.a.Visible))return Ee(e,le.L({renderContextType:n,trackback:s.e.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,i?{contentId:i.selectedCardId,contentType:m.b.CommentThread}:void 0,me.a.SharedComments));var c=ve.d(o),d=ve.f(o).nextPopulatedContextDetails;if(void 0!==i){var u=ve.g(o,!0,N.ub()?n:void 0),l=void 0;l=N.Cb()&&u&&i.selectedCardId===u.newComment.commentId?u.index+(t.direction===j.c.Next?-1:0):this.getSelectedThreadIndex();var f=new Ke.a(c,l,a),p=t.direction===j.c.Next?f.next():f.previous();if(N.Cb()&&u&&i.selectedCardId!==u.newComment.commentId)if(t.direction===j.c.Next?l<u.index&&(p.done||f.currentIndex()>=u.index):l>=u.index&&(p.done||f.currentIndex()<u.index))return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:s.e.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},u.newComment.commentId,!1,t.source);if(!p.done)return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:s.e.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},p.value.commentId,!!t.collapseCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t.direction,n,r)}else{if(Object(pe.c)(c,a))return this.selectFirstThreadInCurrentContext(e,!!t.collapseCard,t.source,n,a);if(!t.restrictToCurrentContext&&d!==qe.a.NoComments)return this.selectAcrossContexts(e,t.direction,n,r)}},e.prototype.selectAcrossContexts=function(e,t,n,r){var a=N.rb()?void 0:void this.telemetryVisitor,o=void 0;return o=t===j.c.Next?Ee(e,le.M({renderContextType:n,trackback:s.e.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):Ee(e,le.N({renderContextType:n,trackback:s.e.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor})),N.rb()?o:Le(e,a,o)},e.prototype.selectNextPost=function(e,t,n){var r;if(N.b()){if(n){var a=new Je(n,this.getSelectedIndexFromRenderableItems(n),t===Ie.a.DiscreteIntegrated).next();if(!a.done)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278850),telemetryVisitor:this.telemetryVisitor},Xe.i(a.value),Xe.e(a.value),me.a.SharedComments);if(N.Ab()&&t===Ie.a.DiscreteIntegrated){var o=ve.o(this.commentStore.getState());f=o?{contentId:o.selectedCardId,contentType:m.b.CommentThread}:void 0;return Ee(e,le.L({renderContextType:t,trackback:s.e.reserveTag(593278851),telemetryVisitor:this.telemetryVisitor},j.c.Next,void 0,!0,!0,f,me.a.SharedComments))}var i=new Ke.a(ve.d(this.commentStore.getState()),this.getSelectedThreadIndex(),t===Ie.a.DiscreteIntegrated).next();return i.done?void 0:this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278852),telemetryVisitor:this.telemetryVisitor},Object(ze.b)(i.value),i.value.commentId,me.a.SharedComments)}Object(u.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278849)}else{var c=new Ye(ve.d(this.commentStore.getState()),this.getSelectedIndex(),t===Ie.a.DiscreteIntegrated).next();if(!c.done){var d=null===(r=ve.o(this.commentStore.getState()))||void 0===r?void 0:r.selectedCardId,l=Object(ze.b)(c.value);if(N.Ab()&&t===Ie.a.DiscreteIntegrated&&d!==l){var f=d?{contentId:d,contentType:m.b.CommentThread}:void 0;return Ee(e,le.L({renderContextType:t,trackback:s.e.reserveTag(593278819),telemetryVisitor:this.telemetryVisitor},j.c.Next,void 0,!0,!0,f,me.a.SharedComments))}return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278848),telemetryVisitor:this.telemetryVisitor},l,c.value.commentId,me.a.SharedComments)}}},e.prototype.selectNextPostWithinCard=function(e,t,n){if(void 0!==ve.o(this.commentStore.getState())){if(!N.b()){var r=ve.d(this.commentStore.getState()),a=this.getSelectedIndex(),o=new Ye(r,a).next(),i=r[a];return!o.done&&o.value.parentId&&o.value.parentId===Object(ze.b)(i)?this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},o.value.parentId,o.value.commentId,me.a.SharedComments):void 0}if(n){var c=this.getSelectedIndexFromRenderableItems(n),d=new Je(n,c).next(),l=n[c],m=Xe.i(l);return d.done||Xe.i(d.value)!==m?void 0:this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},Xe.i(d.value),Xe.e(d.value),me.a.SharedComments)}Object(u.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(u.g)().assertConditionTag(!1,"Expected selectedCommentIndex",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){if(void 0!==ve.o(this.commentStore.getState()))if(N.b())if(n){var r=this.getSelectedIndexFromRenderableItems(n),a=n[r],o=Xe.g(a);if(o)if(!(i=new Je(n,r).previous()).done&&Xe.i(i.value)===o)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},Xe.i(i.value),Xe.e(i.value),me.a.SharedComments)}else Object(u.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);else{var i,c=ve.d(this.commentStore.getState()),d=this.getSelectedIndex(),l=c[d];if(l.parentId&&!(i=new Ye(c,d).previous()).done&&Object(ze.b)(i.value)===l.parentId)return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},Object(ze.b)(i.value),i.value.commentId,me.a.SharedComments)}else Object(u.g)().assertConditionTag(!1,"Expected selectedCommentIndex",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=ve.o(this.commentStore.getState());if(n&&Object(be.c)(n.selectionDetails)){var r=this.getSelectedIndex(),a=ve.d(this.commentStore.getState())[r];return this.selectPost(e,{renderContextType:t,trackback:s.e.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},a.commentId,a.commentId,me.a.SharedComments)}},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n,r=ve.d(this.commentStore.getState()).filter((function(e){return!e.parentId}));if(0!==r.length)if(!(t-1<0&&t+1>=r.length))return n=t-1>=0?t-1:t+1,Le(void 0,De(void 0,{componentType:Ae.a.Card,id:r[n].commentId,renderContextType:e}),Ee(void 0,le.K({renderContextType:e,trackback:s.e.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},r[n].commentId,void 0,le.b.CollapseCard,me.a.SharedComments)))}},e.prototype.getSelectedIndex=function(){return Object(pe.o)(ve.d(this.commentStore.getState()),ve.o(this.commentStore.getState()))},e.prototype.getSelectedThreadIndex=function(){var e=this.commentStore.getState();return Object(pe.J)(ve.d(e),ve.o(e))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=ve.o(this.commentStore.getState());if(!t)return-1;var n=Object(be.b)(t);return e.findIndex((function(e){return Object(Ze.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),tt=function(){function e(e,t){var n=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecuteCallback=function(e,t){e&&je(e)&&(t===te.ShouldRetry?n.focusToRetry={command:Object(r.__assign)(Object(r.__assign)({},e),{shouldRetryOnMount:!1}),timestamp:Date.now()}:N.pb()&&t!==te.Handled||(n.focusToRetry=void 0))},this.commentContentsKeyDown=Ge((function(){return n.commentStore}),this.isRTL,(function(e){var t=ve.h(n.commentStore.getState());if(N.Cb()){var r=Object(pe.G)(t);if(r&&e.isFocusOn({componentType:Ae.a.CardEditor,id:r,renderContextType:t.drafts[t.cardIdToDraftIdMap[r]].renderContextType}))return!1;var a=Object(pe.H)(t);if(a&&e.isFocusOn({componentType:Ae.a.PostEditor,id:a,renderContextType:t.drafts[t.postIdToDraftIdMap[a]].renderContextType}))return!1}else if(Object(Ce.c)(t))return!1;return!e.isFocusOn({componentType:Ae.a.GhostCard})&&!e.isFocusOn({componentType:Ae.a.NewCommentButton})}),{ArrowDown:{handler:function(e,t,r){var a=n.onDownKey(e,t,r?r():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a},phase:ue.a.Bubbling},ArrowUp:{handler:function(e,t,r){var a=n.onUpKey(e,t,r?r():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a},phase:ue.a.Bubbling},ArrowRight:{handler:function(e,t,r){var a=n.onRightKey(e,t,r?r():void 0);return a&&(a.stopPropagation=!0,a.preventDefault=!0),a},phase:ue.a.Bubbling},ArrowLeft:{handler:function(e,t){var r=n.onLeftKey(e,t.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:ue.a.Bubbling},Home:{handler:function(e,t){if(t.renderContextType===Ie.a.FullPane){var r=n.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,me.a.SharedComments,t.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ue.a.Capturing},End:{handler:function(e,t){if(t.renderContextType===Ie.a.FullPane){var r=n.selectionCommandFactory.selectLastThreadInCurrentContext(e,!1,me.a.SharedComments,t.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ue.a.Capturing},F12:{handler:function(e,t){var r=n.handleMoveFocusEvent(e,t);return r&&(r.stopPropagation=!0),r},phase:ue.a.None}}),this.focusCommentCardCommand=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){var r=ve.h(n.commentStore.getState()),a=Object(pe.I)(r),o=void 0;return N.yb()&&(o=n.checkForRetryOfEditorFocus(e,r))||!N.Cb()&&(null==a?void 0:a.threadId)===t&&(o=n.checkForActiveEditorFocus(void 0,e.renderContextType,r))?o:De(void 0,{componentType:Object(Pe.b)(t,ve.g(n.commentStore.getState())),id:t,renderContextType:e.renderContextType},{preventScroll:e.renderContextType===Ie.a.DiscreteIntegrated})})),this.focusCommentPostCommand=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){var r=ve.h(n.commentStore.getState());if(!N.Cb()&&r.postIdToDraftIdMap[t]){var a=n.checkForActiveEditorFocus(void 0,e.renderContextType,r);if(a)return a}return De(void 0,{componentType:Ae.a.Post,id:t,renderContextType:e.renderContextType},N.wb()?{shouldRetryOnMount:!0}:void 0)})),this.focusCommentPaneCommand=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e){if(Object(_e.b)(e.renderContextType)){var t=ve.h(n.commentStore.getState()),r=ve.o(n.commentStore.getState()),a=void 0;if(N.yb()&&(a=n.checkForRetryOfEditorFocus(e,t)))return a;if(!N.Cb()&&(a=n.checkForActiveEditorFocus(void 0,e.renderContextType,t)))return a;if(a=n.checkForCommentSelectionFocus(e.renderContextType,r,ve.g(n.commentStore.getState())))return a;if(!N.P()){if(!e.getComponent(Ae.a.ClosePaneButton)){var o=ve.d(n.commentStore.getState());return o.length>0?n.focusCommentCardCommand.processCommand(e,o[0].commentId):void Object(u.g)().assertConditionTag("win32"===Object(Se.a)()||"ios"===Object(Se.a)()&&e.renderContextType===Ie.a.FullPane,"Shouldn't be reached on current config",575239243)}if(!N.W())return De(void 0,{componentType:Ae.a.ClosePaneButton})}if(N.W())return Fe(e,n.commentStore);if("ios"!==Object(Se.a)()){var i=e.getComponent(Ae.a.NewCommentButton);if(!i||i.disabled)return Ne()}return De(void 0,{componentType:Ae.a.NewCommentButton})}Object(u.g)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)})),this.focusActiveEditorCommand=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e){var t=ve.h(n.commentStore.getState());return n.checkForActiveEditorFocus(void 0,e.renderContextType,t)})),this.commentCardMounted=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){var r,a={componentType:Object(Pe.b)(t.id,ve.g(n.commentStore.getState())),id:t.id,renderContextType:e.renderContextType};if(r=n.handleFocusRetry(e,a,ve.h(n.commentStore.getState())))return r;if(t.selected&&!e.isFocusWithin(a)){var o=Object(_e.b)(e.renderContextType);if((!o||e.isFocusWithinPane())&&(o||e.isFocusWithinAny(Ae.a.Card)||e.isFocusWithinAny(Ae.a.DraftCard)))return n.focusCommentCardCommand.processCommand(e,t.id)}})),this.commentCardEditorMounted=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:Ae.a.CardEditor,id:t,renderContextType:e.renderContextType},ve.h(n.commentStore.getState()))})),this.commentPostMounted=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:Ae.a.Post,id:t,renderContextType:e.renderContextType},ve.h(n.commentStore.getState()))})),this.commentPostEditorMounted=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:Ae.a.PostEditor,id:t,renderContextType:e.renderContextType},ve.h(n.commentStore.getState()))})),this.commentPanePropsUpdated=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t,r){var a=void 0;if(a=n.checkForRetryCommandOnPropsUpdated(e,r.draftState,!1))return a;if(!N.yb()){if(a=n.checkIfCardEditorShouldFocusForReturnToDraft_deprecated(e,t.draftState,r.draftState))return a;if(a=n.checkIfPostEditorShouldFocusForReturnToDraft_deprecated(e,t.draftState,r.draftState))return a;if(a=n.checkForNewDraft_deprecated(e.renderContextType,t.draftState,r.draftState))return a}var o=t.draftState,i=r.draftState,s=t.selectedCommentInfo&&t.selectedCommentInfo.selectedComment,c=r.selectedCommentInfo&&r.selectedCommentInfo.selectedComment;if(a=n.checkForDiscard(e,o,i,s,c))return a;if(N.F()&&(a=n.checkForHalfPaneFullTransition(e,t,r)))return a;if(e.isFocusWithinPane()){if(N.L()&&(a=n.checkForLowFidelityWarning(e,s,c)))return a;if(a=n.checkForSelectionChange(e,i,s,c))return a;if(a=n.checkForCardPendingChange(e,t.cardViewStates,r.cardViewStates,r.createdCommentLie))return a;if(a=n.checkForReplyFinished(e,t.draftState,r.draftState,c&&r.cardViewStates[c.selectedCardId]))return a;if(N.L())return n.checkForLowFidelityWarning(e,s,c)}})),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t,a){var o=void 0;if(N.yb()){if(o=n.checkForRetryCommandOnDiscreteCardPropsUpdated(e,a))return o}else{if(a.cardRelativeDraftingState===Te.a.InCard&&n.shouldFocusDraftEditorForReturnToDraft_deprecated(t.draftState.drafts[t.draftState.cardIdToDraftIdMap[t.threadId]],a.draftState.drafts[a.draftState.cardIdToDraftIdMap[a.threadId]],e.renderContextType))return Object(r.__assign)(Object(r.__assign)({},De(void 0,{renderContextType:e.renderContextType,componentType:Ae.a.CardEditor,id:a.threadId})),{shouldRetryOnMount:!0});if(o=n.checkForRetryCommandOnDiscreteCardPropsUpdated(e,a))return o;if(a.cardRelativeDraftingState===Te.a.InChildPost&&(o=n.checkIfPostEditorShouldFocusForReturnToDraft_deprecated(e,t.draftState,a.draftState)))return o;if((a.cardRelativeDraftingState===Te.a.InCard||a.cardRelativeDraftingState===Te.a.InChildPost)&&(o=n.checkForNewDraft_deprecated(e.renderContextType,t.draftState,a.draftState)))return o}if(o=n.checkForDiscard(e,t.draftState,a.draftState,t.selectedState,a.selectedState))return o;if(e.isFocusWithinAny(Ae.a.Card)||e.isFocusWithinAny(Ae.a.DraftCard)){if(n.shouldFocusFromCardPendingStateChange(t.cardState,a.cardState))return De(void 0,{renderContextType:e.renderContextType,componentType:Object(Pe.b)(a.isDraftThread),id:a.threadId});if(N.L()&&(o=n.checkForLowFidelityWarning(e,t.selectedState,a.selectedState)))return o;if(o=n.checkForSelectionChange(e,a.draftState,t.selectedState,a.selectedState))return o;if(o=n.checkForReplyFinished(e,t.draftState,a.draftState,a.cardState))return o;if(N.L())return n.checkForLowFidelityWarning(e,t.selectedState,a.selectedState)}})),this.paneContainerKeyDown=Ge((function(){return n.commentStore}),this.isRTL,(function(e){return!!Object(_e.b)(e.renderContextType)||(Object(u.g)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return Ee(e,le.B({renderContextType:t.renderContextType,trackback:s.e.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:ue.a.Capturing},Tab:{handler:function(e,t){return n.paneContainerTabHandling(e,t)},phase:ue.a.None}}),this.commentEditorKeyDown=Ge((function(){return n.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var r=n.handleMoveFocusEvent(e,t);return r&&(r.stopPropagation=!0),r},phase:ue.a.None}}),this.onUserAction=Be((function(){return n.commentStore}),this.commandExecuteCallback,(function(e,t){var r;if(N.D()||e.renderContextType===Ie.a.FullPane)switch(t.userAction){case We.a.RequestNewCommentFromHost:if(!N.W())return Ne();if(!Object(_e.b)(e.renderContextType))return;return Fe(e,n.commentStore);case We.a.CancelReplyDraft:return void 0===t.selectedCardId?void Object(u.g)().assertConditionTag(!1,"Cancelling reply with no focused comment?",575239246):De(void 0,{componentType:Ae.a.Card,id:t.selectedCardId,renderContextType:e.renderContextType});case We.a.DeleteThread:case We.a.CancelNewThreadDraft:if(N.W()){if(!Object(_e.b)(e.renderContextType))return;return null!==(r=Fe(e,n.commentStore))&&void 0!==r?r:n.selectionCommandFactory.focusAndSelectSiblingThread(e.renderContextType,t.threadIndex)}if(void 0===t)return Object(u.g)().assertConditionTag(void 0!==t,"User action options are required",575239247),Fe(e,n.commentStore);if(t.isNewCommentButtonFocusable_deprecated)return Fe(e,n.commentStore);if("ios"!==Object(Se.a)())return Ne();if(e.renderContextType!==Ie.a.FullPane)return;return n.selectionCommandFactory.focusAndSelectSiblingThread(e.renderContextType,t.threadIndex);case We.a.ResolveThread:return void 0===t.selectedCardId?void Object(u.g)().assertConditionTag(!1,"Cancelling reply with no focused comment?",575239248):De(void 0,{componentType:Ae.a.ReopenThreadButton,id:t.selectedCardId,renderContextType:e.renderContextType},{shouldRetryOnPropsUpdate:!0});default:Object(s.n)(t)}}))}return e.prototype.initialize=function(e,t){if(this._commentStore)throw new R.a("FocusManager already initialized",s.e.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=t?t:new et(e,this.telemetryVisitor)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new R.a("FocusManager not initialized",s.e.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n){if(N.yb()){var r;if(r=this.checkForRetryOfEditorFocus(e,n))return r}if(this.focusToRetry&&t){var a=Date.now()-this.focusToRetry.timestamp;if(a>15e3)return Object(u.g)().assertConditionTag(!1,"Took too long to mount component for focus retry: "+a+" ms",575239241),void(this.focusToRetry=void 0);var o=this.focusToRetry.command.component;if(Object(Ae.b)(o,t)){var i=this.focusToRetry.command;return this.focusToRetry=void 0,i}}},e.prototype.shouldArrowNavigatePosts=function(e,t){if(Object(be.c)(e.selectionDetails)&&!e.selectionDetails.expanded)return!1;var n=ve.g(this.commentStore.getState());if(e.selectedCardId===(null==n?void 0:n.newComment.commentId))return!1;var r={componentType:Ae.a.Post,id:Object(be.b)(e),renderContextType:t.renderContextType};return N.tb()?t.isFocusOnOrWithin(r):t.isFocusOn(r)||t.isFocusWithin(r)},e.prototype.onDownKey=function(e,t,n){if(ve.d(this.commentStore.getState()).length){var r=ve.o(this.commentStore.getState());if(r){if(!this.shouldArrowNavigatePosts(r,t)){if(t.renderContextType===Ie.a.DiscreteIsolated)return;var a={direction:j.c.Next,source:me.a.SharedComments,collapseCard:!0,restrictToCurrentContext:!0,iterableContentTypes:void 0},o=N.p()&&!ye.a(this.commentStore.getState());return this.selectionCommandFactory.selectNextOrPreviousThread(e,a,t.renderContextType,t,o)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==Ie.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,me.a.SharedComments,t.renderContextType);Object(u.g)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)}},e.prototype.onUpKey=function(e,t,n){if(ve.d(this.commentStore.getState()).length){var r=ve.o(this.commentStore.getState());if(r){if(!this.shouldArrowNavigatePosts(r,t)){if(t.renderContextType===Ie.a.DiscreteIsolated)return;var a={direction:j.c.Previous,source:me.a.SharedComments,collapseCard:!0,restrictToCurrentContext:!0,iterableContentTypes:void 0},o=N.p()&&!ye.a(this.commentStore.getState());return this.selectionCommandFactory.selectNextOrPreviousThread(e,a,t.renderContextType,t,o)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==Ie.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,me.a.SharedComments,t.renderContextType);Object(u.g)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)}},e.prototype.onRightKey=function(e,t,n){if(ve.d(this.commentStore.getState()).length){var r=ve.o(this.commentStore.getState());if(N.Cb()){var a=ve.g(this.commentStore.getState());if(r&&a&&r.selectedCardId===a.newComment.commentId)return}var o=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.renderContextType);return o||(r&&!Object(be.c)(r.selectionDetails)&&t.isFocusOn({componentType:Ae.a.Card,id:r.selectedCardId,renderContextType:t.renderContextType})&&(o=this.focusCommentPostCommand.processCommand(t,r.selectionDetails.selectedPostId)),o||(t.renderContextType===Ie.a.DiscreteIsolated?this.selectionCommandFactory.selectNextPostWithinCard(e,t.renderContextType,n):this.selectionCommandFactory.selectNextPost(e,t.renderContextType,n)))}},e.prototype.onLeftKey=function(e,t){if(ve.d(this.commentStore.getState()).length)return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,me.a.SharedComments,t)},e.prototype.onTabKeyInPane=function(e,t){return void 0===ve.o(this.commentStore.getState())&&ve.d(this.commentStore.getState()).length>0?this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,me.a.SharedComments,t):N.Cb()?void 0:this.checkForActiveEditorFocus(e,t,ve.h(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var e=ve.q(this.commentStore.getState());return e&&!e.isInCurrentContext},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(N.yb()&&void 0!==this.draftToFocus){if(N.qb()&&!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:Oe.PreserveFocus};var a=t.drafts[this.draftToFocus.draftId],o=Date.now()-this.draftToFocus.timestamp;if(o>15e3)return Object(u.g)().assertConditionTag(!1,"Took too long to focus draft editor: "+o+" ms, expected draft still exists: "+!!a,575239251),void(this.draftToFocus=void 0);if(a&&a.renderContextType===e.renderContextType){var i=this.checkForActiveEditorFocus(void 0,e.renderContextType,t);return i&&xe(e,i.component)?(this.draftToFocus=Object(r.__assign)(Object(r.__assign)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),i):void 0}}},e.prototype.checkForActiveEditorFocus=function(e,t,n){if(!this.isDraftInOtherContext()){var r=Object(pe.H)(n);if(r)return De(e,{componentType:Ae.a.PostEditor,id:r,renderContextType:t});var a=Object(pe.G)(n);return a?De(e,{componentType:Ae.a.CardEditor,id:a,renderContextType:t}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){if(e.altKey){var n=ve.o(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:m.b.CommentThread}:void 0;return Ee(e,le.t({renderContextType:t.renderContextType,trackback:s.e.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))}},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(N.Cb()||!this.isDraftInOtherContext())return t&&t.selectedCardId?De(void 0,{componentType:Object(Pe.b)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{shouldRetryOnMount:N.vb()}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,a){if("web"!==Object(Se.a)()&&r&&a){var o=r.selectionDetails,i=a.selectionDetails;if(Object(Ce.j)(t)&&!Object(Ce.c)(n))return this.focusCommentCardCommand.processCommand(e,a.selectedCardId);if(Object(be.c)(o)===Object(be.c)(i)&&r.selectedCardId===a.selectedCardId&&Object(Ce.m)(t,n)){if(Object(be.c)(o)||Object(be.c)(i))return De(void 0,{componentType:Ae.a.CardEditor,id:a.selectedCardId,renderContextType:e.renderContextType},{shouldRetryOnMount:!0});if(o.selectedPostId===i.selectedPostId)return De(void 0,{componentType:Ae.a.PostEditor,id:i.selectedPostId,renderContextType:e.renderContextType},{shouldRetryOnMount:!0})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(Se.a)()){var n=this.commentStore.getState(),r=Object(pe.L)(ve.k(n),ve.t(n));if(!Object(fe.a)({commentData:ve.d(n),pendingCommentLoad:ve.l(n),virtualized:r}))return(c=De(e,{componentType:Ae.a.ClosePaneButton})).stopPropagation=!0,c.preventDefault=!0,c;var a=t.getComponent(Ae.a.ClosePaneButton),o=t.getComponent(Ae.a.NewCommentButton),i=!N.p()&&Object(Ce.c)(ve.h(n))||!o?a:o;if(N.m()){var s=ve.o(n),c=void 0;return s?N.Cb()||t.isFocusWithin({componentType:Object(Pe.b)(s.selectedCardId,ve.g(this.commentStore.getState())),id:s.selectedCardId,renderContextType:t.renderContextType})||(c=this.checkForActiveEditorFocus(e,t.renderContextType,ve.h(n))):i&&e.isEventTarget(i)&&!e.shiftKey&&(c=this.onTabKeyInPane(e,t.renderContextType)),c&&(c.stopPropagation=!0,c.preventDefault=!0),c}if(a&&e.isEventTarget(a)&&e.shiftKey)return(c=this.onTabKeyInPane(e,t.renderContextType))&&(c.preventDefault=!0,c.stopPropagation=!0),c;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(c=this.onTabKeyInPane(e,t.renderContextType))&&(c.preventDefault=!0,c.stopPropagation=!0),c}},e.prototype.checkForNewDraft_deprecated=function(e,t,n){if(!this.isDraftInOtherContext()){var a=Object(pe.I)(n);if(a&&a.renderContextType===e){var i=t.drafts[a.commentDraft.sessionConfiguration.draftId];if(!i||i.renderContextType!==e){if(Object(o.i)(a.commentDraft.sessionConfiguration))return De(void 0,{componentType:Ae.a.PostEditor,id:a.commentDraft.sessionConfiguration.commentId,renderContextType:e});var s=Object(o.k)(a.commentDraft.sessionConfiguration)?a.commentDraft.sessionConfiguration.threadId:a.commentDraft.sessionConfiguration.draftId;return Object(r.__assign)(Object(r.__assign)({},De(void 0,{componentType:Ae.a.CardEditor,id:s,renderContextType:e})),{shouldRetryOnMount:!0})}}}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(be.b)(n)!==Object(be.b)(r)||Object(be.c)(n.selectionDetails)!==Object(be.c)(r.selectionDetails))&&(N.Cb()||!Object(Ce.d)(t))&&!e.isFocusOn({componentType:Ae.a.NextCommentButton})&&!e.isFocusOn({componentType:Ae.a.PreviousCommentButton}))){if(Object(be.c)(r.selectionDetails)){if(N.tb()&&e.isFocusOnOrWithin({componentType:Ae.a.CardEditor,id:r.selectedCardId,renderContextType:e.renderContextType}))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!N.tb()||!e.isFocusOnOrWithin({componentType:Ae.a.PostEditor,id:r.selectionDetails.selectedPostId,renderContextType:e.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r){var a=Object(pe.G)(t),o=Object(pe.G)(n);if(r&&r.pending!==ge.a.Editor)return!a||o||N.W()&&!e.isFocusWithin({componentType:Ae.a.Card,id:a,renderContextType:e.renderContextType})?void 0:this.focusCommentCardCommand.processCommand(e,a)},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.renderContextType===Ie.a.HalfPane&&Object(o.j)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===o.e.Normal&&(!Object(o.j)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===o.e.Variable))return De(void 0,{componentType:Ae.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==ge.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var a=this,o=Object.entries(n).find((function(e){var n=t[e[0]];return a.shouldFocusFromCardPendingStateChange(n,e[1])}));if(o)return De(void 0,{renderContextType:e.renderContextType,componentType:Object(Pe.b)(o[0],r),id:o[0]})},e.prototype.shouldFocusDraftEditorForReturnToDraft_deprecated=function(e,t,n){var r;return!(N.jb()&&(!t||t.renderContextType!==Ie.a.None&&t.renderContextType!==n))&&(N.n()?Object(pe.e)(e,t)&&(null===(r=null==t?void 0:t.draftWarningState)||void 0===r?void 0:r.type)!==he.a.CommitFailed:Object(pe.e)(e,t))},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.focusToRetry.command.shouldRetryOnPropsUpdate&&xe(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.focusToRetry.command.shouldRetryOnPropsUpdate&&(!Object(Ae.c)(this.focusToRetry.command.component)||!Object(Ae.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===Te.a.InCard||t.cardRelativeDraftingState===Te.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkIfCardEditorShouldFocusForReturnToDraft_deprecated=function(e,t,n){var a=this,o=Object.keys(n.cardIdToDraftIdMap).filter((function(r){var o=n.cardIdToDraftIdMap[r];return a.shouldFocusDraftEditorForReturnToDraft_deprecated(t.drafts[o],n.drafts[o],e.renderContextType)}));if(o.length>0)return Object(r.__assign)(Object(r.__assign)({},De(void 0,{renderContextType:e.renderContextType,componentType:Ae.a.CardEditor,id:o[0]})),{shouldRetryOnMount:!0})},e.prototype.checkIfPostEditorShouldFocusForReturnToDraft_deprecated=function(e,t,n){var a=this,o=Object.keys(n.postIdToDraftIdMap).filter((function(r){var o=n.postIdToDraftIdMap[r];return a.shouldFocusDraftEditorForReturnToDraft_deprecated(t.drafts[o],n.drafts[o],e.renderContextType)}));if(o.length>0)return Object(r.__assign)(Object(r.__assign)({},De(void 0,{renderContextType:e.renderContextType,componentType:Ae.a.PostEditor,id:o[0]})),{shouldRetryOnMount:!0})},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(N.m()?Object(be.i)(n):Object(be.h)(n))){var r=t?Object(be.b)(t):void 0,a=Object(be.b)(n);if(a!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return De(void 0,{componentType:Ae.a.Post,renderContextType:e.renderContextType,id:a})}},e}(),nt=n(132),rt=n(492),at=function(){return function(e){return function(t){return Object(O.unstable_batchedUpdates)((function(){return e(t)}))}}},ot=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=Object(s.l)(s.c.Redux,n),a=e(t);return null==r||r.end(),a}}},it=n(312),st=n(133),ct=n(110),dt=n(358),ut=n(124),lt=n(189),mt=n(287);function ft(e){switch(e){case w.b.HalfPane:return Ie.a.HalfPane;case w.b.FullPane:default:return Ie.a.FullPane}}!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern"}($e||($e={}));var pt=n(89);var gt,Ct=n(550),ht={parentId:"",commentId:"",author:{UserId:"",Provider:"",DisplayName:"",Email:void 0,IsCurrentUser:void 0},anchorHintText:"",commentFlags:0,commentBody:(gt=new Ct.a,gt.insert(""),gt.toJSON())};function bt(e,t){for(var n=null==t?void 0:t(),r=[],a=0,o=void 0;a<e.length;){if(e[a].type===pt.a.Thread){var i=e[a].id;o=i,r.push(vt(i,void 0,n))}else r.push(vt(e[a].id,o,n));a++}return r}function vt(e,t,n){var a=void 0;n&&(a=n.commentData.find((function(t){return t.commentId===e})));return a||Object(r.__assign)(Object(r.__assign)({},ht),{commentId:e,parentId:t||""})}function yt(e,t,n,r){if(Object(Ce.e)(t)<Object(Ce.e)(e)){var a=Object(u.g)().createActivityObject("SilentDiscardOnMerge",Object(u.h)(u.f.GlobalAPI),u.a.None,u.b.NecessaryServiceDataEvent);a.addDataField("DiscardReason",n,u.c.SystemMetadata),a.addDataField("MergeSource",r,u.c.SystemMetadata),a.successTag(592007882)}}function Tt(e,t,n){if(Object(Ce.e)(t)<Object(Ce.e)(e)){var r=Object(u.g)().createActivityObject("SilentDiscardOnViewChange",Object(u.h)(u.f.GlobalAPI),u.a.None,u.b.NecessaryServiceDataEvent);r.addDataField("ViewChangeSource",n,u.c.SystemMetadata),r.successTag(591661013)}}function Ot(e,t,n){if(N.K()){var r=Object(u.g)().createActivityObject("MarkCommentCreation",n,u.a.None,u.b.NecessaryServiceDataEvent);r.addDataField("DraftId",e,u.c.SystemMetadata),r.addDataField("CommentId",t,u.c.SystemMetadata),r.addDocumentMetadata(u.e.Basic),r.successTag(591152859)}}function It(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var St=n(130),_t=n(252),Et=n(597),jt=n(316),Dt=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function Pt(e){return wt(Object(Ae.c)(e)?Object(Pe.a)(e):Object(Pe.c)(e.componentType))}function At(e){var t=document.activeElement;return!!e&&t===e}function xt(e,t){var n=document.activeElement,r=!N.tb()||t!==Ae.a.CardEditor&&t!==Ae.a.PostEditor;return!!e&&(n&&e.contains(n)||r&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(n))}function wt(e){var t=document.getElementById(e);return null!=t?t:void 0}var kt=function(){function e(e,t,n){this.renderContextType=e,this.contextIdentifier=t}return e.prototype.getComponent=function(e){return wt(Object(Pe.c)(e))},e.prototype.getComponentById=function(e){return wt(Object(Pe.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return At(Pt(e))},e.prototype.isFocusWithin=function(e){return xt(Pt(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e){var t=Pt(e);return At(t)||xt(t,e.componentType)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case Ae.a.Card:t=Dt(document.querySelectorAll("[id*='"+I.h({id:"",renderContextType:this.renderContextType},!1)+"']"));break;case Ae.a.DraftCard:t=Dt(document.querySelectorAll("[id*='"+I.h({id:"",renderContextType:this.renderContextType},!0)+"']"));break;case Ae.a.PostEditor:t=Dt(document.querySelectorAll("[id*='"+I.u(I.F({id:"",renderContextType:this.renderContextType}))+"']"));break;case Ae.a.CardEditor:t=Dt(document.querySelectorAll("[id*='"+I.u(I.e({id:"",renderContextType:this.renderContextType}))+"']"));break;case Ae.a.Post:t=Dt(document.querySelectorAll("[id*='"+I.I({id:"",renderContextType:this.renderContextType})+"']"))}if(t)for(var n=0;n<t.length;++n){if(xt(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return xt(document.getElementById(I.x()),Ae.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Rt(e,t){switch(void 0===e&&(e={extensions:{}}),void 0===t&&(t=le.a),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(u.g)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var a=t.payload.extension;return Object(r.__assign)(Object(r.__assign)({},e),{extensions:Object(r.__assign)(Object(r.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:a,priority:a.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,a,o=Object(r.__assign)({},e.extensions);try{for(var i=Object(r.__values)(t.payload.renderModes),s=i.next();!s.done;s=i.next()){var c=s.value;delete o[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{extensions:o})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(r.__assign)({},e.extensions);for(var a in t.payload.updates)n[a]&&(n[a]=Object(r.__assign)(Object(r.__assign)({},n[a]),{priority:t.payload.updates[a]}));return Object(r.__assign)(Object(r.__assign)({},e),{extensions:n})}(e,t);default:return e}}var Nt=n(247);function Ft(e,t){if(void 0===e&&(e={tasks:{}}),void 0===t&&(t=le.a),!N.b())return e;switch(t.type){case"LOAD_COMMENT":return function(e,t){var n,a;if(!t.payload.tasks)return e;var o={};try{for(var i=Object(r.__values)(t.payload.tasks),s=i.next();!s.done;s=i.next()){var c=s.value;o[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{tasks:N.fb()?Object(r.__assign)(Object(r.__assign)({},e.tasks),o):o})}(e,t);case"RELOAD_COMMENTS":return function(e,t){var n,a;if(!t.payload.tasks)return e;var o={};try{for(var i=Object(r.__values)(t.payload.tasks),s=i.next();!s.done;s=i.next()){var c=s.value;o[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{tasks:o})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{tasks:{}})}(e);case"APPLY_COMMENT_CHANGES":return function(e,t){var n=Object(r.__assign)({},e.tasks);return t.payload.changes.forEach((function(e){if(e.type!==st.c.Unknown){var t=e.model.commentId;switch(e.type){case st.c.Delete:delete n[t];break;case st.c.Load:case st.c.Insert:case st.c.Modify:Object(u.g)().assertConditionTag(e.type===st.c.Modify||!n[e.model.commentId],"Task should not already be populated on initial load",593875215);var r=e.task;if(r){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===Nt.a.Create}(r))return void Object(u.g)().assertConditionTag(!1,"Invalid task payload - dropping task data",593875213);n[t]=r}else""===e.model.parentId&&n[t]&&delete n[t]}}else Object(u.g)().assertConditionTag(!1,"Unknown change type",593875214)})),Object(r.__assign)(Object(r.__assign)({},e),{tasks:n})}(e,t);default:return e}}function Mt(e){return{commentData:[],cardViewState:{},postViewState:{},selectedComment:void 0,pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:qe.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,virtualized:!1,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(Ce.h)(),atMentionState_deprecated:{capability:Et.a.Unknown},capabilities_deprecated:{resolve:!0},modelCapabilities:Object(pe.n)(),localizationDetails:e,suggestionsDetails:void 0}}function Lt(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new kt(ft(e.containerType),r),visibilityState:t?C.a.Visible:C.a.Closed,initializationStatus:jt.a.NotInitialized,focusTypeAfterContextChange_deprecated:void 0,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{}},taskState:{tasks:{}},commentState:Mt(n)}}(e,t,n,r)}var Vt={isRightToLeft:!1,dataCulture:"",uiCulture:""};function Ut(e,t){switch(void 0===e&&(e=Mt(Vt)),void 0===t&&(t=it.a),t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=pe.S(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return function(e,t){var n,a,o;if(!t.payload.changes.length)return e;var i={commentData:Object(r.__spread)(e.commentData),cardViewState:Object(r.__assign)({},e.cardViewState),postViewState:Object(r.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},c=e.createdCommentLie,d=pe.O(c,e.draftState),l=null==c?void 0:c.index;try{for(var m=Object(r.__values)(t.payload.changes),f=m.next();!f.done;f=m.next()){var p=f.value;if(p.type===ct.b.Load&&(p=void 0!==i.postViewState[p.model.commentId]?Object(r.__assign)(Object(r.__assign)({},p),{type:ct.b.Modify}):Object(r.__assign)(Object(r.__assign)({},p),{type:ct.b.Insert})),p.type===ct.b.Insert){if((C=p.model.parentId)&&(i.cardViewState[C]=Object(r.__assign)(Object(r.__assign)({},i.cardViewState[C]),{pending:ge.a.None})),i.commentData.splice(p.index,0,p.model),p.tempId){if(!C)(g={})[p.model.commentId]=pe.h(p.tempId),i.cardViewState=Object(r.__assign)(Object(r.__assign)({},pe.V(i.cardViewState,[p.tempId])),g);i.postViewState=Object(r.__assign)(Object(r.__assign)({},pe.W(i.postViewState,[p.tempId])),pe.t([p.model])),c&&c.newComment.commentId===p.tempId&&(l=void 0),i.selectedComment&&i.selectedComment.selectedCardId===p.tempId&&(i.selectedComment=pe.B(p.model))}else{var g;Object(u.g)().assertConditionTag(!i.postViewState[p.model.commentId],"Received insert for existing comment "+p.model.commentId,594122589),(g={})[p.model.commentId]=pe.h(void 0),i.cardViewState=Object(r.__assign)(Object(r.__assign)({},i.cardViewState),g),i.postViewState=Object(r.__assign)(Object(r.__assign)({},i.postViewState),pe.t([p.model]))}d&&void 0!==l&&p.index<=l&&l++}else if(p.type===ct.b.Modify){if((v=i.commentData[p.index]).commentId===p.model.commentId){i.commentData[p.index]=p.model;var C=Object(ze.b)(p.model);i.cardViewState[C]=Object(r.__assign)(Object(r.__assign)({},i.cardViewState[C]),{pending:ge.a.None,loadState:{state:St.a.Loaded}});var h=v.displayDate===p.model.displayDate&&v.date===p.model.date?i.postViewState[p.model.commentId].displayDate:pe.j(p.model.date,p.model.displayDate,e.localizationDetails.dataCulture);if(i.postViewState=Object(r.__assign)(Object(r.__assign)({},i.postViewState),((o={})[p.model.commentId]=Object(r.__assign)(Object(r.__assign)({},i.postViewState[p.model.commentId]),{pending:_t.a.None,displayDate:h}),o)),p.model.commentFlags&Qe.a.Resolved){var b=i.draftState;i.selectedComment&&i.selectedComment.selectedCardId===p.model.commentId&&(i.selectedComment=pe.A(i.selectedComment)),i.draftState=pe.U(i.draftState,p.model.commentId,i.commentData),yt(b,i.draftState,1,2)}}else Object(u.g)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(s.j)("changeIndex did not match comment for "+p.model.commentId)}else if(p.type===ct.b.Delete){var v;b=i.draftState;if(i.selectedComment=pe.v(i.selectedComment,i.commentData,p.index,p.index+1),(v=i.commentData[p.index]).commentId===p.model.commentId&&i.commentData.splice(p.index,1),i.highlightedCommentId===p.model.commentId&&(i.highlightedCommentId=void 0),i.topVisibleThreadId===p.model.commentId&&(i.topVisibleThreadId=void 0),i.draftState=pe.X(i.draftState,p.model.commentId),i.draftState=pe.Z(i.draftState,p.model.commentId),yt(b,i.draftState,""===v.parentId?3:2,2),i.cardViewState=Object(r.__assign)({},pe.V(i.cardViewState,[p.model.commentId])),i.postViewState=Object(r.__assign)({},pe.W(i.postViewState,[p.model.commentId])),p.model.commentId===i.selectedThreadIdBeforeCommentSession){var y=p.index;i.commentData.length?(y>=i.commentData.length&&(y=i.commentData.length-1),i.selectedThreadIdBeforeCommentSession=Object(ze.b)(i.commentData[y])):i.selectedThreadIdBeforeCommentSession=void 0}d&&void 0!==l&&p.index<l&&l--}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}d&&(void 0===l?c=void 0:c&&l!==c.index&&(c=Object(r.__assign)(Object(r.__assign)({},c),{index:l})));return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:c,draftState:i.draftState,selectedComment:i.selectedComment,commentData:i.commentData,cardViewState:i.cardViewState,postViewState:i.postViewState,highlightedCommentId:i.highlightedCommentId,topVisibleThreadId:i.topVisibleThreadId,selectedThreadIdBeforeCommentSession:i.selectedThreadIdBeforeCommentSession})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,a=Object(r.__spread)(e.commentData,t.payload.commentData),o=pe.L(e.modelCapabilities,e.virtualized),i=pe.T(e,a,o),s=i.pendingCommentLoad,c=i.selectedComment;return n=pe.i(t.payload.commentData,o?St.a.Placeholder:St.a.Loaded),Object(r.__assign)(Object(r.__assign)({},e),{commentData:a,pendingCommentLoad:s,selectedComment:c,localizationDetails:e.localizationDetails,cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),n),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),pe.t(t.payload.commentData))})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){var n=(o=t.payload.threadInfo.map((function(e){return e.threadId})),o.map((function(e){return vt(e,void 0,void 0)}))),a=Object(r.__spread)(e.commentData,n);var o;if(!pe.L(e.modelCapabilities,e.virtualized))throw new R.a("virtualizeCommentsReducer requires virtualization",s.e.reserveTag(589103643),-2130957500);var i=pe.T(e,a,!0),c=i.pendingCommentLoad,d=i.selectedComment;return Object(r.__assign)(Object(r.__assign)({},e),{commentData:a,pendingCommentLoad:c,selectedComment:d,cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),pe.K(t.payload.threadInfo)),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),pe.t(n)),localizationDetails:e.localizationDetails})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){if(!e.createdCommentLie)return e;var n,a=e.createdCommentLie.draftId,o=pe.V(e.cardViewState,[a]),i=pe.W(e.postViewState,[a]);e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0}});return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:void 0,selectedComment:n,cardViewState:o,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:pe.X(e.draftState,e.createdCommentLie.draftId)})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=pe.w(e,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,selectedThreadIdBeforeCommentSession:void 0,draftState:pe.Z(e.draftState,t.payload.commentId)})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=pe.X(e.draftState,t.payload.commentId),a=pe.y(e.selectedComment,n,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:a,selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"SELECT_COMMENT":return function(e,t){var n,a=!1,o=e.draftState,i=e.selectedComment;if(!pe.ab(o,i,t))return e;if(!t.payload.selectedCard)throw new R.a(J.d,s.e.reserveTag(589103644),-2130957536);var c=void 0,d=pe.db(e.selectedComment,o,t);if(d){e.commentData.filter((function(e){return Object(ze.b)(e)===d.selectedCardId})).forEach((function(t){e.postViewState[t.commentId].displayDate||(c||(c=Object(r.__assign)({},e.postViewState)),c[t.commentId]=pe.s(e.postViewState[t.commentId].displayDate||pe.j(t.date,t.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.commentId].displayingErrorUI),a=!0)}));var u=pe.I(o);if(u&&!u.forceCardExpanded&&u.threadId===d.selectedCardId&&(!Object(be.c)(d.selectionDetails)||d.selectionDetails.expanded)){var l=u.commentDraft.sessionConfiguration.draftId;o=Object(r.__assign)(Object(r.__assign)({},o),{drafts:(n={},n[l]=Object(r.__assign)(Object(r.__assign)({},o.drafts[l]),{forceCardExpanded:!0}),n)})}}return Object(r.__assign)(Object(r.__assign)({},e),{draftState:o,selectedComment:d,postViewState:a&&c?c:e.postViewState})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:ge.a.Card,loadState:{state:St.a.Loaded}}),n)),selectedComment:pe.z(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return function(e,t){var n,a,o={},i={},s=e.selectedComment,c=s&&!Object(be.c)(s.selectionDetails),d=!1,l=!1,m=!1,f=e.selectedThreadIdBeforeCommentSession,p=e.draftState,g=pe.L(e.modelCapabilities,e.virtualized),C=null===(n=pe.I(p))||void 0===n?void 0:n.threadId,h={};e.commentData.forEach((function(e){h[e.commentId]=e}));var b=!1,v=!1;if(t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(b=!0),n.commentId===e.topVisibleThreadId&&(v=!0),n.commentId in h){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(u.g)().assertConditionTag(e.cardViewState[n.commentId].pending!==ge.a.Delete,"Card pending delete remained after a reload.",593762527);var a=e.cardViewState[n.commentId];if(!a||a.pending!==ge.a.None||g){var c=null==a?void 0:a.loadState;i[n.commentId]=Object(r.__assign)(Object(r.__assign)({},a),{pending:ge.a.None,loadState:c&&c.state===St.a.Placeholder?{state:St.a.Placeholder,initialItemCount:c.initialItemCount}:{state:St.a.NeedsReload}})}else i[n.commentId]=a}if(e.postViewState[n.commentId]&&Object(u.g)().assertConditionTag(e.postViewState[n.commentId].pending!==_t.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]&&e.postViewState[n.commentId].pending===_t.a.None?o[n.commentId]=e.postViewState[n.commentId]:o[n.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[n.commentId]),{pending:_t.a.None}),s&&(s.selectedCardId===n.commentId&&(l=!0,n.commentFlags&Qe.a.Resolved&&(s=pe.A(s))),s.selectedCardId!==Object(ze.b)(n)||Object(be.c)(s.selectionDetails)||s.selectionDetails.selectedPostId!==n.commentId||(d=!0)),n.commentId===C&&n.commentFlags&Qe.a.Resolved)yt(p,p=pe.U(p,n.commentId,t.payload.comments),1,1);f&&f===n.commentId&&(m=!0)}else{if(""===n.parentId){var y=n.commentId,T=g?{state:St.a.Placeholder,initialItemCount:1}:{state:St.a.Loaded};i[n.commentId]=pe.p(y,T)}o[n.commentId]=pe.s(n.displayDate,!1)}})),a=pe.a(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState,!0)){var y=a.newComment.commentId;s&&a.newComment.commentId===s.selectedCardId&&(l=!0),i[y]=e.cardViewState[y],o[y]=e.postViewState[y]}l?c&&!d&&s&&!g&&(s={selectedCardId:s.selectedCardId,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0}}):s=void 0;var T=pe.G(p),O=pe.R(p);if(T&&!i[T]&&T!==(null==a?void 0:a.draftId)&&O){var I=p;p=pe.X(p,T),yt(I,p,3,1)}var S=pe.H(p);if(S&&!o[S]&&O){I=p;p=pe.Z(p,S),yt(I,p,2,1)}if(!m&&f){var _=e.commentData.findIndex((function(e){return e.commentId===f}));if(_<0&&(Object(u.g)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),_=0),t.payload.comments.length){_>=t.payload.comments.length&&(_=t.payload.comments.length-1);var E=t.payload.comments[_];f=Object(ze.b)(E)}else f=void 0}return Object(r.__assign)(Object(r.__assign)({},e),{draftState:p,commentData:Object(r.__spread)(t.payload.comments),cardViewState:i,postViewState:o,selectedComment:s,pendingCommentLoad:void 0,highlightedCommentId:b?e.highlightedCommentId:void 0,topVisibleThreadId:v?e.topVisibleThreadId:void 0,createdCommentLie:a,selectedThreadIdBeforeCommentSession:f})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:ge.a.Card}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{pending:_t.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:ge.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(r.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){var t=n[e].loadState;n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{loadState:t.state===St.a.Placeholder?{state:St.a.Loading,initialItemCount:t.initialItemCount}:{state:St.a.Loading}})})),Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,a,o,i,c;if(pe.F(e.draftState))throw new R.a("Draft already active!",s.e.reserveTag(589103640),-2130957551);var d=e.selectedThreadIdBeforeCommentSession;if(!Object(lt.a)(t.payload.draftDetails))throw new R.a("Invalid comment draft!",s.e.reserveTag(589103641),-2130957545);var l=t.payload.draftDetails;switch(l.sessionConfiguration.sessionType){case"CREATE":var m={parentId:"",commentId:l.sessionConfiguration.draftId,author:l.author,anchorHintText:l.anchorHintText};return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:{index:l.insertIndex,newComment:m,draftId:l.sessionConfiguration.draftId},cardViewState:Object(r.__assign)(Object(r.__assign)({},pe.V(e.cardViewState,[Object(I.w)()])),pe.k(m)),postViewState:Object(r.__assign)(Object(r.__assign)({},pe.W(e.postViewState,[Object(I.w)()])),pe.l(m)),selectedComment:pe.C(e.commentData,l),selectedThreadIdBeforeCommentSession:d,draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[l.sessionConfiguration.draftId]={commentDraft:l,forceCardExpanded:!0,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:Ce.a.None,renderContextType:t.payload.draftRenderContextType,threadId:l.sessionConfiguration.draftId},n)),cardIdToDraftIdMap:Object(r.__assign)(Object(r.__assign)({},e.draftState.cardIdToDraftIdMap),(a={},a[l.sessionConfiguration.draftId]=l.sessionConfiguration.draftId,a)),pendingDraft:void 0})});case"EDIT":case"REPLY":if(!Object(mt.b)(l.sessionConfiguration)&&!Object(mt.c)(l.sessionConfiguration))throw Object(u.g)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new R.a(J.c,s.e.reserveTag(589103642),-2130957532);var f=void 0;f=!e.selectedComment||Object(mt.c)(l.sessionConfiguration)&&l.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||ut.e(l.sessionConfiguration)&&!Object(be.c)(e.selectedComment.selectionDetails)&&l.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId?pe.C(e.commentData,l):Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})});var p,g=e.draftState.cardIdToDraftIdMap,C=e.draftState.postIdToDraftIdMap,h="",b=void 0;if(ut.f(l.sessionConfiguration))g=Object(r.__assign)(Object(r.__assign)({},g),((o={})[l.sessionConfiguration.threadId]=l.sessionConfiguration.draftId,o)),h=l.sessionConfiguration.threadId,b=(!Object(be.c)(f.selectionDetails)||f.selectionDetails.expanded)&&f.selectedCardId===l.sessionConfiguration.threadId,p=!0;else if(ut.e(l.sessionConfiguration)){var v=l.sessionConfiguration.commentId;C=Object(r.__assign)(Object(r.__assign)({},C),((i={})[v]=l.sessionConfiguration.draftId,i)),b=!0,p=!1,e.commentData.some((function(e){if(e.commentId===v){var t=Object(Ct.d)(e.commentBody);return p=0===t.length||"web"===Object(Se.a)()&&"\n"===t,h=Object(ze.b)(e),!0}return!1}))}else Object(s.n)(l.sessionConfiguration);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:Object(r.__assign)(Object(r.__assign)({},f),{selectionDetails:Object(r.__assign)({},f.selectionDetails)}),selectedThreadIdBeforeCommentSession:d,draftState:{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(c={},c[l.sessionConfiguration.draftId]={commentDraft:l,forceCardExpanded:b,isDraftEmpty:p,isInCurrentContext:!0,pendingState:Ce.a.None,renderContextType:t.payload.draftRenderContextType,threadId:h},c)),cardIdToDraftIdMap:g,postIdToDraftIdMap:C,pendingDraft:void 0},cardViewState:pe.V(e.cardViewState,[Object(I.w)()]),postViewState:pe.W(e.postViewState,[Object(I.w)()]),createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(u.g)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded:!1,lowFidelityWarningType:void 0}});return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:void 0})})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n,a=void 0,o=e.cardViewState,i=e.postViewState;if(e.createdCommentLie)return Object(u.g)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(ut.f(t.payload.params))n=t.payload.params.threadId;else if(ut.e(t.payload.params)){var s=t.payload.params.commentId,c=e.commentData.find((function(e){return e.commentId===s}));if(!c)return Object(u.g)().assertConditionTag(!1,"Could not lock selection on missing comment "+s,593764357),e;n=Object(ze.b)(c)}else{var d={commentId:n=Object(I.w)()};a={index:-1,newComment:d,draftId:n},o[n]&&Object(u.g)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),o=Object(r.__assign)(Object(r.__assign)({},o),pe.k(d)),i[n]&&Object(u.g)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),i=Object(r.__assign)(Object(r.__assign)({},i),pe.l(d))}var l=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(l=e.selectedComment.selectedCardId);var m=Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:t.payload.params});return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:i,cardViewState:o,selectedThreadIdBeforeCommentSession:l,selectedComment:pe.E(e.selectedComment,m,t,n),draftState:m,createdCommentLie:a})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,a=Object(Ce.h)(),o={},i={},s=void 0,c=void 0;n=t.payload.contextDetails?Object(r.__assign)(Object(r.__assign)({},It(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:qe.a.Unknown,isReadOnly:N.P()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var d=t.payload.contextDrafts;if(d){var l=pe.Y(e.draftState);if(Object(Ce.e)(l)>0){var m={},f=void 0,p=void 0,g=!N.Cb();if(Object(Ce.f)(l).forEach((function(t){var n,a=d.find((function(e){return e.draftId===t}));m[t]=Object(r.__assign)(Object(r.__assign)({},l.drafts[t]),{isInCurrentContext:!!a}),a&&e.createdCommentLie&&e.createdCommentLie.draftId===t&&(f=a.insertIndex,p=a.anchorHintText),!g&&a&&m[t].threadId===(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)&&(g=!0)})),a=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:m}),g&&(s=e.selectedComment),e.createdCommentLie&&(c=e.createdCommentLie,pe.O(c,a))){Object(u.g)().assertConditionTag(void 0!==f,"Index unknown for lie in latest context",587309136);var C=null!=f?f:0;C!==c.index&&(c=Object(r.__assign)(Object(r.__assign)({},c),{index:C})),void 0!==p&&p!==c.newComment.anchorHintText&&(c=Object(r.__assign)(Object(r.__assign)({},c),{newComment:Object(r.__assign)(Object(r.__assign)({},c.newComment),{anchorHintText:p})}));var h=c.draftId;o=pe.q(h),i=pe.r(h),c.index>-1&&(o[h].pending=ge.a.None,i[h].pending=_t.a.None)}}}return Tt(e.draftState,a,2),Object(r.__assign)(Object(r.__assign)({},e),{virtualized:!!t.payload.virtualized,commentData:[],cardViewState:o,postViewState:i,selectedComment:s,pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},contextState:n,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?pe.S(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:c,selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,a=t.payload,o=a.commentId,i=a.lowFidelityWarningType,s=e.commentData.find((function(e){return e.commentId===o}));if(!s)return Object(u.g)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(Ce.d)(e.draftState))return Object(u.g)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;n=i===be.a.DeleteThread?{selectedCardId:o,selectionDetails:{lowFidelityWarningType:i,expanded:pe.M(o,e.selectedComment,e.draftState)}}:{selectedCardId:Object(ze.b)(s),selectionDetails:{selectedPostId:o,lowFidelityWarningType:i}};return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:Object(r.__assign)(Object(r.__assign)({},n),{selectionDetails:{expanded:pe.M(n.selectedCardId,n,e.draftState),lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!pe.ab(e.draftState,e.selectedComment,t))return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=Object(r.__assign)({},e.contextState);void 0!==t.payload.contextState.commentThreadCounts&&(n.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n.isReadOnly=t.payload.contextState.isReadOnly);return Object(r.__assign)(Object(r.__assign)({},e),{contextState:n})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(Ce.b)(e.draftState))return Object(u.g)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var a=e.draftState,o=pe.I(e.draftState);o&&(a=Object(r.__assign)(Object(r.__assign)({},a),{drafts:Object(r.__assign)(Object(r.__assign)({},a.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:Ce.a.Commit}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:a})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(Ce.i)(e.draftState))return Object(u.g)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var a=e.draftState,o=pe.I(e.draftState);o&&(a=Object(r.__assign)(Object(r.__assign)({},a),{drafts:Object(r.__assign)(Object(r.__assign)({},a.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:Ce.a.None}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:a})}(e);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(Ce.b)(e.draftState)&&!Object(be.h)(e.selectedComment))return Object(u.g)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,a=pe.I(e.draftState);a&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:Ce.a.Discard}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(Ce.j)(e.draftState))return Object(u.g)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,a=pe.I(e.draftState);a&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:Ce.a.None}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(r.__assign)(Object(r.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(r.__assign)(Object(r.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=pe.F(e.draftState);if(void 0===n)return Object(u.g)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;var n=t.temporaryCommentId;if(!n)throw Object(u.g)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new R.a(J.c,s.e.reserveTag(589103637),-2130957545);var a={parentId:"",commentId:n,commentBody:t.commentBody,author:e.createdCommentLie.newComment.author},o=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),pe.q(n)),i=Object(r.__assign)(Object(r.__assign)({},e.postViewState),pe.r(n));return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:e.selectedComment&&{selectedCardId:n,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0}},createdCommentLie:Object(r.__assign)(Object(r.__assign)({},e.createdCommentLie),{newComment:a}),cardViewState:o,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:pe.X(e.draftState,e.createdCommentLie.draftId)})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new R.a(J.d,s.e.reserveTag(589103638),-2130957536);var a=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.parentId]),{pending:ge.a.Editor,loadState:{state:St.a.Loaded}}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:a,selectedComment:pe.x(e,t),selectedThreadIdBeforeCommentSession:void 0,draftState:pe.X(e.draftState,t.parentId)})}(e,t.payload.data);case"EDIT":return function(e,t){var n,a=pe.w(e,t.commentId),o=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.commentId]),{pending:_t.a.Post});return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),(n={},n[t.commentId]=o,n)),selectedComment:a,selectedThreadIdBeforeCommentSession:void 0,draftState:pe.Z(e.draftState,t.commentId)})}(e,t.payload.data);default:throw new R.a("Unexpected session type for commit",s.e.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{atMentionState_deprecated:{capability:t.payload.capability},modelCapabilities:Object(r.__assign)(Object(r.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,a=e.draftState.drafts;if(void 0===a[t.payload.draftId])return Object(u.g)().assertConditionTag(!Object(Ce.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=Object(r.__assign)(Object(r.__assign)({},a),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},a[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:o})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,a=e.draftState.drafts;if(void 0===a[t.payload.draftId])return Object(u.g)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=Object(r.__assign)(Object(r.__assign)({},a),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},a[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:o})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=pe.cb(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===Ie.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:Ie.a.None}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=pe.cb(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(_e.b)(r.renderContextType)?ft(t.payload.viewContainer.containerType):r.renderContextType}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,a,o=pe.F(e.draftState);if(void 0===o)return Object(u.g)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=o.sessionConfiguration.draftId,s=e.draftState.drafts;if(!s[i])return Object(u.g)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var c=s[i].draftWarningState,d=Object(r.__assign)(Object(r.__assign)({},s[i]),{draftWarningState:{warningCounter:c?c.warningCounter+1:0,type:t.payload.draftWarningType}}),l=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=d,n)),m=N.Cb()&&(Object(mt.b)(d.commentDraft.sessionConfiguration)||(null===(a=e.selectedComment)||void 0===a?void 0:a.selectedCardId)!==d.threadId)?pe.D(d):e.selectedComment;return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:l}),selectedComment:m})}(e,t);case"UPDATE_CAPABILITIES":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{capabilities_deprecated:t.payload.capabilities})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&$e.AtMentionKnown?t.payload.modelCapabilityFlags&$e.AtMentionEnabled?st.b.Enabled:st.b.Disabled:st.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&$e.NewThread),resolve:!!(t.payload.modelCapabilityFlags&$e.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&$e.Virtualized),tasks:t.payload.modelCapabilityFlags&$e.TasksKnown?t.payload.modelCapabilityFlags&$e.TasksEnabled?dt.a.Enabled:dt.a.Disabled:dt.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&$e.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&$e.UIAAnnotationPattern)};return Object(r.__assign)(Object(r.__assign)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,a=pe.F(e.draftState);if(void 0===a)return Object(u.g)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=a.sessionConfiguration;if(Object(mt.b)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return Object(u.g)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var s=i.currentMentionees,c={};for(var d in s)c[d]={mentionee:Object(r.__assign)({},s[d].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(d)};var l=i.selectedTaskAssignee;if(l){var m=Object(ne.e)(l);c[m]&&c[m].stillInDraft||(l=void 0)}var f=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:c,selectedTaskAssignee:l}),n))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:f})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,a=pe.F(e.draftState);if(void 0===a)return Object(u.g)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var o=a.sessionConfiguration;if(Object(mt.b)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return Object(u.g)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var s=i.currentMentionees,c=Object(ne.e)(t.payload.mentionee);if(s&&s[c])return e;var d={};for(var l in s)d[l]={mentionee:Object(r.__assign)({},s[l].mentionee),stillInDraft:s[l].stillInDraft};d[c]={mentionee:Object(r.__assign)({},t.payload.mentionee),stillInDraft:!0};var m=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:d}),n))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:m})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n,a=pe.F(e.draftState);if(void 0===a)return Object(u.g)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=a.sessionConfiguration;if(Object(mt.b)(o))return e;var i=o.draftId,s=e.draftState.drafts;if(!s[i])return Object(u.g)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=Object(r.__assign)(Object(r.__assign)({},s[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:c})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{draftState:pe.m(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),a=Object(r.__assign)({},e.postViewState);return a[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),a=Object(r.__assign)({},e.postViewState);return a[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:a})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){if(!e.createdCommentLie)return e;if(e.createdCommentLie.draftId!==t.payload.draftId)return Object(u.g)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var n=e.createdCommentLie;void 0!==t.payload.insertIndex&&t.payload.insertIndex!==n.index&&(n=Object(r.__assign)(Object(r.__assign)({},n),{index:t.payload.insertIndex}));void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==n.newComment.anchorHintText&&(n=Object(r.__assign)(Object(r.__assign)({},n),{newComment:Object(r.__assign)(Object(r.__assign)({},n.newComment),{anchorHintText:t.payload.anchorHintText})}));return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:n})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,a=e.selectedComment;if(t.payload.visibilityState!==C.a.Visible&&!N.p()&&(n=pe.Y(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var o=pe.G(e.draftState);o&&(a=pe.y(e.selectedComment,n,o))}return n=pe.cb(n,(function(n){var r=e.draftState.drafts[n];return pe.bb(r.renderContextType,t.payload.visibilityState)})),Tt(e.draftState,n,1),Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:a,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}function Ht(){Object(u.g)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function Bt(e,t){switch(void 0===e&&(e={viewContainer:{closeView:Ht,openView:Ht,containerType:w.b.FullPane,moveFocusToCanvas_donotuse:Ht},componentTree:new kt(Ie.a.FullPane,i.a),visibilityState:C.a.Closed,initializationStatus:jt.a.NotInitialized,focusTypeAfterContextChange_deprecated:void 0,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=le.a),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new kt(ft(t.payload.viewContainer.containerType),e.componentTree.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:t.payload.visibilityState!==C.a.Closed||N.G()?e.initializationStatus:jt.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:jt.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:jt.a.Initialized})}(e);case"UPDATE_FOCUS_TYPE_AFTER_CONTEXT_CHANGE":return function(e,t){if(N.rb())return e;return Object(r.__assign)(Object(r.__assign)({},e),{focusTypeAfterContextChange_deprecated:t.payload.focusTypeAfterContextChange_deprecated})}(e,t);default:return e}}var Gt=void 0;function Wt(e,t){void 0===t&&(t=it.a),Gt||(Gt=Object(nt.combineReducers)({paneState:Bt,contentExtensions:Rt,taskState:Ft,commentState:Ut}));var n=Gt(e,t);return n}var qt=n(123),zt=function(){return{threadIdRequests:new Map,sequenceId:0}};function Yt(e){return e&&(e.loadState.state===St.a.Placeholder||N.ib()&&e.loadState.state===St.a.NeedsReload)}var Kt=function(e,t,n){return void 0===n&&(n=20),Object(c.l)(function(e){return function(t,n){var a,o,i=ve.c(e.getState());try{for(var s=Object(r.__values)(n),c=s.next();!c.done;c=s.next()){var d=c.value;Yt(i[d])&&t.threadIdRequests.set(d,t.sequenceId++)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}return t}}(e),function(e,t,n){return function(a){for(var o=Array.from(a.threadIdRequests.entries()).sort((function(e,t){var n=Object(r.__read)(e,2),a=(n[0],n[1]),o=Object(r.__read)(t,2);o[0];return a-o[1]})),i=[],c=ve.c(e.getState()),d=o.pop();d&&i.length<n;d=o.pop()){var u=Object(r.__read)(d,1)[0];a.threadIdRequests.delete(u),Yt(c[u])&&i.push(u)}if(i.length&&e.dispatch(Object(le.p)({renderContextType:Ie.a.None,telemetryVisitor:t,trackback:s.e.reserveTag(594888212)},{threadIds:i})),a.threadIdRequests.size>0)return a}}(e,t,n),zt,500)};function Xt(e,t){var n=Object(pe.I)(e);return!(!n||N.Ab()&&t&&n.threadId===t.selectedCardId)}var Qt=n(346),Zt=n(717);function Jt(e,t,n){var r=e.getState(),a=Zt.a(r)[m.e.Isolated];return!!a&&(n(t),a.controller.triggerUpdate(),!0)}function $t(e,t,n,r){return"CREATE"===r&&Jt(e,t,n)}function en(e,t){return 0===ve.f(t).lastContextChangeIncrement||ve.l(t)?m.d.Disabled:ye.a(t)?e===m.e.Integrated?m.d.Disabled:m.d.Secondary:m.d.Primary}function tn(e,t){var n=Zt.a(e)[t];n&&(n.controller.priority=n.priority)}var nn=function(e){return function(t){return function(n){var r=e.getState().commentState.draftState.drafts;t(n);var a=e.getState().commentState.draftState.drafts;Object.keys(r).forEach((function(e){void 0===a[e]&&r[e].commentDraft.endDrafting()}))}}},rn=n(149),an=n(437),on=n(606);function sn(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",aggregationMode:u.a.OnSuccess,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"CLEAR_COMMENT_SELECTION":return{name:"ClearCommentSelectionAction",aggregationMode:u.a.OnSuccess,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"COMMIT_DRAFT":return{name:"CommitDraftAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",aggregationMode:u.a.OnSuccess,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent,logDocumentMetadata:u.e.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",aggregationMode:u.a.OnSuccess,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent,logDocumentMetadata:u.e.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent};default:return}}var cn=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===sn(t)){var n=Object(u.g)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);n.addDataField("OperationType",t.type,u.c.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,u.c.SystemMetadata),n.failTag(593278723,Object(rn.a)(e))}!function(e){if(Object(an.a)(e))throw e;if(!Object(R.b)(e))throw Object(u.g)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+Object(s.m)(e),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(u.g)().assertConditionTag(!1,"Comments Error (tag="+e.tag+"): "+e,e.tag)}}(e)}}}};var dn=n(545);function un(e){return void 0!==e&&0!=(e.commentFlags&o.c.Resolved)}function ln(e,t){var n;e.addDataField("IsNewResolvedCardDesign",(n=Object(Se.a)(),!(!N.S()||"web"!==n)||!(!N.m()||"win32"!==n)),u.c.SystemMetadata),e.addDataField("IsCommentResolved",t,u.c.SystemMetadata)}var mn;function fn(e){Object(N.lb)()&&e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(mn||(mn={}));var pn=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var a=t.performanceActivities[e];a&&(a.activity.failTag(n,void 0!==r?r:-2130957541),fn(a),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var a=t.performanceActivities[e];a&&(fn(a),a.activity.addDataField("Timeout",!0,u.c.SystemMetadata),n.failOnTimeout?a.activity.failTag(r,-2130957491):a.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,a){void 0===a&&(a={timeout:5e3,failOnTimeout:!0});var o=r||Object(u.g)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);if(o.addDataField("OperationType",n,u.c.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(u.g)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,s.e.reserveTag(595907678))),Object(N.lb)()){var i={activity:o,expectedChangeType:t};Object(N.kb)()?i.timerHandle=setTimeout(this.timeoutTracker,a.timeout,e,a,s.e.reserveTag(575484417)):i.timerHandle=setTimeout(this.failTracker,a.timeout,e,s.e.reserveTag(574433281),-2130957491),this.performanceActivities[e]=i}else this.performanceActivities[e]={activity:o,expectedChangeType:t}},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(u.g)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,s.e.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var a=n.performanceActivities[r];fn(a),a.activity.failTag(e,void 0!==t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(fn(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?mn.Yes:mn.No,u.c.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];fn(n),n.activity.addDataField("ExpectedChangeArrived",mn.Unknown,u.c.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),gn=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(be.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",u.c.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(u.g)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(be.b)(t);!this.activity||n===this.selectedCommentId&&Object(be.i)(t)||(this.activity.addDataField("OperationType",e.type,u.c.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function Cn(e,t){t?e.addDataField("AffectingTaskMetadata",!0,u.c.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,u.c.SystemMetadata)}function hn(e,t,n){var r=t.find((function(e){return e.commentId===n})),a=(null==r?void 0:r.parentId)||(null==r?void 0:r.commentId);t.some((function(e){return(e.commentId===a||e.parentId===a)&&0!=(e.commentFlags&st.d.IsNew)}))&&a&&e.addDataField("CommentIsNew",a,u.c.SystemMetadata)}var bn=function(e){var t=new pn(e),n=new gn(e),a=Object(c.k)((function(e){Object(u.g)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent).successTag(573687565)}));return function(e){return function(o){return function(i){var c,d,l,m=function(){var t,n,r,a,s,c,d=sn(i);if(!d)return Object(u.g)().assertConditionTag(!1,"Event name not defined for action type: "+i.type,595616738),o(i);var l=Object(u.g)().createActivityObject(d.name,i.actionDetail.telemetryVisitor,d.aggregationMode,d.diagnosticLevel);l.addDataField("Trackback",i.actionDetail.trackback,u.c.SystemMetadata),l.addDataField("RenderContextType",i.actionDetail.renderContextType,u.c.SystemMetadata),d.logDocumentMetadata&&l.addDocumentMetadata(d.logDocumentMetadata);var m=function(e,t){l.addDataField("CommentId",t,u.c.SystemMetadata);var n=Object(pe.f)(e,t);n.valid&&(l.addDataField("MatchesCommentAuthor",n.matchesCurrentUser,u.c.SystemMetadata),l.addDataField("ThreadCreationDeltaMs",n.timeElapsed,u.c.SystemMetadata)),hn(l,e,t)},f=e.getState(),p=Qt.b(e.getState());switch(i.type){case"COMMENT_CONTEXT_CHANGED":l.addDataField("NumberOfThreads",i.payload.numberOfThreads,u.c.SystemMetadata),i.payload.virtualized||l.addDataField("NumberOfComments",i.payload.numberOfComments,u.c.SystemMetadata);break;case"COMMIT_DRAFT":var g=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft"+Object(on.b)(e.payload)+"Action",aggregationMode:u.a.None,diagnosticLevel:u.b.NecessaryServiceDataEvent}}(i);if(!g)return Object(u.g)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),o(i);var C=Object(u.g)().createActivityObject(g.name,i.actionDetail.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);C.addDataField("RenderContextType",i.actionDetail.renderContextType,u.c.SystemMetadata),C.successTag(595903074);var h=ut.b[i.payload.sessionType];l.addDataField("SessionType",h,u.c.SystemMetadata),"REPLY"===i.payload.sessionType&&hn(l,ve.d(f),i.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":l.addDataField("DraftWarningType",i.payload.draftWarningType,u.c.SystemMetadata),l.addDataField("DraftWarningReason",i.payload.draftWarningReason,u.c.SystemMetadata);var b=Object(pe.I)(f.commentState.draftState);b&&(l.addDataField("IsDraftInCurrentContext",b.isInCurrentContext,u.c.SystemMetadata),l.addDataField("DraftId",b.commentDraft.sessionConfiguration.draftId,u.c.SystemMetadata));break;case"UPDATE_DRAFT_RENDER_CONTEXT":l.addDataField("IsClaimingDraftLock",i.payload.isClaimingLock,u.c.SystemMetadata),l.addDataField("IsUpdatingAllDraftLocks",!i.payload.draftId,u.c.SystemMetadata);break;case"SELECT_COMMENT":l.addDataField("SelectType",le.b[i.payload.selectType],u.c.SystemMetadata),l.addDataField("ActionSource",me.a[i.payload.source],u.c.SystemMetadata);var v=ve.o(f),y=!(!v||v.selectedCardId!==i.payload.selectedCard);l.addDataField("IsCurrentCard",y,u.c.SystemMetadata),y||hn(l,ve.d(f),i.payload.selectedCard),i.payload.source!==me.a.Canvas&&i.payload.selectType!==le.b.CollapseCard&&ln(l,un(ve.e(f,i.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":Cn(l,i.payload.isTask),m(ve.d(f),i.payload.commentId);var T=void 0;if(i.payload.isTask){T="REQUEST_THREAD_RESOLVE"===i.type?"ResolveThreadWithTask":"ReopenThreadWithTask",l.addDataField(T,!0,u.c.SystemMetadata,u.d.Critical);var O=null===(r=null===(n=null===(t=p[i.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;l.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,u.c.SystemMetadata,u.d.Critical)}ln(l,un(ve.e(f,i.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(Cn(l,i.payload.isTask),i.payload.isTask){l.addDataField("DeleteThreadWithTask",!0,u.c.SystemMetadata,u.d.Critical);O=null===(c=null===(s=null===(a=p[i.payload.commentId])||void 0===a?void 0:a.history[0])||void 0===s?void 0:s.records[0])||void 0===c?void 0:c.time;l.addDataField("TaskCreationTimeDeltaMs",O?Date.now()-O.getTime():0,u.c.SystemMetadata,u.d.Critical)}ln(l,un(ve.e(f,i.payload.commentId))),m(ve.d(f),i.payload.commentId);break;case"REQUEST_DELETE_POST":m(ve.d(f),i.payload.commentId);break;case"RELOAD_COMMENTS":l.addDataField("NumberOfThreads",i.payload.numberOfThreads,u.c.SystemMetadata)}try{var I=e.getState(),S=o(i),_=e.getState(),E=ve.h(I),j=ve.h(_);switch(i.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var D=i.payload.draftId?E.drafts[i.payload.draftId]:Object(pe.I)(E),P=i.payload.draftId?j.drafts[i.payload.draftId]:Object(pe.I)(j),A=void 0!==D&&void 0!==P&&D.renderContextType!==P.renderContextType;l.addDataField("DidDraftLockUpdate",A,u.c.SystemMetadata)}return l.successTag(595616739),S}catch(e){throw l.failTag(595616768,Object(rn.a)(e,-2130957541)),e}};switch(i.type){case"BEGIN_PROCESSING_COMMIT":var f=Object(u.g)().createActivityObject(t.trackerActivityName,i.actionDetail.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);try{m()}catch(e){throw f.failTag(595687567,Object(rn.a)(e,-2130957541)),e}if(!(g=ve.q(e.getState()))){f.failTag(595687569,-2130957541);break}var p=g.commentDraft.sessionConfiguration;t.beginTracking(p.draftId,ut.a[p.sessionType],p.sessionType,f);break;case"COMMIT_FAILURE":var g=ve.q(e.getState());Object(u.g)().assertConditionTag(!!g,"Draft should exist when failing a commit.",595132701),g&&t.failTracker(g.commentDraft.sessionConfiguration.draftId,s.e.reserveTag(595132702)),o(i);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(i.payload.commentId,ct.a.Modify,i.type);try{m()}catch(e){throw t.failTracker(i.payload.commentId,s.e.reserveTag(595907670),Object(rn.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(i.payload.commentId,ct.a.Delete,i.type);try{m()}catch(e){throw t.failTracker(i.payload.commentId,s.e.reserveTag(595907671),Object(rn.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{o(i)}catch(e){throw t.failAllTrackers(s.e.reserveTag(595731294),Object(rn.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":var h="LOAD_COMMENT"===i.type?i.payload.commentData:i.payload.threadInfo;if((!N.A()||h.length>0)&&!t.getTracker("LoadCommentTracker",ct.a.Load)){f=Object(u.g)().createActivityObject(t.trackerActivityName,i.actionDetail.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",ct.a.Load,i.type,f,{timeout:1e6,failOnTimeout:!1})}o(i);break;case"RELOAD_COMMENTS":try{m()}catch(e){throw t.failAllTrackers(s.e.reserveTag(595907672),Object(rn.a)(e,-2130957541)),e}t.endAllTrackers(s.e.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var b=t.getTracker("LoadCommentTracker",ct.a.Load);b&&(i.payload.commentId&&b.activity.addDataField("AssociatedCommentId",i.payload.commentId,u.c.SystemMetadata),b.activity.addDataField("RenderContextType",i.payload.renderContextType,u.c.SystemMetadata),t.endTracker("LoadCommentTracker",ct.a.Load,s.e.reserveTag(595646476))),o(i);break;case"APPLY_COMMENT_CHANGES":try{m()}catch(e){throw t.failAllTrackers(s.e.reserveTag(595907674),Object(rn.a)(e,-2130957541)),e}try{for(var v=Object(r.__values)(i.payload.changes),y=v.next();!y.done;y=v.next()){var T=y.value;if(T.type===ct.a.Load||T.type===ct.a.Unknown)break;if(T.type!==ct.a.Delete&&T.type!==ct.a.Modify){if(T.type===ct.a.Insert){void 0!==T.tempId&&""===T.model.parentId&&Ot(T.tempId,T.model.commentId,i.actionDetail.telemetryVisitor);var O=T.tempId||T.model.parentId;void 0!==O&&t.endTracker(O,T.type,s.e.reserveTag(595857620))}}else t.endTracker(T.model.commentId,T.type,s.e.reserveTag(595907675))}}catch(e){c={error:e}}finally{try{y&&!y.done&&(d=v.return)&&d.call(v)}finally{if(c)throw c.error}}break;case"COMMIT_DRAFT":g=ve.q(e.getState());if(m(),i.payload.data.temporaryCommentId&&g){var I=void 0;switch((p=g.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e,t,n){Ot(e,t,n)}(p.draftId,i.payload.data.temporaryCommentId,i.actionDetail.telemetryVisitor),I=i.payload.data.temporaryCommentId;break;case"REPLY":I=i.payload.data.temporaryCommentId;break;case"EDIT":I=p.commentId;break;case"METADATA":I=p.threadId}I&&t.updateTrackerId(p.draftId,I)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"CLEAR_COMMENT_SELECTION":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":m();break;case"SHOW_LOW_FIDELITY_WARNING":m();var S=ve.o(e.getState());S&&n.beginTracking(S);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var _="";switch(i.payload.visibilityState){case C.a.Closed:_="ViewContainerClosed";break;case C.a.Hidden:_="ViewContainerHidden";break;case C.a.Visible:_="ViewContainerVisible";break;default:Object(s.n)(i.payload.visibilityState)}var E=Object(u.g)().createActivityObject(_,i.actionDetail.telemetryVisitor,u.a.Always,u.b.NecessaryServiceDataEvent);o(i),E.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var j=e.getState();(null===(l=ve.h(j).drafts[i.payload.draftId])||void 0===l?void 0:l.isDraftEmpty)&&a(i),o(i);break;default:o(i)}var D=ve.o(e.getState());D&&n.endTrackingIfWarningDismissed(i,D)}}}},vn=n(172),yn=n(315),Tn=n(385),On=function(e){return function(e){return function(t){return function(n){switch(n.type){case"REQUEST_SHOW_PANE":(r=ye.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(r=ye.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!N.Ab())(r=ye.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(r=ye.d(e.getState())).invokeModalConfirmationDialog?r.invokeModalConfirmationDialog(n.payload.onConfirm,n.payload.onCancel,n.payload.displayStrings):(Object(u.g)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),r.closeView());break;case"REQUEST_DISPLAY_CONFIG":if(!N.F()){var r=ye.d(e.getState());Object(yn.a)(r)&&Object(vn.b)(n.payload.displayConfig)?n.payload.completion=r.setDisplayConfiguration(n.payload.displayConfig):n.payload.completion=Promise.reject()}break;case"READY_TO_RENDER":(r=ye.d(e.getState())).onReadyToRender&&r.onReadyToRender();break;case"BEGIN_DRAFTING_SUCCESS":r=ye.d(e.getState());if(Object(yn.a)(r)){if("CREATE"===(Object(lt.a)(n.payload.draftDetails)?n.payload.draftDetails.sessionConfiguration.sessionType:n.payload.draftDetails.sessionType))return N.F()?(Sn(e.dispatch,n.actionDetail,{displayMode:vn.a.Variable,desiredHeight:0}),void t(n)):r.setDisplayConfiguration({displayMode:vn.a.Variable,desiredHeight:0}).then((function(){t(n)}))}In(e.getState(),r);break;case"DISPLAY_DRAFT_WARNING":In(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(n.payload.closeOnDiscard){r=ye.d(e.getState());return t(n),void r.closeView()}}var a=e.getState(),o=t(n),i=e.getState();return function(e,t,n,r){var a=ye.d(r);if(!Object(yn.a)(a))return;var o=ve.h(r),i=ve.h(n),c=Object(Ce.c)(o),d=Object(Ce.c)(i),u=ve.g(r),l=ve.g(n);if(c!==d||!Object(yn.a)(ye.d(n))||!u&&l){if(!c)return u?void(N.F()?Sn(e,t,{displayMode:vn.a.Variable,desiredHeight:0}):a.setDisplayConfiguration({displayMode:vn.a.Variable,desiredHeight:0}).catch(Object(S.a)(s.e.reserveTag(593278689)))):void(N.F()?Sn(e,t,{displayMode:vn.a.Normal}):a.setDisplayConfiguration({displayMode:vn.a.Normal}).catch(Object(S.a)(s.e.reserveTag(593278691))));var m=ve.o(r);if(m&&u&&m.selectedCardId===u.draftId)return;N.F()?Sn(e,t,{displayMode:vn.a.FullScreen}):a.setDisplayConfiguration({displayMode:vn.a.FullScreen}).catch(Object(S.a)(s.e.reserveTag(593278721)))}}(e.dispatch,n.actionDetail,a,i),o}}}};function In(e,t){(function(e){var t=ye.e(e);return N.G()&&(N.p()?t===C.a.Hidden:t!==C.a.Visible)})(e)&&(t||ye.d(e)).openView()}function Sn(e,t,n){e(Object(Tn.a)(t,n)).catch(Object(S.a)(s.e.reserveTag(578426776)))}function _n(e,t,n,a,o,i,c){var d=Object(nt.compose)(Object(nt.applyMiddleware)(ot,at,rt.default,cn,bn(a),function(e,t){return function(n){var r=Kt(n,t);return function(t){return function(a){switch(a.type){case"COMMENT_CONTEXT_CHANGED":r.reset();break;case"RELOAD_COMMENTS":N.ib()&&r.reset();break;case"CLEAR_COMMENT_HIGHLIGHT":if(void 0===n.getState().commentState.highlightedCommentId)break;return t(a),void(a.payload.actionSource===me.a.SharedComments&&void 0===n.getState().commentState.highlightedCommentId&&e.highlightComment(""));case"DISPLAY_DRAFT_WARNING":var o=n.getState();if(t(a),N.Q()&&(N.zb()?Xt(ve.h(o),ve.o(o)):!N.Ab())){var i=n.getState();(b=ve.q(i))&&e.selectComment(b.threadId)}return;case"COMMIT_DRAFT":var c=n.getState(),d=Qt.b(n.getState()),l=ve.q(c);if(void 0!==l){var m=l.commentDraft;if(a.payload.metadataUpdates&&a.payload.metadataUpdates.Task){var f=void 0;m.sessionConfiguration.sessionType!==qt.a&&m.sessionConfiguration.sessionType!==qt.b&&(f=d[m.sessionConfiguration.threadId]&&d[m.sessionConfiguration.threadId].id),a.payload.metadataUpdates.Task.taskId=f,m.updateProperties("Task",a.payload.metadataUpdates.Task)}a.payload.data.temporaryCommentId=m.commit(a.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":var p=n.getState();return pe.L(ve.k(p),ve.t(p))?void r(a.payload.threadIds):void Object(u.g)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":var g=n.getState();if(!pe.L(ve.k(g),ve.t(g)))return;e.loadThreads(a.payload.threadIds);break;case"SESSION_REQUEST_STARTED":Object(ut.f)(a.payload.params)&&e.selectComment(a.payload.params.threadId);break;case"HIGHLIGHT_COMMENT":a.payload.actionSource===me.a.SharedComments&&e.highlightComment(a.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var C=n.getState(),h=ve.h(C);if(Object(Ce.d)(h))return;e.deleteComment(a.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":if(N.b())(b=e.beginDraftingAsync({sessionType:"METADATA",threadId:a.payload.commentId})).then((function(e){var t=Qt.b(n.getState())[a.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(S.a)(s.e.reserveTag(593768922)));else e.setThreadResolvedState(a.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":var b;if(N.b())(b=e.beginDraftingAsync({sessionType:"METADATA",threadId:a.payload.commentId})).then((function(e){var t=Qt.b(n.getState())[a.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(S.a)(s.e.reserveTag(593768924)));else e.setThreadResolvedState(a.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"SELECT_COMMENT":var v=n.getState();t(a);var y=n.getState(),T=ve.o(v),O=ve.o(y);return void(a.payload.source===me.a.SharedComments&&O&&(null==T?void 0:T.selectedCardId)!==O.selectedCardId&&e.selectComment(O.selectedCardId));case"SHOW_LOW_FIDELITY_WARNING":var I=ve.o(n.getState()),_=I?I.selectedCardId:void 0;t(a);var E=ve.o(n.getState()),j=E?E.selectedCardId:void 0;return void(j&&j!==_&&e.selectComment(j));case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(a.payload.commentId)}return t(a)}}}}(e,a),nn,function(e){return function(t){return function(n){return function(r){var a=n(r);if(N.yb())switch(r.type){case"BEGIN_DRAFTING_SUCCESS":if(!Object(lt.a)(r.payload.draftDetails))break;var o=Object(ve.h)(t.getState()),i=r.payload.draftDetails.sessionConfiguration.draftId;(s=o.drafts[i])&&e.setDeferredActiveEditorFocusCommand(i);break;case"DISPLAY_DRAFT_WARNING":if(r.payload.draftWarningType===he.a.CommitFailed)break;var s;o=Object(ve.h)(t.getState());(s=Object(pe.F)(o))&&e.setDeferredActiveEditorFocusCommand(s.sessionConfiguration.draftId)}return a}}}}(c),On(),function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":Object(B.b)(dn.e(e,n.payload.draftWarningType))}return t(n)}}}}(i),function(e){return function(t){return function(n){return function(a){var o,i,c;switch(a.type){case"ADD_CONTENT_EXTENSION":a.payload.extension.priority=en(a.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var d=Object(r.__values)(a.payload.renderModes),u=d.next();!u.done;u=d.next()){var l=u.value,f=Zt.a(t.getState())[l];f&&f.controller.unregisterExtension()}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(a),tn(t.getState(),m.e.Integrated),tn(t.getState(),m.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(Jt(t,a,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(a),void t.dispatch(Object(le.T)({renderContextType:Ie.a.None,telemetryVisitor:e,trackback:s.e.reserveTag(594834319)},(c={},c[m.e.Integrated]=en(m.e.Integrated,t.getState()),c[m.e.Isolated]=en(m.e.Isolated,t.getState()),c)));case"BEGIN_DRAFTING_SUCCESS":var p=a.payload.draftDetails,g=Object(lt.a)(p)?p.sessionConfiguration:p;if($t(t,a,n,g.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if($t(t,a,n,a.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(a.payload.isClaimingLock||a.actionDetail.renderContextType===Ie.a.DiscreteIsolated)break;var C=ve.q(t.getState());if(C&&$t(t,a,n,C.commentDraft.sessionConfiguration.sessionType))return}return n(a)}}}}(a),function(e){return function(t){return function(n){return function(r){if(!N.Ab())return n(r);var a=t.getState(),o=n(r),i=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":if(N.Q()&&(!N.zb()||!Xt(ve.h(a),ve.o(a)))){var s=ve.q(i);s&&e.bringContentIntoView({contentIdentifier:{contentId:s.threadId,contentType:m.b.CommentThread}})}break;case"SELECT_COMMENT":var c=ve.o(i);r.payload.source===me.a.SharedComments&&c&&e.bringContentIntoView({contentIdentifier:{contentId:c.selectedCardId,contentType:m.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(ye.a(i))break;var d=ve.q(i),u=d&&d.isInCurrentContext?d.threadId:void 0;u&&e.bringContentIntoView({contentIdentifier:{contentId:u,contentType:m.b.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent({selectDirection:r.payload.selectDirection,iterableContentTypes:r.payload.iterableContentTypes,restrictToCurrentContext:r.payload.restrictToCurrentContext,preventLooping:r.payload.preventLooping,from:r.payload.from});break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:j.a.Canvas,resource:r.payload.resource})}return o}}}}(o))),l=Object(nt.createStore)(Wt,n,d);return c.initialize(l),l}var En=n(342),jn=n(128),Dn=n(150),Pn=n(120),An=n(93),xn=n(228),wn=function(){function e(e,t){this.commentStore=e,this.commandFactory=new et(this.commentStore,t)}return e.prototype.selectNextOrPreviousThread=function(e,t){var n=N.p()&&!ye.a(this.commentStore.getState()),r=ye.c(this.commentStore.getState());return Ve(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,r,n),r,this.commentStore)===te.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=ye.c(this.commentStore.getState());Ve(this.commandFactory.selectAcrossContexts(void 0,e,t,n),n,this.commentStore)},e}(),kn=n(880),Rn=n(718),Nn={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function Fn(e){var t=e.itemCount,n=e.readOnly,r=e.isTask,a=Nn.PostHeight;return t>1&&(a+=Nn.PostHeight+0),t>2&&(a+=Nn.ExpandButtonHeight+0),n||(a+=Nn.ReplyDraftHeight+0),r&&(a+=Nn.TaskTopper),a}function Mn(e,t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(a,n),a.prototype.render=function(){var n=Object(r.__assign)(Object(r.__assign)({},t),this.props);return T.createElement(e,n)},a}(T.PureComponent)}var Ln,Vn=n(869);function Un(e,t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(a,n),a.prototype.render=function(){return T.createElement(Vn.a,{store:t},T.createElement(e,Object(r.__assign)({},this.props)))},a}(T.PureComponent)}!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(Ln||(Ln={}));var Hn,Bn=n(512),Gn=n(151),Wn=n(192),qn=n(317),zn=(s.e.reserveTag(595723983),s.e.reserveTag(595723984),s.e.reserveTag(574456150)),Yn=s.e.reserveTag(574456151),Kn=s.e.reserveTag(574456152),Xn=s.e.reserveTag(574456153),Qn=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),Zn=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(Hn||(Hn={}));var Jn=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),$n=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Hn.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(){var e=n.commentStore.getState();return ye.a(e)?ye.c(e):n.viewManager.getComponentTreeForRenderMode(m.e.Integrated)},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getHostableCommentCardRendererProps(m.e.Integrated)),{resource:{id:e},componentInstanceId:Object(c.c)()})},this.getCompletePaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return ye.a(t)?Object(Bn.b)(r,n.getCompletePaneOwnProps()):Object(Bn.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){var e=ve.g(n.commentStore.getState(),!0);return null==e?void 0:e.draftId},this.getParentId=function(e){var t=n.commentStore.getState(),r=ve.d(t),a=r.findIndex((function(t){return t.commentId===e}));return Object(o.h)(r[a])},this.isNewCommentButtonFocusable_deprecated=function(){return ye.b(n.commentStore.getState())},this.invokeModalDialog=function(e,t,r){var a={renderContextType:n.getActiveComponentTree().renderContextType,trackback:s.e.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},o=n.commentStore.dispatch,i=n.getCompletePaneOwnProps(),c=Object(Bn.b)(o,i),d=n.commentStore.getState(),l=ve.o(d),m=ve.h(d);switch(e){case Gn.a.CancelNewDraft:case Gn.a.CancelReplyDraft:return c.discardDraftAsync(a,me.a.SharedComments,!1);case Gn.a.DeleteThread:return l&&c.requestDeleteThread(a,l.selectedCardId),Promise.resolve(Pn.a.Handled);case Gn.a.ClosePaneDraft:return Wn.o({ownProps:i,dispatchProps:c,componentTree:n.getActiveComponentTree(),draftState:m,invokeModalDialog:n.invokeModalDialog}),Promise.resolve(Pn.a.Handled);default:return Object(u.g)().assertConditionTag(!1,"Unknown ModalDialogMode",592269457),Promise.resolve(Pn.a.Unhandled)}},this.updateEventProcessingState=function(e){var t=ve.l(n.previousStoreState),r=ve.l(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=ve.h(e),r=ve.h(n.previousStoreState);!Object(Ce.d)(t)&&n.pendingActionReason===Hn.NeedNotDrafting&&n.pendingAction&&(Object(u.g)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Hn.None);var a=Object(Ce.b)(t),o=Object(Ce.b)(r);a&&!o&&n.pendingActionReason===Hn.NeedDrafting&&n.pendingAction&&(Object(u.g)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Hn.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(u.g)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent),r=ve.h(n.commentStore.getState());Object(Ce.b)(r)?(t.addDataField("ActionDeferred",!1,u.c.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,u.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Hn.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(u.g)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent),r=ve.h(n.commentStore.getState());Object(Ce.d)(r)?(t.addDataField("ActionDeferred",!0,u.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Hn.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,u.c.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Hn.NeedDrafting:return n.onDrafting(t);case Hn.NeedNotDrafting:return n.onNotDrafting(t);case Hn.None:return t()}},this.onMockUIAction=new c.a((function(e){var t=Object(u.g)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,u.c.SystemMetadata);try{switch(e.actionType){case Ln.CreateThread:!function(e){return e.actionType===Ln.CreateThread&&void 0!==e.content}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction(Hn.NeedDrafting,(function(){return n.onCreateOrReply(new Qn(n.getNewThreadDraftId(),e.content))}));break;case Ln.CancelCreateThread:!function(e){return e.actionType===Ln.CancelCreateThread}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelCreateThread(new Qn(n.getNewThreadDraftId()))}));break;case Ln.StartReplySession:!function(e){return e.actionType===Ln.StartReplySession&&void 0!==e.threadId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction(Hn.NeedNotDrafting,(function(){return n.onStartReplySession(new Qn(e.threadId))}));break;case Ln.CancelReplySession:!function(e){return e.actionType===Ln.CancelReplySession&&void 0!==e.threadId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelReplySession(new Qn(e.threadId))}));break;case Ln.PostReply:!function(e){return e.actionType===Ln.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction(Hn.NeedDrafting,(function(){return n.onCreateOrReply(new Qn(e.threadId,e.content))}));break;case Ln.DeleteComment:!function(e){return e.actionType===Ln.DeleteComment&&void 0!==e.commentId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction(Hn.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case Ln.DeleteThread:!function(e){return e.actionType===Ln.DeleteThread&&void 0!==e.threadId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction(Hn.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case Ln.ResolveThread:!function(e){return e.actionType===Ln.ResolveThread&&void 0!==e.threadId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction(Hn.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case Ln.ReopenThread:!function(e){return e.actionType===Ln.ReopenThread&&void 0!==e.threadId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction(Hn.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case Ln.StartEditSession:!function(e){return e.actionType===Ln.StartEditSession&&void 0!==e.commentId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction(Hn.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case Ln.CancelEditSession:!function(e){return e.actionType===Ln.CancelEditSession&&void 0!==e.commentId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelEditSession(new Zn(e.commentId))}));break;case Ln.PostEdit:if(function(e){return e.actionType===Ln.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var r=new Zn(e.commentId);r.setContents(e.content),n.runAction(Hn.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Ln.SelectComment:!function(e){return e.actionType===Ln.SelectComment&&void 0!==e.commentId}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction(Hn.NeedNotDrafting,(function(){return n.onSelectComment(new Jn(e.commentId))}));break;case Ln.ClosePane:n.onClosePane();break;case Ln.ClickGhostCard:!function(e){return e.actionType===Ln.ClickGhostCard}(e)?Object(u.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction(Hn.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:Object(u.g)().assertConditionTag(!1,"Received unknown MockUIAction: "+e,592269506)}}catch(e){return void t.failTag(592269507,Object(rn.a)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();Wn.F({trackback:s.e.reserveTag(592269509),id:e,data:n.getRenderableItems(t),selectedComment:ve.o(t),renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){Wn.k({componentTree:n.getActiveComponentTree(),focusManager:n.viewManager.getFocusManager(),trackback:s.e.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(ye.b(e)){var t=n.commentStore.dispatch;Object(Bn.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:Ie.a.None,trackback:s.e.reserveTag(592269511)})}else Object(u.g)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),a=ve.h(r),i=Object(pe.I)(a),c=ve.g(r),d=(null==c?void 0:c.newComment.commentId)===t?{type:"CREATE"}:{type:"REPLY",parentId:t};Wn.b({trackback:s.e.reserveTag(592269513),commentCardRef:e,draftState:a,areMentionsEnabled:Object(pe.g)(ve.k(r),ve.a(r))===o.b.Enabled,session:d,componentTree:n.getActiveComponentTree(),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,selectedTaskAssignee:i&&i.selectedTaskAssignee}).catch(Object(S.a)(s.e.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),a=n.commentStore.getState(),o=ve.g(a,!0),i=(null==o?void 0:o.newComment.commentId)===e.getId(),c=ve.o(a),d=ve.h(a),u=ye.b(a),l=n.getActiveComponentTree().renderContextType,m=ve.p(a),f=i&&Object(qn.b)(u,l,c,o,m),p=Xe.f(n.getRenderableItemThreads(a,n.getActiveComponentTree()),t);Wn.d({trackback:s.e.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:r,closeOnDiscard:f,cardId:t,draftState:d,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isNewCommentButtonFocusable_deprecated:n.isNewCommentButtonFocusable_deprecated(),lieIndex:p})},this.onGhostCommentClicked=function(){ye.b(n.commentStore.getState())||Object(u.g)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(j.c.Next,n.getActiveComponentTree().renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getRenderableItems(t),a=ve.h(t),i=n.getParentId(e.getId()),c=n.getDispatchProps(i),d=ve.a(t),u=ve.k(t);Wn.D({trackback:s.e.reserveTag(592269518),id:e.getId(),data:r,draftState:a,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(pe.g)(u,d)===o.b.Enabled,componentTree:n.getActiveComponentTree(),actionDispatchers:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI}).catch(Object(S.a)(s.e.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=ve.h(t),a=ve.o(t),o=ye.b(t),i=ve.g(t,!0),c=ve.p(t),d=Object(qn.b)(o,n.getActiveComponentTree().renderContextType,a,i,c),u=n.getRenderableItems(t),l=n.getParentId(e.getId()),m=n.getDispatchProps(l);Wn.A({trackback:s.e.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:u,draftState:r,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:m,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=ve.g(t,!0),a=(null==r?void 0:r.newComment.commentId)===e.getId(),o=ve.o(t),i=ve.h(t),c=e.getId(),d=n.getDispatchProps(c),u=ye.b(t),l=n.getActiveComponentTree().renderContextType,m=ve.p(n.commentStore.getState()),f=a&&Object(qn.b)(u,l,o,r,m),p=Xe.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),c);Wn.d({trackback:s.e.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:d,closeOnDiscard:f,cardId:e.getId(),draftState:i,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isNewCommentButtonFocusable_deprecated:n.isNewCommentButtonFocusable_deprecated(),lieIndex:p})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=ve.o(t),a=n.getDispatchProps(e),o=Qt.a(t);Wn.c({trackback:s.e.reserveTag(592269523),id:e,data:n.getRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(),invokeModalDialog:n.invokeModalDialog,dispatchProps:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!o.tasks[e],isNewCommentButtonFocusable_deprecated:n.isNewCommentButtonFocusable_deprecated(),threadIndex:Xe.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=ve.o(t),a=n.getParentId(e),o=n.getDispatchProps(a);Wn.E({trackback:s.e.reserveTag(592269524),id:e,data:n.getRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onSelectComment=function(e){var t=n.commentStore.getState(),r=ve.g(t,!0),a=n.getRenderableItems(t),o=e.getId(),i=o===(null==r?void 0:r.draftId)?r&&{commentModel:r.newComment}:a.find((function(e){return Xe.e(e)===o}));if(i&&Object(Ze.a)(i)){var c=i,d=c.commentModel.parentId,l=n.getDispatchProps(d?c.commentModel.commentId:c.commentModel.parentId);Wn.J({trackback:s.e.reserveTag(592269526),renderableItem:i,selectedComment:ve.o(t),dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:n.getActiveComponentTree(),draftState:ve.h(t)}).catch(Object(S.a)(s.e.reserveTag(590123734)))}else Object(u.g)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){Wn.a({trackback:s.e.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=ve.w(),this.getRenderableItemThreads=ve.v(this.getRenderableItems)}return e.prototype.initialize=function(){var e=Object(u.g)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent);this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(Kn)},e.prototype.teardown=function(){var e,t=Object(u.g)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent);null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(Xn)},e.prototype.beginProcessing=function(){var e=this,t=Object(u.g)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent);this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(zn)}),100)},e.prototype.pauseProcessing=function(){var e=Object(u.g)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),u.a.None,u.b.FullEvent);this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(Yn)},e.prototype.onReopenThread=function(e,t){Wn.j({trackback:s.e.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree().renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),er=n(616);var tr=n(599);function nr(e,t,n,r){return function(a){return Object(m.f)().registerExtension(t,n,r).then((function(t){return a(Object(tr.a)(e,t)),t}))}}var rr=n(505);var ar,or=n(487),ir=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),sr=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(r.__extends)(t,e),t}(function(){function e(e){var t=this,n=e.apiContext,r=e.viewProvider,a=e.commentAPI,o=e.peopleAPI,i=e.localizationAPI,d=e.themeAPI,u=e.focusManager,l=e.initializationReason,f=e.commentStore,p=e.viewStrategyFactory,g=e.mockUIDriver;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(le.v({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(_e.b)(e.renderContextType)&&t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(c.k)((function(){P.sendCodeMarker({context:t.apiContext,type:E.DataReceived,assertTag:s.e.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case Ie.a.None:Object(s.o)(!1,"Unexpected render context type:"+e,s.e.reserveTag(589088338));case Ie.a.FullPane:case Ie.a.HalfPane:return ye.c(t.getCommentStore().getState());case Ie.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(m.e.Integrated);case Ie.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(m.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor,onInitialRender:t.onInitialRender}},this.setComponentRef=function(e,n,r){t.viewManagerRefRegistry.registerComponent(e,n,r)},this.onSuggestionsDetailsChange=function(e){t.commentStore.dispatch(le.Y({renderContextType:Ie.a.None,trackback:s.e.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.apiContext=n,this.viewProvider=r,this.commentAPI=a,this.peopleAPI=o,this.localizationAPI=i,this.themeAPI=d,this.focusManager=u,this.lastInitializationReason=l,this.viewStrategyFactory=p,this.mockUIDriver=g,this.telemetryVisitor=V.getTelemetryVisitor(this.apiContext),this.correlationId=V.getCorrelationId(this.apiContext)||Object(c.c)(),this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new wn(f,this.telemetryVisitor);var C=f.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(C.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=f,this.discreteIntegratedComponentTree=new kt(Ie.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new kt(Ie.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new ir,N.p()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new $n(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:Ie.a.None,trackback:s.e.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,function(n){var r=Object(u.g)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,u.a.None,u.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then((function(t){r.addDataField("AtMentionsEnabled",t,u.c.SystemMetadata),r.successTag(595903522),n(Object(rr.a)(e,t?st.b.Enabled:st.b.Disabled))}),(function(t){r.failTag(595903523,Object(rn.a)(t,-2130957528)),n(Object(rr.a)(e,st.b.Disabled))}))})).catch(Object(S.a)(s.e.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t;this.initialized||(this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),N.p()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),N.p()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),N.g()&&this.commentStore.dispatch(le.Q({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595732560),telemetryVisitor:this.telemetryVisitor},{resolve:this.commentAPI.resolveSupported()})),N.R()&&this.commentStore.dispatch(le.W({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595685378),telemetryVisitor:this.telemetryVisitor},this.commentAPI.resolveSupported()?$e.Resolve:$e.None,pe.d)),this.peopleAPI.capabilities&xn.a.GetSuggestionsDetails&&(this.commentStore.dispatch((e={renderContextType:Ie.a.None,trackback:s.e.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},t=this.peopleAPI,function(n){if(!(t.capabilities&xn.a.GetSuggestionsDetails))return Promise.resolve();var r=Object(u.g)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,u.a.OnSuccess,u.b.NecessaryServiceDataEvent);return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){r.successTag(592492760),n(Object(er.a)(e,t))}),(function(e){r.failTag(592492761,-2130957495)})):(r.failTag(592492759,-2130957494),Promise.resolve())})).catch(Object(S.a)(s.e.reserveTag(592492754))),Object(u.g)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===ve.l(e)&&ve.d(e).length>0&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState();if(N.p()){var a=ve.l(r);a!==t&&(t=a,n.onChange(r))}}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(u.g)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Dn.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case m.e.Integrated:return this.discreteIntegratedComponentTree;case m.e.Isolated:return this.discreteIsolatedComponentTree}},e.prototype.getPaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.initializeContentExtensions=function(){var e,t=this;Object(or.c)("CommentPaneContainer").then((function(n){if(void 0!==(e=n)){var a=Un(Mn(e.CommentPaneContainer,Object(r.__assign)({},t.getPaneOwnProps())),t.commentStore),o=_("SharedCommentPane",t.apiContext);t.commentPaneComponentController=Object(y.b)().registerComponent(o,a)}var i;Object(or.c)("HostableCommentCardRendererContainer").then((function(e){if(void 0!==(i=e)){var n=Un(Mn(i.HostableCommentCardRendererContainer,Object(r.__assign)({},t.getHostableCommentCardRendererProps(m.e.Integrated))),t.commentStore),a=_("DiscreteIntegratedCommentCard",t.apiContext);t.discreteIntegratedComponentController=Object(y.b)().registerComponent(a,n),t.discreteIntegratedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,m.e.Integrated)}));var o=Un(Mn(i.HostableCommentCardRendererContainer,Object(r.__assign)({},t.getHostableCommentCardRendererProps(m.e.Isolated))),t.commentStore),c=_("DiscreteIsolatedCommentCard",t.apiContext);t.discreteIsolatedComponentController=Object(y.b)().registerComponent(c,o),t.discreteIsolatedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,m.e.Isolated)})),t.commentStore.dispatch(nr({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595616915),telemetryVisitor:t.telemetryVisitor},m.b.CommentThread,a,{renderMode:m.e.Integrated,priority:m.d.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch(Object(S.a)(s.e.reserveTag(595645980))),t.commentStore.dispatch(nr({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595616916),telemetryVisitor:t.telemetryVisitor},m.b.CommentThread,c,{renderMode:m.e.Isolated,priority:m.d.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize(),isContentAvailable:function(e){var n=t.commentStore.getState(),r=Object(Rn.c)(e,ve.d(n),ve.c(n)),a=ve.h(n);return Object(Rn.a)(e,Object(Rn.b)(e,ve.d(n),r,ve.g(n,!0),a.drafts[e]),a,Ie.a.DiscreteIsolated,Object(kn.a)(e,Ie.a.DiscreteIsolated,a))}})).catch(Object(S.a)(s.e.reserveTag(595645982)))}})).catch(Object(S.a)(s.e.reserveTag(595645984)))})).catch(Object(S.a)(s.e.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:Fn({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void Object(u.g)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n;this.commentStore.dispatch(le.A({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor},m.e.Integrated,m.e.Isolated)),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.discreteIntegratedComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIsolatedComponentController)||void 0===n||n.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Dn.a.AddComment),this.commentAPI.unregisterForAction(Dn.a.NextThread),this.commentAPI.unregisterForAction(Dn.a.PreviousThread),this.commentAPI.unregisterForAction(Dn.a.DeleteThread),this.commentAPI.unregisterForAction(Dn.a.BackKeyPressed),this.commentAPI.unregisterForAction(Dn.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&xn.a.GetSuggestionsDetails&&(Object(u.g)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),N.p()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(N.p()&&e.actionBehavior===En.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var a=Object(r.__values)(this.commentUIActionListeners),o=a.next();!o.done;o=a.next()){var i=(0,o.value)(e);if(i!==An.a.NotHandled)return i===An.a.Success}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===An.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(s.l)(s.c.Comments,jn.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),N.p()&&!this.initialLoadComplete&&e===jn.a.CommentContextChanged&&pt.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(Pn.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==Pn.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case h.a.VisibilityChanged:return void n(le.bb({renderContextType:Ie.a.None,trackback:s.e.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case h.a.ViewContainerChanged:return n(le.Z({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case h.a.FocusTriggered:return void setTimeout((function(){return t.focusManager.focusCommentPaneCommand(ye.c(t.commentStore.getState()))}));case h.a.FoldableLayoutStateChanged:n(le.ab({renderContextType:Ie.a.None,trackback:s.e.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),cr=n(819);!function(e){e[e.HostCanvas=1]="HostCanvas",e[e.ContentNavigation=2]="ContentNavigation"}(ar||(ar={}));var dr=n(157),ur=n(248),lr=n(381),mr=n(438),fr=n(289),pr=n(526),gr=n(338),Cr=n(214),hr=function(){function e(e,t,n,r,a){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=a,this.getDraftRenderContextType=ve.u(),this.getRenderableItems=ve.w()}return e.prototype.processCommentEvent=function(e,t,n,r){var a=r();switch(e){case jn.a.CommentContextChanged:if(!pt.b(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(le.n({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case jn.a.CommentsChanged:if(!pt.i(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case jn.a.LoadComments:if(!pt.j(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case jn.a.CommentSelected:if(!pt.h(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var o=void 0;if(void 0!==ve.c(a)[t.commentId])o=Object(fr.a)(t.commentId,me.a.Canvas,{selectType:t.selectionReason===ar.ContentNavigation?le.b.CollapseCard:le.b.ExpandCard});else{var i=ve.d(a).find((function(e){return e.commentId===t.commentId}));if(void 0===i)return;o=Object(fr.a)(i.parentId,me.a.Canvas,{selectType:le.b.SelectPost,selectedPost:t.commentId})}n(Object(fr.b)(void 0,{renderContextType:Ie.a.None,trackback:s.e.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},o,!1)).catch(Object(S.a)(s.e.reserveTag(579744150)))}else n(le.k({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case jn.a.CommentContextReload:if(!pt.d(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case jn.a.CommentHighlighted:if(!pt.f(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(le.s({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,me.a.Canvas)):n(le.j({renderContextType:Ie.a.None,trackback:s.e.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},me.a.Canvas,void 0));break;case jn.a.NextPopulatedContextDetailsUpdated:if(!pt.l(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(le.u({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case jn.a.CommentHostCapabilitiesChanged:pt.g(t)?n(le.Q({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595732558),telemetryVisitor:this.telemetryVisitor},t.capabilities)):Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595732559);break;case jn.a.ModelCapabilitiesChanged:pt.k(t)?n(le.W({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case jn.a.CommentError:if(!pt.e(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case jn.a.ReturnToDraftRequested:pt.m(t)&&n(le.q({draftWarningType:he.a.ReturnToDraft,draftWarningReason:Cr.a.HostRequest},{renderContextType:Ie.a.None,trackback:s.e.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case jn.a.UpdateDraftThread:pt.o(t)?n(le.S({renderContextType:Ie.a.None,trackback:s.e.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(u.g)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case jn.a.SmartReplyPopulated:if(!pt.n(t))return void Object(u.g)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(le.w({renderContextType:Ie.a.None,trackback:s.e.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;default:return void Object(u.g)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var a=this,o=n();switch(e.actionType){case Dn.a.ShowHideCommentPane:return An.c(e.actionBehavior)?ye.b(o)?An.a.Success:An.a.Fail:(An.d(e.actionBehavior)&&(ye.b(o)?t(le.B({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(le.H({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),An.a.Success);case Dn.a.AddComment:if(An.b(e.actionBehavior)){if(!Object(we.a)(ve.h(o),ve.g(o)))return An.a.Fail}else if(An.d(e.actionBehavior)){var i={renderContextType:Ie.a.None,trackback:s.e.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(ur.a)(i,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI,void 0)).catch(Object(S.a)(s.e.reserveTag(592314376))),An.a.Success}return An.a.Success;case Dn.a.NextThread:if(Object(u.g)().assertConditionTag(!An.c(e.actionBehavior),"This action type does not support toggled status",595899713),An.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return a.selectionManager.selectNextOrPreviousThread({direction:j.c.Next,source:me.a.SharedComments,iterableContentTypes:[m.b.CommentThread]},Ie.a.None)}),t,N.Cb()?void 0:Cr.a.NextThread,s.e.reserveTag(591729749));else if(An.b(e.actionBehavior))return Object(we.c)(o)?An.a.Success:An.a.Fail;return An.a.Success;case Dn.a.PreviousThread:if(Object(u.g)().assertConditionTag(!An.c(e.actionBehavior),"This action type does not support toggled status",595899714),An.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return a.selectionManager.selectNextOrPreviousThread({direction:j.c.Previous,source:me.a.SharedComments,iterableContentTypes:[m.b.CommentThread]},Ie.a.None)}),t,N.Cb()?void 0:Cr.a.PreviousThread,s.e.reserveTag(591729750));else if(An.b(e.actionBehavior))return Object(we.c)(o)?An.a.Success:An.a.Fail;return An.a.Success;case Dn.a.DeleteThread:if(Object(u.g)().assertConditionTag(!An.c(e.actionBehavior),"This action type does not support toggled status",595899715),An.b(e.actionBehavior)){if(!Object(we.b)(o.commentState))return An.a.Fail}else An.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=ve.o(o);e&&t(le.D({renderContextType:Ie.a.None,trackback:s.e.reserveTag(591738706),telemetryVisitor:a.telemetryVisitor},e.selectedCardId))}),t,Cr.a.DeleteThread,s.e.reserveTag(591729751));return An.a.Success}return An.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,r){return e(Object(ur.a)({renderContextType:Ie.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI,void 0)).catch(Object(S.a)(r)).then((function(){return o.f.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},s.e.reserveTag(574371082),s.e.reserveTag(574371083));case"EditComment":var r=n(),a=this.getRenderableItems(r),i=ve.o(r),c=Object(Xe.a)(a,e.commentId);return c?Object(Wn.K)({comment:c,threads:a,selectedComment:i,warningType:be.a.Edit})?(t(le.O({renderContextType:Ie.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(593000206)},e.commentId,be.a.Edit)),Promise.resolve(o.f.Handled)):N.xb()?this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},s.e.reserveTag(593000207),s.e.reserveTag(593000208)):(Object(pr.a)(this.commentAPI,this.peopleAPI,t,{sessionType:"EDIT",commentId:e.commentId},!1,{renderContextType:Ie.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(574362627)},{renderContextType:Ie.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(574362628)}),Promise.resolve(o.f.Handled)):(Object(u.g)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(o.f.Handled));case"ReplyComment":return N.xb()?this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},s.e.reserveTag(593000209),s.e.reserveTag(593000210)):(t(Object(ur.a)({renderContextType:Ie.a.None,trackback:s.e.reserveTag(574362629),telemetryVisitor:this.telemetryVisitor},this.commentAPI,{sessionType:"REPLY",threadId:e.threadId},!1,this.peopleAPI,void 0)).catch(Object(S.a)(s.e.reserveTag(574362630))),Promise.resolve(o.f.Handled));case"DiscardDraft":if(!N.eb())return Promise.resolve(o.f.Unhandled);var d=n();if(e.mode===cr.a.TryAutoDiscard)return t(Object(lr.a)({renderContextType:Ie.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(575411521)},me.a.Canvas)).then((function(e){return e.draftDiscardResult}));i=ve.o(d);if(e.mode===cr.a.Dialog&&Object(gr.a)(ve.h(d))===dr.a.CannotAutoDiscard)return Promise.resolve(o.f.Unhandled);var l=Object(qn.b)(ye.e(d)===C.a.Visible,Ie.a.None,i,ve.g(d),ve.p(d));return t(Object(mr.a)({renderContextType:Ie.a.None,telemetryVisitor:this.telemetryVisitor,trackback:s.e.reserveTag(575411522)},me.a.Canvas,l,void 0));default:return Promise.resolve(o.f.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,r){t(Object(lr.a)({renderContextType:Ie.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},me.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==dr.a.NoDraft&&t.draftDiscardResult!==o.f.Handled||e()})).catch(Object(S.a)(s.e.reserveTag(591738704)))},e}(),br=n(604),vr=n(605),yr=n(607),Tr=n(100),Or=n(614),Ir=n(615);function Sr(e,t,n,r){return function(a,o){var i=o();r&&a(r);var c=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&a(Object(Or.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId)if(n.selectedCommentId){var d=ve.o(i);if(d&&d.selectedCardId===n.selectedCommentId)if(Object(be.c)(d.selectionDetails))a(Object(Tr.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953697)},n.selectedCommentId,void 0,d.selectionDetails.expanded?Tr.a.ExpandCard:Tr.a.CollapseCard,me.a.Canvas));else{var u=d.selectionDetails.selectedPostId,l=o();ve.d(l).find((function(e){return e.commentId===u}))?a(Object(Tr.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953698)},n.selectedCommentId,u,Tr.a.SelectPost,me.a.Canvas)):a(Object(Tr.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953699)},n.selectedCommentId,void 0,Tr.a.ExpandCard,me.a.Canvas))}else a(Object(Tr.b)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953728)},n.selectedCommentId,void 0,Tr.a.ExpandCard,me.a.Canvas))}else a(Object(vr.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953729)}));void 0!==n.highlightedCommentId&&(n.highlightedCommentId?a(Object(yr.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953730)},n.highlightedCommentId,me.a.Canvas)):a(Object(br.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(578586722)},me.a.Canvas,void 0)));var m=It(n);m&&a(Object(Ir.a)({renderContextType:e,telemetryVisitor:c,trackback:s.e.reserveTag(595953732)},m))}}}var _r=n(15),Er=n(350);var jr=n(608),Dr=n(609);function Pr(e,t,n){return function(r){pt.p(t)?r(Object(Dr.a)(Object(_r.a)(e,s.e.reserveTag(595137280)),t.threads)):(N.X()&&r(Object(Er.a)(Object(_r.a)(e,s.e.reserveTag(595137282)),t.comments,t.tasks,n)),r(Object(jr.a)(Object(_r.a)(e,s.e.reserveTag(595137283)),t.comments,t.tasks)))}}var Ar=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case jn.a.CommentsChanged:pt.i(t)&&n(Sr(Ie.a.None,this.telemetryVisitor,t.contextDetails,Object(le.d)({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case jn.a.LoadComments:pt.j(t)&&n(Pr({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case jn.a.CommentContextReload:pt.d(t)&&n((a={renderContextType:Ie.a.None,trackback:s.e.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},o=t,i=this.peopleAPI,c=this.telemetryVisitor,function(e,t){var n=[];Object(pt.c)(o)?(Object(u.g)().assertConditionTag(!t||Object(pe.L)(ve.k(t()),ve.t(t())),"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=bt(o.commentIds,(function(){return t().commentState}))):n=o.comments;var r=Object(pt.c)(o)?[]:o.tasks;e(Sr(a.renderContextType,c,o.contextDetails,Object(le.z)(Object(_r.a)(a,s.e.reserveTag(595953694)),{comments:n,numberOfThreads:o.numberOfThreads,tasks:r}))),N.X()&&e(Object(Er.a)(Object(_r.a)(a,s.e.reserveTag(595932895)),n,r,i)).catch(Object(S.a)(s.e.reserveTag(595645974)))}))}var a,o,i,c;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===o.d.AddComment&&e.actionBehavior!==o.a.CheckEnabled){var r=n();ye.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:We.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();var xr=n(610);var wr=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,a){switch(e){case jn.a.CommentsChanged:pt.i(t)&&n((o=t,i=this.telemetryVisitor,function(e,t){var n,a,c,d=t(),l=!1,m=o.contextDetails;if(""===(null==m?void 0:m.selectedCommentId)&&(m=Object(r.__assign)(Object(r.__assign)({},m),{selectedCommentId:void 0})),e(Sr(Ie.a.None,i,m,Object(le.d)({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595953743),telemetryVisitor:i},o.changes))),!o.contextDetails||!o.contextDetails.selectedCommentId){var f=ve.o(d),p=f?f.selectedCardId:void 0,g=t(),C=ve.o(g),h=ve.d(d),b=ve.d(g);if(p){if(p&&o.changes.some((function(e){return e.type===ct.a.Delete&&e.model.commentId===p}))){var v=h.findIndex((function(e){return e.commentId===p}));try{for(var y=Object(r.__values)(o.changes),T=y.next();!T.done;T=y.next()){var O=T.value;switch(O.type){case ct.a.Insert:O.index<=v&&++v;break;case ct.a.Delete:O.index<v&&--v;break;case ct.a.Modify:case ct.a.Unknown:}}}catch(e){n={error:e}}finally{try{T&&!T.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}if(C)throw new R.a(J.m,s.e.reserveTag(589103626),-2130957551);if(b.length){var I=v;I===b.length&&(I=b.length-1);var S=b[I],_=Object(ze.b)(S);e(Object(le.K)({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595953744),telemetryVisitor:i},_,void 0,Tr.a.ExpandCard,me.a.SharedComments)),l=!0}}}else!h.length&&b.length&&(e(Object(le.K)({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595947723),telemetryVisitor:i},b[0].commentId,void 0,Tr.a.ExpandCard,me.a.SharedComments)),l=!0);Object(u.g)().assertConditionTag(l||0===b.length||""!==(null===(c=o.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case jn.a.LoadComments:pt.j(t)&&(a().paneState.initializationStatus===jt.a.Initialized||this.lastInitializationReason!==k.a.NewThread?n(function(e,t,n,r){return function(a,o){a(Pr({renderContextType:e,trackback:s.e.reserveTag(595899530),telemetryVisitor:r},t,n));var i=o(),c=Object(pe.L)(ve.k(i),ve.t(i)),d=ve.d(i);Object(fe.a)({commentData:d,pendingCommentLoad:ve.l(i),virtualized:c})&&d.length&&!ve.o(i)&&a(Object(le.K)({renderContextType:e,trackback:s.e.reserveTag(595953680),telemetryVisitor:r},d[0].commentId,void 0,Tr.a.ExpandCard,me.a.SharedComments))}}(Ie.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(Pr({renderContextType:Ie.a.None,trackback:s.e.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case jn.a.CommentContextReload:pt.d(t)&&n(function(e,t,n,a){return function(o,i){var c,d,l=i(),m=!1,f=[];Object(pt.c)(t)?(Object(u.g)().assertConditionTag(Object(pe.L)(ve.k(l),ve.t(l)),"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),f=bt(t.commentIds)):f=t.comments;var p=t.contextDetails;""===(null==p?void 0:p.selectedCommentId)&&(p=Object(r.__assign)(Object(r.__assign)({},p),{selectedCommentId:void 0}));var g=Object(pt.c)(t)?[]:t.tasks;o(Sr(e,a,p,Object(xr.a)({renderContextType:e,telemetryVisitor:a,trackback:s.e.reserveTag(595953677)},{comments:f,numberOfThreads:t.numberOfThreads,tasks:g}))),N.X()&&o(Object(Er.a)({renderContextType:e,telemetryVisitor:a,trackback:s.e.reserveTag(595162892)},f,g,n)).catch(Object(S.a)(s.e.reserveTag(595645962)));var C=null===(c=ve.o(l))||void 0===c?void 0:c.selectedCardId,h=ve.d(l),b=i(),v=ve.d(b);if(C){if(!ve.o(b)){var y=h.findIndex((function(e){return e.commentId===C}));if(y<0)return;if(v.length){var T=y;T===v.length&&(T=v.length-1);var O=Object(ze.b)(v[T]);o(Object(le.K)({renderContextType:e,telemetryVisitor:a,trackback:s.e.reserveTag(595953678)},O,void 0,Tr.a.ExpandCard,me.a.SharedComments)),m=!0}}}else!h.length&&v.length&&(o(Object(le.K)({renderContextType:e,telemetryVisitor:a,trackback:s.e.reserveTag(595947722)},v[0].commentId,void 0,Tr.a.ExpandCard,me.a.SharedComments)),m=!0);Object(u.g)().assertConditionTag(m||0===v.length||""!==(null===(d=t.contextDetails)||void 0===d?void 0:d.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(Ie.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var o,i;this.commonViewStrategy.processCommentEvent(e,t,n,a)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),kr=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,a,o,i,s){var c=new hr(t,n,r,a,s);switch(e.containerType){case w.a.HalfPane:return new wr(c,n,i,s);case w.a.FullPane:return new Ar(c,n,o,s)}},e}();function Rr(e){if(void 0===e.hostCommentAPI)throw new R.a("'hostCommentAPI' was not supplied",s.e.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new R.a("'peopleAPI' was not supplied",s.e.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new R.a("'viewContainerProvider' was not supplied",s.e.reserveTag(589103636),-2130957511);var t=Object(j.e)(e.apiContext),n=Object(f.a)(),r=e.themeAPI||new de,a=e.hostCommentAPI;a=new ie(e.hostCommentAPI);var o=V.getTelemetryVisitor(e.apiContext),i=new tt(n.getLocaleInfo().isRightToLeft,o),c=_n(a,e.viewContainerProvider,Lt(e.viewContainerProvider.getViewContainer(),e.paneVisible,n.getLocaleInfo(),e.apiContext),V.getTelemetryVisitor(e.apiContext),t,n,i);return new sr({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:a,peopleAPI:e.peopleAPI,localizationAPI:n,themeAPI:r,focusManager:i,initializationReason:e.initializationReason,commentStore:c,viewStrategyFactory:new kr,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver})}function Nr(e,t,r,a,o,C,h,b){try{try{if($())return void Object(u.g)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(R.b)(e))throw e}L=Rr,Object(d.b)({appSettings:h||{},mapping:X}),Object(u.i)(Z,t),Object(u.g)().assertConditionTag(!!h,"appSettings should not be undefined",595616278);var v=Object(f.b)(o);Object(l.c)(v.getLocaleInfo().isRightToLeft),function(e){var t=n(1151),r=n(1152),a=Object(l.a)()?n(1153):n(1154),o=n(1155),i=n(1156),s=n(1157),c=n(1158),d=n(1159),u=n(1160),m=n(1161),f={HintBarEllipses_16:T.createElement(t,null),CancelGlyph:T.createElement(r,null),NewComment:T.createElement(a,null),CancelGlyph_TaskPane:T.createElement(o,null),Send2_Fluent:T.createElement(i,null),Delete_Fluent:T.createElement(s,null),Edit_Fluent:T.createElement(c,null),Checkmark_Fluent:T.createElement(d,null),CommentReopen_Fluent:T.createElement(u,null),Error:T.createElement(m,null)};if(e||N.b()){var p=n(1162),g=n(1163),C=n(1164),h=n(1165),b=n(932),v=n(1166),y=n(1167);f.TaskAssign=T.createElement(p,null),f.TaskComplete=T.createElement(g,null),f.TaskDelete=T.createElement(C,null),f.TaskEdit=T.createElement(h,null),f.TaskReopen=T.createElement(b,null),f.TaskStatusCircleCheckmark=T.createElement(v,null),f.ChevronDown12=T.createElement(y,null)}if(e||N.a()){var O=n(1168),I=n(1169);f.CommentLikeEmpty=T.createElement(O,null),f.CommentLikeSolid=T.createElement(I,null)}if(e||N.S()){var S=n(932);f.ReopenThread=T.createElement(S,null)}if(e||N.J()){var _=n(1170);f.LinkToComment=T.createElement(_,null)}Object(Q.jb)({icons:f})}();var y=e,O=Object(c.c)(),I=(_=i.a,new H(_,a));V.ensureViewManager({apiContext:i.a,displayMode:g.c.FullPane,foldableLayoutState:g.a.Indeterminate,initializationReason:C||k.a.PaneOpen,correlationId:O,viewContainerProvider:I,peopleAPI:r,hostCommentAPI:y,paneVisible:!1,initializeImmediately:!1}),Object(p.b)(b),z(),Object(m.f)().onExtensionFirstRequested.subscribe((function(e){e.contentType===m.b.CommentThread&&e.instanceId===m.c&&ee()}))}catch(e){throw Object(S.a)(s.e.reserveTag(594367139))(e),e}var _}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)});var Fr=n(325),Mr=n(865);function Lr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Nr.apply(void 0,Object(r.__spreadArrays)(e,[Object(Fr.a)()]))}n.d(t,"instantiate",(function(){return Lr})),n.d(t,"initializeRuntime",(function(){return ee})),n.d(t,"setWebpackPublicPath",(function(){return a.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return B.a})),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return Mr.a}))},149:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(40),a=n(437);function o(e,t){return Object(r.b)(e)?e.errorCode:Object(a.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1);function a(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{trackback:t})}function o(e,t,n){return{type:e,payload:t,actionDetail:n}}},150:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},151:function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},152:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},157:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},164:function(e,t,n){"use strict";var r,a=n(0),o=a.createContext(void 0);function i(e){return e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&((t=e)&&void 0!==t.focus&&void 0!==t.blur);var t}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}));var s=n(70),c=n(879),d=n(1);s.c.Tab,s.a.AtTarget,s.c.Tab,s.a.AtTarget;var u=n(344);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(893),function(){function e(e,t,n,r,o){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=o,this.registrationRef=a.createRef(),this.innerComponentRef=a.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var a=this.focusState;this.focusState=r,l(a)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();!function(){function e(t){this.def=t,this.childNodes=[],this.focus=jest.fn(),this.blur=jest.fn(),this.childNodes=t.childNodes.map((function(t){return new e(t)}))}e.prototype.getId=function(){return this.def.id},e.prototype.getData=function(){},e.prototype.getFocusState=function(){return this.def.isFocused?s.b.FocusOn:this.childNodes.some((function(e){return e.getFocusState()!==s.b.Unfocused}))?s.b.FocusWithin:s.b.Unfocused},e.prototype.getNextTabTarget=function(e,t){return function(e,t,n){var a=e.getFocusState();if(a!==s.b.FocusOn||n||t!==r.Reverse){if((a===s.b.Unfocused||n)&&t===r.Forward&&e.isTabbable())return e;var o=e.getChildNodes();t===r.Reverse&&o.reverse();for(var i=t===r.Forward&&a===s.b.FocusOn||n?0:o.findIndex((function(e){return e.getFocusState()!==s.b.Unfocused})),c=i>=0?i:0;c<o.length;++c){var d=o[c].getNextTabTarget(t,n);if(d)return d}return t===r.Reverse&&e.isTabbable()?e:void 0}}(this,e,t)},e.prototype.isTabbable=function(){return this.def.isTabbable},e.prototype.getChildNodes=function(){return this.childNodes.slice()},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(e){var t,n;try{for(var r=Object(d.__values)(this.childNodes),a=r.next();!a.done;a=r.next()){var o=a.value;if(o.getId()===e)return o;for(var i=o.getIterator(),s=void 0;!(s=i.next()).done;)if(s.value.getId()===e)return s.value}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.getIterator=function(){return e=this,function(){var t,n,r,a,o,i,s,c;return Object(d.__generator)(this,(function(u){switch(u.label){case 0:return[4,e];case 1:u.sent(),u.label=2;case 2:u.trys.push([2,8,9,10]),t=Object(d.__values)(e.getChildNodes()),n=t.next(),u.label=3;case 3:if(n.done)return[3,7];r=n.value,a=r.getIterator(),o=void 0,u.label=4;case 4:return(o=a.next()).done?[3,6]:[4,o.value];case 5:return u.sent(),[3,4];case 6:return n=t.next(),[3,3];case 7:return[3,10];case 8:return i=u.sent(),s={error:i},[3,10];case 9:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}();var e}}();var m=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}},f=(function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new m,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var a=Object(d.__values)(this.viewTreeMap.values()),o=a.next();!o.done;o=a.next()){var i=null===(r=o.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(i)return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}(),function(){function e(){var e=this;this.ref=a.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():s.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}(),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return a.Children.only(this.props.children)},t}(a.PureComponent));!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=a.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.__extends)(t,e),t.prototype.render=function(){var e=this;return a.createElement(o.Consumer,null,(function(t){return a.createElement(f,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(a.PureComponent);n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(function(){return s.c})),n.d(t,"c",(function(){return s.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"f",(function(){return c.b}))},168:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},17:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},170:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},171:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function a(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},172:function(e,t,n){"use strict";var r;function a(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},174:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},18:function(e,t,n){"use strict";var r=n(15);n(599);function a(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function o(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}var i=n(501);n(502),n(600),n(601),n(602);function s(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function c(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function d(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}n(603);var u=n(604),l=n(605);function m(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function f(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function p(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}var g=n(606);n(288);function C(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}var h=n(345);function b(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var v=n(312),y=(n(503),n(607));n(608),n(504),n(609);function T(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function O(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function I(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}function S(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}function _(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function E(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}function j(e){return Object(r.b)("READY_TO_RENDER",{},e)}var D=n(610);function P(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function A(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}function x(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}function w(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}n(611);function k(e,t,n,a){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:a},e)}function R(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function N(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}function F(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}n(505);function M(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}var L=n(100);function V(e,t,n,a,o,i,s){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:i,source:s,iterableContentTypes:n,restrictToCurrentContext:a,preventLooping:o},e)}function U(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function H(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}n(612);var B=n(613);function G(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}n(614);function W(e,t){return Object(r.b)("UPDATE_CAPABILITIES",{capabilities:t},e)}n(615);function q(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function z(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}function Y(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function K(e,t){return Object(r.b)("UPDATE_FOCUS_TYPE_AFTER_CONTEXT_CHANGE",{focusTypeAfterContextChange_deprecated:t},e)}function X(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function Q(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function Z(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}var J=n(616);function $(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function ee(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function te(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}n.d(t,"i",(function(){return r.a})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i.a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u.a})),n.d(t,"k",(function(){return l.a})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return g.a})),n.d(t,"p",(function(){return C})),n.d(t,"q",(function(){return h.a})),n.d(t,"r",(function(){return b})),n.d(t,"a",(function(){return v.a})),n.d(t,"s",(function(){return y.a})),n.d(t,"t",(function(){return T})),n.d(t,"u",(function(){return O})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return S})),n.d(t,"F",(function(){return _})),n.d(t,"x",(function(){return E})),n.d(t,"y",(function(){return j})),n.d(t,"z",(function(){return D.a})),n.d(t,"A",(function(){return P})),n.d(t,"B",(function(){return A})),n.d(t,"C",(function(){return x})),n.d(t,"D",(function(){return w})),n.d(t,"E",(function(){return k})),n.d(t,"G",(function(){return R})),n.d(t,"H",(function(){return N})),n.d(t,"I",(function(){return F})),n.d(t,"J",(function(){return M})),n.d(t,"b",(function(){return L.a})),n.d(t,"K",(function(){return L.b})),n.d(t,"L",(function(){return V})),n.d(t,"M",(function(){return U})),n.d(t,"N",(function(){return H})),n.d(t,"O",(function(){return B.a})),n.d(t,"P",(function(){return G})),n.d(t,"Q",(function(){return W})),n.d(t,"R",(function(){return q})),n.d(t,"S",(function(){return z})),n.d(t,"T",(function(){return Y})),n.d(t,"U",(function(){return K})),n.d(t,"V",(function(){return X})),n.d(t,"W",(function(){return Q})),n.d(t,"X",(function(){return Z})),n.d(t,"Y",(function(){return J.a})),n.d(t,"Z",(function(){return $})),n.d(t,"ab",(function(){return ee})),n.d(t,"bb",(function(){return te}))},180:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed"}(r||(r={}))},189:function(e,t,n){"use strict";function r(e){return void 0!==e.sessionConfiguration&&void 0!==e.author&&void 0!==e.insertIndex&&"function"==typeof e.commit&&"function"==typeof e.endDrafting}n.d(t,"a",(function(){return r}))},192:function(e,t,n){"use strict";var r=n(5),a=n(3),o=n(194),i=n(113),s=n(226),c=n(120),d=n(82),u=n(131),l=n(172),m=n(52),f=n(40),p=n(7);function g(e,t,n,r,o){if(!p.Cb()){var i=Object(a.g)().createActivityObject("SelectionAttemptWhileDrafting",n,a.a.None,a.b.NecessaryServiceDataEvent);i.addDataField("Trackback",r,a.c.SystemMetadata),i.addDataField("RenderContextType",o,a.c.SystemMetadata),i.addDataField("SelectionAttemptType",e,a.c.SystemMetadata),i.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,a.c.SystemMetadata),i.addDataField("DraftId",t.commentDraft.sessionConfiguration.draftId,a.c.SystemMetadata),i.successTag(590206682)}}var C,h=n(18),b=n(42),v=n(289),y=n(197),T=n(13),O=n(48),I=n(41),S=n(168);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(C||(C={}));var _=C,E=n(157),j=n(151),D=n(17),P=n(174),A=n(203),x=n(317),w=n(73);var k=n(140),R=n(87);n.d(t,"K",(function(){return N})),n.d(t,"E",(function(){return M})),n.d(t,"H",(function(){return L})),n.d(t,"B",(function(){return V})),n.d(t,"F",(function(){return U})),n.d(t,"D",(function(){return H})),n.d(t,"J",(function(){return B})),n.d(t,"A",(function(){return G})),n.d(t,"i",(function(){return W})),n.d(t,"g",(function(){return q})),n.d(t,"I",(function(){return z})),n.d(t,"G",(function(){return Y})),n.d(t,"a",(function(){return K})),n.d(t,"m",(function(){return X})),n.d(t,"l",(function(){return Q})),n.d(t,"h",(function(){return Z})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return $})),n.d(t,"d",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"j",(function(){return ne})),n.d(t,"k",(function(){return re})),n.d(t,"c",(function(){return ae})),n.d(t,"n",(function(){return oe})),n.d(t,"u",(function(){return ie})),n.d(t,"r",(function(){return se})),n.d(t,"q",(function(){return ce})),n.d(t,"y",(function(){return de})),n.d(t,"v",(function(){return ue})),n.d(t,"z",(function(){return le})),n.d(t,"s",(function(){return me})),n.d(t,"t",(function(){return fe})),n.d(t,"o",(function(){return pe})),n.d(t,"C",(function(){return ge})),n.d(t,"x",(function(){return Ce})),n.d(t,"p",(function(){return he})),n.d(t,"w",(function(){return be}));function N(e){var t=e.comment,n=e.threads,r=e.selectedComment,a=e.warningType,o=!t.parentId,i=!!(t.commentFlags&s.a.LowFidelity);if(!r)return!(!o||a!==I.a.DeleteThread||!i&&!R.j(n,t.commentId))||p.m()&&i&&o;var c=i||o&&(a===I.a.DeleteReply||a===I.a.DeleteThread)&&R.j(n,t.commentId),d=Object(I.c)(r.selectionDetails)?r.selectedCardId:r.selectionDetails.selectedPostId;return!(!c||d===t.commentId&&r.selectionDetails.lowFidelityWarningType===a)}function F(e){var t=e.result,n=e.localizationAPI;p.n()&&t===y.a.Success&&Object(o.b)(n.getString(67))}function M(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,c=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,m=R.a(i,n);m?N({comment:m,threads:i,selectedComment:s,warningType:I.a.DeleteReply})?d.showLowFidelityWarning({renderContextType:c,telemetryVisitor:u,trackback:r.e.reserveTag(593826118)},n,I.a.DeleteReply):(Object(o.b)(l.getString(65)),d.requestDeleteComment({renderContextType:c,telemetryVisitor:u,trackback:t},n)):Object(a.g)().assertConditionTag(!1,"Comment not found",593826117)}function L(e){var t=e.trackback,n=e.id,r=e.data,o=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=R.a(r,n);c?i.showPostErrorUI({renderContextType:o,telemetryVisitor:s,trackback:t},c.commentId):Object(a.g)().assertConditionTag(!1,"Comment not found",593875075)}function V(e){var t=e.trackback,n=e.id,r=e.data,o=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=R.a(r,n);c?i.clearPostErrorUI({renderContextType:o,telemetryVisitor:s,trackback:t},c.commentId):Object(a.g)().assertConditionTag(!1,"Comment not found",593875076)}function U(e){var t=e.trackback,n=e.id,o=e.data,i=e.selectedComment,s=e.renderContextType,c=e.actionDispatchers,d=e.telemetryVisitor,u=R.a(o,n);u?N({comment:u,threads:o,selectedComment:i,warningType:I.a.Edit})?c.showLowFidelityWarning({renderContextType:s,telemetryVisitor:d,trackback:r.e.reserveTag(593826120)},n,I.a.Edit):c.requestEditCommentSession({renderContextType:s,telemetryVisitor:d,trackback:t},n):Object(a.g)().assertConditionTag(!1,"Comment not found",593826119)}function H(e){var t=e.trackback,n=e.id,i=e.data,s=e.draftState,c=e.contentPromise,u=e.atMentionsEnabled,l=e.componentTree,g=e.actionDispatchers,C=e.telemetryVisitor,h=e.localizationAPI;if(Object(O.i)(s))return Promise.resolve();if(!s.postIdToDraftIdMap[n])return Object(a.g)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new f.a("Post draft to commit not found",r.e.reserveTag(587850403),-2130957492));var b=R.a(i,n);return b?(p.n()||Object(o.b)(h.getString(67)),g.commitCommentAndFocus({renderContextType:l.renderContextType,telemetryVisitor:C,trackback:t},(function(){return c}),{commentId:n,type:"EDIT",previousCommentBody:b.commentBody},u,l,Object(d.b)(b)).then((function(e){F({result:e,localizationAPI:h})})).catch(Object(m.a)(r.e.reserveTag(593826122)))):(Object(a.g)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new f.a("Comment not found in model",r.e.reserveTag(587850432),2130957505)))}function B(e){var t=e.trackback,n=e.renderableItem,a=e.selectedComment,o=e.dispatchProps,i=e.telemetryVisitor,s=e.componentTree,c=e.draftState,d=e.shouldFocusAfter,u=R.i(n),l=R.e(n);return o.discardDraftIfEmpty({renderContextType:s.renderContextType,telemetryVisitor:i,trackback:r.e.reserveTag(593237586)},b.a.SharedComments,void 0).then((function(e){if(p.Cb()||e.draftDiscardBehavior!==E.a.CannotAutoDiscard||a&&!Object(I.c)(a.selectionDetails)&&a.selectionDetails.selectedPostId===l){var n=p.mb()?!Object(T.M)(u,a,c):!a||a.selectedCardId!==u||Object(I.c)(a.selectionDetails)&&!a.selectionDetails.expanded;o.selectComment(s,{renderContextType:s.renderContextType,telemetryVisitor:i,trackback:t},Object(v.a)(u,b.a.SharedComments,n?{selectType:h.b.ExpandCard}:{selectType:h.b.SelectPost,selectedPost:l}),d).catch(Object(m.a)(r.e.reserveTag(590104649)))}else{var f=Object(T.I)(c);f&&g(2,f,i,r.e.reserveTag(590206683),s.renderContextType)}}),Object(m.a)(r.e.reserveTag(593032901)))}function G(e){var t=e.trackback,n=e.commentId,i=e.setContents,s=e.data,d=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,f=e.renderContextType,p=e.dispatchProps,g=e.telemetryVisitor,C=e.localizationAPI,h=R.a(s,n);d.postIdToDraftIdMap[n]&&h?(Object(o.b)(C.getString(66)),p.discardDraftAsync({renderContextType:f,telemetryVisitor:g,trackback:t},b.a.SharedComments,u,l).then((function(e){e===c.a.Handled&&h&&i&&i(h.commentBody)})).catch(Object(m.a)(r.e.reserveTag(593826127)))):Object(a.g)().assertConditionTag(!1,"Cannot find comment post to cancel '"+n+"'",593826126)}function W(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function q(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function z(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function Y(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function K(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;a.requestReplyCommentSession({renderContextType:r,telemetryVisitor:o,trackback:t},n)}function X(e){var t=e.trackback,n=e.commentCardRef,a=e.dispatchProps,o=e.telemetryVisitor,i=e.selectRootPost,s=e.relativeDraftingState,c=e.componentTree,d=e.draftState,u=e.shouldFocusAfter,l=n.getId(),f=!!s;a.discardDraftIfEmpty({renderContextType:c.renderContextType,telemetryVisitor:o,trackback:r.e.reserveTag(593052049)},b.a.SharedComments,void 0).then((function(e){if(e.draftDiscardBehavior===E.a.CannotAutoDiscard&&s===S.a.InOtherCard){var t=Object(T.I)(d);t&&g(1,t,o,r.e.reserveTag(590206684),c.renderContextType)}})).catch(Object(m.a)(r.e.reserveTag(593032903)));var p=Object(v.a)(l,b.a.SharedComments,i&&!f?{selectType:h.b.SelectPost,selectedPost:l}:{selectType:h.b.ExpandCard});a.selectComment(c,{renderContextType:c.renderContextType,telemetryVisitor:o,trackback:t},p,u).catch(Object(m.a)(r.e.reserveTag(590104650)))}function Q(e){var t=e.trackback,n=e.commentCardRef,a=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor,s=e.componentTree;o.selectComment(s,{renderContextType:a,telemetryVisitor:i,trackback:t},{selectType:h.b.CollapseCard,selectedCard:n.getId(),source:b.a.SharedComments},!1).catch(Object(m.a)(r.e.reserveTag(590104651)))}function Z(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;e.shouldHighlightCard?a.highlightComment({renderContextType:r,telemetryVisitor:o,trackback:t},n.getId()):a.clearCommentHighlight({renderContextType:r,telemetryVisitor:o,trackback:t},n.getId())}function J(e){var t=e.trackback,n=e.focusManager,o=e.componentTree,i=e.cardId,s=e.isCardLie,c=e.newHeight,d=e.renderContextType,u=e.selectedComment,f=e.dispatchProps,g=e.telemetryVisitor;if(d===D.a.HalfPane){if(void 0===c)return Object(a.g)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);u&&u.selectedCardId===i&&s&&!Object(T.Q)(i)&&f.requestDisplayConfiguration({renderContextType:d,telemetryVisitor:g,trackback:t},{displayMode:l.a.Variable,desiredHeight:c}).then((function(){p.r()&&n.focusCommentPaneCommand(o)})).catch(Object(m.a)(r.e.reserveTag(593826130)))}}function $(e){var t=e.trackback,n=e.id,r=e.draftState,a=e.renderContextType,o=e.dispatchProps,s=e.telemetryVisitor;if(!p.V()){var c=r.drafts[r.cardIdToDraftIdMap[n]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===i.g&&o.discardDraftAsync({renderContextType:a,telemetryVisitor:s,trackback:t},b.a.SharedComments,!1)}}function ee(e){var t,n=e.trackback,s=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,f=e.closeOnDiscard,g=e.cardId,C=e.draftState,h=e.telemetryVisitor,v=e.localizationAPI,y=e.focusManager,T=e.isNewCommentButtonFocusable_deprecated,O=e.lieIndex,I=C.cardIdToDraftIdMap[g];if(I){var S=void 0;s&&(S=Object(x.a)(C,u,d));var _=(null===(t=C.drafts[I])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===i.g,E=function(e){var t=e.componentTree,n=e.focusManager,r=e.isNewCommentButtonFocusable_deprecated,a=e.lieIndex,o=e.cardId,i=e.isReplyDraft,s=e.discardCallback;return function(e,d){if(s){return s((function(){return n.onUserAction(t,{userAction:P.a.CancelNewThreadDraft,threadIndex:a,isNewCommentButtonFocusable_deprecated:r}),e?e():c.a.Unhandled}),d)}return e?(i?n.onUserAction(t,{userAction:P.a.CancelReplyDraft,selectedCardId:o}):n.onUserAction(t,{userAction:P.a.CancelNewThreadDraft,threadIndex:a,isNewCommentButtonFocusable_deprecated:r}),Promise.resolve(e())):Promise.resolve(c.a.Unhandled)}}({componentTree:u,focusManager:y,isNewCommentButtonFocusable_deprecated:T,lieIndex:O,cardId:g,isReplyDraft:_,discardCallback:S});Object(o.b)(v.getString(_?64:103)),l.discardDraftAsync({renderContextType:u.renderContextType,telemetryVisitor:h,trackback:n},b.a.SharedComments,f,E).then((function(e){e!==c.a.Handled||!p.D()&&_||(_?y.onUserAction(u,{userAction:P.a.CancelReplyDraft,selectedCardId:g}):y.onUserAction(u,{userAction:P.a.CancelNewThreadDraft,isNewCommentButtonFocusable_deprecated:T,threadIndex:O}))}),Object(m.a)(r.e.reserveTag(592840735)))}else Object(a.g)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function te(e){var t=e.trackback,n=e.commentCardRef,i=e.draftState,s=e.areMentionsEnabled,c=e.session,d=e.componentTree,u=e.dispatchProps,l=e.telemetryVisitor,g=e.localizationAPI,C=e.selectedTaskAssignee;if(Object(O.i)(i))return Promise.resolve();var h=n.getId();if(!i.cardIdToDraftIdMap[h])return Object(a.g)().assertConditionTag(!1,"Card draft to commit not found, card ID "+h,588853383),Promise.reject(new f.a("Card draft to commit not found",r.e.reserveTag(587850433),-2130957492));var b=void 0;return p.b()&&C&&(b={Task:{type:"Task",assignee:C}}),p.n()||Object(o.b)(g.getString(67)),u.commitCommentAndFocus({trackback:t,telemetryVisitor:l,renderContextType:d.renderContextType},n.getContentsAsync,c,s,d,h,b).then((function(e){F({result:e,localizationAPI:g})})).catch(Object(m.a)(r.e.reserveTag(593826134)))}function ne(e){var t=e.trackback,n=e.id,r=e.renderContextType,a=e.dispatchProps,i=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(o.b)(s.getString(125)),a.requestReopenThread({renderContextType:r,telemetryVisitor:i,trackback:t},n,c)}function re(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,a=e.id,i=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(o.b)(d.getString(124)),n.onUserAction(t,{userAction:P.a.ResolveThread,selectedCardId:a}),s.requestResolveThread({renderContextType:i,telemetryVisitor:c,trackback:r},a,u)}function ae(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,f=e.telemetryVisitor,g=e.localizationAPI,C=e.focusManager,h=e.isTask,b=e.isNewCommentButtonFocusable_deprecated,v=e.threadIndex;if(e.shouldCheckForLowFidelity){var y=R.a(i,n);if(!y)return void Object(a.g)().assertConditionTag(!1,"Comment not found",593605342);if(N({comment:y,threads:i,selectedComment:s,warningType:I.a.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:r.e.reserveTag(593605343)},y.commentId,I.a.DeleteThread)}if(d.renderContextType===D.a.HalfPane&&u){u(j.a.DeleteThread,(function(){return p.v()||C.onUserAction(d,{userAction:P.a.DeleteThread,isNewCommentButtonFocusable_deprecated:b,threadIndex:v}),function(e){var t=e.dispatchProps,n=e.componentTree,o=e.selectedComment,i=e.telemetryVisitor;if(o)return t.requestDeleteThread({renderContextType:n.renderContextType,telemetryVisitor:i,trackback:r.e.reserveTag(592840775)},o.selectedCardId),c.a.Handled;return Object(a.g)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),c.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:s,telemetryVisitor:f})}),(function(){return c.a.Canceled})).then((function(e){p.v()&&e===c.a.Handled&&C.onUserAction(d,{userAction:P.a.DeleteThread,isNewCommentButtonFocusable_deprecated:b,threadIndex:v})})).catch(Object(m.a)(r.e.reserveTag(595632546)))}else Object(o.b)(g.getString(63)),C.onUserAction(d,{userAction:P.a.DeleteThread,isNewCommentButtonFocusable_deprecated:b,threadIndex:v}),Object(k.a)(d.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:t},n,h)}),100):l.requestDeleteThread({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:t},n,h)}function oe(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,a=e.id,o=e.taskState,i=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI;100!==o.completion?re({componentTree:t,focusManager:n,trackback:r,id:a,renderContextType:i,dispatchProps:s,telemetryVisitor:c,localizationAPI:d,isTask:!0}):ne({trackback:r,id:a,renderContextType:i,dispatchProps:s,telemetryVisitor:c,localizationAPI:d,isTask:!0})}function ie(e){var t=e.failTag,n=e.successTag,r=e.person,o=e.dispatchProps,i=e.telemetryVisitor,s=e.renderContextType,c=e.trackback,d=Object(a.g)().createActivityObject("CheckUserAccess",i,a.a.None,a.b.NecessaryServiceDataEvent),l={UserId:Object(u.e)(r),Provider:A.b,DisplayName:Object(u.d)(r),Email:Object(u.e)(r)};o.checkUserAccess(l).then((function(e){var t;d.addDataField("UserCanWrite",e.UserCanWrite,a.c.SystemMetadata),d.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,a.c.SystemMetadata),d.successTag(n)}),(function(e){d.failTag(t,-2130957562)})),o.addToCurrentMentionees({telemetryVisitor:i,trackback:c,renderContextType:s},r)}function se(e){var t=e.filter,n=e.limit,r=e.searchGraph;return e.dispatchProps.getUserContacts(t,n,r)}function ce(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,a=e.renderContextType,o=e.draftIdMap,i=e.actionDispatchers,s=e.telemetryVisitor,c=o[n];c&&i.draftEmptinessChanged({renderContextType:a,telemetryVisitor:s,trackback:t},c,r)}function de(e){var t=e.trackback,n=e.id,a=e.editor,o=e.renderContextType,i=e.draftIdMap,s=e.draftMap,c=e.actionDispatchers,d=e.telemetryVisitor,u=i[n];if(u){var l=s[u];Object(r.o)(l,"Draft should be defined if draftId exists!",r.e.reserveTag(587850434)),l.pendingState===O.a.None&&c.saveDraft({renderContextType:o,telemetryVisitor:d,trackback:t},u,{editorContent:a.getContentsAsync(),editorCursorPosition:a.getCursorPositionAsync()})}}function ue(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,a=e.dispatchProps,o=e.telemetryVisitor;a.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:o,trackback:t},n)}function le(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,a=e.telemetryVisitor,o=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:a,trackback:t},o)}function me(e){var t=e.selectedState,n=e.draftState,o=e.renderContextType,i=e.dispatchProps,s=e.telemetryVisitor,c=e.componentTree;if(t&&Object(I.i)(t))if(p.L())i.clearLowFidelityWarning({renderContextType:o,telemetryVisitor:s,trackback:r.e.reserveTag(573612046)});else{var d=t.selectedCardId;i.selectComment(c,{renderContextType:o,telemetryVisitor:s,trackback:r.e.reserveTag(590123735)},Object(v.a)(d,b.a.SharedComments,{selectType:Object(T.M)(d,t,n)?h.b.ExpandCard:h.b.CollapseCard}),!1).catch(Object(m.a)(r.e.reserveTag(590104652)))}else Object(a.g)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function fe(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,o=e.onPostEdit;if(t)if(Object(I.c)(t.selectionDetails)||Object(I.e)(t)){if(Object(I.f)(t))return void n(i=t.selectedCardId);if(Object(I.g)(t))return void Object(a.g)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var i=t.selectionDetails.selectedPostId;if(Object(I.d)(t))return void r(i);if(Object(I.g)(t))return void o(i)}else Object(a.g)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function pe(e){var t=e.ownProps,n=e.dispatchProps,o=e.componentTree,i=e.draftState,s=e.invokeModalDialog;if(o.renderContextType!==D.a.HalfPane&&Object(O.b)(i)&&!p.p()){n.discardDraftAsync({renderContextType:o.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.e.reserveTag(592840770)},b.a.SharedComments,!0,Object(x.a)(i,o,s,j.a.ClosePaneDraft)).then((function(e){var t;e===c.a.Canceled?(t=document.getElementById(w.x()))&&t.focus():e===c.a.Unhandled&&Object(a.g)().assertConditionTag(e!==c.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch(Object(m.a)(r.e.reserveTag(592840771)))}else!function(e){var t=e.dispatchProps,n=e.componentTree,o=e.telemetryVisitor,i=Object(a.g)().createActivityObject("ClosePane",o,a.a.None,a.b.NecessaryServiceDataEvent);i.addDataField("PaneCloseResult",_.NoDialog,a.c.SystemMetadata),i.successTag(592840773),t.requestClosePane({renderContextType:n.renderContextType,telemetryVisitor:o,trackback:r.e.reserveTag(592840774)})}({dispatchProps:n,componentTree:o,telemetryVisitor:t.telemetryVisitor})}function ge(e,t,n,a,o){n.selectComment(o,{renderContextType:o.renderContextType,telemetryVisitor:a,trackback:e},{selectType:h.b.CollapseCard,selectedCard:R.i(t),source:b.a.SharedComments},!1).catch(Object(m.a)(r.e.reserveTag(589940443)))}function Ce(e,t,n,r,a,o,i){a.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:o,trackback:e},t,i,n)}function he(e){var t;if(e&&e.target){var n=e.target;if(p.bb()){var r=n.closest(".ql-editor");if(null!==r&&"true"===r.contentEditable)return;e.preventDefault()}else{if("P"===(null===(t=n.tagName)||void 0===t?void 0:t.toUpperCase()))return;for(var a=n.childNodes,o="",i=0;i<a.length;i++){var s=a[i];3===s.nodeType&&(o+=s.nodeValue)}o||e.preventDefault()}}}function be(e,t,n,r,a){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:a,trackback:e},t)}},193:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.VisibilityChanged_deprecated=1]="VisibilityChanged_deprecated",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},194:function(e,t,n){"use strict";var r=n(564),a=new r.a;n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r.c})),n.d(t,"b",(function(){return r.b}))},197:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},202:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},210:function(e,t,n){"use strict";var r,a=n(342),o=n(597),i=n(110);!function(e){e[e.FailedToCommit=0]="FailedToCommit"}(r||(r={}));var s,c=n(128),d=n(226),u=n(123),l=n(150);!function(e){e[e.Unknown=0]="Unknown",e[e.UserAction=1]="UserAction",e[e.Suspend=2]="Suspend"}(s||(s={}));var m=n(120);n(170),n(868);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"e",(function(){return d.a})),n.d(t,"i",(function(){return u.d})),n.d(t,"h",(function(){return u.c})),n.d(t,"f",(function(){return l.a})),n.d(t,"g",(function(){return m.a}))},214:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},219:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));n(1),n(164);var r=n(73),a=n(32);function o(e){switch(e){case a.a.ClosePaneButton:return r.l();case a.a.NextCommentButton:return r.D();case a.a.PreviousCommentButton:return r.L();case a.a.GhostCard:return r.y();case a.a.NewCommentButton:return r.C();case a.a.PaneRoot:return r.x();case a.a.CommentsList:return r.o()}}function i(e){switch(e.componentType){case a.a.Card:return r.h(e,!1);case a.a.DraftCard:return r.h(e,!0);case a.a.PostEditor:return r.u(r.F(e));case a.a.CardEditor:return r.u(r.e(e));case a.a.Post:return r.I(e);case a.a.DiscreteHostedCommentRoot:return r.q(e);case a.a.ReopenThreadButton:return r.c(e,r.N())}}function s(e,t){return!1===e?a.a.Card:!0===e||t&&t.newComment.commentId===e?a.a.DraftCard:a.a.Card}},226:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew"}(r||(r={}))},232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=65535]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},24:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(5),o=n(34),i=n(40);function s(){if(!r)try{r=Object(o.a)()}catch(e){throw new i.a("FeatureGateAPI not initialized",a.e.reserveTag(589103629),-2130957531)}return r}},247:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},248:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n(5),a=n(3),o=n(133),i=n(123),s=n(124),c=n(189),d=n(131),u=n(157),l=n(17),m=n(487),f=n(52),p=n(40),g=n(149),C=n(108),h=n(7),b=n(13),v=n(48),y=n(10),T=n(62),O=n(15),I=n(42),S=n(501),_=n(502),E=n(312),j=n(612),D=n(381),P=n(350);function A(e,t,n,A,x,w){return function(k,R){var N=R(),F=Object(a.g)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),M=s.b[n.sessionType],L=e.renderContextType!==l.a.None||!T.b(N)&&h.p()?e.renderContextType:T.c(N).renderContextType;return F.addDataField("SessionType",M,a.c.SystemMetadata),F.addDataField("Trackback",e.trackback,a.c.SystemMetadata),F.addDataField("RenderContextType",L,a.c.SystemMetadata),F.addDataField("IsPaneVisible",T.b(N),a.c.SystemMetadata),h.b()||n.sessionType!==i.c?(Object(b.g)(y.k(N),y.a(N))===o.b.Enabled&&Object(m.a)().catch(Object(f.a)(r.e.reserveTag(591397600))),k(Object(D.a)(e,I.a.SharedComments,s.c(n))).catch((function(e){return Object(f.a)(r.e.reserveTag(591397602))(e),{draftDiscardResult:o.f.Unhandled,draftDiscardBehavior:u.a.CannotAutoDiscard}})).then((function(o){F.addDataField("DraftDiscardBehavior",o.draftDiscardBehavior,a.c.SystemMetadata);var i=R(),u=y.h(i);return Object(v.d)(u)||y.g(i)&&s.d(n)?(F.addDataField("SessionAlreadyRequested",!0,a.c.SystemMetadata),F.successTag(591397633),Promise.resolve(k(E.a))):(F.addDataField("SessionAlreadyRequested",!1,a.c.SystemMetadata),k(Object(j.a)(Object(O.a)(e,r.e.reserveTag(591397634)),n,A)),t.beginDraftingAsync(n).then((function(t){var o=Object(c.a)(t)?t.sessionConfiguration:t.updatedSessionParams?function(e,t){if(e.sessionType!==t.sessionType){if(!s.d(e))return void Object(a.g)().assertConditionTag(!1,"Invalid session conversion",591397645);if(!(s.d(t)||s.e(t)||s.f(t)))return void Object(a.g)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit",591397646)}switch(t.sessionType){case"CREATE":case"EDIT":case"REPLY":return t;default:return}}(n,t.updatedSessionParams):n;if(void 0===o)throw new p.a(C.c,r.e.reserveTag(589103630),-2130957532);s.d(n)&&h.X()&&k(Object(P.a)(Object(O.a)(e,r.e.reserveTag(591397635)),[],[],x,Object(c.a)(t)?Object(d.f)(t.author):Object(d.f)(Object(d.b)(t))));var i=Object(c.a)(t)?t:o;return Object(c.a)(t)&&F.addDataField("DraftId",t.sessionConfiguration.draftId,a.c.SystemMetadata),w?w().then((function(){return F.successTag(591397636),k(Object(_.a)(Object(O.a)(e,r.e.reserveTag(591397637)),i,L))})).catch((function(t){return F.failTag(591397638,Object(g.a)(t)),Object(c.a)(i)&&i.endDrafting(),k(Object(S.a)(Object(O.a)(e,r.e.reserveTag(591397639)),n,t))})):(F.successTag(591397640),k(Object(_.a)(Object(O.a)(e,r.e.reserveTag(591397641)),i,L)))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?F.successTag(591397643):F.failTag(591397642,Object(g.a)(t)),k(Object(S.a)(Object(O.a)(e,r.e.reserveTag(591397644)),n,t))})))}))):(F.failTag(591397599,-2130957513),Promise.resolve(k(E.a)))}}},252:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},263:function(e,t,n){"use strict";n.d(t,"a",(function(){return"Default_7210d794-9f0f-4d0a-805c-964303b2676b"}))},287:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(123);function a(e){return e.sessionType===r.a}function o(e){return e.sessionType===r.d&&void 0!==e.threadId}function i(e){return e.sessionType===r.b&&void 0!==e.commentId}},288:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("COMMIT_FAILURE",{},e)}},289:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var r=n(1),a=n(3),o=n(219),i=n(32),s=n(41),c=n(10),d=n(15),u=n(100);function l(e,t,n,r){return function(l,m){l(Object(d.b)("SELECT_COMMENT",n,t));var f=m(),p=Object(c.o)(f);return r&&p&&p.selectedCardId===n.selectedCard&&(n.selectType!==u.a.SelectPost||!Object(s.c)(p.selectionDetails)&&p.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if(Object(s.c)(p.selectionDetails)){var d=Object(c.h)(f).drafts[p.selectedCardId],u=!!d&&"CREATE"===d.commentDraft.sessionConfiguration.sessionType;r={componentType:Object(o.b)(u),id:p.selectedCardId,renderContextType:t.renderContextType}}else r={componentType:i.a.Post,id:p.selectionDetails.selectedPostId,renderContextType:t.renderContextType};var l=e.getComponentById(r);l?l.focus():Object(a.g)().assertConditionTag(!1,"Couldn't find focus target after select: "+JSON.stringify(r),590104655),n()}))})):(Object(a.g)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function m(e,t,n){return Object(r.__assign)({selectedCard:e,source:t},n)}},309:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r,a=n(5),o=n(3),i=n(40);function s(e){if(r)throw Object(o.g)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",a.e.reserveTag(577610271),-2130957508);r=e}function c(){if(!r)throw Object(o.g)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",a.e.reserveTag(577610272),-2130957509);return r}},312:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(3),o=n(17),i=n(15);var s,c=(s={renderContextType:o.a.None,telemetryVisitor:Object(a.h)(a.f.ReviewedAsNotNecessary),trackback:r.e.reserveTag(595735680)},Object(i.b)("",{},s))},315:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(202);function a(e){return e.containerType===r.b.HalfPane}},316:function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},317:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(338),a=n(157),o=n(17),i=n(934),s=function(e,t,n,r,a){return!!e&&((null==n?void 0:n.selectedCardId)===(null==r?void 0:r.draftId)&&t===o.a.HalfPane&&void 0===a)},c=function(e,t,n,o){if(n&&Object(r.a)(e)===a.a.CannotAutoDiscard){var s=null!=o?o:Object(i.a)(e,t.renderContextType);return function(e,t){return n(s,e,t)}}}},32:function(e,t,n){"use strict";var r;function a(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function o(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function i(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return o(e)&&o(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(210),a=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.e.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.e.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},330:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},338:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(133),a=n(157),o=n(48),i=n(13);function s(e){if(!Object(o.c)(e))return a.a.NoDraft;if(!function(e){var t=Object(i.G)(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return a.a.CannotAutoDiscard;var t=Object(i.I)(e);return t&&Object(r.i)(t.commentDraft.sessionConfiguration)?a.a.CannotAutoDiscard:a.a.CanAutoDiscard}},34:function(e,t,n){"use strict";var r=n(1),a=n(5),o="$officeonline_globalapi_cache",i=void 0;"undefined"!=typeof window&&(i=window),i[o]||(i[o]={});var s=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new a.d("'"+this.apiName+"' singleton is already initialized",a.e.reserveTag(589103757));return this.ctorStack=Object(a.g)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(r.__spread)([void 0],t)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new a.d("'"+this.apiName+"' singleton has not been initialized",a.e.reserveTag(589103758));return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new a.d("API has already been initialized.\nFirst initialization: "+this.ctorStack,a.e.reserveTag(589103759));this.DefaultCtor=e},e}();var c,d,u,l=function(){function e(e){if(!e)throw new a.d("Missing required arguments in FeatureGateAPIImpl!",a.e.reserveTag(589103760));this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new a.d("FeatureGate API not initialized!",a.e.reserveTag(589103761));var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new a.d("FeatureGate API not initialized!",a.e.reserveTag(589103762));var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!1,configurable:!0}),e}(),m=(c="FeatureGate",d=l,(u=i[o])[c]||(u[c]=new s(c,d)),u[c]);function f(e){return e}function p(e){return m.getAndInitialize(e)}function g(){return m.getInstanceOrThrow()}n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g}))},342:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},343:function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},344:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},345:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},346:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=function(e){return e.taskState},a=function(e){return e.taskState.tasks}},350:function(e,t,n){"use strict";var r=n(5),a=n(52),o=n(1),i=n(131),s=n(37);function c(e,t,n){void 0!==t[e]||n.has(e)||n.add(e)}function d(e){var t,n,r={};try{for(var a=Object(o.__values)(e),i=a.next();!i.done;i=a.next()){var s=i.value;r[s.authorName]=s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}var u=n(10),l=n(504);function m(e,t,n,o,m){return function(f,p){var g=function(e,t,n,r){var a=new Set;e.forEach((function(e){return c(Object(i.f)(e.author),n,a)})),t&&t.forEach((function(e){return e.history.forEach((function(e){return c(Object(i.f)(e.records[0].user),n,a)}))})),r&&c(r,n,a);var o=[];return a.forEach((function(e){return o.push({UserId:"",Provider:"",DisplayName:e})})),o}(t,n,u.m(p()),m);if(o.getPersonaIconPropertiesArray)o.getPersonaIconPropertiesArray(g).then((function(t){f(Object(l.a)(e,d(t)))})).catch(Object(a.a)(r.e.reserveTag(595645964)));else{var C=function(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorId:"",authorColor:s.a.COMMENTS_PURPLE,authorImageURL:""})})),t}(g);f(Object(l.a)(e,d(C)))}return Promise.resolve()}}n.d(t,"a",(function(){return m}))},358:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},37:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a={WHITE:"#FFFFFF",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",BLACK:"#000000",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},o={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED_DEPRECATED:"#7E7969",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",CHECKBOX_GREEN:"#31752F",CHECKBOX_HOVERED_GREEN:"#255924",REST_RESOLVED_BODY:a.GRAY_20,RESOLVED_TEXT:a.GRAY_110,ACTIVE_COMMENT_TEXT:a.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object(r.__assign)(Object(r.__assign)({},a),o)},380:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(170),a=n(13),o=n(48),i=n(10),s=n(62),c=n(7);function d(e,t){return!!c.Q()||!Object(o.d)(e)&&!t}function u(e){return!!e.selectedComment&&m(e.draftState)}function l(e){return function(e){var t=c.p()&&!s.b(e);return i.f(e).nextPopulatedContextDetails!==r.a.NoComments||Object(a.c)(i.d(e),t)}(e)&&m(i.h(e))}function m(e){return c.Q()||!Object(o.d)(e)}},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),a=n(3),o=n(120),i=n(157),s=n(338),c=n(48),d=n(180),u=n(10),l=n(15),m=n(345),f=n(438);function p(e,t,n){return function(p,g){var C=g(),h=u.h(C),b=Object(a.g)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),v=Object(c.i)(h);b.addDataField("Trackback",e.trackback,a.c.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,a.c.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",v,a.c.SystemMetadata),b.addDataField("ActionSource",t,a.c.SystemMetadata);var y=Object(s.a)(h);return y===i.a.CanAutoDiscard?p(Object(f.a)(e,t,!1)).then((function(e){return{draftDiscardResult:e,draftDiscardBehavior:y}})):(void 0!==n&&y===i.a.CannotAutoDiscard&&p(Object(m.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,r.e.reserveTag(591728722)))),Promise.resolve({draftDiscardResult:o.a.Canceled,draftDiscardBehavior:y}))}}},385:function(e,t,n){"use strict";var r=n(5),a=n(172),o=n(315),i=n(52),s=n(40),c=n(7),d=n(62),u=n(611),l=n(15);function m(e,t){return function(n,m){if(c.F()){var f=d.d(m());return Object(o.a)(f)&&Object(a.b)(t)?f.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return Object(l.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return Object(i.a)(r.e.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new s.a("Not half pane or half pane configuration",r.e.reserveTag(577610273),-2130957557))}var p=Object(u.a)(e,t);return n(p),p.payload.completion||Promise.reject(new s.a("requestDisplayConfiguration was not provided a completion from middleware.",r.e.reserveTag(589103625),-2130957557))}}n.d(t,"a",(function(){return m}))},41:function(e,t,n){"use strict";var r;function a(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function o(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function s(e){return o(e)||i(e)}function c(e){return!!e&&(a(e)||o(e))}function d(e){return!!e&&(s(e)||a(e))}function u(e){return void 0!==e.expanded}function l(e){return void 0!==e.selectedPostId}function m(e){return u(e.selectionDetails)?e.selectedCardId:e.selectionDetails.selectedPostId}function f(e,t){return!!t&&!u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"j",(function(){return f})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},413:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(123),a=n(7),o=n(13),i=JSON.stringify({ops:[{insert:""}]}),s={UserId:"",Provider:"",DisplayName:""};function c(e){var t,n=e.newComment.commentBody;return{commentBody:void 0!==n?n:i,commentId:e.newComment.commentId||"",author:null!==(t=e.newComment.author)&&void 0!==t?t:s,parentId:"",commentFlags:0,date:e.newComment.date||new Date,anchorHintText:e.newComment.anchorHintText?e.newComment.anchorHintText:void 0}}function d(e,t){if(!a.p())return!1;var n=Object(o.I)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},42:function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(82);function a(e){return!e.pendingCommentLoad||e.pendingCommentLoad.numberOfComments===e.commentData.length||!!e.virtualized&&(0!==e.commentData.length&&(void 0===e.pendingCommentLoad.selectedThreadIndex||e.pendingCommentLoad.selectedThreadIndex>=e.pendingCommentLoad.numberOfThreads||e.pendingCommentLoad.selectedThreadIndex<e.commentData.filter(r.a).length))}},437:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},438:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),a=n(3),o=n(18),i=n(123),s=n(120),c=n(48),d=n(41),u=n(10),l=n(15),m=n(601),f=n(603);function p(e,t,n,p){return function(g,C){var h=C(),b=Object(a.g)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,a.a.None,a.b.NecessaryServiceDataEvent),v=u.h(h),y=u.o(h),T=Object(c.i)(v);b.addDataField("Trackback",e.trackback,a.c.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,a.c.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",T,a.c.SystemMetadata),b.addDataField("ActionSource",t,a.c.SystemMetadata);var O=function(e,t,n){var s=u.q(e),c=u.o(e);if(!s)return c&&Object(d.k)(c.selectionDetails)&&Object(d.i)(c)?{cancelAction:o.g(Object(l.a)(n,r.e.reserveTag(593278744)),c.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;var m=s.commentDraft.sessionConfiguration.sessionType;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:o.f(Object(l.a)(n,r.e.reserveTag(593278745)),t),sessionType:m};case"REPLY":return{cancelAction:o.h(Object(l.a)(n,r.e.reserveTag(593278746)),s.commentDraft.sessionConfiguration.threadId,t),sessionType:m};case"EDIT":return{cancelAction:o.g(Object(l.a)(n,r.e.reserveTag(593278747)),s.commentDraft.sessionConfiguration.commentId,t),sessionType:m};default:return Object(a.g)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(h,n,e);if("number"==typeof O)return b.failTag(r.e.reserveTag(593278749),O),Promise.resolve(s.a.Handled);var I=O.sessionType,S=O.cancelAction;return b.addDataField("ActiveSessionType",I,a.c.SystemMetadata),T||!Object(c.b)(v)&&!Object(d.h)(y)?(b.addDataField("DiscardUnnecessary",!0,a.c.SystemMetadata),b.successTag(593278755),Promise.resolve(s.a.Unhandled)):(b.addDataField("DiscardUnnecessary",!1,a.c.SystemMetadata),g(Object(m.a)(Object(l.a)(e,r.e.reserveTag(593278750)))),b.addDataField("DiscardDialogShown",!!p,a.c.SystemMetadata),p?p((function(){return g(S),b.addDataField("CancelledByUser",!1,a.c.SystemMetadata),b.successTag(593278751),s.a.Handled}),(function(){return b.addDataField("CancelledByUser",!0,a.c.SystemMetadata),b.successTag(593278752),g(Object(f.a)(Object(l.a)(e,r.e.reserveTag(593278753)))),s.a.Canceled})):(g(S),b.successTag(593278754),Promise.resolve(s.a.Handled)))}}},465:function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReadOnly_deprecated=3]="ReadOnly_deprecated",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},474:function(e,t,n){var r=n(475),a=n(330),o=n(766),i=n(1124),s=n(921),c=function(e,t,n){var d,u,l,m,f=e&c.F,p=e&c.G,g=e&c.S,C=e&c.P,h=e&c.B,b=p?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,v=p?a:a[t]||(a[t]={}),y=v.prototype||(v.prototype={});for(d in p&&(n=t),n)l=((u=!f&&b&&void 0!==b[d])?b:n)[d],m=h&&u?s(l,r):C&&"function"==typeof l?s(Function.call,l):l,b&&i(b,d,l,e&c.U),v[d]!=l&&o(v,d,m),C&&y[d]!=l&&(y[d]=l)};r.core=a,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},475:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return b}));var r,a=n(1),o=n(7);function i(e){return{forceCardExpanded:e.forceCardExpanded,isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,smartReplies:e.smartReplies}}function s(e){return Object.keys(e.drafts)}function c(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function d(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0}}function u(e){return c(e)>0}function l(e){return u(e)||f(e)}function m(e){return!o.Cb()&&l(e)}function f(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var o=Object(a.__values)(s(e)),i=o.next();!i.done;i=o.next()){var c=i.value;if(e.drafts[c].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}function g(e){return p(e,r.None)}function C(e){return p(e,r.Commit)}function h(e){return p(e,r.Discard)}function b(e,t){return h(e)&&g(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},487:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var r=n(5),a=n(3),o=n(40),i=!1;function s(){return Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,1573)).then((function(e){return e})).catch((function(e){}))}function c(){var e;return i||(e=Object(a.g)().createActivityObject("AtMentionLazyLoad",Object(a.h)(a.f.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent),i=!0),Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,1574)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e.failTag(595895121,-2130957515),i=!1}))}function d(e){var t,i=Object(a.g)().createActivityObject("SharedCommentsUILazyLoad",Object(a.h)(a.f.GlobalAPI),a.a.None,a.b.NecessaryServiceDataEvent);switch(i.addDataField("ContainerName",e,a.c.SystemMetadata),e){case"CommentPaneContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(20)]).then(n.bind(null,1577))}),i);break;case"HostableCommentCardRendererContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(20)]).then(n.bind(null,1579))}),i);break;default:return i.failTag(595731076,-2130957503),Promise.reject(new o.a("Invalid container name",r.e.reserveTag(589103633),-2130957503))}return t.then((function(e){return i.successTag(595731075),e}),(function(e){i.failTag(595734544,-2130957504)}))}function u(e,t,n){void 0===n&&(n=3);return new Promise((function(r,o){e().then((function(e){t.addDataField("DelayLoadRetryCount",n,a.c.SystemMetadata),r(e)}),(function(a){setTimeout((function(){1!==n?u(e,t,n-1).then(r,o):o(a)}),500)}))}))}},501:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},502:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n},e)}},503:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("END_VIEW_INIT",{},e)}},504:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},505:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},511:function(e,t,n){"use strict";n(93);n(189);var r=n(89),a=n(82),o=n(287);n(247);n.d(t,"b",(function(){return r.b})),n.d(t,"f",(function(){return r.o})),n.d(t,"a",(function(){return a.b})),n.d(t,"c",(function(){return o.a})),n.d(t,"e",(function(){return o.c})),n.d(t,"d",(function(){return o.b}))},512:function(e,t,n){"use strict";var r=n(1),a=n(5),o=n(3),i=n(228),s=n(52),c=n(7),d=n(18),u=n(42),l=n(248),m=n(149);var f,p=n(123),g=n(124);!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(f||(f={}));var C=n(203),h=function(){function e(e){this.rawDelta=e,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var r=e.attributes.atmention,a=e.optional;!r||void 0!==a&&void 0!==a.atmention||null===(t=n._users)||void 0===t||t.push({UserId:r.email,Provider:C.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}(),b=n(40),v=n(437),y=n(197),T=n(13),O=n(48),I=n(214),S=n(180),_=n(41),E=n(10),j=n(600),D=n(288),P=n(345);function A(e,t,n,r,i,s){return function(u,l){var m=Object(o.g)().createActivityObject("CommitComment",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent);m.addDocumentMetadata(o.e.Basic);var C=g.b[i.type],b=l(),v=l().taskState,A=E.q(b);if(void 0===A||A.commentDraft.sessionConfiguration.sessionType!==i.type)return m.failTag(593278784,-2130957522),Promise.resolve(y.a.CommitFailed);var w="",k=!1;switch(i.type){case p.b:w=i.commentId;break;case p.d:w=i.parentId,k=!0;break;case p.a:A&&(w=A.commentDraft.sessionConfiguration.draftId||"")}var R=E.o(b),N=!k||!!R&&(!Object(_.c)(R.selectionDetails)||(null==R?void 0:R.selectionDetails.expanded));if(m.addDataField("IsCardExpanded",N,o.c.SystemMetadata),(null==s?void 0:s.Task)&&!Object(T.b)(b.commentState.modelCapabilities)&&(Object(o.g)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),s.Task=void 0),(c.b()&&i.type===p.a||c.c()&&i.type===p.d)&&(m.addDataField("IsPreExistingTask",!!v.tasks[w],o.c.SystemMetadata,o.d.Critical),m.addDataField("AffectingTaskMetadata",!!(null==s?void 0:s.Task),o.c.SystemMetadata,o.d.Critical)),m.addDataField("SessionType",C,o.c.SystemMetadata),i.type!==p.a){var F=Object(T.f)(E.d(b),w);F.valid&&(m.addDataField("MatchesCommentAuthor",F.matchesCurrentUser,o.c.SystemMetadata),m.addDataField("ThreadCreationDeltaMs",F.timeElapsed,o.c.SystemMetadata))}m.addDataField("AssociatedCommentId",w,o.c.SystemMetadata),m.addDataField("AtMentionsEnabled",n,o.c.SystemMetadata),m.addDataField("Trackback",e.trackback,o.c.SystemMetadata),m.addDataField("RenderContextType",e.renderContextType,o.c.SystemMetadata);var M=E.h(b);return Object(O.i)(M)?Promise.resolve(y.a.CommitPending):(u(Object(j.a)(d.i(e,a.e.reserveTag(593278785)))),r().then((function(r){if(!n){var l=x(u,i,r,0,m,a.e.reserveTag(593278786),a.e.reserveTag(593278787),e,s);return Promise.resolve(l)}var p=new h(r),g=p.Mentions;m.addDataField("NumberOfMentionsAdded",g.length,o.c.SystemMetadata);var C=Object(o.g)();if(c.h()&&g.length>0&&C.logFloodgateActivity&&C.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),m.addDataField("NumberOfHyperlinks",p.NumHyperlinks,o.c.SystemMetadata),m.addDataField("CreateCommentWithRichFormatting",p.HasRichTextFormatting,o.c.SystemMetadata),!g.length){l=x(u,i,r,0,m,a.e.reserveTag(593278788),a.e.reserveTag(593278789),e,s);return Promise.resolve(l)}return t.grantUsersAccess(g).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===f.Success}(t),c=function(e){return!!e.Details&&e.Details.Canceled}(t);if(m.addDataField("AllUsersGrantedAccess",n,o.c.SystemMetadata),m.addDataField("ShareDialogCanceled",c,o.c.SystemMetadata),t.OperationResult===f.FailedSilently)return Object(a.j)("Check Access Phase failed - share dialog not shown"),m.failTag(593278790,-2130957561),u(Object(D.a)(d.i(e,a.e.reserveTag(593278791)))),u(Object(P.a)({draftWarningType:S.a.GrantAccessFailedSilently,draftWarningReason:I.a.GrantUsersAccessFailure},d.i(e,a.e.reserveTag(593278792)))),Promise.resolve(y.a.ShareFailed);if(c)return Object(a.j)("Share dialog was canceled by user"),m.successTag(593278793),u(Object(D.a)(d.i(e,a.e.reserveTag(593278794)))),Promise.resolve(y.a.ShareFailed);if(!n)return Object(a.j)("Not all users have been granted access - going back to initial state"),m.successTag(593278795),u(Object(D.a)(d.i(e,a.e.reserveTag(593278796)))),Promise.resolve(y.a.ShareFailed);var l=x(u,i,r,g.length,m,a.e.reserveTag(593278797),a.e.reserveTag(593278798),e,s);return Promise.resolve(l)}),(function(t){return m.failTag(593278799,-2130957561),Object(a.j)("Grant Users Access has failed",t),u(Object(D.a)(d.i(e,a.e.reserveTag(593278800)))),Promise.resolve(y.a.ShareFailed)}))}),(function(t){return m.failTag(593278801,-2130957539),u(Object(D.a)(d.i(e,a.e.reserveTag(593278802)))),Object(a.j)("getCommentBody failed",t),c.n()&&u(Object(P.a)({draftWarningReason:I.a.CommitFailure,draftWarningType:S.a.CommitFailed},d.i(e,a.e.reserveTag(593278803)))),Promise.resolve(y.a.CommitFailed)})))}}function x(e,t,n,r,i,s,u,l,f){var g=function(e,t,n,r,i){try{switch(t.type){case"CREATE":e(d.o(d.i(r,a.e.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:i}));break;case"EDIT":e(d.o(d.i(r,a.e.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(d.o(d.i(r,a.e.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:i}));break;default:return Object(o.g)().assertConditionTag(!1,"Unexpected session type '"+t.type+"'",593278807),e(Object(D.a)(d.i(r,a.e.reserveTag(593278808)))),-2130957532}}catch(t){if(!Object(b.b)(t)&&!Object(v.a)(t))throw t;return e(Object(D.a)(d.i(r,a.e.reserveTag(593278809)))),c.n()&&e(Object(P.a)({draftWarningReason:I.a.CommitFailure,draftWarningType:S.a.CommitFailed},d.i(r,a.e.reserveTag(593278810)))),Object(m.a)(t)}return}(e,t,n,l,f);return g?(i.failTag(u,g),y.a.CommitFailed):r?(t.type===p.a?(i.addDataField("CreateThreadWithMentions",!0,o.c.SystemMetadata,o.d.Critical),f&&f.Task&&i.addDataField("CreateThreadWithTaskAssigned",!0,o.c.SystemMetadata,o.d.Critical)):t.type===p.d&&(i.addDataField("CreateReplyWithMentions",!0,o.c.SystemMetadata,o.d.Critical),f&&f.Task&&i.addDataField("CreateReplyWithTaskAssigned",!0,o.c.SystemMetadata,o.d.Critical)),i.successTag(s),y.a.Success):(i.successTag(s),y.a.Success)}var w=n(381),k=n(438),R=n(172),N=n(343),F=n(17),M=n(602),L=n(503),V=n(385);var U=n(100),H=n(613);var B=n(289),G=n(526);function W(e,t){return{requestDeleteComment:function(t,n){e(d.C(t,n))},requestDeleteThread:function(t,n,r){e(d.D(t,n,r))},requestReopenThread:function(t,n,r){e(d.G(t,n,r))},requestResolveThread:function(t,n,r){e(d.I(t,n,r))},requestEditCommentSession:function(n,r){c.xb()?e(Object(l.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r},!1,t.peopleAPI,void 0)).catch(Object(s.a)(a.e.reserveTag(574362624))):Object(G.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"EDIT",commentId:r},!1,n,d.i(n,a.e.reserveTag(593265930)))},requestReplyCommentSession:function(n,r){c.xb()?e(Object(l.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI,void 0)).catch(Object(s.a)(a.e.reserveTag(574362625))):Object(G.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"REPLY",threadId:r},!1,n,d.i(n,a.e.reserveTag(593265931)))},commitCommentAndFocus:function(n,r,a,o,i,s,d){return e(A(n,t.peopleAPI,o,r,a,d)).then((function(e){return e===y.a.ShareFailed?t.focusManager.focusActiveEditorCommand(i,a):c.nb()&&e===y.a.Success&&t.focusManager.focusCommentCardCommand(i,s),e}))},discardDraftAsync:function(t,n,r,a){return e(Object(k.a)(t,n,r,a))},discardDraftIfEmpty:function(t,n,r){return e(Object(w.a)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(d.O(t,n,r))},clearLowFidelityWarning:function(t){e(d.l(t))},saveDraft:function(t,n,r){e(d.J(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(d.j(t,u.a.SharedComments,n))},getUserContacts:function(e,n,r){return t.peopleAPI.capabilities&i.a.GetContactsForMentions?t.peopleAPI.getContactsForMentions(e,n,r):(Object(o.g)().assertConditionTag(!1,"Attempted to retrieve contacts on API without capability.",593265932),Promise.resolve([]))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(d.V(t,n))},addToCurrentMentionees:function(t,n){e(d.c(t,n))},updateSelectedTaskAssignee:function(t,n){e(d.X(t,n))},displayDraftWarning:function(t,n,r){e(d.q({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(d.P(t,n))},clearPostErrorUI:function(t,n){e(d.m(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(function(e,t,n){return function(r,a){var o,i=a();(null===(o=E.o(i))||void 0===o?void 0:o.selectedCardId)!==t&&r(Object(U.b)(e,t,void 0,U.a.ExpandCard,u.a.SharedComments)),r(Object(H.a)(e,t,n))}}(t,n,r))},draftEmptinessChanged:function(t,n,r){e(d.r(t,r,n))},selectComment:function(t,n,r,a){return e(Object(B.b)(t,n,r,a))},requestUpdateCommentReactions:function(n,r,a,i){e(function(e,t,n,r,a){return function(){var i=Object(o.g)().createActivityObject("CommentReaction",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent);t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:a}),e.commit(),e.endDrafting(),i.successTag(587317280)})).catch((function(e){i.failTag(587317281,Object(m.a)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},a,i))},requestPresentLinkToComment:function(t,n){e(d.F(t,n))}}}function q(e,t){return Object(r.__assign)(Object(r.__assign)({},W(e,t)),{highlightComment:function(t,n){e(d.s(t,n,u.a.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Object(l.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI,void 0)).catch(Object(s.a)(a.e.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(d.x(t,{threadIds:n}))},requestClosePane:function(t){e(d.B(t))},requestDisplayConfiguration:function(t,n){return e(Object(V.a)(t,n))},readyToRender:function(t){e(d.y(t))},requestModalConfirmation:function(t,n,r,a){e(d.E(t,n,r,a))},initializeView:function(n){e(function(e,t,n,r,o){return function(i){return i(Object(M.a)({renderContextType:e,trackback:a.e.reserveTag(595899542),telemetryVisitor:o})),t===N.a.NewThread?(e===F.a.HalfPane&&i(Object(V.a)({renderContextType:e,trackback:a.e.reserveTag(595899543),telemetryVisitor:o},{displayMode:R.a.Variable,desiredHeight:0})).catch(Object(s.a)(a.e.reserveTag(595645966))),i(Object(l.a)({renderContextType:e,trackback:a.e.reserveTag(595898586),telemetryVisitor:o},n,{sessionType:"CREATE"},!1,r,void 0)).then((function(){i(Object(L.a)({renderContextType:e,trackback:a.e.reserveTag(595899545),telemetryVisitor:o}))}))):i(Object(L.a)({renderContextType:e,trackback:a.e.reserveTag(595899546),telemetryVisitor:o}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateFocusTypeAfterContextChange_deprecated:function(t,n){e(d.U(t,n))},updateRenderLocksForAllDrafts:function(t,n){e(d.R(t,n))}})}function z(e,t){return Object(r.__assign)(Object(r.__assign)({},W(e,t)),{updateRenderLockForDraft:function(t,n,r){e(d.R(t,n,r))},highlightComment:function(n){e(d.s(n,t.resource.id,u.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.renderContextType!==F.a.HalfPane?Promise.resolve(void 0):e(Object(V.a)(n,r))},queueLoadThread:function(n){return e(d.x(n,{threadIds:[t.resource.id]}))}})}n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return z}))},513:function(e,t,n){"use strict";var r=n(598),a=(n(315),n(172)),o=(n(193),n(202));n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return o.a}))},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),a=n(40),o=function(e){return function(t){Object(a.b)(t)?Object(r.g)().assertConditionTag(!1,t.message,e):Object(r.g)().assertConditionTag(!1,"Unknown error "+t,e)}}},526:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),a=n(52),o=n(18),i=n(248);function s(e,t,n,s,c,d,u){n(Object(i.a)(d,e,s,c,t,void 0)).catch((function(e){Object(a.a)(r.e.reserveTag(591397647))(e),n(Object(o.e)(u,s,e))}))}},545:function(e,t,n){"use strict";var r=n(5),a=n(121),o=n(3),i=n(170),s=n(131),c=n(40),d=n(108),u=n(7),l=n(180),m=n(41),f=n(465),p=n(168);n(151),n(17);function g(e,t,n){var a=n&&u.m()?t-1:t-2;if(a<1)throw new c.a(d.f,r.e.reserveTag(589103692),-2130957559);var o=u.m();return 1===a?o?e.getString(106):e.getString(9):o?e.formatString(107,String(a)):e.formatString(10,String(a))}function C(e,t){switch(t){case i.a.AtFinishNextCommentIsFirst:return e.getString(8);case i.a.AtStartNextCommentIsFirst:return e.getString(6);case i.a.MoreCommentsUpcoming:case i.a.DocumentHasComments:return e.getString(7);case i.a.NoComments:case i.a.Unknown:default:return""}}function h(e,t,n,r){return n?t?e.getString(16):e.getString(17):u.Q()&&void 0!==r&&r!==p.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function b(e,t){switch(t){case l.a.ReturnToDraft:return e.getString(110);case l.a.GrantAccessFailedSilently:return e.getString(134);case l.a.CommitFailed:return e.getString(135);case l.a.None:return Object(o.g)().assertConditionTag(!1,"Invalid DraftWarningType: "+t,595686755),""}}function v(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function y(e,t){return t?Object(m.g)(t)?e.getString(35):Object(m.d)(t)?e.getString(36):"":""}n.d(t,"r",(function(){return g})),n.d(t,"g",(function(){return C})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"b",(function(){return _})),n.d(t,"j",(function(){return E})),n.d(t,"m",(function(){return j})),n.d(t,"n",(function(){return D})),n.d(t,"q",(function(){return P})),n.d(t,"p",(function(){return A})),n.d(t,"c",(function(){return x})),n.d(t,"k",(function(){return w})),n.d(t,"o",(function(){return k}));var T=Object(a.h)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return"RangeError"===e.name}return!1}));function O(e,t){var n=T();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,r)}return Object(o.g)().assertConditionTag(!1,"The locale and options arguments are not supported",595882385),e.toLocaleDateString()}catch(r){return Object(o.g)().assertConditionTag(!1,"LocaleDateString conversion failed: "+r.name+", locale: "+t+", areLocaleAndOptionsArgumentsSupported: "+n+", Date: "+e.toString(),595953050),""}}function I(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function S(e){return u.I()?{loading:e.getString(94),error:e.getString(95),limitedResults:e.getString(96),emptyResults:e.getString(93),suggestionsAnnouncement:e.getString(97),pickerModePlaceholderText:" ",useThisAddress:"",selectedSuggestionAccessibilityLabel:e.getStringOrUndefined(198)||"",selectedSuggestionNumberAccessibilityLabel:e.getStringOrUndefined(199)||""}:{isRTL:e.getLocaleInfo().isRightToLeft,noResultsFound:e.getString(61),searchDirectory:e.getString(59),searching:e.getStringWithStandardPlaceholders(57),suggestedContactsHeader:e.getString(62),topNResults:e.getStringWithStandardPlaceholders(60),typeToSearch:e.getString(58),loading:e.getString(73),accessibilityOnShowAnnouncement:e.getStringOrUndefined(74),a11yLabelForSuggestion:e.getStringWithStandardPlaceholdersOrUndefined(86)}}function _(e,t){var n="";switch(e){case f.a.Draft:case f.a.DraftPreCommitPending:n=t.getString(90);break;default:n=t.getString(89)}return n}function E(e){return e.getString(122)}function j(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(s.f)(e))}function D(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(s.f)(e)):n.formatString(129,Object(s.f)(e))}function P(e){return e.formatString(111,e.getString(133))}function A(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}var x=Object(a.h)((function(e,t,n,r){var a=t===f.a.Draft||t===f.a.DraftPreCommitPending,o=Object(s.d)(r);return o?a?e.formatString(178,o):n?e.formatString(179,o):e.formatString(178,o):a?e.getString(173):e.getString(174)}));function w(e,t){return e?t.getString(176):t.getString(126)}function k(e,t,n){return e?n.getString(180):(null==t?void 0:t.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}},550:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s}));n(5),n(40);var r,a=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function o(e,t,n){return{fullName:e,email:t,resolveState:n}}function i(e){return s(JSON.parse(e))}function s(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},561:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},562:function(e,t,n){e.exports=!n(563)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},563:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},564:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,a=n(3);function o(e){r=e}function i(e){r?r.announceToScreenReader(e):Object(a.g)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&o(e)},e}(),c=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},597:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},598:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},599:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},601:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},602:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},604:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},605:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},606:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(15);function a(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function o(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},608:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},609:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("REQUEST_DISPLAY_CONFIG",{displayConfig:t,completion:void 0},e)}},612:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},616:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},62:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(112),a=function(e){return e.paneState.visibilityState===r.a.Visible},o=function(e){return e.paneState.visibilityState!==r.a.Closed},i=function(e){return e.paneState.visibilityState},s=function(e){return e.paneState.componentTree},c=function(e){return e.paneState.viewContainer}},680:function(e,t,n){"use strict";var r=n(5),a=n(3),o=n(40),i=n(108),s=n(1),c=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||"en-us",dataCulture:this.localizationDetails.dataCulture||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new o.a(i.k,r.e.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 24:return CommentPaneStrings.NewPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 33:return CommentPaneStrings.EditorA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 38:return CommentPaneStrings.PostSaveA11yLabel;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 49:return CommentPaneStrings.CardSendReplyA11yLabel;case 83:return CommentPaneStrings.CardPostCommentA11yLabel;case 50:return CommentPaneStrings.ReplyBoxContainerA11yLabel;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.SavedCommentA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 90:return CommentPaneStrings.NewCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 109:return CommentPaneStrings.FinishEditingCommentText;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 162:return CommentPaneStrings.DraftCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(!1,Object(s.__spread)([this.getString(e)],t))},e.prototype.toFormattedString=function(e,t){for(var n="",r=t[0],a=0;;){var o=r.indexOf("{",a),i=r.indexOf("}",a);if(o<0&&i<0){n+=r.slice(a);break}if(i>0&&(i<o||o<0))n+=r.slice(a,i+1),a=i+2;else if(n+=r.slice(a,o),a=o+1,"{"!==r.charAt(a)){if(i<0)break;var s=r.substring(a,i),c=s.indexOf(":"),d=parseInt(c<0?s:s.substring(0,c),10)+1,u=c<0?"":s.substring(c+1),l=t[d];null==l&&(l=""),n+=l.toFormattedString?l.toFormattedString(u):e&&l.localeFormat?l.localeFormat(u):l.format?l.format(u):l.toString(),a=i+1}else n+="{",a++}return n},e}();n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var d=void 0;function u(){if(!d)throw new o.a(i.g,r.e.reserveTag(589103748),-2130957552);return d}function l(e){return Object(a.g)().assertConditionTag(void 0===d,"LocalizationAPI has already been initialized",589103749),void 0===d&&(d=new c(e)),d}},7:function(e,t,n){"use strict";n.d(t,"I",(function(){return o})),n.d(t,"X",(function(){return i})),n.d(t,"P",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"m",(function(){return d})),n.d(t,"sb",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"V",(function(){return m})),n.d(t,"Q",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"gb",(function(){return g})),n.d(t,"c",(function(){return C})),n.d(t,"R",(function(){return h})),n.d(t,"G",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"Ab",(function(){return y})),n.d(t,"h",(function(){return T})),n.d(t,"q",(function(){return O})),n.d(t,"db",(function(){return I})),n.d(t,"K",(function(){return S})),n.d(t,"cb",(function(){return _})),n.d(t,"e",(function(){return E})),n.d(t,"S",(function(){return j})),n.d(t,"Cb",(function(){return D})),n.d(t,"a",(function(){return P})),n.d(t,"H",(function(){return A})),n.d(t,"J",(function(){return x})),n.d(t,"O",(function(){return w})),n.d(t,"M",(function(){return k})),n.d(t,"E",(function(){return R})),n.d(t,"D",(function(){return N})),n.d(t,"F",(function(){return F})),n.d(t,"W",(function(){return M})),n.d(t,"U",(function(){return L})),n.d(t,"k",(function(){return V})),n.d(t,"Db",(function(){return U})),n.d(t,"Bb",(function(){return H})),n.d(t,"pb",(function(){return B})),n.d(t,"A",(function(){return G})),n.d(t,"Z",(function(){return W})),n.d(t,"wb",(function(){return q})),n.d(t,"jb",(function(){return z})),n.d(t,"yb",(function(){return Y})),n.d(t,"o",(function(){return K})),n.d(t,"vb",(function(){return X})),n.d(t,"lb",(function(){return Q})),n.d(t,"l",(function(){return Z})),n.d(t,"eb",(function(){return J})),n.d(t,"ab",(function(){return $})),n.d(t,"x",(function(){return ee})),n.d(t,"hb",(function(){return te})),n.d(t,"f",(function(){return ne})),n.d(t,"g",(function(){return re})),n.d(t,"i",(function(){return ae})),n.d(t,"ob",(function(){return oe})),n.d(t,"qb",(function(){return ie})),n.d(t,"fb",(function(){return se})),n.d(t,"z",(function(){return ce})),n.d(t,"kb",(function(){return de})),n.d(t,"w",(function(){return ue})),n.d(t,"Y",(function(){return le})),n.d(t,"xb",(function(){return me})),n.d(t,"N",(function(){return fe})),n.d(t,"t",(function(){return pe})),n.d(t,"v",(function(){return ge})),n.d(t,"L",(function(){return Ce})),n.d(t,"B",(function(){return he})),n.d(t,"r",(function(){return be})),n.d(t,"ub",(function(){return ve})),n.d(t,"j",(function(){return ye})),n.d(t,"ib",(function(){return Te})),n.d(t,"T",(function(){return Oe})),n.d(t,"C",(function(){return Ie})),n.d(t,"u",(function(){return Se})),n.d(t,"bb",(function(){return _e})),n.d(t,"rb",(function(){return Ee})),n.d(t,"tb",(function(){return je})),n.d(t,"mb",(function(){return De})),n.d(t,"s",(function(){return Pe})),n.d(t,"nb",(function(){return Ae})),n.d(t,"zb",(function(){return xe})),n.d(t,"y",(function(){return we}));var r=n(34),a=n(24);function o(){return Object(a.a)().isFeatureEnabled("LivePersonaPicker")}function i(){return Object(a.a)().isFeatureEnabled("PersonaFeature")}function s(){return Object(a.a)().isFeatureEnabled("NewCommentButton")}function c(){return f()&&Object(a.a)().isFeatureEnabled("DiscreteHostedComments")}function d(){return Object(a.a)().isFeatureEnabled("CommentsFluentUI")}function u(){return Object(a.a)().isFeatureEnabled("RenderDHCInPane")}function l(){return d()&&Object(a.a)().isFeatureEnabled("CommentTasks")}function m(){return Object(a.a)().isFeatureEnabled("NoDiscardOnFocusLoss")}function f(){return Object(a.a)().isFeatureEnabled("NewDraftingUI")}function p(){return d()&&Object(a.a)().isFeatureEnabled("CommentsFluentUIV2")}function g(){return Object(a.a)().isFeatureEnabled("TaskPaneWithNewInfrastructure")}function C(){return l()&&Object(a.a)().isFeatureEnabled("CommentTasksFromReply")}function h(){return Object(a.a)().isFeatureEnabled("NewModelState")}function b(){return Object(a.a)().isFeatureEnabled("HeadlessBoot")}function v(){return Object(a.a)().isFeatureEnabled("HyperlinksInComments")}function y(){return Object(a.a)().isFeatureEnabled("ContentNavigation")}function T(){return Object(a.a)().isFeatureEnabled("AtMentionFloodgateSurvey")}function O(){return f()&&Object(a.a)().isFeatureEnabled("ExtendedDrafting")}function I(){return Object(a.a)().isFeatureEnabled("RichTextFormattingInWeb")}function S(){return Object(a.a)().isFeatureEnabled("LogDraftCommentIdPair")}function _(){return h()&&Object(a.a)().isFeatureEnabled("RichContentEditIntegrationInWeb")}function E(){return Object(a.a)().isFeatureEnabled("SmartReplies")}function j(){return Object(a.a)().isFeatureEnabled("NewResolvedCardDesignInWeb")}function D(){return Object(a.a)().isFeatureEnabled("NewSelectionInteractions")}function P(){return Object(a.a)().isFeatureEnabled("CommentReactions")}function A(){return Object(a.a)().isFeatureEnabled("HyperlinksWithDisplayText")}function x(){return Object(a.a)().isFeatureEnabled("LinkToComment")}function w(){return Object(a.a)().isFeatureEnabled("NewBorderAndFocusLookInWeb")}function k(){return!1}function R(){return Object(a.a)().isChangeGateEnabled("FocusHandlerSkipNewCommentWhenNotExpected",Object(r.c)(4507524))}function N(){return Object(a.a)().isChangeGateEnabled("FocusHandlerRegistryOnUserActionNative",Object(r.c)(4519117))}function F(){return Object(a.a)().isChangeGateEnabled("FocusOnHalfpaneTransition",Object(r.c)(4533651))}function M(){return Object(a.a)().isChangeGateEnabled("PaneTabFocusFixes3",Object(r.c)(4557365))}function L(){return Object(a.a)().isChangeGateEnabled("NewWin32A11yLabels",Object(r.c)(4609604))}function V(){return Object(a.a)().isChangeGateEnabled("CommentContextMenuRestrictionFix2",Object(r.c)(4681384))}function U(){return Object(a.a)().isChangeGateEnabled("ProdComplianceEnvironmentFlag",Object(r.c)(4593758))}function H(){return Object(a.a)().isChangeGateEnabled("UseIsReadOnlyPropV2",Object(r.c)(4840290))}function B(){return Object(a.a)().isChangeGateEnabled("KeepRetryOnFocusFailed",Object(r.c)(4651682))}function G(){return Object(a.a)().isChangeGateEnabled("FixStrandedActivities",Object(r.c)(4667480))}function W(){return Object(a.a)().isChangeGateEnabled("PostEditSpinnerFix",Object(r.c)(4703646))}function q(){return Object(a.a)().isChangeGateEnabled("RetryPostFocus",Object(r.c)(4658360))}function z(){return Object(a.a)().isChangeGateEnabled("AvoidPaneEditorFocusIfDraftLockedToDHC",Object(r.c)(4663796))}function Y(){return Object(a.a)().isChangeGateEnabled("ReturnToDraftInMiddleware",Object(r.c)(4685682))}function K(){return Object(a.a)().isChangeGateEnabled("ConsumeContextsFix",Object(r.c)(4697079))}function X(){return Object(a.a)().isChangeGateEnabled("RetryPaneToSelectedCardFocusRedirect",Object(r.c)(4688673))}function Q(){return Object(a.a)().isChangeGateEnabled("NewE2EPerfTrackerErrors",Object(r.c)(4696994))}function Z(){return Object(a.a)().isChangeGateEnabled("CommentPaneFlexStylingFixWeb",Object(r.c)(4700190))}function J(){return Object(a.a)().isChangeGateEnabled("SilentDiscard",Object(r.c)(4707504))}function $(){return!1}function ee(){return Object(a.a)().isChangeGateEnabled("FixLPPNotEscaping",Object(r.c)(4707395))}function te(){return Object(a.a)().isChangeGateEnabled("TransparentBGForDisabledWebCommentIcon",Object(r.c)(4719980))}function ne(){return Object(a.a)().isChangeGateEnabled("AccessibilityMetadataForCommentCard",Object(r.c)(4726597))}function re(){return Object(a.a)().isChangeGateEnabled("AllowUpdateCapabilities",Object(r.c)(4727026))||!h()}function ae(){return Object(a.a)().isChangeGateEnabled("AugmentContactSuggestionAddedString",Object(r.c)(4732885))}function oe(){return Object(a.a)().isChangeGateEnabled("HidePaneSpinnerWithIsolatedLie",Object(r.c)(4720622))}function ie(){return Object(a.a)().isChangeGateEnabled("PreventMultiFocusOnReturnToDraft",Object(r.c)(4737114))}function se(){return Object(a.a)().isChangeGateEnabled("SupportTaskChunkedLoading",Object(r.c)(4766335))}function ce(){return w()&&Object(a.a)().isChangeGateEnabled("FixPostFocusBorderCutOff",Object(r.c)(4726880))}function de(){return Object(a.a)().isChangeGateEnabled("E2EPerfTrackersTimeoutsSucceed",Object(r.c)(4756828))}function ue(){return Object(a.a)().isChangeGateEnabled("FixHighContrastForNewBorderAndFocusLook",Object(r.c)(4733382))}function le(){return Object(a.a)().isChangeGateEnabled("PoliteFocusForWin32",Object(r.c)(4790896))}function me(){return Object(a.a)().isChangeGateEnabled("ReturnDispatchInInterruptableBeginDraft",Object(r.c)(4765859))}function fe(){return Object(a.a)().isChangeGateEnabled("MockLPPDataFix",Object(r.c)(4790429))}function pe(){return Object(a.a)().isChangeGateEnabled("FixAutoDiscardOnWithSmartRepliesOff",Object(r.c)(4762274))}function ge(){return Object(a.a)().isChangeGateEnabled("FixHalfPaneDeleteThreadFocus",Object(r.c)(4797453))}function Ce(){return Object(a.a)().isChangeGateEnabled("LowFidelityWarningFix",Object(r.c)(4805040))}function he(){return Object(a.a)().isChangeGateEnabled("FixTaskAssignerPickerSuggestedItemStyles",Object(r.c)(4790910))}function be(){return Object(a.a)().isChangeGateEnabled("FixAndroidHalfPaneNewThreadA11y",Object(r.c)(4809449))}function ve(){return Object(a.a)().isChangeGateEnabled("RestrictLieKeyboardingToRenderContext",Object(r.c)(4814700))}function ye(){return Object(a.a)().isChangeGateEnabled("CheckboxTabFixWin",Object(r.c)(4815075))}function Te(){return Object(a.a)().isChangeGateEnabled("VirtualizedReloadFix",Object(r.c)(4827342))}function Oe(){return Object(a.a)().isChangeGateEnabled("NewUIStringForMoreCommentsNavigationA11yFix",Object(r.c)(4824978))}function Ie(){return Object(a.a)().isChangeGateEnabled("FixTaskTopperReadOnly",Object(r.c)(4840262))}function Se(){return Object(a.a)().isChangeGateEnabled("FixExcelNewBorderFocusBug",Object(r.c)(4840688))}function _e(){return Object(a.a)().isChangeGateEnabled("RestrictBrowserContextMenu",Object(r.c)(4846005))}function Ee(){return Object(a.a)().isChangeGateEnabled("RemoveFocusTypeAfterContextChange",Object(r.c)(4827784))}function je(){return Object(a.a)().isChangeGateEnabled("RestoreSelectionOnEditorFocus",Object(r.c)(4840947))}function De(){return Object(a.a)().isChangeGateEnabled("FixCardExpandedHelper",Object(r.c)(4848880))}function Pe(){return Object(a.a)().isChangeGateEnabled("FixAtMentionReplacement",Object(r.c)(4852879))}function Ae(){return Object(a.a)().isChangeGateEnabled("FocusCardOnCommit",Object(r.c)(4861064))}function xe(){return Object(a.a)().isChangeGateEnabled("SelectOverContentNavForUnselectedDraft",Object(r.c)(4864265))}function we(){return o()&&Object(a.a)().isChangeGateEnabled("FixNarratorAccessibilityIssues",Object(r.c)(4820527))}},70:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var a,o=n(344),i=n(878);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(a||(a={})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return a}))},717:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(30),a=function(e){return e.contentExtensions.extensions},o=function(e,t){var n;return t.renderMode===r.e.Integrated?void 0!==(n=a(e)[t.renderMode])&&n.priority!==r.d.Disabled:t.renderMode===r.e.Isolated&&(void 0!==(n=a(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==r.d.Disabled)}},718:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(3),a=n(30),o=n(320),i=n(82),s=n(13),c=n(48),d=n(168),u=n(17),l=n(413);function m(e,t,n){for(var r,a,i=new o.a(t,-1);!(a=i.next()).done;){var s=a.value.commentId,c=n[s];if((null==c?void 0:c.alternateId)===e||s===e)break}return null===(r=a.value)||void 0===r?void 0:r.commentId}function f(e,t,n,a,o){if(a&&(a.newComment.commentId===e||a.draftId===e))return{thread:[Object(l.a)(a)],isDraftThread:!0,draftThreadState:o};Object(r.g)().assertConditionTag(!o||!o.isInCurrentContext||"CREATE"!==o.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370);var s=n||e;return{thread:t.filter((function(e){return Object(i.b)(e)===s})),isDraftThread:!1,draftThreadState:void 0}}function p(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===u.a.None||t.draftThreadState.renderContextType===r?a.a.Enabled_ForcePrimary:a.a.Disabled;if(t.isDraftThread||t.thread.length>0)return o===d.a.InCard||o===d.a.InChildPost?a.a.Enabled_ForcePrimary:a.a.Enabled_Default;if(Object(c.k)(n))return a.a.Disabled;var i=Object(s.I)(n);return i&&i.threadId===e?a.a.Disabled:a.a.Invalid}},73:function(e,t,n){"use strict";n(5),n(3),n(17);function r(e){return"_"+e.renderContextType+"_"+e.id}function a(e){return"cardEditor"+r(e)}function o(e){return"postEditor"+r(e)}function i(e){return"editorRoot_"+e}function s(e){return"postRoot"+r(e)}function c(e,t){return t?"draftCardRoot"+r(e):"cardRoot"+r(e)}function d(){return"GhostCard"}function u(e){return"replyBoxDescription"+r(e)}function l(e){return"editorBoxDescription"+r(e)}function m(e){return"sendReplyButton"+r(e)}function f(e){return"cancelReplyButton"+r(e)}function p(e){return"cardContextMenu"+r(e)}function g(e){return"postContextMenu"+r(e)}function C(e){return"renderableItemList"+r(e)}function h(e,t){return"actionBarButton_"+t+r(e)}function b(e){return"editorFocusContainer_"+e}function v(e){return"draftCancelButton"+r(e)}function y(e){return"innerReplyBoxContainer"+r(e)}function T(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function O(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function I(){return"postFocusBar"}function S(e){return"viewMoreReply"+r(e)}function _(e){return"postTimeStamp"+r(e)}function E(e,t){return""+t.replace(/\s/g,"")+r(e)}function j(e){return"suggestionsList"+e}function D(e,t){return""+t.replace(/\s/g,"")+r(e)}function P(e){return"anchorHintText"+r(e)}function A(e){return"lowFidelityWarning"+r(e)}function x(){return"CommentsListScrollView"}function w(){return"CommentsList"}function k(e){return"cardSideBar"+r(e)}function R(){return"EmptyCreatedCommentLie"}function N(){return"NewCommentButton"}function F(e){return"taskAssignerCheckbox"+r(e)}function M(e){return"cardTaskFooterPickerButton"+r(e)}function L(e){return"cardTaskTopperCheckbox"+r(e)}function V(e){return"cardTaskTopperDiv"+r(e)}function U(e){return"taskAssignerDiv"+r(e)}function H(){return"TaskChevronIcon"}function B(e){return"postWarning"+r(e)}function G(e){return"draftWarning"+r(e)}function W(e){return"truncationOverlay"+e}function q(){return"next-thread-button"}function z(){return"previous-thread-button"}function Y(e){return"loadingPlaceholder"+r(e)}function K(e){return"DiscreteHostedCommentRoot"+r(e)}function X(e){return"CommentLikeButton"+r(e)}function Q(){return"ReopenThread"}function Z(){return"suggestion-list"}function J(){return"lppSuggestionListId"}n.d(t,"e",(function(){return a})),n.d(t,"F",(function(){return o})),n.d(t,"v",(function(){return i})),n.d(t,"I",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"y",(function(){return d})),n.d(t,"P",(function(){return u})),n.d(t,"t",(function(){return l})),n.d(t,"Q",(function(){return m})),n.d(t,"O",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"H",(function(){return g})),n.d(t,"M",(function(){return C})),n.d(t,"a",(function(){return h})),n.d(t,"u",(function(){return b})),n.d(t,"r",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"x",(function(){return T})),n.d(t,"l",(function(){return O})),n.d(t,"G",(function(){return I})),n.d(t,"W",(function(){return S})),n.d(t,"J",(function(){return _})),n.d(t,"p",(function(){return E})),n.d(t,"B",(function(){return j})),n.d(t,"c",(function(){return D})),n.d(t,"b",(function(){return P})),n.d(t,"A",(function(){return A})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return w})),n.d(t,"i",(function(){return k})),n.d(t,"w",(function(){return R})),n.d(t,"C",(function(){return N})),n.d(t,"R",(function(){return F})),n.d(t,"T",(function(){return M})),n.d(t,"j",(function(){return L})),n.d(t,"k",(function(){return V})),n.d(t,"S",(function(){return U})),n.d(t,"U",(function(){return H})),n.d(t,"K",(function(){return B})),n.d(t,"s",(function(){return G})),n.d(t,"V",(function(){return W})),n.d(t,"D",(function(){return q})),n.d(t,"L",(function(){return z})),n.d(t,"f",(function(){return Y})),n.d(t,"q",(function(){return K})),n.d(t,"m",(function(){return X})),n.d(t,"N",(function(){return Q})),n.d(t,"E",(function(){return Z})),n.d(t,"z",(function(){return J}))},766:function(e,t,n){var r=n(1118),a=n(1123);e.exports=n(562)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},767:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},768:function(e,t,n){var r=n(330),a=n(475),o=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(1126)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},769:function(e,t,n){var r=n(924);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},770:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},771:function(e,t,n){var r=n(927)("unscopables"),a=Array.prototype;null==a[r]&&n(766)(a,r,{}),e.exports=function(e){a[r][e]=!0}},775:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));n(102);var r="sharedcommentsdemo"===Object({NODE_ENV:"production"}).TEST_PAGE,a=!1},819:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},82:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function a(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},864:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={}))},865:function(e,t,n){"use strict";var r,a,o=n(232);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(a||(a={}));var i=((r={})[0]=o.DeltaFormattingType.Weight,r[1]=o.DeltaFormattingType.Highlight,r[2]=o.DeltaFormattingType.Hyperlink,r[3]=o.DeltaFormattingType.Italic,r[4]=o.DeltaFormattingType.Strikethrough,r[5]=o.DeltaFormattingType.Underline,r),s=n(3),c=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,a,i,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var c=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=c.bold;break;case 3:n.italic=c.italic;break;case 5:n.underline=c.underline;break;case 4:n.strikethrough=c.strikethrough}return 2}var d=void 0,u=void 0;switch(e){case 0:d={type:o.DeltaFormattingType.Weight};break;case 3:d={type:o.DeltaFormattingType.Italic};break;case 5:d={type:o.DeltaFormattingType.Underline};break;case 4:d={type:o.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var l=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.link,m=null!==(s=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.text)&&void 0!==s?s:l;u={type:o.DeltaFormattingType.Hyperlink,data:{text:m,link:l}}}}return d&&this.richContentEditorActor.applyFormattingToCurrentSelection(d),u&&this.richContentEditorActor.addContent(u),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(s.g)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(i[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}(),d=void 0;function u(){if(!d)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===d.RichContentEditAPIImpl&&(d.RichContentEditAPIImpl=new c),d.RichContentEditAPIImpl}"undefined"!=typeof window&&(d=window);var l=new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}());n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}))},868:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},869:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=(n(106),a.a.createContext(null));var i=function(e){e()},s={notify:function(){}};function c(){var e=i,t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,a=n={callback:e,next:null,prev:n};return a.prev?a.prev.next=a:t=a,function(){r&&null!==t&&(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var d=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=s,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=c())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=s)},e}();var u=function(e){var t=e.store,n=e.context,i=e.children,s=Object(r.useMemo)((function(){var e=new d(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),c=Object(r.useMemo)((function(){return t.getState()}),[t]);Object(r.useEffect)((function(){var e=s.subscription;return e.trySubscribe(),c!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[s,c]);var u=n||o;return a.a.createElement(u.Provider,{value:s},i)},l=n(98),m=n(126),f=n(261),p=n.n(f),g=n(311),C="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect,h=[],b=[null,null];function v(e,t){var n=e[1];return[t.payload,n+1]}function y(e,t,n){C((function(){return e.apply(void 0,t)}),n)}function T(e,t,n,r,a,o,i){e.current=r,t.current=a,n.current=!1,o.current&&(o.current=null,i())}function O(e,t,n,r,a,o,i,s,c,d){if(e){var u=!1,l=null,m=function(){if(!u){var e,n,m=t.getState();try{e=r(m,a.current)}catch(e){n=e,l=e}n||(l=null),e===o.current?i.current||c():(o.current=e,s.current=e,i.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=m,n.trySubscribe(),m();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,l)throw l}}}var I=function(){return[null,0]};function S(e,t){void 0===t&&(t={});var n=t,i=n.getDisplayName,s=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,c=n.methodName,u=void 0===c?"connectAdvanced":c,f=n.renderCountProp,C=void 0===f?void 0:f,S=n.shouldHandleStateChanges,_=void 0===S||S,E=n.storeKey,j=void 0===E?"store":E,D=(n.withRef,n.forwardRef),P=void 0!==D&&D,A=n.context,x=void 0===A?o:A,w=Object(m.a)(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),k=x;return function(t){var n=t.displayName||t.name||"Component",o=s(n),i=Object(l.a)({},w,{getDisplayName:s,methodName:u,renderCountProp:C,shouldHandleStateChanges:_,storeKey:j,displayName:o,wrappedComponentName:n,WrappedComponent:t}),c=w.pure;var f=c?r.useMemo:function(e){return e()};function S(n){var o=Object(r.useMemo)((function(){var e=n.reactReduxForwardedRef,t=Object(m.a)(n,["reactReduxForwardedRef"]);return[n.context,e,t]}),[n]),s=o[0],c=o[1],u=o[2],p=Object(r.useMemo)((function(){return s&&s.Consumer&&Object(g.isContextConsumer)(a.a.createElement(s.Consumer,null))?s:k}),[s,k]),C=Object(r.useContext)(p),S=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(C)&&Boolean(C.store);var E=S?n.store:C.store,j=Object(r.useMemo)((function(){return function(t){return e(t.dispatch,i)}(E)}),[E]),D=Object(r.useMemo)((function(){if(!_)return b;var e=new d(E,S?null:C.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[E,S,C]),P=D[0],A=D[1],x=Object(r.useMemo)((function(){return S?C:Object(l.a)({},C,{subscription:P})}),[S,C,P]),w=Object(r.useReducer)(v,h,I),R=w[0][0],N=w[1];if(R&&R.error)throw R.error;var F=Object(r.useRef)(),M=Object(r.useRef)(u),L=Object(r.useRef)(),V=Object(r.useRef)(!1),U=f((function(){return L.current&&u===M.current?L.current:j(E.getState(),u)}),[E,R,u]);y(T,[M,F,V,u,U,L,A]),y(O,[_,E,P,j,M,F,V,L,A,N],[E,P,j]);var H=Object(r.useMemo)((function(){return a.a.createElement(t,Object(l.a)({},U,{ref:c}))}),[c,t,U]);return Object(r.useMemo)((function(){return _?a.a.createElement(p.Provider,{value:x},H):H}),[p,H,x])}var E=c?a.a.memo(S):S;if(E.WrappedComponent=t,E.displayName=o,P){var D=a.a.forwardRef((function(e,t){return a.a.createElement(E,Object(l.a)({},e,{reactReduxForwardedRef:t}))}));return D.displayName=o,D.WrappedComponent=t,p()(D,t)}return p()(E,t)}}function _(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function E(e,t){if(_(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++)if(!Object.prototype.hasOwnProperty.call(t,n[a])||!_(e[n[a]],t[n[a]]))return!1;return!0}var j=n(132);function D(e){return function(t,n){var r=e(t,n);function a(){return r}return a.dependsOnOwnProps=!1,a}}function P(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function A(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=P(e);var a=r(t,n);return"function"==typeof a&&(r.mapToProps=a,r.dependsOnOwnProps=P(a),a=r(t,n)),a},r}}var x=[function(e){return"function"==typeof e?A(e):void 0},function(e){return e?void 0:D((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?D((function(t){return Object(j.bindActionCreators)(e,t)})):void 0}];var w=[function(e){return"function"==typeof e?A(e):void 0},function(e){return e?void 0:D((function(){return{}}))}];function k(e,t,n){return Object(l.a)({},n,e,t)}var R=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,a=n.pure,o=n.areMergedPropsEqual,i=!1;return function(t,n,s){var c=e(t,n,s);return i?a&&o(c,r)||(r=c):(i=!0,r=c),r}}}(e):void 0},function(e){return e?void 0:function(){return k}}];function N(e,t,n,r){return function(a,o){return n(e(a,o),t(r,o),o)}}function F(e,t,n,r,a){var o,i,s,c,d,u=a.areStatesEqual,l=a.areOwnPropsEqual,m=a.areStatePropsEqual,f=!1;function p(a,f){var p,g,C=!l(f,i),h=!u(a,o);return o=a,i=f,C&&h?(s=e(o,i),t.dependsOnOwnProps&&(c=t(r,i)),d=n(s,c,i)):C?(e.dependsOnOwnProps&&(s=e(o,i)),t.dependsOnOwnProps&&(c=t(r,i)),d=n(s,c,i)):h?(p=e(o,i),g=!m(p,s),s=p,g&&(d=n(s,c,i)),d):d}return function(a,u){return f?p(a,u):(s=e(o=a,i=u),c=t(r,i),d=n(s,c,i),f=!0,d)}}function M(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,a=t.initMergeProps,o=Object(m.a)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),i=n(e,o),s=r(e,o),c=a(e,o);return(o.pure?F:N)(i,s,c,e,o)}function L(e,t,n){for(var r=t.length-1;r>=0;r--){var a=t[r](e);if(a)return a}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function V(e,t){return e===t}function U(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?S:n,a=t.mapStateToPropsFactories,o=void 0===a?w:a,i=t.mapDispatchToPropsFactories,s=void 0===i?x:i,c=t.mergePropsFactories,d=void 0===c?R:c,u=t.selectorFactory,f=void 0===u?M:u;return function(e,t,n,a){void 0===a&&(a={});var i=a,c=i.pure,u=void 0===c||c,p=i.areStatesEqual,g=void 0===p?V:p,C=i.areOwnPropsEqual,h=void 0===C?E:C,b=i.areStatePropsEqual,v=void 0===b?E:b,y=i.areMergedPropsEqual,T=void 0===y?E:y,O=Object(m.a)(i,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),I=L(e,o,"mapStateToProps"),S=L(t,s,"mapDispatchToProps"),_=L(n,d,"mergeProps");return r(f,Object(l.a)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:I,initMapDispatchToProps:S,initMergeProps:_,pure:u,areStatesEqual:g,areOwnPropsEqual:h,areStatePropsEqual:v,areMergedPropsEqual:T},O))}}var H=U();var B,G=n(56);n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return H})),B=G.unstable_batchedUpdates,i=B},87:function(e,t,n){"use strict";n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return T})),n.d(t,"h",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"e",(function(){return S})),n.d(t,"i",(function(){return _})),n.d(t,"d",(function(){return E})),n.d(t,"f",(function(){return j})),n.d(t,"j",(function(){return D})),n.d(t,"b",(function(){return P}));var r=n(1),a=n(5),o=n(3),i=n(210),s=n(82),c=n(247),d=n(131),u=n(40),l=n(108),m=n(7),f=n(152),p=n(171),g=n(413);function C(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function h(e,t,n,r,a,i){for(var s=[],c=t,d=a;c<=n&&d<=i;){var u=e[c].date;Object(o.g)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(o.g)().assertConditionTag(e[c].parentId===r.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(o.g)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:r.history[d],parentThreadId:r.commentId}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=i;++d)Object(o.g)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:r.history[d],parentThreadId:r.commentId});return s}function b(e,t){if(!m.b()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(m.c()||t.commentId===t.history[0].commentId||(Object(o.g)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(o.g)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var a=[];m.c()||a.push({commentModel:e[0],historyItem:t.history[0]});for(var i=m.c()?0:1,s=m.c()?0:1,c=m.c()?0:1;i<e.length&&c<t.history.length;){var d=C(e,i,t.history[c]);d>=0&&(a.push.apply(a,Object(r.__spread)(h(e,i,d-1,t,s,c-1))),Object(o.g)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),a.push({commentModel:e[d],historyItem:t.history[c]}),i=d+1,s=c+1),++c}return a.push.apply(a,Object(r.__spread)(h(e,i,e.length-1,t,s,t.history.length-1))),a}function v(e,t){for(var n=[],a=0,o=1;o<=e.length;o++)(o===e.length||Object(s.a)(e[o]))&&(n.push.apply(n,Object(r.__spread)(b(e.slice(a,o),t[e[a].commentId]))),a=o);return n}function y(e){return e.filter(p.a).map((function(e){return e.commentModel}))}function T(e,t){var n=e.find((function(e){return Object(p.a)(e)&&e.commentModel.commentId===t}));if(Object(p.a)(n))return n.commentModel}function O(e){var t=e[0];if(Object(p.a)(t))return t.commentModel;throw new u.a(l.a,a.e.reserveTag(589103627),2130957505)}function I(e){return Object(p.a)(e)?e.commentModel.parentId:e.parentThreadId}function S(e){return Object(p.a)(e)?e.commentModel.commentId:e.historyItem.records[0].recordId}function _(e){return Object(p.a)(e)?Object(s.b)(e.commentModel):e.parentThreadId}function E(e,t){var n=e.records[0];switch(n.type){case c.a.Create:if(!(a=e.records[1])||a.type!==c.a.Assign)return Object(o.g)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:"Unexpected HistoryRecordType"};var r=Object(d.f)(a.assignee);return{icon:13,description:t.formatString(114,r)};case c.a.UnassignAll:case c.a.Unassign:var a;if(!(a=e.records[1])||a.type!==c.a.Assign)return Object(o.g)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:14,description:t.getString(204)};r=Object(d.f)(a.assignee);return{icon:14,description:t.formatString(115,r)};case c.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:21,description:t.getString(117)};case c.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(o.g)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function j(e,t){return e.findIndex((function(e){return e.length>0&&_(e[0])===t}))}function D(e,t){return e.some((function(e){return Object(p.a)(e)&&!!(e.commentModel.commentFlags&i.e.LowFidelity)&&(void 0===t||t===e.commentModel.parentId||t===e.commentModel.commentId)}))}function P(e,t,n,r,a){for(var i=[],s=!a&&void 0!==n&&(void 0===n.newComment.parentId||""===n.newComment.parentId)&&n.index>=0,c=y(e).length,d=n&&n.index===c?c:-1,u=-1,l=0;l<e.length;l+=1){var m=e[l],C=Object(p.a)(m)?m:void 0;if(C&&void 0!==t[C.commentModel.commentId])if(t[C.commentModel.commentId].pending===f.a.Delete&&r)for(;!(l+1>=e.length||""===I(e[l+1]));)++l;else{++u,i.push([C]),s&&-1===d&&n&&u===n.index&&(d=i.length-1);for(var h=l+1;h<e.length;h+=1){var b=e[h];if(Object(p.a)(b)){var v=I(b);if(v!==C.commentModel.commentId){Object(o.g)().assertConditionTag(!v,"Orphaned reply with id "+S(b)+", expected parent "+C.commentModel.commentId+" but was "+v,593085889);break}i[i.length-1].push(b),++u}else i[i.length-1].push(b);++l}}else{var T=C?C.commentModel.commentId:"",O=C?C.commentModel.parentId:"";for(Object(o.g)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: "+e.length+" | cardViewStateLength: "+Object.keys(t).length+" | isLieThread: "+s+" | CommentId: "+T+" | ParentId: "+O,593085888);!(l+1>=e.length||""===I(e[l+1]));)++l}}if(-1!==d&&s&&n){var _=Object(g.a)(n);i.splice(d,0,[{commentModel:_}])}return i}},878:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},879:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(70);function a(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function o(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},880:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),a=n(13),o=n(168);function i(e,t,n){var i=Object(a.I)(n);if(i)return i.threadId!==e?o.a.InOtherCard:r.p()&&i.renderContextType!==t?o.a.InOtherContextOfThisCard:"EDIT"===i.commentDraft.sessionConfiguration.sessionType?o.a.InChildPost:o.a.InCard}},89:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function a(e){return void 0!==e.comments||void 0!==e.threads}function o(e){return void 0!==e.threads&&void 0===e.comments}var i;function s(e){return(void 0!==e.comments||void 0!==e.commentIds)&&void 0!==e.numberOfThreads}function c(e){return void 0!==e.commentIds&&void 0!==e.numberOfThreads}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function m(e){return void 0!==e.contextDetails}function f(e){return void 0!==e.capabilities}function p(e){return void 0!==e.modelCapabilityFlags}function g(e){return void 0!==e.errorType}function C(e){return void 0!==e.draftId}function h(e){return void 0!==e.draftId}function b(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"p",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"m",(function(){return C})),n.d(t,"o",(function(){return h})),n.d(t,"n",(function(){return b})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(i||(i={}))},893:function(e,t,n){"use strict";var r,a=n(0),o=n(1);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(o.__spreadArrays)(n,t))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var a=s.apply(void 0,t);return r=void 0,a}}n.d(t,"a",(function(){return u}));var d,u={useMemo:c(a.useMemo),useEffect:c(a.useEffect),useLayoutEffect:c(a.useLayoutEffect),useCallback:(d=a.useCallback,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r)throw new Error("Recursive calls of hooks is not supported!");r=d;var n=i.apply(void 0,e);return r=void 0,n})}},920:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},921:function(e,t,n){var r=n(1127);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},922:function(e,t,n){var r=n(923),a=n(925),o=n(1128);e.exports=function(e){return function(t,n,i){var s,c=r(t),d=a(c.length),u=o(i,d);if(e&&n!=n){for(;d>u;)if((s=c[u++])!=s)return!0}else for(;d>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},923:function(e,t,n){var r=n(769),a=n(770);e.exports=function(e){return r(a(e))}},924:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},925:function(e,t,n){var r=n(926),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},926:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},927:function(e,t,n){var r=n(768)("wks"),a=n(767),o=n(475).Symbol,i="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=i&&o[e]||(i?o:a)("Symbol."+e))}).store=r},928:function(e,t,n){var r=n(921),a=n(769),o=n(929),i=n(925),s=n(1131);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,u=4==e,l=6==e,m=5==e||l,f=t||s;return function(t,s,p){for(var g,C,h=o(t),b=a(h),v=r(s,p,3),y=i(b.length),T=0,O=n?f(t,y):c?f(t,0):void 0;y>T;T++)if((m||T in b)&&(C=v(g=b[T],T,h),e))if(n)O[T]=C;else if(C)switch(e){case 3:return!0;case 5:return g;case 6:return T;case 2:O.push(g)}else if(u)return!1;return l?-1:d||u?u:O}}},929:function(e,t,n){var r=n(770);e.exports=function(e){return Object(r(e))}},93:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));var r,a=n(342);function o(e){return e===a.a.CheckEnabled}function i(e){return e===a.a.CheckToggled}function s(e){return e===a.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},932:function(e,t,n){var r=n(0);function a(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}a.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=a,a.default=a},933:function(e,t,n){"use strict";var r=n(1171).SharedCommentsVersion;t.a=r},934:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),a=n(13),o=n(151),i=n(140);function s(e,t){var n=Object(a.I)(e);if(!n)return Object(r.g)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(i.b)(t)?o.a.ClosePaneDraft:o.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return o.a.CancelNewDraft;case"EDIT":return o.a.CancelPostEdit;case"REPLY":return o.a.CancelReplyDraft;case"METADATA":return Object(r.g)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),o.a.CancelNewDraft}}}},[[1480,2,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map